Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Background 2 Partitioning the sum of squares in linear regression Toggle Partitioning the sum of squares in linear regression subsection 2.1 Proof 2.2 Further partitioning 3 See also 4 References Toggle the table of contents Partition of sums of squares 1 language Italiano Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Concept that permeates much of inferential statistics and descriptive statistics This article is about the partition of sums of squares in statistics. For other uses, see Sum of squares .

For broader coverage of this topic, see Analysis of variance .

"Variance partitioning" redirects here; not to be confused with Variance decomposition .

The partition of sums of squares is a concept that permeates much of inferential statistics and descriptive statistics . More properly, it is the partitioning of sums of squared deviations or errors . Mathematically, the sum of squared deviations is an unscaled, or unadjusted measure of dispersion (also called variability ). When scaled for the number of degrees of freedom , it estimates the variance , or spread of the observations about their mean value. Partitioning of the sum of squared deviations into various components allows the overall variability in a dataset to be ascribed to different types or sources of variability, with the relative importance of each being quantified by the size of each component of the overall sum of squares.

Background [ edit ] The distance from any point in a collection of data, to the mean of the data, is the deviation. This can be written as y i − − y ¯ ¯ {\displaystyle y_{i}-{\overline {y}}} , where y i {\displaystyle y_{i}} is the ith data point, and y ¯ ¯ {\displaystyle {\overline {y}}} is the estimate of the mean. If all such deviations are squared, then summed, as in ∑ ∑ i = 1 n ( y i − − y ¯ ¯ ) 2 {\displaystyle \sum _{i=1}^{n}\left(y_{i}-{\overline {y}}\,\right)^{2}} , this gives the "sum of squares" for these data.

When more data are added to the collection the sum of squares will increase, except in unlikely cases such as the new data being equal to the mean. So usually, the sum of squares will grow with the size of the data collection. That is a manifestation of the fact that it is unscaled.

In many cases, the number of degrees of freedom is simply the number of data points in the collection, minus one. We write this as n − 1, where n is the number of data points.

Scaling (also known as normalizing) means adjusting the sum of squares so that it does not grow as the size of the data collection grows. This is important when we want to compare samples of different sizes, such as a sample of 100 people compared to a sample of 20 people. If the sum of squares were not normalized, its value would always be larger for the sample of 100 people than for the sample of 20 people. To scale the sum of squares, we divide it by the degrees of freedom, i.e., calculate the sum of squares per degree of freedom, or variance.

Standard deviation , in turn, is the square root of the variance.

The above describes how the sum of squares is used in descriptive statistics; see the article on total sum of squares for an application of this broad principle to inferential statistics .

Partitioning the sum of squares in linear regression [ edit ] Theorem.

Given a linear regression model y i = β β 0 + β β 1 x i 1 + ⋯ ⋯ + β β p x i p + ε ε i {\displaystyle y_{i}=\beta _{0}+\beta _{1}x_{i1}+\cdots +\beta _{p}x_{ip}+\varepsilon _{i}} including a constant β β 0 {\displaystyle \beta _{0}} , based on a sample ( y i , x i 1 , … … , x i p ) , i = 1 , … … , n {\displaystyle (y_{i},x_{i1},\ldots ,x_{ip}),\,i=1,\ldots ,n} containing n observations, the total sum of squares T S S = ∑ ∑ i = 1 n ( y i − − y ¯ ¯ ) 2 {\displaystyle \mathrm {TSS} =\sum _{i=1}^{n}(y_{i}-{\bar {y}})^{2}} can be partitioned as follows into the explained sum of squares (ESS) and the residual sum of squares (RSS): T S S = E S S + R S S , {\displaystyle \mathrm {TSS} =\mathrm {ESS} +\mathrm {RSS} ,} where this equation is equivalent to each of the following forms: ‖ y − − y ¯ ¯ 1 ‖ 2 = ‖ y ^ ^ − − y ¯ ¯ 1 ‖ 2 + ‖ ε ε ^ ^ ‖ 2 , 1 = ( 1 , 1 , … … , 1 ) T , ∑ ∑ i = 1 n ( y i − − y ¯ ¯ ) 2 = ∑ ∑ i = 1 n ( y ^ ^ i − − y ¯ ¯ ) 2 + ∑ ∑ i = 1 n ( y i − − y ^ ^ i ) 2 , ∑ ∑ i = 1 n ( y i − − y ¯ ¯ ) 2 = ∑ ∑ i = 1 n ( y ^ ^ i − − y ¯ ¯ ) 2 + ∑ ∑ i = 1 n ε ε ^ ^ i 2 , {\displaystyle {\begin{aligned}\left\|y-{\bar {y}}\mathbf {1} \right\|^{2}&=\left\|{\hat {y}}-{\bar {y}}\mathbf {1} \right\|^{2}+\left\|{\hat {\varepsilon }}\right\|^{2},\quad \mathbf {1} =(1,1,\ldots ,1)^{T},\\\sum _{i=1}^{n}(y_{i}-{\bar {y}})^{2}&=\sum _{i=1}^{n}({\hat {y}}_{i}-{\bar {y}})^{2}+\sum _{i=1}^{n}(y_{i}-{\hat {y}}_{i})^{2},\\\sum _{i=1}^{n}(y_{i}-{\bar {y}})^{2}&=\sum _{i=1}^{n}({\hat {y}}_{i}-{\bar {y}})^{2}+\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}^{2},\\\end{aligned}}} where y ^ ^ i {\displaystyle {\hat {y}}_{i}} is the value estimated by the regression line having b ^ ^ 0 {\displaystyle {\hat {b}}_{0}} , b ^ ^ 1 {\displaystyle {\hat {b}}_{1}} , ..., b ^ ^ p {\displaystyle {\hat {b}}_{p}} as the estimated coefficients .

[ 1 ] Proof [ edit ] ∑ ∑ i = 1 n ( y i − − y ¯ ¯ ) 2 = ∑ ∑ i = 1 n ( y i − − y ¯ ¯ + y ^ ^ i − − y ^ ^ i ) 2 = ∑ ∑ i = 1 n ( ( y ^ ^ i − − y ¯ ¯ ) + ( y i − − y ^ ^ i ) ⏟ ⏟ ε ε ^ ^ i ) 2 = ∑ ∑ i = 1 n ( ( y ^ ^ i − − y ¯ ¯ ) 2 + 2 ε ε ^ ^ i ( y ^ ^ i − − y ¯ ¯ ) + ε ε ^ ^ i 2 ) = ∑ ∑ i = 1 n ( y ^ ^ i − − y ¯ ¯ ) 2 + ∑ ∑ i = 1 n ε ε ^ ^ i 2 + 2 ∑ ∑ i = 1 n ε ε ^ ^ i ( y ^ ^ i − − y ¯ ¯ ) = ∑ ∑ i = 1 n ( y ^ ^ i − − y ¯ ¯ ) 2 + ∑ ∑ i = 1 n ε ε ^ ^ i 2 + 2 ∑ ∑ i = 1 n ε ε ^ ^ i ( β β ^ ^ 0 + β β ^ ^ 1 x i 1 + ⋯ ⋯ + β β ^ ^ p x i p − − y ¯ ¯ ) = ∑ ∑ i = 1 n ( y ^ ^ i − − y ¯ ¯ ) 2 + ∑ ∑ i = 1 n ε ε ^ ^ i 2 + 2 ( β β ^ ^ 0 − − y ¯ ¯ ) ∑ ∑ i = 1 n ε ε ^ ^ i ⏟ ⏟ 0 + 2 β β ^ ^ 1 ∑ ∑ i = 1 n ε ε ^ ^ i x i 1 ⏟ ⏟ 0 + ⋯ ⋯ + 2 β β ^ ^ p ∑ ∑ i = 1 n ε ε ^ ^ i x i p ⏟ ⏟ 0 = ∑ ∑ i = 1 n ( y ^ ^ i − − y ¯ ¯ ) 2 + ∑ ∑ i = 1 n ε ε ^ ^ i 2 = E S S + R S S {\displaystyle {\begin{aligned}\sum _{i=1}^{n}(y_{i}-{\overline {y}})^{2}&=\sum _{i=1}^{n}(y_{i}-{\overline {y}}+{\hat {y}}_{i}-{\hat {y}}_{i})^{2}=\sum _{i=1}^{n}(({\hat {y}}_{i}-{\bar {y}})+\underbrace {(y_{i}-{\hat {y}}_{i})} _{{\hat {\varepsilon }}_{i}})^{2}\\&=\sum _{i=1}^{n}(({\hat {y}}_{i}-{\bar {y}})^{2}+2{\hat {\varepsilon }}_{i}({\hat {y}}_{i}-{\bar {y}})+{\hat {\varepsilon }}_{i}^{2})\\&=\sum _{i=1}^{n}({\hat {y}}_{i}-{\bar {y}})^{2}+\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}^{2}+2\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}({\hat {y}}_{i}-{\bar {y}})\\&=\sum _{i=1}^{n}({\hat {y}}_{i}-{\bar {y}})^{2}+\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}^{2}+2\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}({\hat {\beta }}_{0}+{\hat {\beta }}_{1}x_{i1}+\cdots +{\hat {\beta }}_{p}x_{ip}-{\overline {y}})\\&=\sum _{i=1}^{n}({\hat {y}}_{i}-{\bar {y}})^{2}+\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}^{2}+2({\hat {\beta }}_{0}-{\overline {y}})\underbrace {\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}} _{0}+2{\hat {\beta }}_{1}\underbrace {\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}x_{i1}} _{0}+\cdots +2{\hat {\beta }}_{p}\underbrace {\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}x_{ip}} _{0}\\&=\sum _{i=1}^{n}({\hat {y}}_{i}-{\bar {y}})^{2}+\sum _{i=1}^{n}{\hat {\varepsilon }}_{i}^{2}=\mathrm {ESS} +\mathrm {RSS} \\\end{aligned}}} The requirement that the model include a constant or equivalently that the design matrix contain a column of ones ensures that ∑ ∑ i = 1 n ε ε ^ ^ i = 0 {\displaystyle \sum _{i=1}^{n}{\hat {\varepsilon }}_{i}=0} , i.e.

ε ε ^ ^ T 1 = 0 {\displaystyle {\hat {\varepsilon }}^{T}\mathbf {1} =0} .

The proof can also be expressed in vector form, as follows: S S total = ‖ ‖ y − − y ¯ ¯ 1 ‖ ‖ 2 = ‖ ‖ y − − y ¯ ¯ 1 + y ^ ^ − − y ^ ^ ‖ ‖ 2 , = ‖ ‖ ( y ^ ^ − − y ¯ ¯ 1 ) + ( y − − y ^ ^ ) ‖ ‖ 2 , = ‖ ‖ y ^ ^ − − y ¯ ¯ 1 ‖ ‖ 2 + ‖ ‖ ε ε ^ ^ ‖ ‖ 2 + 2 ε ε ^ ^ T ( y ^ ^ − − y ¯ ¯ 1 ) , = S S regression + S S error + 2 ε ε ^ ^ T ( X β β ^ ^ − − y ¯ ¯ 1 ) , = S S regression + S S error + 2 ( ε ε ^ ^ T X ) β β ^ ^ − − 2 y ¯ ¯ ε ε ^ ^ T 1 ⏟ ⏟ 0 , = S S regression + S S error .

{\displaystyle {\begin{aligned}SS_{\text{total}}=\Vert \mathbf {y} -{\bar {y}}\mathbf {1} \Vert ^{2}&=\Vert \mathbf {y} -{\bar {y}}\mathbf {1} +\mathbf {\hat {y}} -\mathbf {\hat {y}} \Vert ^{2},\\&=\Vert \left(\mathbf {\hat {y}} -{\bar {y}}\mathbf {1} \right)+\left(\mathbf {y} -\mathbf {\hat {y}} \right)\Vert ^{2},\\&=\Vert {\mathbf {\hat {y}} -{\bar {y}}\mathbf {1} }\Vert ^{2}+\Vert {\hat {\varepsilon }}\Vert ^{2}+2{\hat {\varepsilon }}^{T}\left(\mathbf {\hat {y}} -{\bar {y}}\mathbf {1} \right),\\&=SS_{\text{regression}}+SS_{\text{error}}+2{\hat {\varepsilon }}^{T}\left(X{\hat {\beta }}-{\bar {y}}\mathbf {1} \right),\\&=SS_{\text{regression}}+SS_{\text{error}}+2\left({\hat {\varepsilon }}^{T}X\right){\hat {\beta }}-2{\bar {y}}\underbrace {{\hat {\varepsilon }}^{T}\mathbf {1} } _{0},\\&=SS_{\text{regression}}+SS_{\text{error}}.\end{aligned}}} The elimination of terms in the last line, used the fact that ε ε ^ ^ T X = ( y − − y ^ ^ ) T X = y T ( I − − X ( X T X ) − − 1 X T ) T X = y T ( X T − − X T ) T = 0 .

{\displaystyle {\hat {\varepsilon }}^{T}X=\left(\mathbf {y} -\mathbf {\hat {y}} \right)^{T}X=\mathbf {y} ^{T}(I-X(X^{T}X)^{-1}X^{T})^{T}X={\mathbf {y} }^{T}(X^{T}-X^{T})^{T}={\mathbf {0} }.} Further partitioning [ edit ] Note that the residual sum of squares can be further partitioned as the lack-of-fit sum of squares plus the sum of squares due to pure error.

See also [ edit ] Inner-product space Hilbert space Euclidean space Expected mean squares Orthogonality Orthonormal basis Orthogonal complement , the closed subspace orthogonal to a set (especially a subspace) Orthomodular lattice of the subspaces of an inner-product space Orthogonal projection Pythagorean theorem that the sum of the squared norms of orthogonal summands equals the squared norm of the sum.

Least squares Mean squared error Squared deviations References [ edit ] ^ "Sum of Squares - Definition, Formulas, Regression Analysis" .

Corporate Finance Institute . Retrieved 2020-10-16 .

Bailey, R. A.

(2008).

Design of Comparative Experiments . Cambridge University Press.

ISBN 978-0-521-68357-9 .

Pre-publication chapters are available on-line.

Christensen, Ronald (2002).

Plane Answers to Complex Questions: The Theory of Linear Models (Third ed.). New York: Springer.

ISBN 0-387-95361-2 .

Whittle, Peter (1963).

Prediction and Regulation . English Universities Press.

ISBN 0-8166-1147-5 .

{{ cite book }} : ISBN / Date incompatibility ( help ) Republished as: Whittle, P. (1983).

Prediction and Regulation by Linear Least-Square Methods . University of Minnesota Press.

ISBN 0-8166-1148-3 .

Whittle, P. (20 April 2000).

Probability Via Expectation (4th ed.). Springer.

ISBN 0-387-98955-2 .

Retrieved from " https://en.wikipedia.org/w/index.php?title=Partition_of_sums_of_squares&oldid=1305882814 " Categories : Analysis of variance Least squares Hidden categories: Articles with short description Short description is different from Wikidata CS1 errors: ISBN date This page was last edited on 14 August 2025, at 16:52 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Partition of sums of squares 1 language Add topic

