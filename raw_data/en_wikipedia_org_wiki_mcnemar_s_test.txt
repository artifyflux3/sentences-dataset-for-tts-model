Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Definition Toggle Definition subsection 1.1 Variations 2 Examples Toggle Examples subsection 2.1 Example implementation in Python 3 Discussion Toggle Discussion subsection 3.1 Information in the pairings 4 Related tests and methods 5 See also 6 References 7 External links Toggle the table of contents McNemar's test 12 languages Deutsch Euskara فارسی Français Italiano עברית Kiswahili 日本語 Polski Português Suomi 粵語 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Statistical test used on paired nominal data This article may be too technical for most readers to understand .

Please help improve it to make it understandable to non-experts , without removing the technical details.

( November 2012 ) ( Learn how and when to remove this message ) McNemar's test is a statistical test used on paired nominal data . It is applied to 2 × 2 contingency tables with a dichotomous trait, with matched pairs of subjects, to determine whether the row and column marginal frequencies are equal (that is, whether there is "marginal homogeneity "). It is named after Quinn McNemar , who introduced it in 1947.

[ 1 ] An application of the test in genetics is the transmission disequilibrium test for detecting linkage disequilibrium .

[ 2 ] The commonly used parameters to assess a diagnostic test in medical sciences are sensitivity and specificity . Sensitivity (or recall) is the ability of a test to correctly identify the people with disease. Specificity is the ability of the test  to correctly identify those without the disease.

Now presume two tests are performed on the same group of patients. And also presume that these tests have identical sensitivity and specificity. In this situation one is carried away by these findings and presume that both the tests are equivalent. However this may not be the case. For this we have to study the patients with disease and patients without disease (by a reference test). We also have to find out where these two tests disagree with each other. This is precisely the basis of McNemar's test. This test compares the sensitivity and specificity of  two diagnostic tests on the same group of patients.

[ 3 ] Definition [ edit ] The test is applied to a 2 × 2 contingency table, which tabulates the outcomes of two tests on a sample of N subjects, as follows.

Test 2 positive Test 2 negative Row total Test 1 positive a b a + b Test 1 negative c d c + d Column total a + c b + d N The null hypothesis of marginal homogeneity states that the two marginal probabilities for each outcome are the same, i.e.

p a + p b = p a + p c and p c + p d = p b + p d .

Thus the null and alternative hypotheses are [ 1 ] H 0 : p b = p c H 1 : p b ≠ ≠ p c {\displaystyle {\begin{aligned}H_{0}&:~p_{b}=p_{c}\\H_{1}&:~p_{b}\neq p_{c}\end{aligned}}} Here p a , etc., denote the theoretical probability of occurrences in cells with the corresponding label.

The McNemar test statistic is: χ χ 2 = ( b − − c ) 2 b + c .

{\displaystyle \chi ^{2}={(b-c)^{2} \over b+c}.} Under the null hypothesis, with a sufficiently large number of discordants (cells b and c), χ χ 2 {\displaystyle \chi ^{2}} has a chi-squared distribution with 1 degree of freedom . If the χ χ 2 {\displaystyle \chi ^{2}} result is significant , this provides sufficient evidence to reject the null hypothesis, in favour of the alternative hypothesis that p b ≠ p c , which would mean that the marginal proportions are significantly different from each other.

Variations [ edit ] If either b or c is small ( b + c < 25) then χ χ 2 {\displaystyle \chi ^{2}} is not well-approximated by the chi-squared distribution.

[ citation needed ] An exact binomial test can then be used, where b is compared to a binomial distribution with size parameter n = b + c and p = 0.5. Effectively, the exact binomial test evaluates the imbalance in the discordants b and c . To achieve a two-sided P-value, the P-value of the extreme tail should be multiplied by 2. For b ≥ c : exact-P-value = 2 ∑ ∑ i = b n ( n i ) 0.5 i ( 1 − − 0.5 ) n − − i , {\displaystyle {\text{exact-P-value}}=2\sum _{i=b}^{n}{n \choose i}0.5^{i}(1-0.5)^{n-i},} which is simply twice the binomial distribution cumulative distribution function with p = 0.5 and n = b + c .

Edwards [ 4 ] proposed the following continuity corrected version of the McNemar test to approximate the binomial exact-P-value: χ χ 2 = ( | b − − c | − − 1 ) 2 b + c .

{\displaystyle \chi ^{2}={(|b-c|-1)^{2} \over b+c}.} The mid-P McNemar test (mid-p binomial test) is calculated by subtracting half the probability of the observed b from the exact
one-sided P-value, then double it to obtain the two-sided mid-P-value: [ 5 ] [ 6 ] mid-p-value = 2 ( ∑ ∑ i = b n ( n i ) 0.5 i ( 1 − − 0.5 ) n − − i − − 0.5 ( n b ) 0.5 b ( 1 − − 0.5 ) n − − b ) {\displaystyle {\text{mid-p-value}}=2\left(\sum _{i=b}^{n}{n \choose i}0.5^{i}(1-0.5)^{n-i}-0.5{n \choose b}0.5^{b}(1-0.5)^{n-b}\right)} This is equivalent to: mid-p-value = exact-p-value − − ( n b ) 0.5 b ( 1 − − 0.5 ) n − − b {\displaystyle {\text{mid-p-value}}={\text{exact-p-value}}-{n \choose b}0.5^{b}(1-0.5)^{n-b}} where the second term is the binomial distribution probability mass function and n = b + c . Binomial distribution functions are readily available in common software packages and the McNemar mid-P test can easily be calculated.

[ 6 ] The traditional advice has been to use the exact binomial test when b + c < 25. However, simulations have shown both the exact binomial test and the McNemar test with continuity correction to be overly conservative.

[ 6 ] When b + c < 6, the exact-P-value always exceeds the common significance level 0.05. The original McNemar test was most powerful, but often slightly liberal. The mid-P version was almost as powerful as the asymptotic McNemar test and was not found to exceed the nominal significance level.

Examples [ edit ] In the first example, a researcher attempts to determine if a drug has an effect on a particular disease. There are 314 patients, and they are diagnosed (disease: present or absent ) before and after using the drug, which means that each sample can be described using 1 out of 4 combinations.
Counts of individuals are given in the table, with the diagnosis (disease: present or absent ) before treatment given in the rows, and the diagnosis after treatment in the columns. The test requires the same subjects to be included in the before-and-after measurements (matched pairs).

After: present After: absent Row total Before: present 101 121 222 Before: absent 59 33 92 Column total 160 154 314 In this example, the null hypothesis of "marginal homogeneity" would mean there was no effect of the treatment. From the above data, the McNemar test statistic: χ χ 2 = ( 121 − − 59 ) 2 121 + 59 {\displaystyle \chi ^{2}={(121-59)^{2} \over {121+59}}} has the value 21.35, which is extremely unlikely to form the distribution implied by the null hypothesis ( p < 0.001). Thus the test provides strong evidence to reject the null hypothesis of no treatment effect.

A second example illustrates differences between the asymptotic McNemar test and alternatives.

[ 6 ] The data table is formatted as before, with different numbers in the cells: After: present After: absent Row total Before: present 59 6 65 Before: absent 16 80 96 Column total 75 86 161 With these data, the sample size (161 patients) is not small, however results from the McNemar test and other versions are different. The exact binomial test gives p = 0.053 and McNemar's test with continuity correction gives χ χ 2 {\displaystyle \chi ^{2}} = 3.68 and p = 0.055. The asymptotic McNemar's test gives χ χ 2 {\displaystyle \chi ^{2}} = 4.55 and p = 0.033 and the mid-P McNemar's test gives p = 0.035. Both the McNemar's test and mid-P version provide stronger evidence for a statistically significant treatment effect in this second example.

Example implementation in Python [ edit ] The following is an example implementation using the probability distributions provided by the SciPy package. The implementation uses the mid-P version if b + c < 25. Otherwise, it uses the asymptotic version, allowing for both the regular form and the continuity corrected form.

from scipy.stats import binom , chi2 def mcnemar ( b : int , c : int , continuity_correction : bool = False ) -> float : check_valid = lambda n : isinstance ( n , int ) or ( isinstance ( n , float ) and n .

is_integer ()) if not all ( map ( check_valid , [ b , c ])): raise ValueError ( "b and c must be integers!" ) n_min , n_max = sorted ([ b , c ]) corr = int ( continuity_correction ) if ( n_min + n_max ) < 25 : pvalue = 2 * binom .

cdf ( n_min , n_min + n_max , 0.5 ) - binom .

pmf ( n_min , n_min + n_max , 0.5 ) else : chi2_statistic = ( abs ( n_min - n_max ) - corr ) ** 2 / ( n_min + n_max ) pvalue = chi2 .

sf ( chi2_statistic , 1 ) return pvalue It is also worth noting that the above implementation ensures that the smaller of b and c is passed as the first argument to the binomial probability distributions. See "Additional file 1" under the supplementary materials for further reading.

[ 6 ] Discussion [ edit ] An interesting observation when interpreting McNemar's test is that the elements of the main diagonal do not contribute to the decision about whether (in the above example) pre- or post-treatment condition is more favourable. Thus, the sum b + c can be small and statistical power of the tests described above can be low even though the number of pairs a + b + c + d is large (see second example above).

An extension of McNemar's test exists in situations where independence does not necessarily hold between the pairs; instead, there are clusters of paired data where the pairs in a cluster may not be independent, but independence holds between different clusters.

[ 7 ] An example is analyzing the effectiveness of a dental procedure; in this case, a pair corresponds to the treatment of an individual tooth in patients who might have multiple teeth treated; the effectiveness of treatment of two teeth in the same patient is not likely to be independent, but the treatment of two teeth in different patients is more likely to be independent.

[ 8 ] Information in the pairings [ edit ] In the 1970s, it was conjectured that retaining one's tonsils might protect against Hodgkin's lymphoma . John Rice wrote: [ 9 ] 85 Hodgkin's patients [...] had a sibling of the same sex
who was free of the disease and whose age was within 5 years of
the patient's. These investigators presented the following table: Tonsillectomy No tonsillectomy Hodgkins 41 44 Control 33 52 {\displaystyle {\begin{array}{c|c|c}\hline &{\text{Tonsillectomy}}&{\text{No tonsillectomy}}\\\hline {\text{Hodgkins}}&41&44\\\hline {\text{Control}}&33&52\end{array}}} They calculated a chi-squared statistic [...] [they] had made an error in their analysis by ignoring the pairings.[...] [their] samples were not independent, because the siblings were paired [...] we set up a table that exhibits the pairings: Sibling Patient No tonsillectomy Tonsillectomy No tonsillectomy 37 7 Tonsillectomy 15 26 {\displaystyle {\begin{array}{cc}&{\text{Sibling}}\\{\text{Patient}}&{\begin{array}{c|c|c}\hline &{\text{No tonsillectomy}}&{\text{Tonsillectomy}}\\\hline {\text{No tonsillectomy}}&37&7\\\hline {\text{Tonsillectomy}}&15&26\end{array}}\end{array}}} It is to the second table that McNemar's test can be applied.  Notice that the sum of the numbers in the second table is 85—the number of pairs of siblings—whereas the sum of the numbers in the first table is twice as big, 170—the number of individuals.  The second table gives more information than the first.  The numbers in the first table can be found by using the numbers in the second table, but not vice versa.  The numbers in the first table give only the marginal totals of the numbers in the second table. McNemar's test allows the 15 and 7 pairs where the siblings had previously had differing  treatment to their tonsils to be compared, as being relevant to the hypothesis, while ignoring the less informative 37 and 26 where the siblings had previously both had the treatment or to their tonsils or neither had.

Related tests and methods [ edit ] The binomial sign test gives an exact test for the McNemar's test.

The Cochran's Q test is an extension of the McNemar's test for more than two "treatments".

The Liddell's exact test is an exact alternative to McNemar's test.

[ 10 ] [ 11 ] The Stuart–Maxwell test is different generalization of the McNemar test, used for testing marginal homogeneity in a square table with more than two rows/columns.

[ 12 ] [ 13 ] [ 14 ] The Bhapkar's test (1966)  is a more powerful alternative to the Stuart–Maxwell test, [ 15 ] [ 16 ] but it tends to be liberal. Competitive alternatives to the extant methods are available.

[ 17 ] The McNemar's test is a special case of the Cochran–Mantel–Haenszel test ; it is equivalent to a CMH test with one stratum for each of the N pairs and, in each stratum, a 2x2 table showing the paired binary responses.

[ 18 ] Multinomial confidence intervals are used for matched pairs binary data.

See also [ edit ] Pearson's chi-squared test Chi-squared distribution References [ edit ] ^ a b McNemar, Quinn (June 18, 1947). "Note on the sampling error of the difference between correlated proportions or percentages".

Psychometrika .

12 (2): 153– 157.

doi : 10.1007/BF02295996 .

PMID 20254758 .

S2CID 46226024 .

^ Spielman RS; McGinnis RE; Ewens WJ (Mar 1993).

"Transmission test for linkage disequilibrium: the insulin gene region and insulin-dependent diabetes mellitus (IDDM)" .

Am J Hum Genet .

52 (3): 506– 16.

PMC 1682161 .

PMID 8447318 .

^ Hawass, N E (April 1997). "Comparing the sensitivities and specificities of two diagnostic procedures performed on the same group of patients".

The British Journal of Radiology .

70 (832): 360– 366.

doi : 10.1259/bjr.70.832.9166071 .

ISSN 0007-1285 .

PMID 9166071 .

^ Edwards, A (1948). "Note on the "correction for continuity" in testing the significance of the difference between correlated proportions".

Psychometrika .

13 (3): 185– 187.

doi : 10.1007/bf02289261 .

PMID 18885738 .

S2CID 33607853 .

^ Lancaster, H.O. (1961). "Significance tests in discrete distributions".

J Am Stat Assoc .

56 (294): 223– 234.

doi : 10.1080/01621459.1961.10482105 .

^ a b c d e Fagerland, M.W.; Lydersen, S.; Laake, P. (2013).

"The McNemar test for binary matched-pairs data: mid-p and asymptotic are better than exact conditional" .

BMC Medical Research Methodology .

13 : 91.

doi : 10.1186/1471-2288-13-91 .

PMC 3716987 .

PMID 23848987 .

^ Yang, Z.; Sun, X.; Hardin, J.W. (2010). "A note on the tests for clustered matched-pair binary data".

Biometrical Journal .

52 (5): 638– 652.

doi : 10.1002/bimj.201000035 .

PMID 20976694 .

S2CID 29461324 .

^ Durkalski, V.L.; Palesch, Y.Y.; Lipsitz, S.R.; Rust, P.F. (2003).

"Analysis of clustered matched-pair data" .

Statistics in Medicine .

22 (15): 2417– 28.

doi : 10.1002/sim.1438 .

PMID 12872299 .

S2CID 25909362 . Archived from the original on January 5, 2013 . Retrieved April 1, 2009 .

^ Rice, John (1995).

Mathematical Statistics and Data Analysis (Second ed.). Belmont, California: Duxbury Press . pp.

492 –494.

ISBN 978-0-534-20934-6 .

^ Liddell, D. (1976). "Practical Tests of 2 × 2 Contingency Tables".

Journal of the Royal Statistical Society .

25 (4): 295– 304.

doi : 10.2307/2988087 .

JSTOR 2988087 .

^ "Maxwell's test, McNemar's test, Kappa test" . Rimarcik.com . Retrieved 2012-11-22 .

^ Sun, Xuezheng; Yang, Zhao (2008).

"Generalized McNemar's Test for Homogeneity of the Marginal Distributions" (PDF) .

SAS Global Forum.

^ Stuart, Alan (1955). "A Test for Homogeneity of the Marginal Distributions in a Two-Way Classification".

Biometrika .

42 (3/4): 412– 416.

doi : 10.1093/biomet/42.3-4.412 .

JSTOR 2333387 .

^ Maxwell, A.E. (1970). "Comparing the Classification of Subjects by Two Independent Judges".

The British Journal of Psychiatry .

116 (535): 651– 655.

doi : 10.1192/bjp.116.535.651 .

PMID 5452368 .

S2CID 9211848 .

^ "McNemar Tests of Marginal Homogeneity" . John-uebersax.com. 2006-08-30 . Retrieved 2012-11-22 .

^ Bhapkar, V.P. (1966). "A Note on the Equivalence of Two Test Criteria for Hypotheses in Categorical Data".

Journal of the American Statistical Association .

61 (313): 228– 235.

doi : 10.1080/01621459.1966.10502021 .

JSTOR 2283057 .

^ Yang, Z.; Sun, X.; Hardin, J.W. (2012). "Testing Marginal Homogeneity in Matched-Pair Polytomous Data".

Therapeutic Innovation & Regulatory Science .

46 (4): 434– 438.

doi : 10.1177/0092861512442021 .

S2CID 123109340 .

^ Agresti, Alan (2002).

Categorical Data Analysis (PDF) . Hooken, New Jersey: John Wiley & Sons, Inc. p. 413.

ISBN 978-0-471-36093-3 .

External links [ edit ] Vassar College's McNemar 2×2 Grid with online calculator McNemar Tests of Marginal Homogeneity v t e Statistics Outline Index Descriptive statistics Continuous data Center Mean Arithmetic Arithmetic-Geometric Contraharmonic Cubic Generalized/power Geometric Harmonic Heronian Heinz Lehmer Median Mode Dispersion Average absolute deviation Coefficient of variation Interquartile range Percentile Range Standard deviation Variance Shape Central limit theorem Moments Kurtosis L-moments Skewness Count data Index of dispersion Summary tables Contingency table Frequency distribution Grouped data Dependence Partial correlation Pearson product-moment correlation Rank correlation Kendall's τ Spearman's ρ Scatter plot Graphics Bar chart Biplot Box plot Control chart Correlogram Fan chart Forest plot Histogram Pie chart Q–Q plot Radar chart Run chart Scatter plot Stem-and-leaf display Violin plot Data collection Study design Effect size Missing data Optimal design Population Replication Sample size determination Statistic Statistical power Survey methodology Sampling Cluster Stratified Opinion poll Questionnaire Standard error Controlled experiments Blocking Factorial experiment Interaction Random assignment Randomized controlled trial Randomized experiment Scientific control Adaptive designs Adaptive clinical trial Stochastic approximation Up-and-down designs Observational studies Cohort study Cross-sectional study Natural experiment Quasi-experiment Statistical inference Statistical theory Population Statistic Probability distribution Sampling distribution Order statistic Empirical distribution Density estimation Statistical model Model specification L p space Parameter location scale shape Parametric family Likelihood (monotone) Location–scale family Exponential family Completeness Sufficiency Statistical functional Bootstrap U V Optimal decision loss function Efficiency Statistical distance divergence Asymptotics Robustness Frequentist inference Point estimation Estimating equations Maximum likelihood Method of moments M-estimator Minimum distance Unbiased estimators Mean-unbiased minimum-variance Rao–Blackwellization Lehmann–Scheffé theorem Median unbiased Plug-in Interval estimation Confidence interval Pivot Likelihood interval Prediction interval Tolerance interval Resampling Bootstrap Jackknife Testing hypotheses 1- & 2-tails Power Uniformly most powerful test Permutation test Randomization test Multiple comparisons Parametric tests Likelihood-ratio Score/Lagrange multiplier Wald Specific tests Z -test (normal) Student's t -test F -test Goodness of fit Chi-squared G -test Kolmogorov–Smirnov Anderson–Darling Lilliefors Jarque–Bera Normality (Shapiro–Wilk) Likelihood-ratio test Model selection Cross validation AIC BIC Rank statistics Sign Sample median Signed rank (Wilcoxon) Hodges–Lehmann estimator Rank sum (Mann–Whitney) Nonparametric anova 1-way (Kruskal–Wallis) 2-way (Friedman) Ordered alternative (Jonckheere–Terpstra) Van der Waerden test Bayesian inference Bayesian probability prior posterior Credible interval Bayes factor Bayesian estimator Maximum posterior estimator Correlation Regression analysis Correlation Pearson product-moment Partial correlation Confounding variable Coefficient of determination Regression analysis Errors and residuals Regression validation Mixed effects models Simultaneous equations models Multivariate adaptive regression splines (MARS) Linear regression Simple linear regression Ordinary least squares General linear model Bayesian regression Non-standard predictors Nonlinear regression Nonparametric Semiparametric Isotonic Robust Homoscedasticity and Heteroscedasticity Generalized linear model Exponential families Logistic (Bernoulli) / Binomial / Poisson regressions Partition of variance Analysis of variance (ANOVA, anova) Analysis of covariance Multivariate ANOVA Degrees of freedom Categorical / multivariate / time-series / survival analysis Categorical Cohen's kappa Contingency table Graphical model Log-linear model McNemar's test Cochran–Mantel–Haenszel statistics Multivariate Regression Manova Principal components Canonical correlation Discriminant analysis Cluster analysis Classification Structural equation model Factor analysis Multivariate distributions Elliptical distributions Normal Time-series General Decomposition Trend Stationarity Seasonal adjustment Exponential smoothing Cointegration Structural break Granger causality Specific tests Dickey–Fuller Johansen Q-statistic (Ljung–Box) Durbin–Watson Breusch–Godfrey Time domain Autocorrelation (ACF) partial (PACF) Cross-correlation (XCF) ARMA model ARIMA model (Box–Jenkins) Autoregressive conditional heteroskedasticity (ARCH) Vector autoregression (VAR) Frequency domain Spectral density estimation Fourier analysis Least-squares spectral analysis Wavelet Whittle likelihood Survival Survival function Kaplan–Meier estimator (product limit) Proportional hazards models Accelerated failure time (AFT) model First hitting time Hazard function Nelson–Aalen estimator Test Log-rank test Applications Biostatistics Bioinformatics Clinical trials / studies Epidemiology Medical statistics Engineering statistics Chemometrics Methods engineering Probabilistic design Process / quality control Reliability System identification Social statistics Actuarial science Census Crime statistics Demography Econometrics Jurimetrics National accounts Official statistics Population statistics Psychometrics Spatial statistics Cartography Environmental statistics Geographic information system Geostatistics Kriging Category Mathematics portal Commons WikiProject Retrieved from " https://en.wikipedia.org/w/index.php?title=McNemar%27s_test&oldid=1292113929 " Categories : Statistical tests for contingency tables Nonparametric statistics Summary statistics for contingency tables Hidden categories: Articles with short description Short description matches Wikidata Wikipedia articles that are too technical from November 2012 All articles that are too technical All articles with unsourced statements Articles with unsourced statements from June 2011 This page was last edited on 25 May 2025, at 08:02 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents McNemar's test 12 languages Add topic

