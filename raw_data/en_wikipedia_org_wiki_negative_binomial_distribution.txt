Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Definitions Toggle Definitions subsection 1.1 Probability mass function 1.2 Cumulative distribution function 1.3 Alternative formulations 1.4 Alternative parameterizations 1.5 Examples 1.5.1 Length of hospital stay 1.5.2 Selling candy 2 Properties Toggle Properties subsection 2.1 Expectation 2.2 Expectation of successes 2.3 Variance 2.4 Relation to the binomial theorem 2.5 Recurrence relations 3 Related distributions Toggle Related distributions subsection 3.1 Poisson distribution 3.2 Gamma–Poisson mixture 3.3 Distribution of a sum of geometrically distributed random variables 3.4 Representation as compound Poisson distribution 3.5 ( a , b ,0) class of distributions 4 Statistical inference Toggle Statistical inference subsection 4.1 Parameter estimation 4.1.1 MVUE for p 4.1.2 Maximum likelihood estimation 5 Occurrence and applications Toggle Occurrence and applications subsection 5.1 Waiting time in a Bernoulli process 5.2 Overdispersed Poisson 5.3 Multiplicity observations (physics) 6 History 7 See also 8 References Toggle the table of contents Negative binomial distribution 27 languages Беларуская Català Deutsch Ελληνικά Español Euskara فارسی Français Galego Italiano עברית Magyar Nederlands 日本語 Novial Polski Português Русский Slovenščina Sunda Suomi Svenska తెలుగు ไทย Türkçe Українська 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikimedia Commons Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Probability distribution Different texts (and even different parts of this article) adopt slightly different definitions for the negative binomial distribution. They can be distinguished by whether the support starts at k = 0 or at k = r , whether p denotes the probability of a success or of a failure, and whether r represents success or failure, [ 1 ] so identifying the specific parametrization used is crucial in any given text.

Probability mass function The orange line represents the mean, which is equal to 10 in each of these plots; the green line shows the standard deviation.

Notation N B ( r , p ) {\displaystyle \mathrm {NB} (r,\,p)} Parameters r > 0 — number of successes until the experiment is stopped ( integer , but the definition can also be extended to reals ) p ∈ [0,1] — success probability in each experiment (real) Support k ∈ { 0, 1, 2, 3, … } — number of failures PMF k ↦ ↦ ( k + r − − 1 k ) ⋅ ⋅ ( 1 − − p ) k p r , {\displaystyle k\mapsto {k+r-1 \choose k}\cdot (1-p)^{k}p^{r},} involving a binomial coefficient CDF k ↦ ↦ I p ( r , k + 1 ) , {\displaystyle k\mapsto I_{p}(r,\,k+1),} the regularized incomplete beta function Mean r ( 1 − − p ) p {\displaystyle {\frac {r(1-p)}{p}}} Mode { ⌊ ( r − − 1 ) ( 1 − − p ) p ⌋ if r > 1 0 if r ≤ ≤ 1 {\displaystyle {\begin{cases}\left\lfloor {\frac {(r-1)(1-p)}{p}}\right\rfloor &{\text{if }}r>1\\0&{\text{if }}r\leq 1\end{cases}}} Variance r ( 1 − − p ) p 2 {\displaystyle {\frac {r(1-p)}{p^{2}}}} Skewness 2 − − p ( 1 − − p ) r {\displaystyle {\frac {2-p}{\sqrt {(1-p)r}}}} Excess kurtosis 6 r + p 2 ( 1 − − p ) r {\displaystyle {\frac {6}{r}}+{\frac {p^{2}}{(1-p)r}}} MGF ( p 1 − − ( 1 − − p ) e t ) r for t < − − log ⁡ ⁡ ( 1 − − p ) {\displaystyle {\biggl (}{\frac {p}{1-(1-p)e^{t}}}{\biggr )}^{\!r}{\text{ for }}t<-\log(1-p)} CF ( p 1 − − ( 1 − − p ) e i t ) r with t ∈ ∈ R {\displaystyle {\biggl (}{\frac {p}{1-(1-p)e^{i\,t}}}{\biggr )}^{\!r}{\text{ with }}t\in \mathbb {R} } PGF ( p 1 − − ( 1 − − p ) z ) r for | z | < 1 p {\displaystyle {\biggl (}{\frac {p}{1-(1-p)z}}{\biggr )}^{\!r}{\text{ for }}|z|<{\frac {1}{p}}} Fisher information r p 2 ( 1 − − p ) {\displaystyle {\frac {r}{p^{2}(1-p)}}} Method of moments r = E [ X ] 2 V [ X ] − − E [ X ] {\displaystyle r={\frac {E[X]^{2}}{V[X]-E[X]}}} p = E [ X ] V [ X ] {\displaystyle p={\frac {E[X]}{V[X]}}} In probability theory and statistics , the negative binomial distribution , also called a Pascal distribution , [ 2 ] is a discrete probability distribution that models the number of failures in a sequence of independent and identically distributed Bernoulli trials before a specified/constant/fixed number of successes r {\displaystyle r} occur.

[ 3 ] For example, we can define rolling a 6 on some dice as a success, and rolling any other number as a failure, and ask how many failure rolls will occur before we see the third success ( r = 3 {\displaystyle r=3} ). In such a case, the probability distribution of the number of failures that appear will be a negative binomial distribution.

An alternative formulation is to model the number of total trials (instead of the number of failures). In fact, for a specified (non-random) number of successes ( r ) , the number of failures ( n − r ) is random because the number of total trials ( n ) is random. For example, we could use the negative binomial distribution to model the number of days n (random) a certain machine works (specified by r ) before it breaks down.

The negative binomial distribution has a variance μ μ / p {\displaystyle \mu /p} , with the distribution becoming identical to Poisson in the limit p → → 1 {\displaystyle p\to 1} for a given mean μ μ {\displaystyle \mu } (i.e. when the failures are increasingly rare). Here p ∈ ∈ [ 0 , 1 ] {\displaystyle p\in [0,1]} is the success probability of each Bernoulli trial. This can make the distribution a useful overdispersed alternative to the Poisson distribution, for example for a robust modification of Poisson regression . In epidemiology, it has been used to model disease transmission for infectious diseases where the likely number of onward infections may vary considerably from individual to individual and from setting to setting.

[ 4 ] More generally, it may be appropriate where events have positively correlated occurrences causing a larger variance than if the occurrences were independent, due to a positive covariance term.

The term "negative binomial" is likely due to the fact that a certain binomial coefficient that appears in the formula for the probability mass function of the distribution can be written more simply with negative numbers.

[ 5 ] Definitions [ edit ] Imagine a sequence of independent Bernoulli trials : each trial has two potential outcomes called "success" and "failure." In each trial the probability of success is p {\displaystyle p} and of failure is 1 − − p {\displaystyle 1-p} . We observe this sequence until a predefined number r {\displaystyle r} of successes occurs. Then the random number of observed failures, X {\displaystyle X} , follows the negative binomial distribution: X ∼ ∼ NB ⁡ ⁡ ( r , p ) {\displaystyle X\sim \operatorname {NB} (r,p)} Probability mass function [ edit ] The probability mass function of the negative binomial distribution is f ( k ; r , p ) ≡ ≡ Pr ( X = k ) = ( k + r − − 1 k ) ( 1 − − p ) k p r {\displaystyle f(k;r,p)\equiv \Pr(X=k)={\binom {k+r-1}{k}}(1-p)^{k}p^{r}} where r is the number of successes, k is the number of failures, and p is the probability of success on each trial.

Here, the quantity in parentheses is the binomial coefficient , and is equal to ( k + r − − 1 k ) = ( k + r − − 1 ) !

( r − − 1 ) !

( k ) !

= ( k + r − − 1 ) ( k + r − − 2 ) ⋯ ⋯ ( r ) k !

= Γ Γ ( k + r ) k !

Γ Γ ( r ) .

{\displaystyle {\binom {k+r-1}{k}}={\frac {(k+r-1)!}{(r-1)!\,(k)!}}={\frac {(k+r-1)(k+r-2)\dotsm (r)}{k!}}={\frac {\Gamma (k+r)}{k!\ \Gamma (r)}}.} Note that Γ( r ) is the Gamma function .

There are k failures chosen from k + r − 1 trials rather than k + r because the last of the k + r trials is by definition a success.

This quantity can alternatively be written in the following manner, explaining the name "negative binomial": ( k + r − − 1 ) ⋯ ⋯ ( r ) k !

= ( − − 1 ) k ( − − r ) ( − − r − − 1 ) ( − − r − − 2 ) ⋯ ⋯ ( − − r − − k + 1 ) ⏞ ⏞ k factors k !

= ( − − 1 ) k ( − − r − − k ) .

{\displaystyle {\begin{aligned}&{\frac {(k+r-1)\dotsm (r)}{k!}}\\[10pt]={}&(-1)^{k}{\frac {\overbrace {(-r)(-r-1)(-r-2)\dotsm (-r-k+1)} ^{k{\text{ factors}}}}{k!}}=(-1)^{k}{\binom {-r}{{\phantom {-}}k}}.\end{aligned}}} Note that by the last expression and the binomial series , for every 0 ≤ p < 1 and q = 1 − − p {\displaystyle q=1-p} , p − − r = ( 1 − − q ) − − r = ∑ ∑ k = 0 ∞ ∞ ( − − r − − k ) ( − − q ) k = ∑ ∑ k = 0 ∞ ∞ ( k + r − − 1 k ) q k {\displaystyle p^{-r}=(1-q)^{-r}=\sum _{k=0}^{\infty }{\binom {-r}{{\phantom {-}}k}}(-q)^{k}=\sum _{k=0}^{\infty }{\binom {k+r-1}{k}}q^{k}} hence the terms of the probability mass function indeed add up to one as below.

∑ ∑ k = 0 ∞ ∞ ( k + r − − 1 k ) ( 1 − − p ) k p r = p − − r p r = 1 {\displaystyle \sum _{k=0}^{\infty }{\binom {k+r-1}{k}}\left(1-p\right)^{k}p^{r}=p^{-r}p^{r}=1} To understand the above definition of the probability mass function, note that the probability for every specific sequence of r successes and k failures is p r (1 − p ) k , because the outcomes of the k + r trials are supposed to happen independently . Since the r -th success always comes last, it remains to choose the k trials with failures out of the remaining k + r − 1 trials. The above binomial coefficient, due to its combinatorial interpretation, gives precisely the number of all these sequences of length k + r − 1 .

Cumulative distribution function [ edit ] The cumulative distribution function can be expressed in terms of the regularized incomplete beta function : [ 3 ] [ 6 ] F ( k ; r , p ) ≡ ≡ Pr ( X ≤ ≤ k ) = I p ( r , k + 1 ) .

{\displaystyle F(k;r,p)\equiv \Pr(X\leq k)=I_{p}(r,k+1).} (This formula is using the same parameterization as in the article's table, with r the number of successes, and p = r / ( r + μ μ ) {\displaystyle p=r/(r+\mu )} with μ μ {\displaystyle \mu } the mean.) It can also be expressed in terms of the cumulative distribution function of the binomial distribution : [ 7 ] F ( k ; r , p ) = F binomial ( k ; n = k + r , 1 − − p ) .

{\displaystyle F(k;r,p)=F_{\text{binomial}}(k;n=k+r,1-p).} Alternative formulations [ edit ] Some sources may define the negative binomial distribution slightly differently from the primary one here. The most common variations are where the random variable X is counting different things. These variations can be seen in the table here: X is counting...

Probability mass function Formula Alternate formula (using equivalent binomial) Alternate formula (simplified using: n = k + r {\textstyle n=k+r} ) Support 1 k failures, given r successes f ( k ; r , p ) ≡ ≡ Pr ( X = k ) = {\textstyle f(k;r,p)\equiv \Pr(X=k)=} ( k + r − − 1 k ) p r ( 1 − − p ) k {\textstyle {\binom {k+r-1}{k}}p^{r}(1-p)^{k}} [ 8 ] [ 6 ] [ 9 ] ( k + r − − 1 r − − 1 ) p r ( 1 − − p ) k {\textstyle {\binom {k+r-1}{r-1}}p^{r}(1-p)^{k}} [ 3 ] [ 10 ] [ 11 ] [ 12 ] ( n − − 1 k ) p r ( 1 − − p ) k {\textstyle {\binom {n-1}{k}}p^{r}(1-p)^{k}} for k = 0 , 1 , 2 , … … {\displaystyle {\text{for }}k=0,1,2,\ldots } 2 n trials, given r successes f ( n ; r , p ) ≡ ≡ Pr ( X = n ) = {\textstyle f(n;r,p)\equiv \Pr(X=n)=} ( n − − 1 r − − 1 ) p r ( 1 − − p ) n − − r {\textstyle {\binom {n-1}{r-1}}p^{r}(1-p)^{n-r}} [ 6 ] [ 12 ] [ 13 ] [ 14 ] [ 15 ] ( n − − 1 n − − r ) p r ( 1 − − p ) n − − r {\textstyle {\binom {n-1}{n-r}}p^{r}(1-p)^{n-r}} for n = r , r + 1 , r + 2 , … … {\displaystyle {\text{for }}n=r,r+1,r+2,\dotsc } 3 n trials, given r failures f ( n ; r , p ) ≡ ≡ Pr ( X = n ) = {\textstyle f(n;r,p)\equiv \Pr(X=n)=} ( n − − 1 r − − 1 ) p n − − r ( 1 − − p ) r {\textstyle {\binom {n-1}{r-1}}p^{n-r}(1-p)^{r}} ( n − − 1 n − − r ) p n − − r ( 1 − − p ) r {\textstyle {\binom {n-1}{n-r}}p^{n-r}(1-p)^{r}} ( n − − 1 k ) p k ( 1 − − p ) r {\textstyle {\binom {n-1}{k}}p^{k}(1-p)^{r}} 4 k successes, given r failures f ( k ; r , p ) ≡ ≡ Pr ( X = k ) = {\textstyle f(k;r,p)\equiv \Pr(X=k)=} ( k + r − − 1 k ) p k ( 1 − − p ) r {\textstyle {\binom {k+r-1}{k}}p^{k}(1-p)^{r}} ( k + r − − 1 r − − 1 ) p k ( 1 − − p ) r {\textstyle {\binom {k+r-1}{r-1}}p^{k}(1-p)^{r}} for k = 0 , 1 , 2 , … … {\displaystyle {\text{for }}k=0,1,2,\ldots } - k successes, given n trials f ( k ; n , p ) ≡ ≡ Pr ( X = k ) = {\textstyle f(k;n,p)\equiv \Pr(X=k)=} This is the binomial distribution not the negative binomial: ( n k ) p k ( 1 − − p ) n − − k = ( n n − − k ) p k ( 1 − − p ) n − − k = ( n k ) p k ( 1 − − p ) r {\textstyle {\binom {n}{k}}p^{k}(1-p)^{n-k}={\binom {n}{n-k}}p^{k}(1-p)^{n-k}={\binom {n}{k}}p^{k}(1-p)^{r}} for k = 0 , 1 , 2 , … … , n {\displaystyle {\text{for }}k=0,1,2,\dotsc ,n} Each of the four definitions of the negative binomial distribution can be expressed in slightly different but equivalent ways. The first alternative formulation is simply an equivalent form of the binomial coefficient, that is: ( a b ) = ( a a − − b ) for 0 ≤ ≤ b ≤ ≤ a {\textstyle {\binom {a}{b}}={\binom {a}{a-b}}\quad {\text{for }}\ 0\leq b\leq a} .  The second alternate formulation somewhat simplifies the expression by recognizing that the total number of trials is simply the number of successes and failures, that is: n = r + k {\textstyle n=r+k} .  These second formulations may be more intuitive to understand, however they are perhaps less practical as they have more terms.

The definition where X is the number of n trials that occur for a given number of r successes is similar to the primary definition, except that the number of trials is given instead of the number of failures.  This adds r to the value of the random variable, shifting its support and mean.

The definition where X is the number of k successes (or n trials ) that occur for a given number of r failures is similar to the primary definition used in this article, except that numbers of failures and successes are switched when considering what is being counted and what is given.  Note however, that p still refers to the probability of "success".

The definition of the negative binomial distribution can be extended to the case where the parameter r can take on a positive real value.  Although it is impossible to visualize a non-integer number of "failures", we can still formally define the distribution through its probability mass function.  The problem of extending the definition to real-valued (positive) r boils down to extending the binomial coefficient to its real-valued counterpart, based on the gamma function : ( k + r − − 1 k ) = ( k + r − − 1 ) ( k + r − − 2 ) ⋯ ⋯ ( r ) k !

= Γ Γ ( k + r ) k !

Γ Γ ( r ) {\displaystyle {\binom {k+r-1}{k}}={\frac {(k+r-1)(k+r-2)\dotsm (r)}{k!}}={\frac {\Gamma (k+r)}{k!\,\Gamma (r)}}} After substituting this expression in the original definition, we say that X has a negative binomial (or Pólya ) distribution if it has a probability mass function : f ( k ; r , p ) ≡ ≡ Pr ( X = k ) = Γ Γ ( k + r ) k !

Γ Γ ( r ) ( 1 − − p ) k p r for k = 0 , 1 , 2 , … … {\displaystyle f(k;r,p)\equiv \Pr(X=k)={\frac {\Gamma (k+r)}{k!\,\Gamma (r)}}(1-p)^{k}p^{r}\quad {\text{for }}k=0,1,2,\dotsc } Here r is a real, positive number.

In negative binomial regression, [ 16 ] the distribution is specified in terms of its mean, m = r ( 1 − − p ) p {\textstyle m={\frac {r(1-p)}{p}}} , which is then related to explanatory variables as in linear regression or other generalized linear models .  From the expression for the mean m , one can derive p = r m + r {\textstyle p={\frac {r}{m+r}}} and 1 − − p = m m + r {\textstyle 1-p={\frac {m}{m+r}}} .  Then, substituting these expressions in the one for the probability mass function when r is real-valued , yields this parametrization of the probability mass function in terms of m : Pr ( X = k ) = Γ Γ ( r + k ) k !

Γ Γ ( r ) ( r r + m ) r ( m r + m ) k for k = 0 , 1 , 2 , … … {\displaystyle \Pr(X=k)={\frac {\Gamma (r+k)}{k!\,\Gamma (r)}}\left({\frac {r}{r+m}}\right)^{r}\left({\frac {m}{r+m}}\right)^{k}\quad {\text{for }}k=0,1,2,\dotsc } The variance can then be written as m + m 2 r {\textstyle m+{\frac {m^{2}}{r}}} .  Some authors prefer to set α α = 1 r {\textstyle \alpha ={\frac {1}{r}}} , and express the variance as m + α α m 2 {\textstyle m+\alpha m^{2}} .  In this context, and depending on the author, either the parameter r or its reciprocal α is referred to as the "dispersion parameter", " shape parameter " or " clustering coefficient ", [ 17 ] or the "heterogeneity" [ 16 ] or "aggregation" parameter.

[ 11 ] The term "aggregation" is particularly used in ecology when describing counts of individual organisms. Decrease of the aggregation parameter r towards zero corresponds to increasing aggregation of the organisms; increase of r towards infinity corresponds to absence of aggregation, as can be described by Poisson regression .

Alternative parameterizations [ edit ] Sometimes the distribution is parameterized in terms of its mean μ and variance σ 2 : p = μ μ σ σ 2 , r = μ μ 2 σ σ 2 − − μ μ , Pr ( X = k ) = ( k + μ μ 2 σ σ 2 − − μ μ − − 1 k ) ( 1 − − μ μ σ σ 2 ) k ( μ μ σ σ 2 ) μ μ 2 / ( σ σ 2 − − μ μ ) E ⁡ ⁡ ( X ) = μ μ Var ⁡ ⁡ ( X ) = σ σ 2 .

{\displaystyle {\begin{aligned}&p={\frac {\mu }{\sigma ^{2}}},\\[6pt]&r={\frac {\mu ^{2}}{\sigma ^{2}-\mu }},\\[3pt]&\Pr(X=k)={k+{\frac {\mu ^{2}}{\sigma ^{2}-\mu }}-1 \choose k}\left(1-{\frac {\mu }{\sigma ^{2}}}\right)^{k}\left({\frac {\mu }{\sigma ^{2}}}\right)^{\mu ^{2}/(\sigma ^{2}-\mu )}\\&\operatorname {E} (X)=\mu \\&\operatorname {Var} (X)=\sigma ^{2}.\end{aligned}}} Another popular parameterization uses r and the failure odds β : p = 1 1 + β β Pr ( X = k ) = ( k + r − − 1 k ) ( β β 1 + β β ) k ( 1 1 + β β ) r E ⁡ ⁡ ( X ) = r β β Var ⁡ ⁡ ( X ) = r β β ( 1 + β β ) .

{\displaystyle {\begin{aligned}&p={\frac {1}{1+\beta }}\\&\Pr(X=k)={k+r-1 \choose k}\left({\frac {\beta }{1+\beta }}\right)^{k}\left({\frac {1}{1+\beta }}\right)^{r}\\&\operatorname {E} (X)=r\beta \\&\operatorname {Var} (X)=r\beta (1+\beta ).\end{aligned}}} Examples [ edit ] Length of hospital stay [ edit ] Hospital length of stay is an example of real-world data that can be modelled well with a negative binomial distribution via negative binomial regression .

[ 18 ] [ 19 ] Selling candy [ edit ] Pat Collis is required to sell candy bars to raise money for the 6th grade field trip.  Pat is (somewhat harshly) not supposed to return home until five candy bars have been sold.  So the child goes door to door, selling candy bars. At each house, there is a 0.6 probability of selling one candy bar and a 0.4 probability of selling nothing.

What's the probability of selling the last candy bar at the n -th house?

Successfully selling candy enough times is what defines our stopping criterion (as opposed to failing to sell it), so k in this case represents the number of failures and r represents the number of successes.  Recall that the NB( r , p ) distribution describes the probability of k failures and r successes in k + r Bernoulli( p ) trials with success on the last trial.  Selling five candy bars means getting five successes.  The number of trials (i.e. houses) this takes is therefore k + 5 = n .  The random variable we are interested in is the number of houses, so we substitute k = n − 5 into a NB(5, 0.4) mass function and obtain the following mass function of the distribution of houses (for n ≥ 5 ): f ( n ) = ( ( n − − 5 ) + 5 − − 1 n − − 5 ) ( 1 − − 0.4 ) 5 0.4 n − − 5 = ( n − − 1 n − − 5 ) 3 5 2 n − − 5 5 n .

{\displaystyle f(n)={\binom {(n-5)+5-1}{n-5}}\;(1-0.4)^{5}\;0.4^{n-5}={n-1 \choose n-5}\;3^{5}\;{\frac {2^{n-5}}{5^{n}}}.} What's the probability that Pat finishes on the tenth house?

f ( 10 ) = 979776 9765625 ≈ ≈ 0.10033.

{\displaystyle f(10)={\frac {979776}{9765625}}\approx 0.10033.\,} What's the probability that Pat finishes on or before reaching the eighth house?

To finish on or before the eighth house, Pat must finish at the fifth, sixth, seventh, or eighth house. Sum those probabilities: f ( 5 ) = 243 3125 ≈ ≈ 0.07776 f ( 6 ) = 486 3125 ≈ ≈ 0.15552 f ( 7 ) = 2916 15625 ≈ ≈ 0.18662 f ( 8 ) = 13608 78125 ≈ ≈ 0.17418 {\displaystyle {\begin{aligned}f(5)&={\frac {243}{3125}}\approx 0.07776\\f(6)&={\frac {486}{3125}}\approx 0.15552\\f(7)&={\frac {2916}{15625}}\approx 0.18662\\f(8)&={\frac {13608}{78125}}\approx 0.17418\end{aligned}}} ∑ ∑ j = 5 8 f ( j ) = 46413 78125 ≈ ≈ 0.59409.

{\displaystyle \sum _{j=5}^{8}f(j)={\frac {46413}{78125}}\approx 0.59409.} What's the probability that Pat exhausts all 30 houses that happen to stand in the neighborhood?

This can be expressed as the probability that Pat does not finish on the fifth through the thirtieth house: 1 − − ∑ ∑ j = 5 30 f ( j ) = 1 − − I 0.4 ( 5 , 30 − − 5 + 1 ) ≈ ≈ 1 − − 0.999999823 = 0.000000177.

{\displaystyle 1-\sum _{j=5}^{30}f(j)=1-I_{0.4}(5,30-5+1)\approx 1-0.999999823=0.000000177.} Because of the rather high probability that Pat will sell to each house (60 percent), the probability of her not fulfilling her quest is vanishingly slim.

Properties [ edit ] Expectation [ edit ] The expected total number of trials needed to see r successes is r p {\displaystyle {\frac {r}{p}}} . Thus, the expected number of failures would be this value, minus the successes: E ⁡ ⁡ [ NB ⁡ ⁡ ( r , p ) ] = r p − − r = r ( 1 − − p ) p {\displaystyle \operatorname {E} [\operatorname {NB} (r,p)]={\frac {r}{p}}-r={\frac {r(1-p)}{p}}} Expectation of successes [ edit ] The expected total number of failures in a negative binomial distribution with parameters ( r , p ) is r (1 − p )/ p . To see this, imagine an experiment simulating the negative binomial is performed many times. That is, a set of trials is performed until r successes are obtained, then another set of trials, and then another etc. Write down the number of trials performed in each experiment: a , b , c , ...

and set a + b + c + ... = N . Now we would expect about Np successes in total. Say the experiment was performed n times. Then there are nr successes in total. So we would expect nr = Np , so N / n = r / p . See that N / n is just the average number of trials per experiment. That is what we mean by "expectation". The average number of failures per experiment is N / n − r = r / p − r = r (1 − p )/ p . This agrees with the mean given in the box on the right-hand side of this page.

A rigorous derivation can be done by representing the negative binomial distribution as the sum of waiting times. Let X r ∼ ∼ NB ⁡ ⁡ ( r , p ) {\displaystyle X_{r}\sim \operatorname {NB} (r,p)} with the convention X {\displaystyle X} represents the number of failures observed before r {\displaystyle r} successes with the probability of success being p {\displaystyle p} . And let Y i ∼ ∼ G e o m ( p ) {\displaystyle Y_{i}\sim \mathrm {Geom} (p)} where Y i {\displaystyle Y_{i}} represents the number of failures before seeing a success. We can think of Y i {\displaystyle Y_{i}} as the waiting time (number of failures) between the i {\displaystyle i} th and ( i − − 1 ) {\displaystyle (i-1)} th success. Thus X r = Y 1 + Y 2 + ⋯ ⋯ + Y r .

{\displaystyle X_{r}=Y_{1}+Y_{2}+\cdots +Y_{r}.} The mean is E ⁡ ⁡ [ X r ] = E ⁡ ⁡ [ Y 1 ] + E ⁡ ⁡ [ Y 2 ] + ⋯ ⋯ + E ⁡ ⁡ [ Y r ] = r ( 1 − − p ) p , {\displaystyle \operatorname {E} [X_{r}]=\operatorname {E} [Y_{1}]+\operatorname {E} [Y_{2}]+\cdots +\operatorname {E} [Y_{r}]={\frac {r(1-p)}{p}},} which follows from the fact E ⁡ ⁡ [ Y i ] = ( 1 − − p ) / p {\displaystyle \operatorname {E} [Y_{i}]=(1-p)/p} .

Variance [ edit ] When counting the number of failures before the r -th success, the variance is r (1 − p )/ p 2 . 
When counting the number of successes before the r -th failure, as in alternative formulation (3) above, the variance is rp /(1 − p ) 2 .

Relation to the binomial theorem [ edit ] Suppose Y is a random variable with a binomial distribution with parameters n and p .  Assume p + q = 1 , with p , q ≥ 0 , then 1 = 1 n = ( p + q ) n .

{\displaystyle 1=1^{n}=(p+q)^{n}.} Using Newton's binomial theorem , this can equally be written as: ( p + q ) n = ∑ ∑ k = 0 ∞ ∞ ( n k ) p k q n − − k , {\displaystyle (p+q)^{n}=\sum _{k=0}^{\infty }{\binom {n}{k}}p^{k}q^{n-k},} in which the upper bound of summation is infinite.  In this case, the binomial coefficient ( n k ) = n ( n − − 1 ) ( n − − 2 ) ⋯ ⋯ ( n − − k + 1 ) k !

.

{\displaystyle {\binom {n}{k}}={n(n-1)(n-2)\cdots (n-k+1) \over k!}.} is defined when n is a real number, instead of just a positive integer .  But in our case of the binomial distribution it is zero when k > n .  We can then say, for example ( p + q ) 8.3 = ∑ ∑ k = 0 ∞ ∞ ( 8.3 k ) p k q 8.3 − − k .

{\displaystyle (p+q)^{8.3}=\sum _{k=0}^{\infty }{\binom {8.3}{k}}p^{k}q^{8.3-k}.} Now suppose r > 0 and we use a negative exponent: 1 = p r ⋅ ⋅ p − − r = p r ( 1 − − q ) − − r = p r ∑ ∑ k = 0 ∞ ∞ ( − − r k ) ( − − q ) k .

{\displaystyle 1=p^{r}\cdot p^{-r}=p^{r}(1-q)^{-r}=p^{r}\sum _{k=0}^{\infty }{\binom {-r}{k}}(-q)^{k}.} Then all of the terms are positive, and the term p r ( − − r k ) ( − − q ) k = ( k + r − − 1 k ) p r q k {\displaystyle p^{r}{\binom {-r}{k}}(-q)^{k}={\binom {k+r-1}{k}}p^{r}q^{k}} is just the probability that the number of failures before the r -th success is equal to k , provided r is an integer.  (If r is a negative non-integer, so that the exponent is a positive non-integer, then some of the terms in the sum above are negative, so we do not have a probability distribution on the set of all nonnegative integers.) Now we also allow non-integer values of r .

Recall from above that The sum of independent negative-binomially distributed random variables r 1 and r 2 with the same value for parameter p is negative-binomially distributed with the same p but with r -value r 1 + r 2 .

This property persists when the definition is thus generalized, and affords a quick way to see that the negative binomial distribution is infinitely divisible .

Recurrence relations [ edit ] The following recurrence relations hold: For the probability mass function { ( k + 1 ) Pr ( X = k + 1 ) − − p Pr ( X = k ) ( k + r ) = 0 , Pr ( X = 0 ) = ( 1 − − p ) r .

{\displaystyle {\begin{cases}(k+1)\Pr(X=k+1)-p\Pr(X=k)(k+r)=0,\\[5pt]\Pr(X=0)=(1-p)^{r}.\end{cases}}} For the moments m k = E ( X k ) , {\displaystyle m_{k}=\mathbb {E} (X^{k}),} m k + 1 = r P m k + ( P 2 + P ) d m k d P , P := ( 1 − − p ) / p , m 0 = 1.

{\displaystyle m_{k+1}=rPm_{k}+(P^{2}+P){dm_{k} \over dP},\quad P:=(1-p)/p,\quad m_{0}=1.} For the cumulants κ κ k + 1 = ( Q − − 1 ) Q d κ κ k d Q , Q := 1 / p , κ κ 1 = r ( Q − − 1 ) .

{\displaystyle \kappa _{k+1}=(Q-1)Q{d\kappa _{k} \over dQ},\quad Q:=1/p,\quad \kappa _{1}=r(Q-1).} Related distributions [ edit ] The geometric distribution on {0, 1, 2, 3, ... } is a special case of the negative binomial distribution, with Geom ⁡ ⁡ ( p ) = NB ⁡ ⁡ ( 1 , p ) .

{\displaystyle \operatorname {Geom} (p)=\operatorname {NB} (1,\,p).\,} The negative binomial distribution is a special case of the discrete phase-type distribution .

The negative binomial distribution is a special case of discrete compound Poisson distribution .

Poisson distribution [ edit ] Consider a sequence of negative binomial random variables where the stopping parameter r goes to infinity, while the probability p of success in each trial goes to one, in such a way as to keep the mean of the distribution (i.e. the expected number of failures) constant. Denoting this mean as λ , the parameter p will be p = r /( r + λ ) Mean: λ λ = ( 1 − − p ) r p ⇒ ⇒ p = r r + λ λ , Variance: λ λ ( 1 + λ λ r ) > λ λ , thus always overdispersed .

{\displaystyle {\begin{aligned}{\text{Mean:}}\quad &\lambda ={\frac {(1-p)r}{p}}\quad \Rightarrow \quad p={\frac {r}{r+\lambda }},\\{\text{Variance:}}\quad &\lambda \left(1+{\frac {\lambda }{r}}\right)>\lambda ,\quad {\text{thus always overdispersed}}.\end{aligned}}} Under this parametrization the probability mass function will be f ( k ; r , p ) = Γ Γ ( k + r ) k !

⋅ ⋅ Γ Γ ( r ) ( 1 − − p ) k p r = λ λ k k !

⋅ ⋅ Γ Γ ( r + k ) Γ Γ ( r ) ( r + λ λ ) k ⋅ ⋅ 1 ( 1 + λ λ r ) r {\displaystyle f(k;r,p)={\frac {\Gamma (k+r)}{k!\cdot \Gamma (r)}}(1-p)^{k}p^{r}={\frac {\lambda ^{k}}{k!}}\cdot {\frac {\Gamma (r+k)}{\Gamma (r)\;(r+\lambda )^{k}}}\cdot {\frac {1}{\left(1+{\frac {\lambda }{r}}\right)^{r}}}} Now if we consider the limit as r → ∞ , the second factor will converge to one, and the third to the exponent function: lim r → → ∞ ∞ f ( k ; r , p ) = λ λ k k !

⋅ ⋅ 1 ⋅ ⋅ 1 e λ λ , {\displaystyle \lim _{r\to \infty }f(k;r,p)={\frac {\lambda ^{k}}{k!}}\cdot 1\cdot {\frac {1}{e^{\lambda }}},} which is the mass function of a Poisson-distributed random variable with expected value λ .

In other words, the alternatively parameterized negative binomial distribution converges to the Poisson distribution and r controls the deviation from the Poisson.  This makes the negative binomial distribution suitable as a robust alternative to the Poisson, which approaches the Poisson for large r , but which has larger variance than the Poisson for small r .

Poisson ⁡ ⁡ ( λ λ ) = lim r → → ∞ ∞ NB ⁡ ⁡ ( r , r r + λ λ ) .

{\displaystyle \operatorname {Poisson} (\lambda )=\lim _{r\to \infty }\operatorname {NB} \left(r,{\frac {r}{r+\lambda }}\right).} Gamma–Poisson mixture [ edit ] The negative binomial distribution also arises as a continuous mixture of Poisson distributions (i.e. a compound probability distribution ) where the mixing distribution of the Poisson rate is a gamma distribution . That is, we can view the negative binomial as a Poisson( λ ) distribution, where λ is itself a random variable, distributed as a gamma distribution with shape r and scale θ = (1 − p )/ p or correspondingly rate β = p /(1 − p ) .

To display the intuition behind this statement, consider two independent Poisson processes, "Success" and "Failure", with intensities p and 1 − p . Together, the Success and Failure processes are equivalent to a single Poisson process of intensity 1, where an occurrence of the process is a success if a corresponding independent coin toss comes up heads with probability p ; otherwise, it is a failure. If r is a counting number, the coin tosses show that the count of successes before the r -th failure follows a negative binomial distribution with parameters r and p . The count is also, however, the count of the Success Poisson process at the random time T of the r -th occurrence in the Failure Poisson process. The Success count follows a Poisson distribution with mean pT , where T is the waiting time for r occurrences in a Poisson process of intensity 1 − p , i.e., T is gamma-distributed with shape parameter r and intensity 1 − p . Thus, the negative binomial distribution is equivalent to a Poisson distribution with mean pT , where the random variate T is gamma-distributed with shape parameter r and intensity (1 − p ) . The preceding paragraph follows, because λ = pT is gamma-distributed with shape parameter r and intensity (1 − p )/ p .

The following formal derivation (which does not depend on r being a counting number) confirms the intuition.

∫ ∫ 0 ∞ ∞ f Poisson ⁡ ⁡ ( λ λ ) ( k ) × × f Gamma ⁡ ⁡ ( r , p 1 − − p ) ( λ λ ) d λ λ = ∫ ∫ 0 ∞ ∞ λ λ k k !

e − − λ λ × × 1 Γ Γ ( r ) ( p 1 − − p λ λ ) r − − 1 e − − p 1 − − p λ λ ( p 1 − − p ) d λ λ = ( p 1 − − p ) r 1 k !

Γ Γ ( r ) ∫ ∫ 0 ∞ ∞ λ λ r + k − − 1 e − − λ λ p + 1 − − p 1 − − p d λ λ = ( p 1 − − p ) r 1 k !

Γ Γ ( r ) Γ Γ ( r + k ) ( 1 − − p ) k + r ∫ ∫ 0 ∞ ∞ f Gamma ⁡ ⁡ ( k + r , 1 1 − − p ) ( λ λ ) d λ λ = Γ Γ ( r + k ) k !

Γ Γ ( r ) ( 1 − − p ) k p r = f ( k ; r , p ) .

{\displaystyle {\begin{aligned}&\int _{0}^{\infty }f_{\operatorname {Poisson} (\lambda )}(k)\times f_{\operatorname {Gamma} \left(r,\,{\frac {p}{1-p}}\right)}(\lambda )\,\mathrm {d} \lambda \\[8pt]={}&\int _{0}^{\infty }{\frac {\lambda ^{k}}{k!}}e^{-\lambda }\times {\frac {1}{\Gamma (r)}}\left({\frac {p}{1-p}}\lambda \right)^{r-1}e^{-{\frac {p}{1-p}}\lambda }\,\left({\frac {p}{1-p}}\,\right)\mathrm {d} \lambda \\[8pt]={}&\left({\frac {p}{1-p}}\right)^{r}{\frac {1}{k!\,\Gamma (r)}}\int _{0}^{\infty }\lambda ^{r+k-1}e^{-\lambda {\frac {p+1-p}{1-p}}}\;\mathrm {d} \lambda \\[8pt]={}&\left({\frac {p}{1-p}}\right)^{r}{\frac {1}{k!\,\Gamma (r)}}\Gamma (r+k)(1-p)^{k+r}\int _{0}^{\infty }f_{\operatorname {Gamma} \left(k+r,{\frac {1}{1-p}}\right)}(\lambda )\;\mathrm {d} \lambda \\[8pt]={}&{\frac {\Gamma (r+k)}{k!\;\Gamma (r)}}\;(1-p)^{k}\,p^{r}\\[8pt]={}&f(k;r,p).\end{aligned}}} Because of this, the negative binomial distribution is also known as the gamma–Poisson (mixture) distribution . The negative binomial distribution was originally derived as a limiting case of the gamma-Poisson distribution.

[ 20 ] Distribution of a sum of geometrically distributed random variables [ edit ] If Y r is a random variable following the negative binomial distribution with parameters r and p , and support {0, 1, 2, ...} , then Y r is a sum of r independent variables following the geometric distribution (on {0, 1, 2, ...} ) with parameter p . As a result of the central limit theorem , Y r (properly scaled and shifted) is therefore approximately normal for sufficiently large r .

Furthermore, if B s + r is a random variable following the binomial distribution with parameters s + r and p , then Pr ( Y r ≤ ≤ s ) = 1 − − I p ( s + 1 , r ) = 1 − − I p ( ( s + r ) − − ( r − − 1 ) , ( r − − 1 ) + 1 ) = 1 − − Pr ( B s + r ≤ ≤ r − − 1 ) = Pr ( B s + r ≥ ≥ r ) = Pr ( after s + r trials, there are at least r successes ) .

{\displaystyle {\begin{aligned}\Pr(Y_{r}\leq s)&{}=1-I_{p}(s+1,r)\\[5pt]&{}=1-I_{p}((s+r)-(r-1),(r-1)+1)\\[5pt]&{}=1-\Pr(B_{s+r}\leq r-1)\\[5pt]&{}=\Pr(B_{s+r}\geq r)\\[5pt]&{}=\Pr({\text{after }}s+r{\text{ trials, there are at least }}r{\text{ successes}}).\end{aligned}}} In this sense, the negative binomial distribution is the "inverse" of the binomial distribution.

The sum of independent negative-binomially distributed random variables r 1 and r 2 with the same value for parameter p is negative-binomially distributed with the same p but with r -value r 1 + r 2 .

The negative binomial distribution is infinitely divisible , i.e., if Y has a negative binomial distribution, then for any positive integer n , there exist independent identically distributed random variables Y 1 , ..., Y n whose sum has the same distribution that Y has.

Representation as compound Poisson distribution [ edit ] The negative binomial distribution NB( r , p ) can be represented as a compound Poisson distribution : Let ( Y n ) n ∈ ∈ N {\textstyle (Y_{n})_{n\,\in \,\mathbb {N} }} denote a sequence of independent and identically distributed random variables , each one having the logarithmic series distribution Log( p ) , with probability mass function f ( k ; r , p ) = − − p k k ln ⁡ ⁡ ( 1 − − p ) , k ∈ ∈ N .

{\displaystyle f(k;r,p)={\frac {-p^{k}}{k\ln(1-p)}},\qquad k\in {\mathbb {N} }.} Let N be a random variable, independent of the sequence, and suppose that N has a Poisson distribution with mean λ = − r ln(1 − p ) . Then the random sum X = ∑ ∑ n = 1 N Y n {\displaystyle X=\sum _{n=1}^{N}Y_{n}} is NB( r , p ) -distributed. To prove this, we calculate the probability generating function G X of X , which is the composition of the probability generating functions G N and G Y 1 . Using G N ( z ) = exp ⁡ ⁡ ( λ λ ( z − − 1 ) ) , z ∈ ∈ R , {\displaystyle G_{N}(z)=\exp(\lambda (z-1)),\qquad z\in \mathbb {R} ,} and G Y 1 ( z ) = ln ⁡ ⁡ ( 1 − − p z ) ln ⁡ ⁡ ( 1 − − p ) , | z | < 1 p , {\displaystyle G_{Y_{1}}(z)={\frac {\ln(1-pz)}{\ln(1-p)}},\qquad |z|<{\frac {1}{p}},} we obtain G X ( z ) = G N ( G Y 1 ( z ) ) = exp ⁡ ⁡ [ λ λ ( ln ⁡ ⁡ ( 1 − − p z ) ln ⁡ ⁡ ( 1 − − p ) − − 1 ) ] = exp ⁡ ⁡ [ − − r ( ln ⁡ ⁡ ( 1 − − p z ) − − ln ⁡ ⁡ ( 1 − − p ) ) ] = ( 1 − − p 1 − − p z ) r , | z | < 1 p , {\displaystyle {\begin{aligned}G_{X}(z)&=G_{N}(G_{Y_{1}}(z))\\[4pt]&=\exp \left[\lambda \left({\frac {\ln(1-pz)}{\ln(1-p)}}-1\right)\right]\\[1ex]&=\exp \left[-r\left(\ln(1-pz)-\ln(1-p)\right)\right]\\[1ex]&=\left({\frac {1-p}{1-pz}}\right)^{r},\qquad |z|<{\frac {1}{p}},\end{aligned}}} which is the probability generating function of the NB( r , p ) distribution.

The following table describes four distributions related to the number of successes in a sequence of draws: With replacements No replacements Given number of draws binomial distribution hypergeometric distribution Given number of failures negative binomial distribution negative hypergeometric distribution ( a , b ,0) class of distributions [ edit ] The negative binomial, along with the Poisson and binomial distributions, is a member of the ( a , b , 0) class of distributions . All three of these distributions are special cases of the Panjer distribution . They are also members of a natural exponential family .

Statistical inference [ edit ] Parameter estimation [ edit ] MVUE for p [ edit ] Suppose p is unknown and an experiment is conducted where it is decided ahead of time that sampling will continue until r successes are found. A sufficient statistic for the experiment is k , the number of failures.

In estimating p , the minimum variance unbiased estimator is p ^ ^ = r − − 1 r + k − − 1 .

{\displaystyle {\widehat {p}}={\frac {r-1}{r+k-1}}.} Maximum likelihood estimation [ edit ] When r is known, the maximum likelihood estimate of p is p ~ ~ = r r + k , {\displaystyle {\widetilde {p}}={\frac {r}{r+k}},} but this is a biased estimate . Its inverse ( r + k )/ r , is an unbiased estimate of 1/ p , however.

[ 21 ] When r is unknown, the maximum likelihood estimator for p and r together only exists for samples for which the sample variance is larger than the sample mean.

[ 22 ] The likelihood function for N iid observations ( k 1 , ..., k N ) is L ( r , p ) = ∏ ∏ i = 1 N f ( k i ; r , p ) {\displaystyle L(r,p)=\prod _{i=1}^{N}f(k_{i};r,p)\,\!} from which we calculate the log-likelihood function ℓ ℓ ( r , p ) = ∑ ∑ i = 1 N [ ln ⁡ ⁡ Γ Γ ( k i + r ) − − ln ⁡ ⁡ ( k i !

) + k i ln ⁡ ⁡ ( 1 − − p ) ] + N [ r ln ⁡ ⁡ p − − ln ⁡ ⁡ Γ Γ ( r ) ] .

{\displaystyle \ell (r,p)=\sum _{i=1}^{N}\left[\ln \Gamma (k_{i}+r)-\ln(k_{i}!)+k_{i}\ln(1-p)\right]+N\left[r\ln p-\ln \Gamma (r)\right].} To find the maximum we take the partial derivatives with respect to r and p and set them equal to zero: ∂ ∂ ℓ ℓ ( r , p ) ∂ ∂ p = − − [ ∑ ∑ i = 1 N k i 1 1 − − p ] + N r 1 p = 0 {\displaystyle {\frac {\partial \ell (r,p)}{\partial p}}=-\left[\sum _{i=1}^{N}k_{i}{\frac {1}{1-p}}\right]+Nr{\frac {1}{p}}=0} and ∂ ∂ ℓ ℓ ( r , p ) ∂ ∂ r = [ ∑ ∑ i = 1 N ψ ψ ( k i + r ) ] − − N ψ ψ ( r ) + N ln ⁡ ⁡ ( p ) = 0 {\displaystyle {\frac {\partial \ell (r,p)}{\partial r}}=\left[\sum _{i=1}^{N}\psi (k_{i}+r)\right]-N\psi (r)+N\ln(p)=0} where ψ ψ ( k ) = Γ Γ ′ ( k ) Γ Γ ( k ) {\displaystyle \psi (k)={\frac {\Gamma '(k)}{\Gamma (k)}}\!} is the digamma function .

Solving the first equation for p gives: p = N r N r + ∑ ∑ i = 1 N k i {\displaystyle p={\frac {Nr}{Nr+\sum _{i=1}^{N}k_{i}}}} Substituting this in the second equation gives: ∂ ∂ ℓ ℓ ( r , p ) ∂ ∂ r = [ ∑ ∑ i = 1 N ψ ψ ( k i + r ) ] − − N ψ ψ ( r ) + N ln ⁡ ⁡ ( r r + ∑ ∑ i = 1 N k i / N ) = 0 {\displaystyle {\frac {\partial \ell (r,p)}{\partial r}}=\left[\sum _{i=1}^{N}\psi (k_{i}+r)\right]-N\psi (r)+N\ln \left({\frac {r}{r+\sum _{i=1}^{N}k_{i}/N}}\right)=0} This equation cannot be solved for r in closed form . If a numerical solution is desired, an iterative technique such as Newton's method can be used. Alternatively, the expectation–maximization algorithm can be used.

[ 22 ] Occurrence and applications [ edit ] Waiting time in a Bernoulli process [ edit ] Let k and r be integers with k non-negative and r positive.  In a sequence of independent Bernoulli trials with success probability p , the negative binomial gives the probability of k successes and r failures, with a failure on the last trial. Therefore, the negative binomial distribution represents the probability distribution of the number of successes before the r -th failure in a Bernoulli process , with probability p of successes on each trial.

Consider the following example. Suppose we repeatedly throw a die, and consider a 1 to be a failure.  The probability of success on each trial is 5/6. The number of successes before the third failure belongs to the infinite set { 0, 1, 2, 3, ... } . That number of successes is a negative-binomially distributed random variable.

When r = 1 we get the probability distribution of number of successes before the first failure (i.e. the probability of the first failure occurring on the ( k + 1) -st trial), which is a geometric distribution : f ( k ; r , p ) = ( 1 − − p ) ⋅ ⋅ p k {\displaystyle f(k;r,p)=(1-p)\cdot p^{k}} Overdispersed Poisson [ edit ] The negative binomial distribution, especially in its alternative parameterization described above, can be used as an alternative to the Poisson distribution.  It is especially useful for discrete data over an unbounded positive range whose sample variance exceeds the sample mean . In such cases, the observations are overdispersed with respect to a Poisson distribution, for which the mean is equal to the variance. Hence a Poisson distribution is not an appropriate model.  Since the negative binomial distribution has one more parameter than the Poisson, the second parameter can be used to adjust the variance independently of the mean. See Cumulants of some discrete probability distributions .

An application of this is to annual counts of tropical cyclones in the North Atlantic or to monthly to 6-monthly counts of wintertime extratropical cyclones over Europe, for which the variance is greater than the mean.

[ 23 ] [ 24 ] [ 25 ] In the case of modest overdispersion, this may produce substantially similar results to an overdispersed Poisson distribution.

[ 26 ] [ 27 ] Negative binomial modeling is widely employed in ecology and biodiversity research for analyzing count data where overdispersion is very common. This is because overdispersion is indicative of biological aggregation, such as species or communities forming clusters. Ignoring overdispersion can lead to significantly inflated model parameters, resulting in misleading statistical inferences. The negative binomial distribution effectively addresses overdispersed counts by permitting the variance to vary quadratically with the mean. An additional dispersion parameter governs the slope of the quadratic term, determining the severity of overdispersion. The model's quadratic mean-variance relationship proves to be a realistic approach for handling overdispersion, as supported by empirical evidence from many studies. Overall, the NB model offers two attractive features: (1) the convenient interpretation of the dispersion parameter as an index of clustering or aggregation, and (2) its tractable form, featuring a closed expression for the probability mass function.

[ 28 ] In genetics, the negative binomial distribution is commonly used to model data in the form of discrete sequence read counts from high-throughput RNA and DNA sequencing experiments.

[ 29 ] [ 30 ] [ 31 ] [ 32 ] In epidemiology of infectious diseases, the negative binomial has been used as a better option than the Poisson distribution to model overdispersed counts of secondary infections from one infected case (super-spreading events).

[ 33 ] Multiplicity observations (physics) [ edit ] The negative binomial distribution has been the most effective statistical model for a broad range of multiplicity observations in particle collision experiments, e.g., p p ¯ ¯ , h h , h A , A A , e + e − − {\displaystyle p{\bar {p}},\ hh,\ hA,\ AA,\ e^{+}e^{-}} [ 34 ] [ 35 ] [ 36 ] [ 37 ] [ 38 ] (See [ 39 ] for an overview), and is argued to be a scale-invariant property of matter, [ 40 ] [ 41 ] providing the best fit for astronomical observations, where it predicts the number of galaxies in a region of space.

[ 42 ] [ 43 ] [ 44 ] [ 45 ] The phenomenological justification for the effectiveness of the negative binomial distribution in these contexts remained unknown for fifty years, since their first observation in 1973.

[ 46 ] In 2023, a proof from first principles was eventually demonstrated by Scott V. Tezlaf, where it was shown that the negative binomial distribution emerges from symmetries in the dynamical equations of a canonical ensemble of particles in Minkowski space .

[ 47 ] Roughly, given an expected number of trials ⟨ ⟨ n ⟩ ⟩ {\displaystyle \langle n\rangle } and expected number of successes ⟨ ⟨ r ⟩ ⟩ {\displaystyle \langle r\rangle } , where ⟨ ⟨ n ⟩ ⟩ − − ⟨ ⟨ r ⟩ ⟩ = k , ⟨ ⟨ p ⟩ ⟩ = ⟨ ⟨ r ⟩ ⟩ ⟨ ⟨ n ⟩ ⟩ ⟹ ⟹ ⟨ ⟨ n ⟩ ⟩ = k 1 − − ⟨ ⟨ p ⟩ ⟩ , ⟨ ⟨ r ⟩ ⟩ = k ⟨ ⟨ p ⟩ ⟩ 1 − − ⟨ ⟨ p ⟩ ⟩ , {\displaystyle {\begin{aligned}\langle {\mathcal {n}}\rangle -\langle r\rangle &=k,&\langle p\rangle &={\frac {\langle r\rangle }{\langle {\mathcal {n}}\rangle }}\\[1ex]\implies \langle {\mathcal {n}}\rangle &={\frac {k}{1-\langle p\rangle }},&\langle {r}\rangle &={\frac {k\langle p\rangle }{1-\langle p\rangle }},\end{aligned}}} an isomorphic set of equations can be identified with the parameters of a relativistic current density of a canonical ensemble of massive particles, via c 2 ⟨ ρ ρ 2 ⟩ − − ⟨ j 2 ⟩ = c 2 ρ ρ 0 2 , ⟨ β β v 2 ⟩ = ⟨ j 2 ⟩ c 2 ⟨ ⟨ ρ ρ 2 ⟩ ⟩ ⟹ ⟹ c 2 ⟨ ρ ρ 2 ⟩ = c 2 ρ ρ 0 2 1 − − ⟨ β β v 2 ⟩ , ⟨ j 2 ⟩ = c 2 ρ ρ 0 2 ⟨ β β v 2 ⟩ 1 − − ⟨ β β v 2 ⟩ , {\displaystyle {\begin{aligned}c^{2}\left\langle \rho ^{2}\right\rangle -\left\langle j^{2}\right\rangle &=c^{2}\rho _{0}^{2},&\left\langle \beta _{v}^{2}\right\rangle &={\frac {\left\langle j^{2}\right\rangle }{c^{2}\langle \rho ^{2}\rangle }}\\[1ex]\implies c^{2}\left\langle \rho ^{2}\right\rangle &={\frac {c^{2}\rho _{0}^{2}}{1-\left\langle \beta _{v}^{2}\right\rangle }},&\left\langle j^{2}\right\rangle &={\frac {c^{2}\rho _{0}^{2}\left\langle \beta _{v}^{2}\right\rangle }{1-\left\langle \beta _{v}^{2}\right\rangle }},\end{aligned}}} where ρ ρ 0 {\displaystyle \rho _{0}} is the rest density , ⟨ ⟨ ρ ρ 2 ⟩ ⟩ {\displaystyle \langle \rho ^{2}\rangle } is the relativistic mean square density, ⟨ ⟨ j 2 ⟩ ⟩ {\displaystyle \langle j^{2}\rangle } is the relativistic mean square current density, and ⟨ ⟨ β β v 2 ⟩ ⟩ = ⟨ ⟨ v 2 ⟩ ⟩ / c 2 {\displaystyle \langle \beta _{v}^{2}\rangle =\langle v^{2}\rangle /c^{2}} , where ⟨ ⟨ v 2 ⟩ ⟩ {\displaystyle \langle v^{2}\rangle } is the mean square speed of the particle ensemble and c {\displaystyle c} is the speed of light —such that one can establish the following bijective map : c 2 ρ ρ 0 2 ↦ ↦ k , ⟨ ⟨ β β v 2 ⟩ ⟩ ↦ ↦ ⟨ ⟨ p ⟩ ⟩ , c 2 ⟨ ⟨ ρ ρ 2 ⟩ ⟩ ↦ ↦ ⟨ ⟨ n ⟩ ⟩ , ⟨ ⟨ j 2 ⟩ ⟩ ↦ ↦ ⟨ ⟨ r ⟩ ⟩ .

{\displaystyle {\begin{aligned}c^{2}\rho _{0}^{2}&\mapsto k,&\langle \beta _{v}^{2}\rangle &\mapsto \langle p\rangle ,\\[1ex]c^{2}\langle \rho ^{2}\rangle &\mapsto \langle {\mathcal {n}}\rangle ,&\langle j^{2}\rangle &\mapsto \langle r\rangle .\end{aligned}}} A rigorous alternative proof of the above correspondence has also been demonstrated through quantum mechanics via the Feynman path integral .

[ 47 ] History [ edit ] This distribution was first studied in 1713 by Pierre Remond de Montmort in his Essay d'analyse sur les jeux de hazard , as the distribution of the number of trials required in an experiment to obtain a given number of successes.

[ 48 ] It had previously been mentioned by Pascal .

[ 49 ] See also [ edit ] Coupon collector's problem Beta negative binomial distribution Extended negative binomial distribution Negative multinomial distribution Binomial distribution Poisson distribution Compound Poisson distribution Exponential family Negative binomial regression Vector generalized linear model References [ edit ] ^ DeGroot, Morris H.

(1986).

Probability and Statistics (Second ed.). Addison-Wesley. pp.

258– 259.

ISBN 0-201-11366-X .

LCCN 84006269 .

OCLC 10605205 .

^ Pascal distribution , Univariate Distribution Relationships, Larry Leemis ^ a b c Weisstein, Eric.

"Negative Binomial Distribution" .

Wolfram MathWorld . Wolfram Research . Retrieved 11 October 2020 .

^ e.g.

Lloyd-Smith, J. O.; Schreiber, S. J.; Kopp, P. E.; Getz, W. M. (2005).

"Superspreading and the effect of individual variation on disease emergence" .

Nature .

438 (7066): 355– 359.

Bibcode : 2005Natur.438..355L .

doi : 10.1038/nature04153 .

PMC 7094981 .

PMID 16292310 .

The overdispersion parameter is usually denoted by the letter k {\displaystyle k} in epidemiology, rather than r {\displaystyle r} as here.

^ Casella, George; Berger, Roger L. (2002).

Statistical inference (2nd ed.). Thomson Learning. p.

95 .

ISBN 0-534-24312-6 .

^ a b c Cook, John D.

"Notes on the Negative Binomial Distribution" (PDF) .

^ Morris K W (1963),A note on direct and inverse sampling, Biometrika, 50, 544–545.

^ "Mathworks: Negative Binomial Distribution" .

^ Saha, Abhishek.

"Introduction to Probability / Fundamentals of Probability: Lecture 14" (PDF) .

^ SAS Institute , " Negative Binomial Distribution ", SAS(R) 9.4 Functions and CALL Routines: Reference, Fourth Edition , SAS Institute, Cary, NC, 2016.

^ a b Crawley, Michael J. (2012).

The R Book . Wiley.

ISBN 978-1-118-44896-0 .

^ a b "Set theory: Section 3.2.5 – Negative Binomial Distribution" (PDF) .

^ "Randomservices.org, Chapter 10: Bernoulli Trials, Section 4: The Negative Binomial Distribution" .

^ "Stat Trek: Negative Binomial Distribution" .

^ Wroughton, Jacqueline.

"Distinguishing Between Binomial, Hypergeometric and Negative Binomial Distributions" (PDF) .

^ a b Hilbe, Joseph M.

(2011).

Negative Binomial Regression (Second ed.). Cambridge, UK: Cambridge University Press.

ISBN 978-0-521-19815-8 .

^ Lloyd-Smith, J. O. (2007).

"Maximum Likelihood Estimation of the Negative Binomial Dispersion Parameter for Highly Overdispersed Data, with Applications to Infectious Diseases" .

PLoS ONE .

2 (2): e180.

Bibcode : 2007PLoSO...2..180L .

doi : 10.1371/journal.pone.0000180 .

PMC 1791715 .

PMID 17299582 .

^ Carter, E.M., Potts, H.W.W. (4 April 2014).

"Predicting length of stay from an electronic patient record system: a primary total knee replacement example" .

BMC Medical Informatics and Decision Making .

14 : 26.

doi : 10.1186/1472-6947-14-26 .

PMC 3992140 .

PMID 24708853 .

{{ cite journal }} :  CS1 maint: multiple names: authors list ( link ) ^ Orooji, Arezoo; Nazar, Eisa; Sadeghi, Masoumeh; Moradi, Ali; Jafari, Zahra; Esmaily, Habibollah (2021-04-30).

"Factors associated with length of stay in hospital among the elderly patients using count regression models" .

Medical Journal of the Islamic Republic of Iran .

35 : 5.

doi : 10.47176/mjiri.35.5 .

PMC 8111647 .

PMID 33996656 .

^ Greenwood, M.; Yule, G. U. (1920).

"An inquiry into the nature of frequency distributions representative of multiple happenings with particular reference of multiple attacks of disease or of repeated accidents" .

J R Stat Soc .

83 (2): 255– 279.

doi : 10.2307/2341080 .

JSTOR 2341080 .

^ Haldane, J. B. S.

(1945). "On a Method of Estimating Frequencies".

Biometrika .

33 (3): 222– 225.

doi : 10.1093/biomet/33.3.222 .

hdl : 10338.dmlcz/102575 .

JSTOR 2332299 .

PMID 21006837 .

^ a b Aramidis, K. (1999).

"An EM algorithm for estimating negative binomial parameters" .

Australian & New Zealand Journal of Statistics .

41 (2): 213– 221.

doi : 10.1111/1467-842X.00075 .

S2CID 118758171 .

^ Villarini, G.; Vecchi, G.A.; Smith, J.A. (2010).

"Modeling of the dependence of tropical storm counts in the North Atlantic Basin on climate indices" .

Monthly Weather Review .

138 (7): 2681– 2705.

Bibcode : 2010MWRv..138.2681V .

doi : 10.1175/2010MWR3315.1 .

^ Mailier, P.J.; Stephenson, D.B.; Ferro, C.A.T.; Hodges, K.I. (2006).

"Serial Clustering of Extratropical Cyclones" .

Monthly Weather Review .

134 (8): 2224– 2240.

Bibcode : 2006MWRv..134.2224M .

doi : 10.1175/MWR3160.1 .

^ Vitolo, R.; Stephenson, D.B.; Cook, Ian M.; Mitchell-Wallace, K. (2009). "Serial clustering of intense European storms".

Meteorologische Zeitschrift .

18 (4): 411– 424.

Bibcode : 2009MetZe..18..411V .

doi : 10.1127/0941-2948/2009/0393 .

S2CID 67845213 .

^ McCullagh, Peter ; Nelder, John (1989).

Generalized Linear Models (Second ed.). Boca Raton: Chapman and Hall/CRC.

ISBN 978-0-412-31760-6 .

^ Cameron, Adrian C.; Trivedi, Pravin K. (1998).

Regression analysis of count data . Cambridge University Press.

ISBN 978-0-521-63567-7 .

^ Stoklosa, J.; Blakey, R.V.; Hui, F.K.C. (2022).

"An Overview of Modern Applications of Negative Binomial Modelling in Ecology and Biodiversity" .

Diversity .

14 (5): 320.

Bibcode : 2022Diver..14..320S .

doi : 10.3390/d14050320 .

^ Robinson, M.D.; Smyth, G.K. (2007).

"Moderated statistical tests for assessing differences in tag abundance" .

Bioinformatics .

23 (21): 2881– 2887.

doi : 10.1093/bioinformatics/btm453 .

PMID 17881408 .

^ "Differential analysis of count data – the" (PDF) .

^ Airoldi, E. M.; Cohen, W. W.; Fienberg, S. E. (June 2005). "Bayesian Models for Frequent Terms in Text".

Proceedings of the Classification Society of North America and INTERFACE Annual Meetings . Vol. 990. St. Louis, MO, USA. p. 991.

^ Chen, Yunshun; Davis, McCarthy (September 25, 2014).

"edgeR: differential expression analysis of digital gene expression data" (PDF) . Retrieved October 14, 2014 .

^ Lloyd-Smith, J. O.; Schreiber, S. J.; Kopp, P. E.; Getz, W. M. (2005).

"Superspreading and the effect of individual variation on disease emergence" .

Nature .

438 (7066): 355– 359.

Bibcode : 2005Natur.438..355L .

doi : 10.1038/nature04153 .

PMC 7094981 .

PMID 16292310 .

^ Grosse-Oetringhaus, Jan Fiete; Reygers, Klaus (2010-08-01).

"Charged-particle multiplicity in proton–proton collisions" .

Journal of Physics G: Nuclear and Particle Physics .

37 (8): 083001.

arXiv : 0912.0023 .

doi : 10.1088/0954-3899/37/8/083001 .

ISSN 0954-3899 .

S2CID 119233810 .

^ Rybczyński, Maciej; Wilk, Grzegorz; Włodarczyk, Zbigniew (2019-05-31).

"Intriguing properties of multiplicity distributions" .

Physical Review D .

99 (9): 094045.

arXiv : 1811.07197 .

Bibcode : 2019PhRvD..99i4045R .

doi : 10.1103/PhysRevD.99.094045 .

ISSN 2470-0010 .

^ Tarnowsky, Terence J.; Westfall, Gary D. (2013-07-09).

"First study of the negative binomial distribution applied to higher moments of net-charge and net-proton multiplicity distributions" .

Physics Letters B .

724 (1): 51– 55.

arXiv : 1210.8102 .

Bibcode : 2013PhLB..724...51T .

doi : 10.1016/j.physletb.2013.05.064 .

ISSN 0370-2693 .

^ Derrick, M.; Gan, K. K.; Kooijman, P.; Loos, J. S.; Musgrave, B.; Price, L. E.; Repond, J.; Schlereth, J.; Sugano, K.; Weiss, J. M.; Wood, D. E.; Baranko, G.; Blockus, D.; Brabson, B.; Brom, J. M. (1986-12-01).

"Study of quark fragmentation in ${e}^{+}$${e}^{\mathrm{\ensuremath{-}}}$ annihilation at 29 GeV: Charged-particle multiplicity and single-particle rapidity distributions" .

Physical Review D .

34 (11): 3304– 3320.

doi : 10.1103/PhysRevD.34.3304 .

hdl : 1808/15222 .

PMID 9957066 .

^ Zborovský, I. (2018-10-10).

"Three-component multiplicity distribution, oscillation of combinants and properties of clans in pp collisions at the LHC" .

The European Physical Journal C .

78 (10): 816.

arXiv : 1811.11230 .

Bibcode : 2018EPJC...78..816Z .

doi : 10.1140/epjc/s10052-018-6287-x .

ISSN 1434-6052 .

^ Kittel, Wolfram; De Wolf, Eddi A (2005).

Soft multihardon dynamics . World Scientific.

^ Schaeffer, R (1984). "Determination of the galaxy N-point correlation function".

Astronomy and Astrophysics .

134 (2): L15.

Bibcode : 1984A&A...134L..15S .

^ Schaeffer, R (1985). "The probability generating function for galaxy clustering".

Astronomy and Astrophysics .

144 (1): L1 – L4 .

Bibcode : 1985A&A...144L...1S .

^ Perez, Lucia A.; Malhotra, Sangeeta; Rhoads, James E.; Tilvi, Vithal (2021-01-07).

"Void Probability Function of Simulated Surveys of High-redshift Ly α Emitters" .

The Astrophysical Journal .

906 (1): 58.

arXiv : 2011.03556 .

Bibcode : 2021ApJ...906...58P .

doi : 10.3847/1538-4357/abc88b .

ISSN 1538-4357 .

^ Hurtado-Gil, Lluís; Martínez, Vicent J.; Arnalte-Mur, Pablo; Pons-Bordería, María-Jesús; Pareja-Flores, Cristóbal; Paredes, Silvestre (2017-05-01).

"The best fit for the observed galaxy counts-in-cell distribution function" .

Astronomy & Astrophysics .

601 : A40.

arXiv : 1703.01087 .

Bibcode : 2017A&A...601A..40H .

doi : 10.1051/0004-6361/201629097 .

ISSN 0004-6361 .

^ Elizalde, E.; Gaztanaga, E. (January 1992).

"Void probability as a function of the void's shape and scale-invariant models" .

Monthly Notices of the Royal Astronomical Society .

254 (2): 247– 256.

doi : 10.1093/mnras/254.2.247 .

hdl : 2060/19910019799 .

ISSN 0035-8711 .

^ Hameeda, M; Plastino, Angelo; Rocca, M C (2021-03-01).

"Generalized Poisson distributions for systems with two-particle interactions" .

IOP SciNotes .

2 (1): 015003.

Bibcode : 2021IOPSN...2a5003H .

doi : 10.1088/2633-1357/abec9f .

hdl : 11336/181371 .

ISSN 2633-1357 .

^ Giovannini, A. (June 1973).

" "Thermal chaos" and "coherence" in multiplicity distributions at high energies" .

Il Nuovo Cimento A .

15 (3): 543– 551.

Bibcode : 1973NCimA..15..543G .

doi : 10.1007/bf02734689 .

ISSN 0369-3546 .

S2CID 118805136 .

^ a b Tezlaf, Scott V. (2023-09-29).

"Significance of the negative binomial distribution in multiplicity phenomena" .

Physica Scripta .

98 (11).

arXiv : 2310.03776 .

Bibcode : 2023PhyS...98k5310T .

doi : 10.1088/1402-4896/acfead .

ISSN 0031-8949 .

S2CID 263300385 .

^ Montmort PR de (1713) Essai d'analyse sur les jeux de hasard. 2nd ed. Quillau, Paris ^ Pascal B (1679) Varia Opera Mathematica. D. Petri de Fermat. Tolosae v t e Probability distributions ( list ) Discrete univariate with finite support Benford Bernoulli Beta-binomial Binomial Categorical Hypergeometric Negative Poisson binomial Rademacher Soliton Discrete uniform Zipf Zipf–Mandelbrot with infinite support Beta negative binomial Borel Conway–Maxwell–Poisson Discrete phase-type Delaporte Extended negative binomial Flory–Schulz Gauss–Kuzmin Geometric Logarithmic Mixed Poisson Negative binomial Panjer Parabolic fractal Poisson Skellam Yule–Simon Zeta Continuous univariate supported on a bounded interval Arcsine ARGUS Balding–Nichols Bates Beta Generalized Beta rectangular Continuous Bernoulli Irwin–Hall Kumaraswamy Logit-normal Noncentral beta PERT Raised cosine Reciprocal Triangular U-quadratic Uniform Wigner semicircle supported on a semi-infinite interval Benini Benktander 1st kind Benktander 2nd kind Beta prime Burr Chi Chi-squared Noncentral Inverse Scaled Dagum Davis Erlang Hyper Exponential Hyperexponential Hypoexponential Logarithmic F Noncentral Folded normal Fréchet Gamma Generalized Inverse gamma/Gompertz Gompertz Shifted Half-logistic Half-normal Hotelling's T -squared Hartman–Watson Inverse Gaussian Generalized Kolmogorov Lévy Log-Cauchy Log-Laplace Log-logistic Log-normal Log-t Lomax Matrix-exponential Maxwell–Boltzmann Maxwell–Jüttner Mittag-Leffler Nakagami Pareto Phase-type Poly-Weibull Rayleigh Relativistic Breit–Wigner Rice Truncated normal type-2 Gumbel Weibull Discrete Wilks's lambda supported on the whole real line Cauchy Exponential power Fisher's z Kaniadakis κ-Gaussian Gaussian q Generalized hyperbolic Generalized logistic (logistic-beta) Generalized normal Geometric stable Gumbel Holtsmark Hyperbolic secant Johnson's S U Landau Laplace Asymmetric Logistic Noncentral t Normal (Gaussian) Normal-inverse Gaussian Skew normal Slash Stable Student's t Tracy–Widom Variance-gamma Voigt with support whose type varies Generalized chi-squared Generalized extreme value Generalized Pareto Marchenko–Pastur Kaniadakis κ -exponential Kaniadakis κ -Gamma Kaniadakis κ -Weibull Kaniadakis κ -Logistic Kaniadakis κ -Erlang q -exponential q -Gaussian q -Weibull Shifted log-logistic Tukey lambda Mixed univariate continuous- discrete Rectified Gaussian Multivariate (joint) Discrete: Ewens Multinomial Dirichlet Negative Continuous: Dirichlet Generalized Multivariate Laplace Multivariate normal Multivariate stable Multivariate t Normal-gamma Inverse Matrix-valued: LKJ Matrix beta Matrix normal Matrix t Matrix gamma Inverse Wishart Normal Inverse Normal-inverse Complex Uniform distribution on a Stiefel manifold Directional Univariate (circular) directional Circular uniform Univariate von Mises Wrapped normal Wrapped Cauchy Wrapped exponential Wrapped asymmetric Laplace Wrapped Lévy Bivariate (spherical) Kent Bivariate (toroidal) Bivariate von Mises Multivariate von Mises–Fisher Bingham Degenerate and singular Degenerate Dirac delta function Singular Cantor Families Circular Compound Poisson Elliptical Exponential Natural exponential Location–scale Maximum entropy Mixture Pearson Tweedie Wrapped Category Commons Retrieved from " https://en.wikipedia.org/w/index.php?title=Negative_binomial_distribution&oldid=1305618611 " Categories : Discrete distributions Exponential family distributions Compound probability distributions Factorial and binomial topics Infinitely divisible probability distributions Hidden categories: CS1 maint: multiple names: authors list Articles with short description Short description matches Wikidata This page was last edited on 13 August 2025, at 03:44 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Negative binomial distribution 27 languages Add topic

