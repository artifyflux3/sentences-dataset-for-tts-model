Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Definition Toggle Definition subsection 1.1 Strictly increasing distribution function 1.2 General distribution function 2 Simple example 3 Applications 4 Calculation Toggle Calculation subsection 4.1 Normal distribution 4.1.1 Ordinary differential equation for the normal quantile 4.2 Student's t -distribution 5 Quantile mixtures 6 Non-linear differential equations for quantile functions 7 See also 8 References 9 Further reading Toggle the table of contents Quantile function 13 languages Català Čeština Deutsch Español فارسی Français 한국어 Magyar Nederlands Polski Português Shqip 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Statistical function that defines the quantiles of a probability distribution The probit is the quantile function of the normal distribution .

In probability and statistics , the quantile function is a function Q : [ 0 , 1 ] ↦ ↦ R {\displaystyle Q:[0,1]\mapsto \mathbb {R} } which maps some probability x ∈ ∈ [ 0 , 1 ] {\displaystyle x\in [0,1]} of a random variable v {\displaystyle v} to the value of the variable y {\displaystyle y} such that P ( v ≤ ≤ y ) = x {\displaystyle P(v\leq y)=x} according to its probability distribution . In other words, the function returns the value of the variable below which the specified cumulative probability is contained. For example, if the distribution is a standard normal distribution then Q ( 0.5 ) {\displaystyle Q(0.5)} will return 0 as 0.5 of the probability mass is contained below 0.

The quantile function is also called the percentile function (after the percentile ), percent-point function , inverse cumulative distribution function (after the cumulative distribution function or c.d.f.) or inverse distribution function .

Definition [ edit ] Strictly increasing distribution function [ edit ] With reference to a continuous and strictly increasing cumulative distribution function (c.d.f.) F X : : R → → [ 0 , 1 ] {\displaystyle F_{X}\colon \mathbb {R} \to [0,1]} of a random variable X , the quantile function Q : : [ 0 , 1 ] → → R {\displaystyle Q\colon [0,1]\to \mathbb {R} } maps its input p to a threshold value x so that the probability of X being less or equal than x is p . In terms of the distribution function F , the quantile function Q returns the value x such that F X ( x ) := Pr ( X ≤ ≤ x ) = p , {\displaystyle F_{X}(x):=\Pr(X\leq x)=p,} which can be written as inverse of the c.d.f.

Q ( p ) = F X − − 1 ( p ) .

{\displaystyle Q(p)=F_{X}^{-1}(p).} The cumulative distribution function (shown as F ( x ) ) gives the p values as a function of the q values. The quantile function does the opposite: it gives the q values as a function of the p values. Note that the portion of F ( x ) in red is a horizontal line segment.

General distribution function [ edit ] In the general case of distribution functions that are not strictly monotonic and therefore do not permit an inverse c.d.f.

, the quantile is a (potentially) set valued functional of a distribution function F , given by the interval [ 1 ] Q ( p ) = [ sup { x : : F ( x ) < p } , sup { x : : F ( x ) ≤ ≤ p } ] .

{\displaystyle Q(p)={\big [}\sup\{x\colon F(x)<p\},\sup\{x\colon F(x)\leq p\}{\big ]}.} It is often standard to choose the lowest value, which can equivalently be written as (using right-continuity of F ) Q ( p ) = inf { x ∈ ∈ R : p ≤ ≤ F ( x ) } .

{\displaystyle Q(p)=\inf\{x\in \mathbb {R} :p\leq F(x)\}.} Here we capture the fact that the quantile function returns the minimum value of x from amongst all those values whose c.d.f value exceeds p , which is equivalent to the previous probability statement in the special case that the distribution is continuous.

The quantile is the unique function satisfying the Galois inequalities Q ( p ) ≤ ≤ x {\displaystyle Q(p)\leq x} if and only if p ≤ ≤ F ( x ) .

{\displaystyle p\leq F(x).} If the function F is continuous and strictly monotonically increasing, then the inequalities can be replaced by equalities, and we have Q = F − − 1 .

{\displaystyle Q=F^{-1}.} In general, even though the distribution function F may fail to possess a left or right inverse , the quantile function Q behaves as an "almost sure left inverse" for the distribution function, in the sense that Q ( F ( X ) ) = X almost surely.

{\displaystyle Q{\bigl (}F(X){\bigr )}=X\quad {\text{almost surely.}}} Simple example [ edit ] For example, the cumulative distribution function of Exponential( λ ) (i.e. intensity λ and expected value ( mean ) 1/ λ ) is F ( x ; λ λ ) = { 1 − − e − − λ λ x x ≥ ≥ 0 , 0 x < 0.

{\displaystyle F(x;\lambda )={\begin{cases}1-e^{-\lambda x}&x\geq 0,\\0&x<0.\end{cases}}} The quantile function for Exponential( λ ) is derived by finding the value of Q for which 1 − − e − − λ λ Q = p {\displaystyle 1-e^{-\lambda Q}=p} : Q ( p ; λ λ ) = − − ln ⁡ ⁡ ( 1 − − p ) λ λ , {\displaystyle Q(p;\lambda )={\frac {-\ln(1-p)}{\lambda }},} for 0 ≤ p < 1 .  The quartiles are therefore: first quartile ( p = 1/4 ) − − ln ⁡ ⁡ ( 3 / 4 ) / λ λ , {\displaystyle -\ln(3/4)/\lambda ,} median ( p = 2/4 ) − − ln ⁡ ⁡ ( 1 / 2 ) / λ λ , {\displaystyle -\ln(1/2)/\lambda ,} third quartile ( p = 3/4 ) − − ln ⁡ ⁡ ( 1 / 4 ) / λ λ .

{\displaystyle -\ln(1/4)/\lambda .} Applications [ edit ] Quantile functions are used in both statistical applications and Monte Carlo methods .

The quantile function is one way of prescribing a probability distribution, and it is an alternative to the probability density function (pdf) or probability mass function , the cumulative distribution function (cdf) and the characteristic function . The quantile function, Q , of a probability distribution is the inverse of its cumulative distribution function F . The derivative of the quantile function, namely the quantile density function , is yet another way of prescribing a probability distribution. It is the reciprocal of the pdf composed with the quantile function.

Consider a statistical application where a user needs to know key percentage points of a given distribution.  For example, they require the median and 25% and 75% quartiles as in the example above or 5%, 95%, 2.5%, 97.5% levels for other applications such as assessing the statistical significance of an observation whose distribution is known; see the quantile entry. Before the popularization of computers, it was not uncommon for books to have appendices with statistical tables sampling the quantile function.

[ 2 ] Statistical applications of quantile functions are discussed extensively by Gilchrist.

[ 3 ] Monte-Carlo simulations employ quantile functions to produce non-uniform random or pseudorandom numbers for use in diverse types of simulation calculations. A sample from a given distribution may be obtained in principle by applying its quantile function to a sample from a uniform distribution. The demands of simulation methods, for example in modern computational finance , are focusing increasing attention on methods based on quantile functions, as they work well with multivariate techniques based on either copula or quasi-Monte-Carlo methods [ 4 ] and Monte Carlo methods in finance .

Calculation [ edit ] The evaluation of quantile functions often involves numerical methods , such as the exponential distribution above, which is one of the few distributions where a closed-form expression can be found (others include the uniform , the Weibull , the Tukey lambda (which includes the logistic ) and the log-logistic ). When the cdf itself has a closed-form expression, one can always use a numerical root-finding algorithm such as the bisection method to invert the cdf. Other methods rely on an approximation of the inverse via interpolation techniques.

[ 5 ] [ 6 ] Further algorithms to evaluate quantile functions are given in the Numerical Recipes series of books. Algorithms for common distributions are built into many statistical software packages. General methods to numerically compute the quantile functions for general classes of distributions can be found in the following libraries: C library UNU.RAN [ 7 ] R library Runuran [ 8 ] Python subpackage sampling in scipy.stats [ 9 ] [ 10 ] Quantile functions may also be characterized as solutions of non-linear ordinary and partial differential equations . The ordinary differential equations for the cases of the normal , Student , beta and gamma distributions have been given and solved.

[ 11 ] Normal distribution [ edit ] Main article: Normal distribution § Quantile function The normal distribution is perhaps the most important case.  Because the normal distribution is a location-scale family , its quantile function for arbitrary parameters can be derived from a simple transformation of the quantile function of the standard normal distribution, known as the probit function.  Unfortunately, this function has no closed-form representation using basic algebraic functions; as a result, approximate representations are usually used. Thorough composite rational and polynomial approximations have been given by Wichura [ 12 ] and Acklam.

[ 13 ] Non-composite rational approximations have been developed by Shaw.

[ 14 ] Ordinary differential equation for the normal quantile [ edit ] A non-linear ordinary differential equation for the normal quantile, w ( p ) , may be given. It is d 2 w d p 2 = w ( d w d p ) 2 {\displaystyle {\frac {d^{2}w}{dp^{2}}}=w\left({\frac {dw}{dp}}\right)^{2}} with the centre (initial) conditions w ( 1 / 2 ) = 0 , {\displaystyle w\left(1/2\right)=0,\,} w ′ ( 1 / 2 ) = 2 π π .

{\displaystyle w'\left(1/2\right)={\sqrt {2\pi }}.\,} This equation may be solved by several methods, including the classical power series approach. From this solutions of arbitrarily high accuracy may be developed (see Steinbrecher and Shaw, 2008).

Student's t -distribution [ edit ] Further information: Student's t-distribution This has historically been one of the more intractable cases, as the presence of a parameter, ν, the degrees of freedom, makes the use of rational and other approximations awkward. Simple formulas exist when the ν = 1, 2, 4 and the problem may be reduced to the solution of a polynomial when ν is even. In other cases the quantile functions may be developed as power series.

[ 15 ] The simple cases are as follows: Main article: Cauchy distribution ν = 1 (Cauchy distribution) Q ( p ) = tan ⁡ ⁡ ( π π ( p − − 1 / 2 ) ) {\displaystyle Q(p)=\tan(\pi (p-1/2))\!} ν = 2 Q ( p ) = 2 ( p − − 1 / 2 ) 2 α α {\displaystyle Q(p)=2(p-1/2){\sqrt {\frac {2}{\alpha }}}\!} ν = 4 Q ( p ) = sign ⁡ ⁡ ( p − − 1 / 2 ) 2 q − − 1 {\displaystyle Q(p)=\operatorname {sign} (p-1/2)\,2\,{\sqrt {q-1}}\!} where q = cos ⁡ ⁡ ( 1 3 arccos ⁡ ⁡ ( α α ) ) α α {\displaystyle q={\frac {\cos \left({\frac {1}{3}}\arccos \left({\sqrt {\alpha }}\,\right)\right)}{\sqrt {\alpha }}}\!} and α α = 4 p ( 1 − − p ) .

{\displaystyle \alpha =4p(1-p).\!} In the above the "sign" function is +1 for positive arguments, −1 for negative arguments and zero at zero. It should not be confused with the trigonometric sine function.

Quantile mixtures [ edit ] Analogously to the mixtures of densities , distributions can be defined as quantile mixtures Q ( p ) = ∑ ∑ i = 1 m a i Q i ( p ) , {\displaystyle Q(p)=\sum _{i=1}^{m}a_{i}Q_{i}(p),} where Q i ( p ) {\displaystyle Q_{i}(p)} , i = 1 , … … , m {\displaystyle i=1,\ldots ,m} are quantile functions and a i {\displaystyle a_{i}} , i = 1 , … … , m {\displaystyle i=1,\ldots ,m} are the model parameters. The parameters a i {\displaystyle a_{i}} must be selected so that Q ( p ) {\displaystyle Q(p)} is a quantile function.
Two four-parametric quantile mixtures, the normal-polynomial quantile mixture and the Cauchy-polynomial quantile mixture, are presented by Karvanen.

[ 16 ] Non-linear differential equations for quantile functions [ edit ] The non-linear ordinary differential equation given for normal distribution is a special case of that available for any quantile function whose second derivative exists. In general the equation for a quantile, Q ( p ) , may be given. It is d 2 Q d p 2 = H ( Q ) ( d Q d p ) 2 {\displaystyle {\frac {d^{2}Q}{dp^{2}}}=H(Q)\left({\frac {dQ}{dp}}\right)^{2}} augmented by suitable boundary conditions, where H ( x ) = − − f ′ ( x ) f ( x ) = − − d d x ln ⁡ ⁡ f ( x ) {\displaystyle H(x)=-{\frac {f'(x)}{f(x)}}=-{\frac {d}{dx}}\ln f(x)} and f ( x ) is the probability density function. The forms of this equation, and its classical analysis by series and asymptotic solutions,  for the cases of the normal, Student, gamma and beta distributions has been elucidated by Steinbrecher and Shaw (2008). Such solutions provide accurate benchmarks, and in the case of the Student, suitable series for live Monte Carlo use.

See also [ edit ] Inverse transform sampling Percentage point Probability integral transform Quantile Rank–size distribution References [ edit ] ^ Ehm, W.; Gneiting, T.; Jordan, A.; Krüger, F. (2016).

"Of quantiles and expectiles: Consistent scoring functions, Choquet representations, and forecast rankings" .

J. R. Stat. Soc. B .

78 (3): 505– 562.

arXiv : 1503.08195 .

doi : 10.1111/rssb.12154 .

^ "Archived copy" (PDF) . Archived from the original (PDF) on March 24, 2012 . Retrieved March 25, 2012 .

{{ cite web }} :  CS1 maint: archived copy as title ( link ) ^ Gilchrist, W. (2000).

Statistical Modelling with Quantile Functions . Taylor & Francis.

ISBN 1-58488-174-7 .

^ Jaeckel, P. (2002).

Monte Carlo methods in finance .

^ Hörmann, Wolfgang; Leydold, Josef (2003).

"Continuous random variate generation by fast numerical inversion" .

ACM Transactions on Modeling and Computer Simulation .

13 (4): 347– 362.

doi : 10.1145/945511.945517 . Retrieved 17 June 2024 – via WU Vienna.

^ Derflinger, Gerhard; Hörmann, Wolfgang; Leydold, Josef (2010).

"Random variate generation by numerical inversion when only the density is known" (PDF) .

ACM Transactions on Modeling and Computer Simulation .

20 (4) 18: 1– 25.

doi : 10.1145/1842722.1842723 .

^ "UNU.RAN - Universal Non-Uniform RANdom number generators" .

^ "Runuran: R Interface to the 'UNU.RAN' Random Variate Generators" . 17 January 2023.

^ "Random Number Generators (Scipy.stats.sampling) — SciPy v1.13.0 Manual" .

^ Baumgarten, Christoph; Patel, Tirth (2022). "Automatic random variate generation in Python".

Proceedings of the 21st Python in Science Conference . pp.

46– 51.

doi : 10.25080/majora-212e5952-007 .

^ Steinbrecher, G.; Shaw, W.T. (2008). "Quantile mechanics".

European Journal of Applied Mathematics .

19 (2): 87– 112.

doi : 10.1017/S0956792508007341 .

S2CID 6899308 .

^ Wichura, M.J. (1988). "Algorithm AS241: The Percentage Points of the Normal Distribution".

Applied Statistics .

37 (3). Blackwell Publishing: 477– 484.

doi : 10.2307/2347330 .

JSTOR 2347330 .

^ An algorithm for computing the inverse normal cumulative distribution function Archived May 5, 2007, at the Wayback Machine ^ Computational Finance: Differential Equations for Monte Carlo Recycling ^ Shaw, W.T. (2006). "Sampling Student's T distribution – Use of the inverse cumulative distribution function".

Journal of Computational Finance .

9 (4): 37– 73.

doi : 10.21314/JCF.2006.150 .

^ Karvanen, J. (2006). "Estimation of quantile mixtures via L-moments and trimmed L-moments".

Computational Statistics & Data Analysis .

51 (2): 947– 956.

doi : 10.1016/j.csda.2005.09.014 .

Further reading [ edit ] Abernathy, Roger W. and Smith, Robert P. (1993) * "Applying series expansion to the inverse beta distribution to find percentiles of the F-distribution" , ACM Trans. Math. Softw.

, 9 (4), 478–480 doi : 10.1145/168173.168387 Refinement of the Normal Quantile New Methods for Managing "Student's" T Distribution ACM Algorithm 396: Student's t-Quantiles v t e Theory of probability distributions probability mass function (pmf) probability density function (pdf) cumulative distribution function (cdf) quantile function raw moment central moment mean variance standard deviation skewness kurtosis L-moment moment-generating function (mgf) characteristic function probability-generating function (pgf) cumulant combinant NewPP limit report
Parsed by mw‐web.codfw.main‐6cc77c66b8‐v5dst
Cached time: 20250812005845
Cache expiry: 2592000
Reduced expiry: false
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.383 seconds
Real time usage: 0.496 seconds
Preprocessor visited node count: 2067/1000000
Revision size: 17260/2097152 bytes
Post‐expand include size: 37072/2097152 bytes
Template argument size: 1965/2097152 bytes
Highest expansion depth: 8/100
Expensive parser function count: 4/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 63409/5000000 bytes
Lua time usage: 0.232/10.000 seconds
Lua memory usage: 5405763/52428800 bytes
Number of Wikibase entities loaded: 0/500 Transclusion expansion time report (%,ms,calls,template)
100.00%  380.103      1 -total
 46.41%  176.401      1 Template:Reflist
 29.45%  111.933      7 Template:Cite_journal
 19.72%   74.956      1 Template:Short_description
 18.80%   71.459      1 Template:Theory_of_probability_distributions
 18.35%   69.762      1 Template:Navbox
 11.48%   43.652      2 Template:Pagetype
  6.22%   23.628     18 Template:Main_other
  5.31%   20.190      2 Template:Main
  5.28%   20.086      3 Template:Cite_book Saved in parser cache with key enwiki:pcache:10167616:|#|:idhash:canonical and timestamp 20250812005845 and revision id 1300123235. Rendering was triggered because: page-view Retrieved from " https://en.wikipedia.org/w/index.php?title=Quantile_function&oldid=1300123235 " Category : Functions related to probability distributions Hidden categories: CS1 maint: archived copy as title Webarchive template wayback links Articles with short description Short description matches Wikidata This page was last edited on 12 July 2025, at 11:33 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Quantile function 13 languages Add topic

