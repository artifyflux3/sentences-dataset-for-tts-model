Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Growth rate Toggle Growth rate subsection 1.1 More precise estimates 1.2 Exact form 2 Table of π ( x ) , ⁠ x / log x ⁠ , and li( x ) 3 Algorithms for evaluating π ( x ) Toggle Algorithms for evaluating π ( x ) subsection 3.1 The Meissel–Lehmer algorithm 4 Other prime-counting functions Toggle Other prime-counting functions subsection 4.1 Riemann's prime-power counting function 4.2 Chebyshev's function 5 Formulas for prime-counting functions 6 Inequalities 7 The Riemann hypothesis 8 See also 9 References Toggle References subsection 9.1 Notes 10 External links Toggle the table of contents Prime-counting function 34 languages العربية বাংলা Български Català Čeština Cymraeg Dansk Deutsch Español Esperanto فارسی Français Galego 한국어 Bahasa Indonesia Italiano עברית Kreyòl ayisyen Magyar Nederlands 日本語 Polski Português Русский Simple English Slovenščina Српски / srpski Suomi Svenska தமிழ் ไทย Українська Tiếng Việt 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikimedia Commons Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Function representing the number of primes less than or equal to a given number "Π(x)" redirects here. For the variant of the gamma function, see Gamma function § Pi function .

This article uses technical mathematical notation for logarithms. All instances of log( x ) without a subscript base should be interpreted as a natural logarithm , also commonly written as ln( x ) or log e ( x ) .

This article duplicates the scope of other articles , specifically Prime number theorem .

Please discuss this issue and help introduce a summary style to the article.

( December 2024 ) The values of π ( n ) for the first 60 positive integers In mathematics , the prime-counting function is the function counting the number of prime numbers less than or equal to some real number x .

[ 1 ] [ 2 ] It is denoted by π ( x ) (unrelated to the number π ).

A symmetric variant seen sometimes is π 0 ( x ) , which is equal to π ( x ) − 1 ⁄ 2 if x is exactly a prime number, and equal to π ( x ) otherwise.  That is, the number of prime numbers less than x , plus half if x equals a prime.

Growth rate [ edit ] Main article: Prime number theorem Of great interest in number theory is the growth rate of the prime-counting function.

[ 3 ] [ 4 ] It was conjectured in the end of the 18th century by Gauss and by Legendre to be approximately x log ⁡ ⁡ x {\displaystyle {\frac {x}{\log x}}} where log is the natural logarithm , in the sense that lim x → → ∞ ∞ π π ( x ) x / log ⁡ ⁡ x = 1.

{\displaystyle \lim _{x\rightarrow \infty }{\frac {\pi (x)}{x/\log x}}=1.} This statement is the prime number theorem . An equivalent statement is lim x → → ∞ ∞ π π ( x ) li ⁡ ⁡ ( x ) = 1 {\displaystyle \lim _{x\rightarrow \infty }{\frac {\pi (x)}{\operatorname {li} (x)}}=1} where li is the logarithmic integral function. The prime number theorem was first proved in 1896 by Jacques Hadamard and by Charles de la Vallée Poussin independently, using properties of the Riemann zeta function introduced by Riemann in 1859. Proofs of the prime number theorem not using the zeta function or complex analysis were found around 1948 by Atle Selberg and by Paul Erdős (for the most part independently).

[ 5 ] More precise estimates [ edit ] In 1899, de la Vallée Poussin proved that [ 6 ] π π ( x ) = li ⁡ ⁡ ( x ) + O ( x e − − a log ⁡ ⁡ x ) as x → → ∞ ∞ {\displaystyle \pi (x)=\operatorname {li} (x)+O\left(xe^{-a{\sqrt {\log x}}}\right)\quad {\text{as }}x\to \infty } for some positive constant a . Here, O (...) is the big O notation .

More precise estimates of π ( x ) are now known. For example, in 2002, Kevin Ford proved that [ 7 ] π π ( x ) = li ⁡ ⁡ ( x ) + O ( x exp ⁡ ⁡ ( − − 0.2098 ( log ⁡ ⁡ x ) 3 / 5 ( log ⁡ ⁡ log ⁡ ⁡ x ) − − 1 / 5 ) ) .

{\displaystyle \pi (x)=\operatorname {li} (x)+O\left(x\exp \left(-0.2098(\log x)^{3/5}(\log \log x)^{-1/5}\right)\right).} Mossinghoff and Trudgian proved [ 8 ] an explicit upper bound for the difference between π ( x ) and li( x ) : | π π ( x ) − − li ⁡ ⁡ ( x ) | ≤ ≤ 0.2593 x ( log ⁡ ⁡ x ) 3 / 4 exp ⁡ ⁡ ( − − log ⁡ ⁡ x 6.315 ) for x ≥ ≥ 229.

{\displaystyle {\bigl |}\pi (x)-\operatorname {li} (x){\bigr |}\leq 0.2593{\frac {x}{(\log x)^{3/4}}}\exp \left(-{\sqrt {\frac {\log x}{6.315}}}\right)\quad {\text{for }}x\geq 229.} For values of x that are not unreasonably large, li( x ) is greater than π ( x ) . However, π ( x ) − li( x ) is known to change sign infinitely many times. For a discussion of this, see Skewes' number .

Exact form [ edit ] For x > 1 let π 0 ( x ) = π ( x ) − ⁠ 1 / 2 ⁠ when x is a prime number, and π 0 ( x ) = π ( x ) otherwise.

Bernhard Riemann , in his work On the Number of Primes Less Than a Given Magnitude , proved that π 0 ( x ) is equal to [ 9 ] Riemann's explicit formula using the first 200 non-trivial zeros of the zeta function π π 0 ( x ) = R ⁡ ⁡ ( x ) − − ∑ ∑ ρ ρ R ⁡ ⁡ ( x ρ ρ ) , {\displaystyle \pi _{0}(x)=\operatorname {R} (x)-\sum _{\rho }\operatorname {R} (x^{\rho }),} where R ⁡ ⁡ ( x ) = ∑ ∑ n = 1 ∞ ∞ μ μ ( n ) n li ⁡ ⁡ ( x 1 / n ) , {\displaystyle \operatorname {R} (x)=\sum _{n=1}^{\infty }{\frac {\mu (n)}{n}}\operatorname {li} \left(x^{1/n}\right),} μ ( n ) is the Möbius function , li( x ) is the logarithmic integral function , ρ indexes every zero of the Riemann zeta function, and li( x ⁠ ρ / n ⁠ ) is not evaluated with a branch cut but instead considered as Ei( ⁠ ρ / n ⁠ log x ) where Ei( x ) is the exponential integral . If the trivial zeros are collected and the sum is taken only over the non-trivial zeros ρ of the Riemann zeta function, then π 0 ( x ) may be approximated by [ 10 ] π π 0 ( x ) ≈ ≈ R ⁡ ⁡ ( x ) − − ∑ ∑ ρ ρ R ⁡ ⁡ ( x ρ ρ ) − − 1 log ⁡ ⁡ x + 1 π π arctan ⁡ ⁡ π π log ⁡ ⁡ x .

{\displaystyle \pi _{0}(x)\approx \operatorname {R} (x)-\sum _{\rho }\operatorname {R} \left(x^{\rho }\right)-{\frac {1}{\log x}}+{\frac {1}{\pi }}\arctan {\frac {\pi }{\log x}}.} The Riemann hypothesis suggests that every such non-trivial zero lies along Re( s ) = ⁠ 1 / 2 ⁠ .

Table of π ( x ) , ⁠ x / log x ⁠ , and li( x ) [ edit ] The table shows how the three functions π ( x ) , ⁠ x / log x ⁠ , and li( x ) compared at powers of 10. See also, [ 3 ] [ 11 ] and [ 12 ] x π ( x ) π ( x ) − ⁠ x / log x ⁠ li( x ) − π ( x ) ⁠ x / π ( x ) ⁠ ⁠ x / log x ⁠ % error 10 4 0 2 2.500 −8.57% 10 2 25 3 5 4.000 +13.14% 10 3 168 23 10 5.952 +13.83% 10 4 1,229 143 17 8.137 +11.66% 10 5 9,592 906 38 10.425 +9.45% 10 6 78,498 6,116 130 12.739 +7.79% 10 7 664,579 44,158 339 15.047 +6.64% 10 8 5,761,455 332,774 754 17.357 +5.78% 10 9 50,847,534 2,592,592 1,701 19.667 +5.10% 10 10 455,052,511 20,758,029 3,104 21.975 +4.56% 10 11 4,118,054,813 169,923,159 11,588 24.283 +4.13% 10 12 37,607,912,018 1,416,705,193 38,263 26.590 +3.77% 10 13 346,065,536,839 11,992,858,452 108,971 28.896 +3.47% 10 14 3,204,941,750,802 102,838,308,636 314,890 31.202 +3.21% 10 15 29,844,570,422,669 891,604,962,452 1,052,619 33.507 +2.99% 10 16 279,238,341,033,925 7,804,289,844,393 3,214,632 35.812 +2.79% 10 17 2,623,557,157,654,233 68,883,734,693,928 7,956,589 38.116 +2.63% 10 18 24,739,954,287,740,860 612,483,070,893,536 21,949,555 40.420 +2.48% 10 19 234,057,667,276,344,607 5,481,624,169,369,961 99,877,775 42.725 +2.34% 10 20 2,220,819,602,560,918,840 49,347,193,044,659,702 222,744,644 45.028 +2.22% 10 21 21,127,269,486,018,731,928 446,579,871,578,168,707 597,394,254 47.332 +2.11% 10 22 201,467,286,689,315,906,290 4,060,704,006,019,620,994 1,932,355,208 49.636 +2.02% 10 23 1,925,320,391,606,803,968,923 37,083,513,766,578,631,309 7,250,186,216 51.939 +1.93% 10 24 18,435,599,767,349,200,867,866 339,996,354,713,708,049,069 17,146,907,278 54.243 +1.84% 10 25 176,846,309,399,143,769,411,680 3,128,516,637,843,038,351,228 55,160,980,939 56.546 +1.77% 10 26 1,699,246,750,872,437,141,327,603 28,883,358,936,853,188,823,261 155,891,678,121 58.850 +1.70% 10 27 16,352,460,426,841,680,446,427,399 267,479,615,610,131,274,163,365 508,666,658,006 61.153 +1.64% 10 28 157,589,269,275,973,410,412,739,598 2,484,097,167,669,186,251,622,127 1,427,745,660,374 63.456 +1.58% 10 29 1,520,698,109,714,272,166,094,258,063 23,130,930,737,541,725,917,951,446 4,551,193,622,464 65.759 +1.52% Graph showing ratio of the prime-counting function π ( x ) to two of its approximations, ⁠ x / log x ⁠ and Li( x ) . As x increases (note x -axis is logarithmic), both ratios tend towards 1. The ratio for ⁠ x / log x ⁠ converges from above very slowly, while the ratio for Li( x ) converges more quickly from below.

In the On-Line Encyclopedia of Integer Sequences , the π ( x ) column is sequence OEIS : A006880 , π ( x ) − ⁠ x / log x ⁠ is sequence OEIS : A057835 , and li( x ) − π ( x ) is sequence OEIS : A057752 .

The value for π (10 24 ) was originally computed by J. Buethe, J. Franke , A. Jost, and T. Kleinjung assuming the Riemann hypothesis .

[ 13 ] It was later verified unconditionally in a computation by D. J. Platt.

[ 14 ] The value for π (10 25 ) is by the same four authors.

[ 15 ] The value for π (10 26 ) was computed by D. B. Staple.

[ 16 ] All other prior entries in this table were also verified as part of that work.

The values for 10 27 , 10 28 , and 10 29 were announced by David Baugh and Kim Walisch in 2015, [ 17 ] 2020, [ 18 ] and 2022, [ 19 ] respectively.

Algorithms for evaluating π ( x ) [ edit ] A simple way to find π ( x ) , if x is not too large, is to use the sieve of Eratosthenes to produce the primes less than or equal to x and then to count them.

A more elaborate way of finding π ( x ) is due to Legendre (using the inclusion–exclusion principle ): given x , if p 1 , p 2 ,…, p n are distinct prime numbers, then the number of integers less than or equal to x which are divisible by no p i is ⌊ ⌊ x ⌋ ⌋ − − ∑ ∑ i ⌊ x p i ⌋ + ∑ ∑ i < j ⌊ x p i p j ⌋ − − ∑ ∑ i < j < k ⌊ x p i p j p k ⌋ + ⋯ ⋯ {\displaystyle \lfloor x\rfloor -\sum _{i}\left\lfloor {\frac {x}{p_{i}}}\right\rfloor +\sum _{i<j}\left\lfloor {\frac {x}{p_{i}p_{j}}}\right\rfloor -\sum _{i<j<k}\left\lfloor {\frac {x}{p_{i}p_{j}p_{k}}}\right\rfloor +\cdots } (where ⌊ x ⌋ denotes the floor function ). This number is therefore equal to π π ( x ) − − π π ( x ) + 1 {\displaystyle \pi (x)-\pi \left({\sqrt {x}}\right)+1} when the numbers p 1 , p 2 ,…, p n are the prime numbers less than or equal to the square root of x .

The Meissel–Lehmer algorithm [ edit ] Main article: Meissel–Lehmer algorithm In a series of articles published between 1870 and 1885, Ernst Meissel described (and used) a practical combinatorial way of evaluating π ( x ) : Let p 1 , p 2 ,…, p n be the first n primes and denote by Φ( m , n ) the number of natural numbers not greater than m which are divisible by none of the p i for any i ≤ n . Then Φ Φ ( m , n ) = Φ Φ ( m , n − − 1 ) − − Φ Φ ( m p n , n − − 1 ) .

{\displaystyle \Phi (m,n)=\Phi (m,n-1)-\Phi \left({\frac {m}{p_{n}}},n-1\right).} Given a natural number m , if n = π ( 3 √ m ) and if μ = π ( √ m ) − n , then π π ( m ) = Φ Φ ( m , n ) + n ( μ μ + 1 ) + μ μ 2 − − μ μ 2 − − 1 − − ∑ ∑ k = 1 μ μ π π ( m p n + k ) .

{\displaystyle \pi (m)=\Phi (m,n)+n(\mu +1)+{\frac {\mu ^{2}-\mu }{2}}-1-\sum _{k=1}^{\mu }\pi \left({\frac {m}{p_{n+k}}}\right).} Using this approach, Meissel computed π ( x ) , for x equal to 5 × 10 5 , 10 6 , 10 7 , and 10 8 .

In 1959, Derrick Henry Lehmer extended and simplified Meissel's method. Define, for real m and for natural numbers n and k , P k ( m , n ) as the number of numbers not greater than m with exactly k prime factors, all greater than p n . Furthermore, set P 0 ( m , n ) = 1 . Then Φ Φ ( m , n ) = ∑ ∑ k = 0 + ∞ ∞ P k ( m , n ) {\displaystyle \Phi (m,n)=\sum _{k=0}^{+\infty }P_{k}(m,n)} where the sum actually has only finitely many nonzero terms. Let y denote an integer such that 3 √ m ≤ y ≤ √ m , and set n = π ( y ) . Then P 1 ( m , n ) = π ( m ) − n and P k ( m , n ) = 0 when k ≥ 3 . Therefore, π π ( m ) = Φ Φ ( m , n ) + n − − 1 − − P 2 ( m , n ) {\displaystyle \pi (m)=\Phi (m,n)+n-1-P_{2}(m,n)} The computation of P 2 ( m , n ) can be obtained this way: P 2 ( m , n ) = ∑ ∑ y < p ≤ ≤ m ( π π ( m p ) − − π π ( p ) + 1 ) {\displaystyle P_{2}(m,n)=\sum _{y<p\leq {\sqrt {m}}}\left(\pi \left({\frac {m}{p}}\right)-\pi (p)+1\right)} where the sum is over prime numbers.

On the other hand, the computation of Φ( m , n ) can be done using the following rules: Φ Φ ( m , 0 ) = ⌊ ⌊ m ⌋ ⌋ {\displaystyle \Phi (m,0)=\lfloor m\rfloor } Φ Φ ( m , b ) = Φ Φ ( m , b − − 1 ) − − Φ Φ ( m p b , b − − 1 ) {\displaystyle \Phi (m,b)=\Phi (m,b-1)-\Phi \left({\frac {m}{p_{b}}},b-1\right)} Using his method and an IBM 701 , Lehmer was able to compute the correct value of π (10 9 ) and missed the correct value of π (10 10 ) by 1.

[ 20 ] Further improvements to this method were made by Lagarias, Miller, Odlyzko, Deléglise, and Rivat.

[ 21 ] Other prime-counting functions [ edit ] Other prime-counting functions are also used because they are more convenient to work with.

Riemann's prime-power counting function [ edit ] Riemann's prime-power counting function is usually denoted as Π 0 ( x ) or J 0 ( x ) . It has jumps of ⁠ 1 / n ⁠ at prime powers p n and it takes a value halfway between the two sides at the discontinuities of π ( x ) . That added detail is used because the function may then be defined by an inverse Mellin transform .

Formally, we may define Π 0 ( x ) by Π Π 0 ( x ) = 1 2 ( ∑ ∑ p n < x 1 n + ∑ ∑ p n ≤ ≤ x 1 n ) {\displaystyle \Pi _{0}(x)={\frac {1}{2}}\left(\sum _{p^{n}<x}{\frac {1}{n}}+\sum _{p^{n}\leq x}{\frac {1}{n}}\right)\ } where the variable p in each sum ranges over all primes within the specified limits.

We may also write Π Π 0 ( x ) = ∑ ∑ n = 2 x Λ Λ ( n ) log ⁡ ⁡ n − − Λ Λ ( x ) 2 log ⁡ ⁡ x = ∑ ∑ n = 1 ∞ ∞ 1 n π π 0 ( x 1 / n ) {\displaystyle \ \Pi _{0}(x)=\sum _{n=2}^{x}{\frac {\Lambda (n)}{\log n}}-{\frac {\Lambda (x)}{2\log x}}=\sum _{n=1}^{\infty }{\frac {1}{n}}\pi _{0}\left(x^{1/n}\right)} where Λ is the von Mangoldt function and π π 0 ( x ) = lim ε ε → → 0 π π ( x − − ε ε ) + π π ( x + ε ε ) 2 .

{\displaystyle \pi _{0}(x)=\lim _{\varepsilon \to 0}{\frac {\pi (x-\varepsilon )+\pi (x+\varepsilon )}{2}}.} The Möbius inversion formula then gives π π 0 ( x ) = ∑ ∑ n = 1 ∞ ∞ μ μ ( n ) n Π Π 0 ( x 1 / n ) , {\displaystyle \pi _{0}(x)=\sum _{n=1}^{\infty }{\frac {\mu (n)}{n}}\ \Pi _{0}\left(x^{1/n}\right),} where μ ( n ) is the Möbius function .

Knowing the relationship between the logarithm of the Riemann zeta function and the von Mangoldt function Λ , and using the Perron formula we have log ⁡ ⁡ ζ ζ ( s ) = s ∫ ∫ 0 ∞ ∞ Π Π 0 ( x ) x − − s − − 1 d x {\displaystyle \log \zeta (s)=s\int _{0}^{\infty }\Pi _{0}(x)x^{-s-1}\,\mathrm {d} x} Chebyshev's function [ edit ] The Chebyshev function weights primes or prime powers p n by log p : ϑ ϑ ( x ) = ∑ ∑ p ≤ ≤ x log ⁡ ⁡ p ψ ψ ( x ) = ∑ ∑ p n ≤ ≤ x log ⁡ ⁡ p = ∑ ∑ n = 1 ∞ ∞ ϑ ϑ ( x 1 / n ) = ∑ ∑ n ≤ ≤ x Λ Λ ( n ) .

{\displaystyle {\begin{aligned}\vartheta (x)&=\sum _{p\leq x}\log p\\\psi (x)&=\sum _{p^{n}\leq x}\log p=\sum _{n=1}^{\infty }\vartheta \left(x^{1/n}\right)=\sum _{n\leq x}\Lambda (n).\end{aligned}}} For x ≥ 2 , [ 22 ] ϑ ϑ ( x ) = π π ( x ) log ⁡ ⁡ x − − ∫ ∫ 2 x π π ( t ) t d t {\displaystyle \vartheta (x)=\pi (x)\log x-\int _{2}^{x}{\frac {\pi (t)}{t}}\,\mathrm {d} t} and π π ( x ) = ϑ ϑ ( x ) log ⁡ ⁡ x + ∫ ∫ 2 x ϑ ϑ ( t ) t log 2 ⁡ ⁡ ( t ) d t .

{\displaystyle \pi (x)={\frac {\vartheta (x)}{\log x}}+\int _{2}^{x}{\frac {\vartheta (t)}{t\log ^{2}(t)}}\mathrm {d} t.} Formulas for prime-counting functions [ edit ] Formulas for prime-counting functions come in two kinds: arithmetic formulas and analytic formulas. Analytic formulas for prime-counting were the first used to prove the prime number theorem . They stem from the work of Riemann and von Mangoldt , and are generally known as explicit formulae .

[ 23 ] We have the following expression for the second Chebyshev function ψ : ψ ψ 0 ( x ) = x − − ∑ ∑ ρ ρ x ρ ρ ρ ρ − − log ⁡ ⁡ 2 π π − − 1 2 log ⁡ ⁡ ( 1 − − x − − 2 ) , {\displaystyle \psi _{0}(x)=x-\sum _{\rho }{\frac {x^{\rho }}{\rho }}-\log 2\pi -{\frac {1}{2}}\log \left(1-x^{-2}\right),} where ψ ψ 0 ( x ) = lim ε ε → → 0 ψ ψ ( x − − ε ε ) + ψ ψ ( x + ε ε ) 2 .

{\displaystyle \psi _{0}(x)=\lim _{\varepsilon \to 0}{\frac {\psi (x-\varepsilon )+\psi (x+\varepsilon )}{2}}.} Here ρ are the zeros of the Riemann zeta function in the critical strip, where the real part of ρ is between zero and one. The formula is valid for values of x greater than one, which is the region of interest. The sum over the roots is conditionally convergent, and should be taken in order of increasing absolute value of the imaginary part. Note that the same sum over the trivial roots gives the last subtrahend in the formula.

For Π 0 ( x ) we have a more complicated formula Π Π 0 ( x ) = li ⁡ ⁡ ( x ) − − ∑ ∑ ρ ρ li ⁡ ⁡ ( x ρ ρ ) − − log ⁡ ⁡ 2 + ∫ ∫ x ∞ ∞ d t t ( t 2 − − 1 ) log ⁡ ⁡ t .

{\displaystyle \Pi _{0}(x)=\operatorname {li} (x)-\sum _{\rho }\operatorname {li} \left(x^{\rho }\right)-\log 2+\int _{x}^{\infty }{\frac {\mathrm {d} t}{t\left(t^{2}-1\right)\log t}}.} Again, the formula is valid for x > 1 , while ρ are the nontrivial zeros of the zeta function ordered according to their absolute value.  The first term li( x ) is the usual logarithmic integral function ; the expression li( x ρ ) in the second term should be considered as Ei( ρ log x ) , where Ei is the analytic continuation of the exponential integral function from negative reals to the complex plane with branch cut along the positive reals. The final integral is equal to the series over the trivial zeros: ∫ ∫ x ∞ ∞ d t t ( t 2 − − 1 ) log ⁡ ⁡ t = ∫ ∫ x ∞ ∞ 1 t log ⁡ ⁡ t ( ∑ ∑ m t − − 2 m ) d t = ∑ ∑ m ∫ ∫ x ∞ ∞ t − − 2 m t log ⁡ ⁡ t d t = ( u = t − − 2 m ) − − ∑ ∑ m li ⁡ ⁡ ( x − − 2 m ) {\displaystyle \int _{x}^{\infty }{\frac {\mathrm {d} t}{t\left(t^{2}-1\right)\log t}}=\int _{x}^{\infty }{\frac {1}{t\log t}}\left(\sum _{m}t^{-2m}\right)\,\mathrm {d} t=\sum _{m}\int _{x}^{\infty }{\frac {t^{-2m}}{t\log t}}\,\mathrm {d} t\,\,{\overset {\left(u=t^{-2m}\right)}{=}}-\sum _{m}\operatorname {li} \left(x^{-2m}\right)} Thus, Möbius inversion formula gives us [ 10 ] π π 0 ( x ) = R ⁡ ⁡ ( x ) − − ∑ ∑ ρ ρ R ⁡ ⁡ ( x ρ ρ ) − − ∑ ∑ m R ⁡ ⁡ ( x − − 2 m ) {\displaystyle \pi _{0}(x)=\operatorname {R} (x)-\sum _{\rho }\operatorname {R} \left(x^{\rho }\right)-\sum _{m}\operatorname {R} \left(x^{-2m}\right)} valid for x > 1 , where R ⁡ ⁡ ( x ) = ∑ ∑ n = 1 ∞ ∞ μ μ ( n ) n li ⁡ ⁡ ( x 1 / n ) = 1 + ∑ ∑ k = 1 ∞ ∞ ( log ⁡ ⁡ x ) k k !

k ζ ζ ( k + 1 ) {\displaystyle \operatorname {R} (x)=\sum _{n=1}^{\infty }{\frac {\mu (n)}{n}}\operatorname {li} \left(x^{1/n}\right)=1+\sum _{k=1}^{\infty }{\frac {\left(\log x\right)^{k}}{k!k\zeta (k+1)}}} is Riemann's R-function [ 24 ] and μ ( n ) is the Möbius function . The latter series for it is known as Gram series.

[ 25 ] [ 26 ] Because log x < x for all x > 0 , this series converges for all positive x by comparison with the series for e x . The logarithm in the Gram series of the sum over the non-trivial zero contribution should be evaluated as ρ log x and not log x ρ .

Folkmar Bornemann proved, [ 27 ] when assuming the conjecture that all zeros of the Riemann zeta function are simple, [ note 1 ] that R ⁡ ⁡ ( e − − 2 π π t ) = 1 π π ∑ ∑ k = 1 ∞ ∞ ( − − 1 ) k − − 1 t − − 2 k − − 1 ( 2 k + 1 ) ζ ζ ( 2 k + 1 ) + 1 2 ∑ ∑ ρ ρ t − − ρ ρ ρ ρ cos ⁡ ⁡ π π ρ ρ 2 ζ ζ ′ ( ρ ρ ) {\displaystyle \operatorname {R} \left(e^{-2\pi t}\right)={\frac {1}{\pi }}\sum _{k=1}^{\infty }{\frac {(-1)^{k-1}t^{-2k-1}}{(2k+1)\zeta (2k+1)}}+{\frac {1}{2}}\sum _{\rho }{\frac {t^{-\rho }}{\rho \cos {\frac {\pi \rho }{2}}\zeta '(\rho )}}} where ρ runs over the non-trivial zeros of the Riemann zeta function and t > 0 .

The sum over non-trivial zeta zeros in the formula for π 0 ( x ) describes the fluctuations of π 0 ( x ) while the remaining terms give the "smooth" part of prime-counting function, [ 28 ] so one can use R ⁡ ⁡ ( x ) − − ∑ ∑ m = 1 ∞ ∞ R ⁡ ⁡ ( x − − 2 m ) {\displaystyle \operatorname {R} (x)-\sum _{m=1}^{\infty }\operatorname {R} \left(x^{-2m}\right)} as a good estimator of π ( x ) for x > 1 . In fact, since the second term approaches 0 as x → ∞ , while the amplitude of the "noisy" part is heuristically about ⁠ √ x / log x ⁠ , estimating π ( x ) by R( x ) alone is just as good, and fluctuations of the distribution of primes may be clearly represented with the function ( π π 0 ( x ) − − R ⁡ ⁡ ( x ) ) log ⁡ ⁡ x x .

{\displaystyle {\bigl (}\pi _{0}(x)-\operatorname {R} (x){\bigr )}{\frac {\log x}{\sqrt {x}}}.} Inequalities [ edit ] Ramanujan [ 29 ] proved that the inequality π π ( x ) 2 < e x log ⁡ ⁡ x π π ( x e ) {\displaystyle \pi (x)^{2}<{\frac {ex}{\log x}}\pi \left({\frac {x}{e}}\right)} holds for all sufficiently large values of x .

Here are some useful inequalities for π ( x ) .

x log ⁡ ⁡ x < π π ( x ) < 1.25506 x log ⁡ ⁡ x for x ≥ ≥ 17.

{\displaystyle {\frac {x}{\log x}}<\pi (x)<1.25506{\frac {x}{\log x}}\quad {\text{for }}x\geq 17.} The left inequality holds for x ≥ 17 and the right inequality holds for x > 1 . The constant 1.25506 is 30 ⁠ log 113 / 113 ⁠ to 5 decimal places, as π ( x ) ⁠ log x / x ⁠ has its maximum value at x = p 30 = 113 .

[ 30 ] Pierre Dusart proved in 2010: [ 31 ] x log ⁡ ⁡ x − − 1 < π π ( x ) < x log ⁡ ⁡ x − − 1.1 for x ≥ ≥ 5393 and x ≥ ≥ 60184 , respectively.

{\displaystyle {\frac {x}{\log x-1}}<\pi (x)<{\frac {x}{\log x-1.1}}\quad {\text{for }}x\geq 5393{\text{ and }}x\geq 60184,{\text{ respectively.}}} More recently, Dusart has proved [ 32 ] (Theorem 5.1) that x log ⁡ ⁡ x ( 1 + 1 log ⁡ ⁡ x + 2 log 2 ⁡ ⁡ x ) ≤ ≤ π π ( x ) ≤ ≤ x log ⁡ ⁡ x ( 1 + 1 log ⁡ ⁡ x + 2 log 2 ⁡ ⁡ x + 7.59 log 3 ⁡ ⁡ x ) , {\displaystyle {\frac {x}{\log x}}\left(1+{\frac {1}{\log x}}+{\frac {2}{\log ^{2}x}}\right)\leq \pi (x)\leq {\frac {x}{\log x}}\left(1+{\frac {1}{\log x}}+{\frac {2}{\log ^{2}x}}+{\frac {7.59}{\log ^{3}x}}\right),} for x ≥ 88789 and x > 1 , respectively.

Going in the other direction, an approximation for the n th  prime, p n , is p n = n ( log ⁡ ⁡ n + log ⁡ ⁡ log ⁡ ⁡ n − − 1 + log ⁡ ⁡ log ⁡ ⁡ n − − 2 log ⁡ ⁡ n + O ( ( log ⁡ ⁡ log ⁡ ⁡ n ) 2 ( log ⁡ ⁡ n ) 2 ) ) .

{\displaystyle p_{n}=n\left(\log n+\log \log n-1+{\frac {\log \log n-2}{\log n}}+O\left({\frac {(\log \log n)^{2}}{(\log n)^{2}}}\right)\right).} Here are some inequalities for the n th prime. The lower bound is due to Dusart (1999) [ 33 ] and the upper bound to Rosser (1941).

[ 34 ] n ( log ⁡ ⁡ n + log ⁡ ⁡ log ⁡ ⁡ n − − 1 ) < p n < n ( log ⁡ ⁡ n + log ⁡ ⁡ log ⁡ ⁡ n ) for n ≥ ≥ 6.

{\displaystyle n(\log n+\log \log n-1)<p_{n}<n(\log n+\log \log n)\quad {\text{for }}n\geq 6.} The left inequality holds for n ≥ 2 and the right inequality holds for n ≥ 6 .  A variant form sometimes seen substitutes log ⁡ ⁡ n + log ⁡ ⁡ log ⁡ ⁡ n = log ⁡ ⁡ ( n log ⁡ ⁡ n ) .

{\displaystyle \log n+\log \log n=\log(n\log n).} An even simpler lower bound is [ 35 ] n log ⁡ ⁡ n < p n , {\displaystyle n\log n<p_{n},} which holds for all n ≥ 1 , but the lower bound above is tighter for n > e e ≈15.154 .

In 2010 Dusart proved [ 31 ] (Propositions 6.7 and 6.6) that n ( log ⁡ ⁡ n + log ⁡ ⁡ log ⁡ ⁡ n − − 1 + log ⁡ ⁡ log ⁡ ⁡ n − − 2.1 log ⁡ ⁡ n ) ≤ ≤ p n ≤ ≤ n ( log ⁡ ⁡ n + log ⁡ ⁡ log ⁡ ⁡ n − − 1 + log ⁡ ⁡ log ⁡ ⁡ n − − 2 log ⁡ ⁡ n ) , {\displaystyle n\left(\log n+\log \log n-1+{\frac {\log \log n-2.1}{\log n}}\right)\leq p_{n}\leq n\left(\log n+\log \log n-1+{\frac {\log \log n-2}{\log n}}\right),} for n ≥ 3 and n ≥ 688383 , respectively.

In 2024, Axler [ 36 ] further tightened this (equations 1.12 and 1.13) using bounds of the form f ( n , g ( w ) ) = n ( log ⁡ ⁡ n + log ⁡ ⁡ log ⁡ ⁡ n − − 1 + log ⁡ ⁡ log ⁡ ⁡ n − − 2 log ⁡ ⁡ n − − g ( log ⁡ ⁡ log ⁡ ⁡ n ) 2 log 2 ⁡ ⁡ n ) {\displaystyle f(n,g(w))=n\left(\log n+\log \log n-1+{\frac {\log \log n-2}{\log n}}-{\frac {g(\log \log n)}{2\log ^{2}n}}\right)} proving that f ( n , w 2 − − 6 w + 11.321 ) ≤ ≤ p n ≤ ≤ f ( n , w 2 − − 6 w ) {\displaystyle f(n,w^{2}-6w+11.321)\leq p_{n}\leq f(n,w^{2}-6w)} for n ≥ 2 and n ≥ 3468 , respectively.
The lower bound may also be simplified to f ( n , w 2 ) without altering its validity.  The upper bound may be tightened to f ( n , w 2 − 6 w + 10.667) if n ≥ 46254381 .

There are additional bounds of varying complexity.

[ 37 ] [ 38 ] [ 39 ] The Riemann hypothesis [ edit ] The Riemann hypothesis implies a much tighter bound on the error in the estimate for π ( x ) , and hence to a more regular distribution of prime numbers, π π ( x ) = li ⁡ ⁡ ( x ) + O ( x log ⁡ ⁡ x ) .

{\displaystyle \pi (x)=\operatorname {li} (x)+O({\sqrt {x}}\log {x}).} Specifically, [ 40 ] | π π ( x ) − − li ⁡ ⁡ ( x ) | < x 8 π π log ⁡ ⁡ x , for all x ≥ ≥ 2657.

{\displaystyle |\pi (x)-\operatorname {li} (x)|<{\frac {\sqrt {x}}{8\pi }}\,\log {x},\quad {\text{for all }}x\geq 2657.} Dudek (2015) proved that the Riemann hypothesis implies that for all x ≥ 2 there is a prime p satisfying x − − 4 π π x log ⁡ ⁡ x < p ≤ ≤ x .

{\displaystyle x-{\frac {4}{\pi }}{\sqrt {x}}\log x<p\leq x.} See also [ edit ] Bertrand's postulate Oppermann's conjecture Ramanujan prime References [ edit ] ^ Bach, Eric; Shallit, Jeffrey (1996).

Algorithmic Number Theory . MIT Press. volume 1 page 234 section 8.8.

ISBN 0-262-02405-5 .

^ Weisstein, Eric W.

"Prime Counting Function" .

MathWorld .

^ a b "How many primes are there?" . Chris K. Caldwell. Archived from the original on 2012-10-15 . Retrieved 2008-12-02 .

^ Dickson, Leonard Eugene (2005).

History of the Theory of Numbers, Vol. I: Divisibility and Primality . Dover Publications.

ISBN 0-486-44232-2 .

^ Ireland, Kenneth; Rosen, Michael (1998).

A Classical Introduction to Modern Number Theory (Second ed.). Springer.

ISBN 0-387-97329-X .

^ See also Theorem 23 of A. E. Ingham (2000).

The Distribution of Prime Numbers . Cambridge University Press.

ISBN 0-521-39789-8 .

^ Kevin Ford (November 2002).

"Vinogradov's Integral and Bounds for the Riemann Zeta Function" (PDF) .

Proc. London Math. Soc .

85 (3): 565– 633.

arXiv : 1910.08209 .

doi : 10.1112/S0024611502013655 .

S2CID 121144007 .

^ Mossinghoff, Michael J.; Trudgian, Timothy S.

(2015). "Nonnegative trigonometric polynomials and a zero-free region for the Riemann zeta-function".

J. Number Theory .

157 : 329– 349.

arXiv : 1410.3926 .

doi : 10.1016/J.JNT.2015.05.010 .

S2CID 117968965 .

^ Hutama, Daniel (2017).

"Implementation of Riemann's Explicit Formula for Rational and Gaussian Primes in Sage" (PDF) .

Institut des sciences mathématiques .

^ a b Riesel, Hans ; Göhl, Gunnar (1970).

"Some calculations related to Riemann's prime number formula" (PDF) .

Mathematics of Computation .

24 (112). American Mathematical Society: 969– 983.

doi : 10.2307/2004630 .

ISSN 0025-5718 .

JSTOR 2004630 .

MR 0277489 .

^ "Tables of values of π ( x ) and of π 2 ( x ) " . Tomás Oliveira e Silva . Retrieved 2024-03-31 .

^ "A table of values of π ( x ) " . Xavier Gourdon, Pascal Sebah, Patrick Demichel . Retrieved 2008-09-14 .

^ Franke, Jens (2010-07-29).

"Conditional Calculation of π(10 24 )" . Chris K. Caldwell . Retrieved 2024-03-30 .

^ Platt, David J. (May 2015) [March 2012].

"Computing π ( x ) Analytically" .

Mathematics of Computation .

84 (293): 1521– 1535.

arXiv : 1203.5712 .

doi : 10.1090/S0025-5718-2014-02884-6 .

^ "Analytic Computation of the prime-counting Function" . J. Buethe. 27 May 2014 . Retrieved 2015-09-01 .

Includes 600,000 value of π ( x ) for 10 14 ≤ x ≤ 1.6×10 18 ^ Staple, Douglas (19 August 2015).

The combinatorial algorithm for computing π(x) (Thesis). Dalhousie University . Retrieved 2015-09-01 .

^ Walisch, Kim (September 6, 2015).

"New confirmed π(10 27 ) prime counting function record" .

Mersenne Forum .

^ Baugh, David (August 30, 2020).

"New prime counting function record, pi(10^28)" .

Mersenne Forum .

^ Walisch, Kim (March 4, 2022).

"New prime counting function record: PrimePi(10^29)" .

Mersenne Forum .

^ Lehmer, Derrick Henry (1 April 1958).

"On the exact number of primes less than a given limit" .

Illinois J. Math .

3 (3): 381– 388 . Retrieved 1 February 2017 .

^ Deléglise, Marc; Rivat, Joel (January 1996).

"Computing π ( x ) : The Meissel, Lehmer, Lagarias, Miller, Odlyzko method" (PDF) .

Mathematics of Computation .

65 (213): 235– 245.

doi : 10.1090/S0025-5718-96-00674-6 .

^ Apostol, Tom M.

(2010).

Introduction to Analytic Number Theory . Springer.

ISBN 978-1441928054 .

^ Titchmarsh, E.C. (1960).

The Theory of Functions, 2nd ed . Oxford University Press.

^ Weisstein, Eric W.

"Riemann Prime Counting Function" .

MathWorld .

^ Riesel, Hans (1994).

Prime Numbers and Computer Methods for Factorization . Progress in Mathematics. Vol. 126 (2nd ed.). Birkhäuser. pp.

50– 51.

ISBN 0-8176-3743-5 .

^ Weisstein, Eric W.

"Gram Series" .

MathWorld .

^ Bornemann, Folkmar.

"Solution of a Problem Posed by Jörg Waldvogel" (PDF) .

^ "The encoding of the prime distribution by the zeta zeros" . Matthew Watkins . Retrieved 2008-09-14 .

^ Berndt, Bruce C. (2012-12-06).

Ramanujan's Notebooks, Part IV . Springer Science & Business Media. pp.

112– 113.

ISBN 9781461269328 .

^ Rosser, J. Barkley ; Schoenfeld, Lowell (1962).

"Approximate formulas for some functions of prime numbers" .

Illinois J. Math.

6 : 64– 94.

doi : 10.1215/ijm/1255631807 .

ISSN 0019-2082 .

Zbl 0122.05001 .

^ a b Dusart, Pierre (2 Feb 2010). "Estimates of Some Functions Over Primes without R.H.".

arXiv : 1002.0442v1 [ math.NT ].

^ Dusart, Pierre (January 2018). "Explicit estimates of some functions over primes".

Ramanujan Journal .

45 (1): 225– 234.

doi : 10.1007/s11139-016-9839-4 .

S2CID 125120533 .

^ Dusart, Pierre (January 1999).

"The k th prime is greater than k (ln k + ln ln k − 1) for k ≥ 2" (PDF) .

Mathematics of Computation .

68 (225): 411– 415.

Bibcode : 1999MaCom..68..411D .

doi : 10.1090/S0025-5718-99-01037-6 .

^ Rosser, Barkley (January 1941). "Explicit bounds for some functions of prime numbers".

American Journal of Mathematics .

63 (1): 211– 232.

doi : 10.2307/2371291 .

JSTOR 2371291 .

^ Rosser, J. Barkley ; Schoenfeld, Lowell (March 1962). "Approximate formulas for some functions of prime numbers".

Illinois Journal of Mathematics .

6 (1): 64– 94.

doi : 10.1215/ijm/1255631807 .

^ Axler, Christian (2019) [23 Mar 2017].

"New estimates for the n th prime number" .

Journal of Integer Sequences .

19 (4) 2.

arXiv : 1706.03651 .

^ "Bounds for n -th prime" .

Mathematics StackExchange . 31 December 2015.

^ Axler, Christian (2018) [23 Mar 2017].

"New Estimates for Some Functions Defined Over Primes" (PDF) .

Integers .

18 A52.

arXiv : 1703.08032 .

doi : 10.5281/zenodo.10677755 .

^ Axler, Christian (2024) [11 Mar 2022].

"Effective Estimates for Some Functions Defined over Primes" (PDF) .

Integers .

24 A34.

arXiv : 2203.05917 .

doi : 10.5281/zenodo.10677755 .

^ Schoenfeld, Lowell (1976). "Sharper bounds for the Chebyshev functions θ ( x ) and ψ ( x ). II".

Mathematics of Computation .

30 (134). American Mathematical Society: 337– 360.

doi : 10.2307/2005976 .

ISSN 0025-5718 .

JSTOR 2005976 .

MR 0457374 .

Notes [ edit ] ^ Montgomery showed that (assuming the Riemann hypothesis) at least two thirds of all zeros are simple.

External links [ edit ] Chris Caldwell, The Nth Prime Page at The Prime Pages .

Tomás Oliveira e Silva, Tables of prime-counting functions .

Dudek, Adrian W. (2015), "On the Riemann hypothesis and the difference between primes", International Journal of Number Theory , 11 (3): 771– 778, arXiv : 1402.6417 , Bibcode : 2014arXiv1402.6417D , doi : 10.1142/S1793042115500426 , ISSN 1793-0421 , S2CID 119321107 NewPP limit report
Parsed by mw‐web.codfw.main‐6cc77c66b8‐ckb9x
Cached time: 20250812015030
Cache expiry: 2592000
Reduced expiry: false
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.791 seconds
Real time usage: 0.976 seconds
Preprocessor visited node count: 9841/1000000
Revision size: 36397/2097152 bytes
Post‐expand include size: 124135/2097152 bytes
Template argument size: 16453/2097152 bytes
Highest expansion depth: 12/100
Expensive parser function count: 5/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 163518/5000000 bytes
Lua time usage: 0.444/10.000 seconds
Lua memory usage: 10564477/52428800 bytes
Number of Wikibase entities loaded: 0/500 Transclusion expansion time report (%,ms,calls,template)
100.00%  764.913      1 -total
 46.94%  359.073      2 Template:Reflist
 19.31%  147.713    133 Template:Math
 14.49%  110.841      8 Template:Cite_book
 13.18%  100.840     15 Template:Cite_journal
  9.72%   74.327      1 Template:Short_description
  8.63%   65.975     12 Template:Cite_web
  6.59%   50.396      2 Template:Pagetype
  5.33%   40.737      1 Template:Duplication
  4.77%   36.495      1 Template:Harvtxt Saved in parser cache with key enwiki:pcache:331826:|#|:idhash:canonical and timestamp 20250812015030 and revision id 1303866339. Rendering was triggered because: page-view Retrieved from " https://en.wikipedia.org/w/index.php?title=Prime-counting_function&oldid=1303866339 " Categories : Analytic number theory Prime numbers Arithmetic functions Hidden categories: Articles with short description Short description matches Wikidata Duplicate articles This page was last edited on 2 August 2025, at 14:18 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Prime-counting function 34 languages Add topic

