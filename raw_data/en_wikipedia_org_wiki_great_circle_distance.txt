Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Formulae 2 Relation between central angle and chord length Toggle Relation between central angle and chord length subsection 2.1 Computational formulae 2.2 Vector version 2.3 From chord length 3 Radius for spherical Earth 4 See also 5 References and notes 6 External links Toggle the table of contents Great-circle distance 22 languages العربية Български Català Čeština Deutsch Eesti Ελληνικά Español Euskara Français Íslenska Italiano עברית Magyar 日本語 Polski Português Русский Slovenčina Slovenščina Українська 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikimedia Commons Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Shortest distance between two points on the surface of a sphere This article is about shortest-distance on a sphere. For the shortest distance on an ellipsoid, see geodesics on an ellipsoid .

A diagram illustrating great-circle distance (drawn in red) between two points on a sphere, P and Q. Two antipodal points , u and v are also shown.

The great-circle distance , orthodromic distance , or spherical distance is the distance between two points on a sphere , measured along the great-circle arc between them. This arc is the shortest path between the two points on the surface of the sphere. (By comparison, the shortest path passing through the sphere's interior is the chord between the points.) On a curved surface , the concept of straight lines is replaced by a more general concept of geodesics , curves which are locally straight with respect to the surface. Geodesics on the sphere are great circles, circles whose center coincides with the center of the sphere.

Any two distinct points on a sphere that are not antipodal (diametrically opposite) both lie on a unique great circle, which the points separate into two arcs; the length of the shorter arc is the great-circle distance between the points. This arc length is proportional to the central angle between the points, which if measured in radians can be scaled up by the sphere's radius to obtain the arc length. Two antipodal points both lie on infinitely many great circles, each of which they divide into two arcs of length π times the radius.

The determination of the great-circle distance is part of the more general problem of great-circle navigation , which also computes the azimuths at the end points and intermediate way-points. Because the Earth is nearly spherical , great-circle distance formulas applied to longitude and geodetic latitude of points on Earth are accurate to within about 0.5%.

[ 1 ] Formulae [ edit ] An illustration of the central angle, Δσ, between two points, P and Q. λ and φ are the longitudinal and latitudinal angles of P respectively Let λ λ 1 , ϕ ϕ 1 {\displaystyle \lambda _{1},\phi _{1}} and λ λ 2 , ϕ ϕ 2 {\displaystyle \lambda _{2},\phi _{2}} be the geographical longitude and latitude of two points 1 and 2, and Δ Δ λ λ , Δ Δ ϕ ϕ {\displaystyle \Delta \lambda ,\Delta \phi } be their absolute differences; then Δ Δ σ σ {\displaystyle \Delta \sigma } , the central angle between them, is given by the spherical law of cosines if one of the poles is used as an auxiliary third point on the sphere: [ 2 ] Δ Δ σ σ = arccos ⁡ ⁡ ( sin ⁡ ⁡ ϕ ϕ 1 sin ⁡ ⁡ ϕ ϕ 2 + cos ⁡ ⁡ ϕ ϕ 1 cos ⁡ ⁡ ϕ ϕ 2 cos ⁡ ⁡ Δ Δ λ λ ) .

{\displaystyle \Delta \sigma =\arccos {\bigl (}\sin \phi _{1}\sin \phi _{2}+\cos \phi _{1}\cos \phi _{2}\cos \Delta \lambda {\bigr )}.} The problem is normally expressed in terms of finding the central angle Δ Δ σ σ {\displaystyle \Delta \sigma } . Given this angle in radians, the actual arc length d on a sphere of radius r can be trivially computed as d = r Δ Δ σ σ .

{\displaystyle d=r\,\Delta \sigma .} Relation between central angle and chord length [ edit ] The central angle Δ Δ σ σ {\displaystyle \Delta \sigma } is related with the chord length of unit sphere Δ Δ σ σ c {\displaystyle \Delta \sigma _{\text{c}}\,\!} : Δ Δ σ σ = 2 arcsin ⁡ ⁡ Δ Δ σ σ c 2 , Δ Δ σ σ c = 2 sin ⁡ ⁡ Δ Δ σ σ 2 .

{\displaystyle {\begin{aligned}\Delta \sigma &=2\arcsin {\frac {\Delta \sigma _{\text{c}}}{2}},\\\Delta \sigma _{\text{c}}&=2\sin {\frac {\Delta \sigma }{2}}.\end{aligned}}} For short-distance approximation ( | Δ Δ σ σ c | ≪ ≪ 1 {\displaystyle |\Delta \sigma _{\text{c}}|\ll 1} ), Δ Δ σ σ = Δ Δ σ σ c ( 1 + 1 24 ( Δ Δ σ σ c ) 2 + ⋯ ⋯ ) .

{\displaystyle \Delta \sigma =\Delta \sigma _{\text{c}}\left(1+{\frac {1}{24}}\left(\Delta \sigma _{\text{c}}\right)^{2}+\cdots \right).} Computational formulae [ edit ] On computer systems with low floating point precision, the spherical law of cosines formula can have large rounding errors if the distance is small (if the two points are a kilometer apart on the surface of the Earth, the cosine of the central angle is near 0.99999999). For modern 64-bit floating-point numbers , the spherical law of cosines formula, given above, does not have serious rounding errors for distances larger than a few meters on the surface of the Earth.

[ 3 ] The haversine formula is numerically better-conditioned for small distances by using the chord-length relation: [ 4 ] Δ Δ σ σ = archav ⁡ ⁡ ( hav ⁡ ⁡ ( Δ Δ ϕ ϕ ) + ( 1 − − hav ⁡ ⁡ ( Δ Δ ϕ ϕ ) − − hav ⁡ ⁡ ( ϕ ϕ 1 + ϕ ϕ 2 ) ) hav ⁡ ⁡ ( Δ Δ λ λ ) ) .

{\displaystyle {\begin{aligned}\Delta \sigma &=\operatorname {archav} \left(\operatorname {hav} \left(\Delta \phi \right)+\left(1-\operatorname {hav} (\Delta \phi )-\operatorname {hav} (\phi _{1}+\phi _{2})\right)\operatorname {hav} \left(\Delta \lambda \right)\right).\end{aligned}}} Historically, the use of this formula was simplified by the availability of tables for the haversine function: hav ⁡ ⁡ θ θ = sin 2 ⁡ ⁡ θ θ 2 {\displaystyle \operatorname {hav} \theta =\sin ^{2}{\frac {\theta }{2}}} and archav ⁡ ⁡ x = 2 arcsin ⁡ ⁡ x {\displaystyle \operatorname {archav} x=2\arcsin {\sqrt {x}}} .

The following shows the equivalent formula expressing the chord length explicitly: Δ Δ σ σ c = 2 sin 2 ⁡ ⁡ ( Δ Δ ϕ ϕ 2 ) + cos ⁡ ⁡ ϕ ϕ 1 ⋅ ⋅ cos ⁡ ⁡ ϕ ϕ 2 ⋅ ⋅ sin 2 ⁡ ⁡ ( Δ Δ λ λ 2 ) , = 2 ( sin ⁡ ⁡ Δ Δ λ λ 2 cos ⁡ ⁡ ϕ ϕ m ) 2 + ( cos ⁡ ⁡ Δ Δ λ λ 2 sin ⁡ ⁡ Δ Δ ϕ ϕ 2 ) 2 , {\displaystyle {\begin{aligned}\Delta \sigma _{\text{c}}&=2{\sqrt {\sin ^{2}\left({\frac {\Delta \phi }{2}}\right)+\cos {\phi _{1}}\cdot \cos {\phi _{2}}\cdot \sin ^{2}\left({\frac {\Delta \lambda }{2}}\right)}}\ ,\\&=2{\sqrt {\left(\sin {\frac {\Delta \lambda }{2}}\cos \phi _{\textrm {m}}\right)^{2}+\left(\cos {\frac {\Delta \lambda }{2}}\sin {\frac {\Delta \phi }{2}}\right)^{2}}}\ ,\end{aligned}}} where ϕ ϕ m = 1 2 ( ϕ ϕ 1 + ϕ ϕ 2 ) {\displaystyle \phi _{\text{m}}={\tfrac {1}{2}}(\phi _{1}+\phi _{2})} .

Although this formula is accurate for most distances on a sphere, it too suffers from rounding errors for the special (and somewhat unusual) case of antipodal points. A formula that is accurate for all distances is the following special case of the Vincenty formula for an ellipsoid with equal major and minor axes: [ 5 ] Δ Δ σ σ = atan2 ( ( cos ⁡ ⁡ ϕ ϕ 2 sin ⁡ ⁡ Δ Δ λ λ ) 2 + ( cos ⁡ ⁡ ϕ ϕ 1 sin ⁡ ⁡ ϕ ϕ 2 − − sin ⁡ ⁡ ϕ ϕ 1 cos ⁡ ⁡ ϕ ϕ 2 cos ⁡ ⁡ Δ Δ λ λ ) 2 , sin ⁡ ⁡ ϕ ϕ 1 sin ⁡ ⁡ ϕ ϕ 2 + cos ⁡ ⁡ ϕ ϕ 1 cos ⁡ ⁡ ϕ ϕ 2 cos ⁡ ⁡ Δ Δ λ λ ) , {\displaystyle {\begin{aligned}\Delta \sigma ={\operatorname {atan2} }{\Bigl (}&{\sqrt {\left(\cos \phi _{2}\sin \Delta \lambda \right)^{2}+\left(\cos \phi _{1}\sin \phi _{2}-\sin \phi _{1}\cos \phi _{2}\cos \Delta \lambda \right)^{2}}},\\&\quad {\sin \phi _{1}\sin \phi _{2}+\cos \phi _{1}\cos \phi _{2}\cos \Delta \lambda }{\Bigr )},\end{aligned}}} where ⁠ atan2 ⁡ ⁡ ( y , x ) {\displaystyle \operatorname {atan2} (y,x)} ⁠ is the two-argument arctangent . Using atan2 ensures that the correct quadrant is chosen.

Vector version [ edit ] Another representation of similar formulas, but using normal vectors instead of latitude and longitude to describe the positions, is found by means of 3D vector algebra , using the dot product , cross product , or a combination: [ 6 ] Δ Δ σ σ = arccos ⁡ ⁡ ( n 1 ⋅ ⋅ n 2 ) = arcsin ⁡ ⁡ | n 1 × × n 2 | = arctan ⁡ ⁡ | n 1 × × n 2 | n 1 ⋅ ⋅ n 2 {\displaystyle {\begin{aligned}\Delta \sigma &=\arccos \left(\mathbf {n} _{1}\cdot \mathbf {n} _{2}\right)\\&=\arcsin \left|\mathbf {n} _{1}\times \mathbf {n} _{2}\right|\\&=\arctan {\frac {\left|\mathbf {n} _{1}\times \mathbf {n} _{2}\right|}{\mathbf {n} _{1}\cdot \mathbf {n} _{2}}}\\\end{aligned}}} where n 1 {\displaystyle \mathbf {n} _{1}} and n 2 {\displaystyle \mathbf {n} _{2}} are the normals to the sphere at the two positions 1 and 2. Similarly to the equations above based on latitude and longitude, the expression based on arctan is the only one that is well-conditioned for all angles . The expression based on arctan requires the magnitude of the cross product over the dot product.

From chord length [ edit ] A line through three-dimensional space between points of interest on a spherical Earth is the chord of the great circle between the points. The central angle between the two points can be determined from the chord length. The great circle distance is proportional to the central angle.

The great circle chord length, Δ Δ σ σ c {\displaystyle \Delta \sigma _{\text{c}}\,\!} , may be calculated as follows for the corresponding unit sphere, by means of Cartesian subtraction : Δ Δ X = cos ⁡ ⁡ ϕ ϕ 2 cos ⁡ ⁡ λ λ 2 − − cos ⁡ ⁡ ϕ ϕ 1 cos ⁡ ⁡ λ λ 1 ; Δ Δ Y = cos ⁡ ⁡ ϕ ϕ 2 sin ⁡ ⁡ λ λ 2 − − cos ⁡ ⁡ ϕ ϕ 1 sin ⁡ ⁡ λ λ 1 ; Δ Δ Z = sin ⁡ ⁡ ϕ ϕ 2 − − sin ⁡ ⁡ ϕ ϕ 1 ; Δ Δ σ σ c = ( Δ Δ X ) 2 + ( Δ Δ Y ) 2 + ( Δ Δ Z ) 2 .

{\displaystyle {\begin{aligned}\Delta {X}&=\cos \phi _{2}\cos \lambda _{2}-\cos \phi _{1}\cos \lambda _{1};\\\Delta {Y}&=\cos \phi _{2}\sin \lambda _{2}-\cos \phi _{1}\sin \lambda _{1};\\\Delta {Z}&=\sin \phi _{2}-\sin \phi _{1};\\\Delta \sigma _{\text{c}}&={\sqrt {(\Delta {X})^{2}+(\Delta {Y})^{2}+(\Delta {Z})^{2}}}.\end{aligned}}} Substituting λ λ 1 = − − 1 2 Δ Δ λ λ {\displaystyle \lambda _{1}=-{\tfrac {1}{2}}\Delta \lambda } and λ λ 2 = 1 2 Δ Δ λ λ {\displaystyle \lambda _{2}={\tfrac {1}{2}}\Delta \lambda } this formula can be algebraically manipulated to the form shown above in § Computational formulae .

Radius for spherical Earth [ edit ] Equatorial ( a ), polar ( b ) and mean Earth radii as defined in the 1984 World Geodetic System revision. ( Not to scale .) Main article: Earth radius The shape of the Earth closely resembles a flattened sphere (a spheroid ) with equatorial radius a {\displaystyle a} of 6378.137 km; distance b {\displaystyle b} from the center of the spheroid to each pole is 6356.7523142 km. When calculating the length of a short north-south line at the equator, the circle that best approximates that line has a radius of b 2 a {\textstyle {\frac {b^{2}}{a}}} (which equals the meridian's semi-latus rectum ), or 6335.439 km, while the spheroid at the poles is best approximated by a sphere of radius a 2 b {\textstyle {\frac {a^{2}}{b}}} , or 6399.594 km, a 1% difference. So long as a spherical Earth is assumed, any single formula for distance on the Earth is only guaranteed correct within 0.5% (though better accuracy is possible if the formula is only intended to apply to a limited area). Using the mean Earth radius , R 1 = 1 3 ( 2 a + b ) ≈ ≈ 6371.009 km {\textstyle R_{1}={\frac {1}{3}}(2a+b)\approx 6371.009{\text{ km}}} (for the WGS84 ellipsoid) means that in the limit of small flattening, the mean square relative error in the estimates for distance is minimized.

[ 7 ] For distances smaller than 500 kilometers and outside of the poles, a Euclidean approximation of an ellipsoidal Earth ( Federal Communications Commission's (FCC)'s formula ) is both simpler and more accurate (to 0.1%).

[ 8 ] See also [ edit ] Air navigation Angular distance Circumnavigation Elliptic geometry § Elliptic space (the 3D case) Flight planning Geodesy Geodesics on an ellipsoid Geodetic system Geographical distance Isoazimuthal Loxodromic navigation Meridian arc Rhumb line Spherical geometry Spherical trigonometry Versor References and notes [ edit ] ^ Admiralty Manual of Navigation, Volume 1 , The Stationery Office, 1987, p. 10, ISBN 9780117728806 , The errors introduced by assuming a spherical Earth based on the international nautical mile are not more than 0.5% for latitude, 0.2% for longitude.

^ Kells, Lyman M.; Kern, Willis F.; Bland, James R. (1940).

Plane And Spherical Trigonometry . McGraw Hill Book Company, Inc. pp.

323 -326 . Retrieved July 13, 2018 .

^ "Calculate distance, bearing and more between Latitude/Longitude points" . Retrieved 10 Aug 2013 .

^ Sinnott, Roger W. (August 1984). "Virtues of the Haversine".

Sky and Telescope .

68 (2): 159.

^ Vincenty, Thaddeus (1975-04-01).

"Direct and Inverse Solutions of Geodesics on the Ellipsoid with Application of Nested Equations" (PDF) .

Survey Review .

23 (176). Kingston Road, Tolworth, Surrey: Directorate of Overseas Surveys : 88– 93.

Bibcode : 1975SurRv..23...88V .

doi : 10.1179/sre.1975.23.176.88 . Retrieved 2008-07-21 .

^ Gade, Kenneth (2010).

"A non-singular horizontal position representation" (PDF) .

The Journal of Navigation .

63 (3). Cambridge University Press: 395– 417.

Bibcode : 2010JNav...63..395G .

doi : 10.1017/S0373463309990415 .

^ McCaw, G. T. (1932). "Long lines on the Earth".

Empire Survey Review .

1 (6): 259– 263.

doi : 10.1179/sre.1932.1.6.259 .

^ Agafonkin, Vladimir (30 August 2017).

"Fast geodesic approximations with Cheap Ruler" .

Mapbox .

"mapbox/cheap-ruler" . Mapbox. 10 May 2024.

External links [ edit ] GreatCircle at MathWorld NewPP limit report
Parsed by mw‐web.codfw.main‐6cc77c66b8‐4tx82
Cached time: 20250812000314
Cache expiry: 2592000
Reduced expiry: false
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.276 seconds
Real time usage: 0.405 seconds
Preprocessor visited node count: 1017/1000000
Revision size: 13329/2097152 bytes
Post‐expand include size: 20873/2097152 bytes
Template argument size: 928/2097152 bytes
Highest expansion depth: 8/100
Expensive parser function count: 3/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 34542/5000000 bytes
Lua time usage: 0.156/10.000 seconds
Lua memory usage: 5791672/52428800 bytes
Number of Wikibase entities loaded: 0/500 Transclusion expansion time report (%,ms,calls,template)
100.00%  277.666      1 -total
 54.79%  152.123      1 Template:Reflist
 27.35%   75.936      1 Template:Citation
 24.20%   67.208      1 Template:Short_description
 15.46%   42.915      2 Template:Pagetype
  9.60%   26.647      1 Template:About
  8.33%   23.124      4 Template:Cite_journal
  8.17%   22.694      1 Template:Multiref
  6.16%   17.097      3 Template:Cite_web
  5.23%   14.532      5 Template:Main_other Saved in parser cache with key enwiki:pcache:379733:|#|:idhash:canonical and timestamp 20250812000314 and revision id 1271272622. Rendering was triggered because: page-view Retrieved from " https://en.wikipedia.org/w/index.php?title=Great-circle_distance&oldid=1271272622 " Categories : Metric geometry Spherical trigonometry Distance Spherical curves Hidden categories: Articles with short description Short description is different from Wikidata This page was last edited on 23 January 2025, at 08:30 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Great-circle distance 22 languages Add topic

