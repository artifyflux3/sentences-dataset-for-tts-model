Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Assumptions and formal statement of hypotheses 2 U statistic Toggle U statistic subsection 2.1 Area-under-curve (AUC) statistic for ROC curves 3 Calculations 4 Properties 5 Examples Toggle Examples subsection 5.1 Illustration of calculation methods 5.2 Example statement of results 6 Normal approximation and tie correction 7 Effect sizes Toggle Effect sizes subsection 7.1 Proportion of concordance out of all pairs 7.1.1 Common language effect size 7.1.2 ρ statistic 7.2 Rank-biserial correlation 8 Relation to other tests Toggle Relation to other tests subsection 8.1 Comparison to Student's t -test 8.2 Different distributions 8.2.1 Alternatives 9 Related test statistics Toggle Related test statistics subsection 9.1 Kendall's tau 10 Software implementations 11 History 12 See also 13 Notes 14 References 15 External links Toggle the table of contents Mann–Whitney U test 24 languages العربية Cymraeg Deutsch Español Euskara فارسی Français 한국어 Hrvatski Italiano Kiswahili Latviešu Magyar Nederlands 日本語 Polski Português Русский Suomi Svenska Tagalog Türkçe Українська 粵語 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Nonparametric test of the null hypothesis "Wilcoxon rank-sum test" redirects here. For Wilcoxon signed-rank test, see Wilcoxon signed-rank test .

The Mann–Whitney U {\displaystyle U} test (also called the Mann–Whitney–Wilcoxon ( MWW/MWU ), Wilcoxon rank-sum test , or Wilcoxon–Mann–Whitney test ) is a nonparametric statistical test of the null hypothesis that randomly selected values X and Y from two populations have the same distribution.

Nonparametric tests used on two dependent samples are the sign test and the Wilcoxon signed-rank test .

Assumptions and formal statement of hypotheses [ edit ] Although Henry Mann and Donald Ransom Whitney [ 1 ] developed the Mann–Whitney U test under the assumption of continuous responses with the alternative hypothesis being that one distribution is stochastically greater than the other, there are many other ways to formulate the null and alternative hypotheses such that the Mann–Whitney U test will give a valid test.

[ 2 ] A very general formulation is to assume that: All the observations from both groups are independent of each other, The responses are at least ordinal (i.e., one can at least say, of any two observations, which is the greater), Under the null hypothesis H 0 , the distributions of both populations are identical.

[ 3 ] The alternative hypothesis H 1 is that the distributions are not identical.

Under the general formulation, the test is only consistent when the following occurs under H 1 : The probability of an observation from population X exceeding an observation from population Y is different (larger, or smaller) than the probability of an observation from Y exceeding an observation from X ; i.e., P( X > Y ) ≠ P( Y > X ) or P( X > Y ) + 0.5 · P( X = Y ) ≠ 0.5 .

Under more strict assumptions than the general formulation above, e.g., if the responses are assumed to be continuous and the alternative is restricted to a shift in location, i.e., F 1 ( x ) = F 2 ( x + δ ) , we can interpret a significant Mann–Whitney U test as showing a difference in medians. Under this location shift assumption, we can also interpret the Mann–Whitney U test as assessing whether the Hodges–Lehmann estimate of the difference in central tendency between the two populations differs from zero. The Hodges–Lehmann estimate for this two-sample problem is the median of all possible differences between an observation in the first sample and an observation in the second sample.

Otherwise, if both the dispersions and shapes of the distribution of both samples differ, the Mann–Whitney U test fails a test of medians. It is possible to show examples where medians are numerically equal while the test rejects the null hypothesis with a small p-value.

[ 4 ] [ 5 ] [ 6 ] The Mann–Whitney U test / Wilcoxon rank-sum test is not the same as the Wilcoxon signed -rank test , although both are nonparametric and involve summation of ranks . The Mann–Whitney U test is applied to independent samples. The Wilcoxon signed-rank test is applied to matched or dependent samples.

U statistic [ edit ] Let X 1 , … … , X n 1 {\displaystyle X_{1},\ldots ,X_{n_{1}}} be group 1, an i.i.d. sample from X {\displaystyle X} , and Y 1 , … … , Y n 2 {\displaystyle Y_{1},\ldots ,Y_{n_{2}}} be group 2, an i.i.d. sample from Y {\displaystyle Y} , and let both samples be independent of each other. The corresponding Mann–Whitney U statistic is defined as the smaller of: U 1 = n 1 n 2 + n 1 ( n 1 + 1 ) 2 − − R 1 , U 2 = n 1 n 2 + n 2 ( n 2 + 1 ) 2 − − R 2 {\displaystyle U_{1}=n_{1}n_{2}+{\tfrac {n_{1}(n_{1}+1)}{2}}-R_{1},U_{2}=n_{1}n_{2}+{\tfrac {n_{2}(n_{2}+1)}{2}}-R_{2}} with R 1 , R 2 {\displaystyle R_{1},R_{2}} being the sums of the ranks in groups 1 and 2, after ranking all samples from both groups such that the smallest value obtains rank 1 and the largest rank n 1 + n 2 {\displaystyle n_{1}+n_{2}} .

[ 7 ] Area-under-curve (AUC) statistic for ROC curves [ edit ] The U statistic is related to the area under the receiver operating characteristic curve ( AUC ): [ 8 ] A U C 1 = U 1 n 1 n 2 {\displaystyle \mathrm {AUC} _{1}={U_{1} \over n_{1}n_{2}}} Note that this is the same definition as the common language effect size , i.e. the probability that a classifier will rank a randomly chosen instance from the first group higher than a randomly chosen instance from the second group.

[ 9 ] Because of its probabilistic form, the U statistic can be generalized to a measure of a classifier's separation power for more than two classes: [ 10 ] M = 1 c ( c − − 1 ) ∑ ∑ A U C k , ℓ ℓ {\displaystyle M={1 \over c(c-1)}\sum \mathrm {AUC} _{k,\ell }} Where c is the number of classes, and the R k , ℓ term of AUC k , ℓ considers only the ranking of the items belonging to classes k and ℓ (i.e., items belonging to all other classes are ignored) according to the classifier's estimates of the probability of those items belonging to class k . AUC k , k will always be zero but, unlike in the two-class case, generally AUC k , ℓ ≠ AUC ℓ , k , which is why the M measure sums over all ( k , ℓ ) pairs, in effect using the average of AUC k , ℓ and AUC ℓ , k .

Calculations [ edit ] The test involves the calculation of a statistic , usually called U , whose distribution under the null hypothesis is known: In the case of small samples, the distribution is tabulated For sample sizes above ~20, approximation using the normal distribution is fairly good.

Alternatively, the null distribution can be approximated using permutation tests and Monte Carlo simulations.

Some books tabulate statistics equivalent to U , such as the sum of ranks in one of the samples, rather than U itself.

The Mann–Whitney U test is included in most statistical packages .

It is also easily calculated by hand, especially for small samples. There are two ways of doing this.

Method one: For comparing two small sets of observations, a direct method is quick, and gives insight into the meaning of the U statistic, which corresponds to the number of wins out of all pairwise contests (see the tortoise and hare example under Examples below). For each observation in one set, count the number of times this first value wins over any observations in the other set (the other value loses if this first is larger). Count 0.5 for any ties. The sum of wins and ties is U (i.e.: U 1 {\displaystyle U_{1}} ) for the first set.

U for the other set is the converse (i.e.: U 2 {\displaystyle U_{2}} ).

Method two: For larger samples: Assign numeric ranks to all the observations (put the observations from both groups to one set), beginning with 1 for the smallest value. Where there are groups of tied values, assign a rank equal to the midpoint of unadjusted rankings (e.g., the ranks of (3, 5, 5, 5, 5, 8) are (1, 3.5, 3.5, 3.5, 3.5, 6) , where the unadjusted ranks would be (1, 2, 3, 4, 5, 6) ).

Now, add up the ranks for the observations which came from sample 1. The sum of ranks in sample 2 is now determined, since the sum of all the ranks equals N ( N + 1)/2 where N is the total number of observations.

U is then given by: [ 11 ] U 1 = R 1 − − n 1 ( n 1 + 1 ) 2 {\displaystyle U_{1}=R_{1}-{n_{1}(n_{1}+1) \over 2}\,\!} where n 1 is the sample size for sample 1, and R 1 is the sum of the ranks in sample 1.

Note that it doesn't matter which of the two samples is considered sample 1. An equally valid formula for U is U 2 = R 2 − − n 2 ( n 2 + 1 ) 2 {\displaystyle U_{2}=R_{2}-{n_{2}(n_{2}+1) \over 2}\,\!} The smaller value of U 1 and U 2 is the one used when consulting significance tables. The sum of the two values is given by U 1 + U 2 = R 1 − − n 1 ( n 1 + 1 ) 2 + R 2 − − n 2 ( n 2 + 1 ) 2 .

{\displaystyle U_{1}+U_{2}=R_{1}-{n_{1}(n_{1}+1) \over 2}+R_{2}-{n_{2}(n_{2}+1) \over 2}.\,\!} Knowing that R 1 + R 2 = N ( N + 1)/2 and N = n 1 + n 2 , and doing some algebra , we find that the sum is U 1 + U 2 = n 1 n 2 .

Properties [ edit ] The maximum value of U is the product of the sample sizes for the two samples (i.e.: U i = n 1 n 2 {\displaystyle U_{i}=n_{1}n_{2}} ). In such a case, the "other" U would be 0.

Examples [ edit ] Illustration of calculation methods [ edit ] Suppose that Aesop is dissatisfied with his classic experiment in which one tortoise was found to beat one hare in a race, and decides to carry out a significance test to discover whether the results could be extended to tortoises and hares in general. He collects a sample of 6 tortoises and 6 hares, and makes them all run his race at once. The order in which they reach the finishing post (their rank order, from first to last crossing the finish line) is as follows, writing T for a tortoise and H for a hare: T H H H H H T T T T T H What is the value of U ?

Using the direct method, we take each tortoise in turn, and count the number of hares it beats, getting 6, 1, 1, 1, 1, 1, which means that U T = 11 . Alternatively, we could take each hare in turn, and count the number of tortoises it beats. In this case, we get 5, 5, 5, 5, 5, 0, so U H = 25 . Note that the sum of these two values for U = 36 , which is 6×6 .

Using the indirect method: rank the animals by the time they take to complete the course, so give the first animal home rank 12, the second rank 11, and so forth.

the sum of the ranks achieved by the tortoises is 12 + 6 + 5 + 4 + 3 + 2 = 32 .

Therefore U T = 32 − (6×7)/2 = 32 − 21 = 11 (same as method one).

The sum of the ranks achieved by the hares is 11 + 10 + 9 + 8 + 7 + 1 = 46 , leading to U H = 46 − 21 = 25 .

Example statement of results [ edit ] In reporting the results of a Mann–Whitney U test, it is important to state: [ 12 ] A measure of the central tendencies of the two groups (means or medians; since the Mann–Whitney U test is an ordinal test, medians are usually recommended) The value of U (perhaps with some measure of effect size, such as common language effect size or rank-biserial correlation ).

The sample sizes The significance level.

In practice some of this information may already have been supplied and common sense should be used in deciding whether to repeat it. A typical report might run, "Median latencies in groups E and C were 153 and 247 ms; the distributions in the two groups differed significantly (Mann–Whitney U = 10.5 , n 1 = n 2 = 8 , P < 0.05 two-tailed)." A statement that does full justice to the statistical status of the test might run, "Outcomes of the two treatments were compared using the Wilcoxon–Mann–Whitney two-sample rank-sum test. The treatment effect (difference between treatments) was quantified using the Hodges–Lehmann (HL) estimator, which is consistent with the Wilcoxon test.

[ 13 ] This estimator (HLΔ) is the median of all possible differences in outcomes between a subject in group B and a subject in group A. A non-parametric 0.95 confidence interval for HLΔ accompanies these estimates as does ρ, an estimate of the probability that a randomly chosen subject from population B has a higher weight than a randomly chosen subject from population A. The median [quartiles] weight for subjects on treatment A and B respectively are 147 [121, 177] and 151 [130, 180] kg. Treatment A decreased weight by HLΔ = 5 kg (0.95 CL [2, 9] kg, 2 P = 0.02 , ρ = 0.58 )." However it would be rare to find such an extensive report in a document whose major topic was not statistical inference.

Normal approximation and tie correction [ edit ] For large samples, U is approximately normally distributed . In that case, the standardized value z = U − − m U σ σ U , {\displaystyle z={\frac {U-m_{U}}{\sigma _{U}}},\,} where m U and σ U are the mean and standard deviation of U , is approximately a standard normal deviate whose significance can be checked in tables of the normal distribution.

m U and σ U are given by m U = n 1 n 2 2 , {\displaystyle m_{U}={\frac {n_{1}n_{2}}{2}},\,} [ 14 ] and σ σ U = n 1 n 2 ( n 1 + n 2 + 1 ) 12 .

{\displaystyle \sigma _{U}={\sqrt {n_{1}n_{2}(n_{1}+n_{2}+1) \over 12}}.\,} [ 14 ] The formula for the standard deviation is more complicated in the presence of tied ranks. If there are ties in ranks, σ should be adjusted as follows: σ σ ties = n 1 n 2 ( n 1 + n 2 + 1 ) 12 − − n 1 n 2 ∑ ∑ k = 1 K ( t k 3 − − t k ) 12 n ( n − − 1 ) , {\displaystyle \sigma _{\text{ties}}={\sqrt {{n_{1}n_{2}(n_{1}+n_{2}+1) \over 12}-{n_{1}n_{2}\sum _{k=1}^{K}(t_{k}^{3}-t_{k}) \over 12n(n-1)}}},\,} [ 15 ] where the left side is simply the variance and the right side is the adjustment for ties, t k is the number of ties for the k th rank, and K is the total number of unique ranks with ties.

A more computationally-efficient form with n 1 n 2 /12 factored out is σ σ ties = n 1 n 2 12 ( ( n + 1 ) − − ∑ ∑ k = 1 K ( t k 3 − − t k ) n ( n − − 1 ) ) , {\displaystyle \sigma _{\text{ties}}={\sqrt {{n_{1}n_{2} \over 12}\left((n+1)-{\sum _{k=1}^{K}(t_{k}^{3}-t_{k}) \over n(n-1)}\right)}},} where n = n 1 + n 2 .

If the number of ties is small (and especially if there are no large tie bands) ties can be ignored when doing calculations by hand. The computer statistical packages will use the correctly adjusted formula as a matter of routine.

Note that since U 1 + U 2 = n 1 n 2 , the mean n 1 n 2 /2 used in the normal approximation is the mean of the two values of U . Therefore, the absolute value of the z -statistic calculated will be same whichever value of U is used.

Effect sizes [ edit ] It is a widely recommended practice for scientists to report an effect size for an inferential test.

[ 16 ] [ 17 ] Proportion of concordance out of all pairs [ edit ] The following measures are equivalent.

Common language effect size [ edit ] One method of reporting the effect size for the Mann–Whitney U test is with f , the common language effect size.

[ 18 ] [ 19 ] As a sample statistic, the common language effect size is computed by forming all possible pairs between the two groups, then finding the proportion of pairs that support a direction (say, that items from group 1 are larger than items from group 2).

[ 19 ] To illustrate, in a study with a sample of ten hares and ten tortoises, the total number of ordered pairs is ten times ten or 100 pairs of hares and tortoises. Suppose the results show that the hare ran faster than the tortoise in 90 of the 100 sample pairs; in that case, the sample common language effect size is 90%.

[ 20 ] The relationship between f and the Mann–Whitney U (specifically U 1 {\displaystyle U_{1}} ) is as follows: f = U 1 n 1 n 2 {\displaystyle f={U_{1} \over n_{1}n_{2}}\,} This is the same as the area under the curve (AUC) for the ROC curve .

ρ statistic [ edit ] A statistic called ρ that is linearly related to U and widely used in studies of categorization ( discrimination learning involving concepts ), and elsewhere, [ 21 ] is calculated by dividing U by its maximum value for the given sample sizes, which is simply n 1 × n 2 .

ρ is thus a non-parametric measure of the overlap between two distributions; it can take values between 0 and 1, and it estimates P( Y > X ) + 0.5 P( Y = X ) , where X and Y are randomly chosen observations from the two distributions. Both extreme values represent complete separation of the distributions, while a ρ of 0.5 represents complete overlap. The usefulness of the ρ statistic can be seen in the case of the odd example used above, where two distributions that were significantly different on a Mann–Whitney U test nonetheless had nearly identical medians: the ρ value in this case is approximately 0.723 in favour of the hares, correctly reflecting the fact that even though the median tortoise beat the median hare, the hares collectively did better than the tortoises collectively.

[ citation needed ] Rank-biserial correlation [ edit ] A method of reporting the effect size for the Mann–Whitney U test is with a measure of rank correlation known as the rank-biserial correlation. Edward Cureton introduced and named the measure.

[ 22 ] Like other correlational measures, the rank-biserial correlation can range from minus one to plus one, with a value of zero indicating no relationship.

There is a simple difference formula to compute the rank-biserial correlation from the common language effect size: the correlation is the difference between the proportion of pairs favorable to the hypothesis ( f ) minus its complement (i.e.: the proportion that is unfavorable ( u )). This simple difference formula is just the difference of the common language effect size of each group, and is as follows: [ 18 ] r = f − − u {\displaystyle r=f-u} For example, consider the example where hares run faster than tortoises in 90 of 100 pairs. The common language effect size is 90%, so the rank-biserial correlation is 90% minus 10%, and the rank-biserial r = 0.80 .

An alternative formula for the rank-biserial can be used to calculate it from the Mann–Whitney U (either U 1 {\displaystyle U_{1}} or U 2 {\displaystyle U_{2}} ) and the sample sizes of each group: [ 23 ] r = f − − ( 1 − − f ) = 2 f − − 1 = 2 U 1 n 1 n 2 − − 1 = 1 − − 2 U 2 n 1 n 2 {\displaystyle r=f-(1-f)=2f-1={2U_{1} \over n_{1}n_{2}}-1=1-{2U_{2} \over n_{1}n_{2}}} This formula is useful when the data are not available, but when there is a published report, because U and the sample sizes are routinely reported. Using the example above with 90 pairs that favor the hares and 10 pairs that favor the tortoise, U 2 is the smaller of the two, so U 2 = 10 . This formula then gives r = 1 – (2×10) / (10×10) = 0.80 , which is the same result as with the simple difference formula above.

Relation to other tests [ edit ] Comparison to Student's t -test [ edit ] The Mann–Whitney U test tests a null hypothesis that the probability distribution of a randomly drawn observation from one group is the same as the probability distribution of a randomly drawn observation from the other group against an alternative that those distributions are not equal (see Mann–Whitney U test#Assumptions and formal statement of hypotheses ). In contrast, a t-test tests a null hypothesis of equal means in two groups against an alternative of unequal means. Hence, except in special cases, the Mann–Whitney U test and the t-test do not test the same hypotheses and should be compared with this in mind.

Ordinal data The Mann–Whitney U test is preferable to the t -test when the data are ordinal but not interval scaled, in which case the spacing between adjacent values of the scale cannot be assumed to be constant.

Robustness As it compares the sums of ranks, [ 24 ] the Mann–Whitney U test is less likely than the t -test to spuriously indicate significance because of the presence of outliers . However, the Mann–Whitney U test may have worse type I error control when data are both heteroscedastic and non-normal.

[ 25 ] Efficiency When normality holds, the Mann–Whitney U test has an (asymptotic) efficiency of 3/ π or about 0.95 when compared to the t -test.

[ 26 ] For distributions sufficiently far from normal and for sufficiently large sample sizes, the Mann–Whitney U test is considerably more efficient than the t .

[ 27 ] This comparison in efficiency, however, should be interpreted with caution, as Mann–Whitney and the t-test do not test the same quantities. If, for example, a difference of group means is of primary interest, Mann–Whitney is not an appropriate test.

[ 28 ] The Mann–Whitney U test will give very similar results to performing an ordinary parametric two-sample t -test on the rankings of the data.

[ 29 ] Relative efficiencies of the Mann–Whitney test versus the two-sample t -test if f = g equals a number of distributions [ 30 ] Distribution Efficiency Logistic π π 2 / 9 {\displaystyle \pi ^{2}/9} Normal 3 / π π {\displaystyle 3/\pi } Laplace 3/2 Uniform 1 Different distributions [ edit ] The Mann–Whitney U test is not valid for testing the null hypothesis P ( Y > X ) + 0.5 P ( Y = X ) = 0.5 {\displaystyle P(Y>X)+0.5P(Y=X)=0.5} against  the alternative hypothesis P ( Y > X ) + 0.5 P ( Y = X ) ≠ ≠ 0.5 {\displaystyle P(Y>X)+0.5P(Y=X)\neq 0.5} ), without assuming that the distributions are the same under the null hypothesis (i.e., assuming F 1 = F 2 {\displaystyle F_{1}=F_{2}} ).

[ 2 ] To test between those hypotheses, better tests are available. Among those are the Brunner-Munzel and the Fligner–Policello test.

[ 31 ] Specifically, under the more general null hypothesis P ( Y > X ) + 0.5 P ( Y = X ) = 0.5 {\displaystyle P(Y>X)+0.5P(Y=X)=0.5} , the Mann–Whitney U test can have inflated type I error rates even in large samples (especially if the variances of two populations are unequal and the sample sizes are different), a problem the better alternatives solve.

[ 32 ] As a result, it has been suggested to use one of the alternatives (specifically the Brunner–Munzel test) if it cannot be assumed that the distributions are equal under the null hypothesis.

[ 32 ] Alternatives [ edit ] If one desires a simple shift interpretation, the Mann–Whitney U test should not be used when the distributions of the two samples are very different, as it can give erroneous interpretation of significant results.

[ 33 ] In that situation, the unequal variances version of the t -test may give more reliable results.

Similarly, some authors ( Conover, W. J. (1999).

Practical Nonparametric Statistics -- 3rd ed . New York: John Wiley & Sons. p. 272-281.

ISBN 0-471-16068-7 .

) suggest transforming the data to ranks (if they are not already ranks) and then performing the t -test on the transformed data, the version of the t -test used depending on whether or not the population variances are suspected to be different. Rank transformations do not preserve variances, but variances are recomputed from samples after rank transformations.

The Brown–Forsythe test has been suggested as an appropriate non-parametric equivalent to the F -test for equal variances.

[ citation needed ] A more powerful test is the Brunner-Munzel test , outperforming the Mann–Whitney U test in case of violated assumption of exchangeability.

[ 34 ] The Mann–Whitney U test is a special case of the proportional odds model , allowing for covariate-adjustment.

[ 35 ] See also Kolmogorov–Smirnov test .

Related test statistics [ edit ] Kendall's tau [ edit ] The Mann–Whitney U test is related to a number of other non-parametric statistical procedures. For example, it is equivalent to Kendall's tau correlation coefficient if one of the variables is binary (that is, it can only take two values).

[ citation needed ] Software implementations [ edit ] In many software packages, the Mann–Whitney U test (of the hypothesis of equal distributions against appropriate alternatives) has been poorly documented. Some packages incorrectly treat ties or fail to document asymptotic techniques (e.g., correction for continuity). A 2000 review discussed some of the following packages: [ 36 ] MATLAB has ranksum in its Statistics Toolbox.

R 's statistics base-package implements the test wilcox.test in its "stats" package.

The R function wilcoxonZ from the rcompanion package will calculate the z statistic for a Wilcoxon two-sample, paired, or one-sample test.

SAS implements the test in its PROC NPAR1WAY procedure.

Python has an implementation of this test provided by SciPy .

[ 37 ] SigmaStat (SPSS Inc., Chicago, IL) SYSTAT (SPSS Inc., Chicago, IL) Java has an implementation of this test provided by Apache Commons [ 38 ] Julia has implementations of this test through several packages.  In the package HypothesisTests.jl , this is found as pvalue(MannWhitneyUTest(X, Y)) .

[ 39 ] JMP (SAS Institute Inc., Cary, NC) S-Plus (MathSoft, Inc., Seattle, WA) STATISTICA (StatSoft, Inc., Tulsa, OK) UNISTAT (Unistat Ltd, London) SPSS (SPSS Inc, Chicago) StatsDirect (StatsDirect Ltd, Manchester, UK) implements all common variants .

Stata (Stata Corporation, College Station, TX) implements the test in its ranksum command.

StatXact (Cytel Software Corporation, Cambridge, Massachusetts) PSPP implements the test in its WILCOXON function.

KNIME implements the test in its Wilcoxon–Mann–Whitney Test node.

History [ edit ] The statistic appeared in a 1914 article [ 40 ] by the German Gustav Deuchler (with a missing term in the variance).

In a single paper in 1945, Frank Wilcoxon proposed [ 41 ] both the one-sample signed rank and the two-sample rank sum test, in a test of significance with a point null-hypothesis against its complementary alternative (that is, equal versus not equal). However, he only tabulated a few points for the equal-sample size case in that paper (though in a later paper he gave larger tables).

A thorough analysis of the statistic, which included a recurrence allowing the computation of tail probabilities for arbitrary sample sizes and tables for sample sizes of eight or less appeared in the article by Henry Mann and his student Donald Ransom Whitney in 1947.

[ 1 ] This article discussed alternative hypotheses, including a stochastic ordering (where the cumulative distribution functions satisfied the pointwise inequality F X ( t ) < F Y ( t ) ). This paper also computed the first four moments and established the limiting normality of the statistic under the null hypothesis, so establishing that it is asymptotically distribution-free.

See also [ edit ] Lepage test Cucconi test Kolmogorov–Smirnov test Wilcoxon signed-rank test Kruskal–Wallis one-way analysis of variance Brunner Munzel test Proportional odds model Notes [ edit ] ^ a b Mann, Henry B.

; Whitney, Donald R. (1947).

"On a Test of Whether one of Two Random Variables is Stochastically Larger than the Other" .

Annals of Mathematical Statistics .

18 (1): 50– 60.

doi : 10.1214/aoms/1177730491 .

MR 0022058 .

Zbl 0041.26103 .

^ a b Fay, Michael P.; Proschan, Michael A. (2010).

"Wilcoxon–Mann–Whitney or t -test? On assumptions for hypothesis tests and multiple interpretations of decision rules" .

Statistics Surveys .

4 : 1– 39.

doi : 10.1214/09-SS051 .

MR 2595125 .

PMC 2857732 .

PMID 20414472 .

^ [1] , See Table 2.1 of Pratt (1964) "Robustness of Some Procedures for the Two-Sample Location Problem." Journal of the American Statistical Association.

59 (307): 655–680. If the two distributions are normal with the same mean but different variances, then Pr[ X > Y ] = Pr[ Y < X ] but the size of the Mann–Whitney test can be larger than the nominal level. So we cannot define the null hypothesis as Pr[ X > Y ] = Pr[ Y < X ] and get a valid test.

^ Divine, George W.; Norton, H. James; Barón, Anna E.; Juarez-Colunga, Elizabeth (2018).

"The Wilcoxon–Mann–Whitney Procedure Fails as a Test of Medians" .

The American Statistician .

72 (3): 278– 286.

doi : 10.1080/00031305.2017.1305291 .

^ Conroy, Ronán (2012).

"What Hypotheses do "Nonparametric" Two-Group Tests Actually Test?" .

Stata Journal .

12 (2): 182– 190.

doi : 10.1177/1536867X1201200202 .

S2CID 118445807 . Retrieved 24 May 2021 .

^ Hart, Anna (2001).

"Mann–Whitney test is not just a test of medians: differences in spread can be important" .

BMJ .

323 (7309): 391– 393.

doi : 10.1136/bmj.323.7309.391 .

PMC 1120984 .

PMID 11509435 .

^ Boston University (SPH), 2017 ^ Mason, S. J., Graham, N. E. (2002). "Areas beneath the relative operating characteristics (ROC) and relative operating levels (ROL) curves: Statistical significance and interpretation".

Quarterly Journal of the Royal Meteorological Society .

128 (584): 2145– 2166.

doi : 10.1256/003590002320603584 .

ISSN 1477-870X .

^ Fawcett, Tom (2006); An introduction to ROC analysis , Pattern Recognition Letters, 27, 861–874.

^ Hand, David J.; Till, Robert J. (2001).

"A Simple Generalisation of the Area Under the ROC Curve for Multiple Class Classification Problems" .

Machine Learning .

45 (2): 171– 186.

doi : 10.1023/A:1010920819831 .

^ Zar, Jerrold H. (1998).

Biostatistical Analysis . New Jersey: Prentice Hall International, INC. p. 147.

ISBN 978-0-13-082390-8 .

^ Fritz, Catherine O.; Morris, Peter E.; Richler, Jennifer J. (2012).

"Effect size estimates: Current use, calculations, and interpretation" .

Journal of Experimental Psychology: General .

141 (1): 2– 18.

doi : 10.1037/a0024338 .

ISSN 1939-2222 .

PMID 21823805 .

^ Myles Hollander; Douglas A. Wolfe (1999).

Nonparametric Statistical Methods (2 ed.). Wiley-Interscience.

ISBN 978-0471190455 .

^ a b Siegal, Sidney (1956).

Nonparametric statistics for the behavioral sciences . McGraw-Hill. p. 121.

{{ cite book }} :  CS1 maint: numeric names: authors list ( link ) ^ Lehmann, Erich; D'Abrera, Howard (1975).

Nonparametrics: Statistical Methods Based on Ranks . Holden-Day. p. 20.

{{ cite book }} :  CS1 maint: numeric names: authors list ( link ) ^ Wilkinson, Leland (1999). "Statistical methods in psychology journals: Guidelines and explanations".

American Psychologist .

54 (8): 594– 604.

doi : 10.1037/0003-066X.54.8.594 .

^ Nakagawa, Shinichi; Cuthill, Innes C (2007). "Effect size, confidence interval and statistical significance: a practical guide for biologists".

Biological Reviews of the Cambridge Philosophical Society .

82 (4): 591– 605.

doi : 10.1111/j.1469-185X.2007.00027.x .

PMID 17944619 .

S2CID 615371 .

^ a b Kerby, D.S. (2014).

"The simple difference formula: An approach to teaching nonparametric correlation" .

Comprehensive Psychology .

3 : 11.IT.3.1.

doi : 10.2466/11.IT.3.1 .

S2CID 120622013 .

^ a b McGraw, K.O.; Wong, J.J. (1992). "A common language effect size statistic".

Psychological Bulletin .

111 (2): 361– 365.

doi : 10.1037/0033-2909.111.2.361 .

^ Grissom RJ (1994). "Statistical analysis of ordinal categorical status after therapies".

Journal of Consulting and Clinical Psychology .

62 (2): 281– 284.

doi : 10.1037/0022-006X.62.2.281 .

PMID 8201065 .

^ Herrnstein, Richard J.; Loveland, Donald H.; Cable, Cynthia (1976). "Natural Concepts in Pigeons".

Journal of Experimental Psychology: Animal Behavior Processes .

2 (4): 285– 302.

doi : 10.1037/0097-7403.2.4.285 .

PMID 978139 .

^ Cureton, E.E. (1956). "Rank-biserial correlation".

Psychometrika .

21 (3): 287– 290.

doi : 10.1007/BF02289138 .

S2CID 122500836 .

^ Wendt, H.W. (1972). "Dealing with a common problem in social science: A simplified rank-biserial coefficient of correlation based on the U statistic".

European Journal of Social Psychology .

2 (4): 463– 465.

doi : 10.1002/ejsp.2420020412 .

^ Motulsky, Harvey J.; Statistics Guide , San Diego, CA: GraphPad Software, 2007, p. 123 ^ Zimmerman, Donald W. (1998-01-01). "Invalidation of Parametric and Nonparametric Statistical Tests by Concurrent Violation of Two Assumptions".

The Journal of Experimental Education .

67 (1): 55– 68.

doi : 10.1080/00220979809598344 .

ISSN 0022-0973 .

^ Lehamnn, Erich L.; Elements of Large Sample Theory , Springer, 1999, p. 176 ^ Conover, William J.; Practical Nonparametric Statistics , John Wiley & Sons, 1980 (2nd Edition), pp. 225–226 ^ Lumley, Thomas; Diehr, Paula ; Emerson, Scott; Chen, Lu (May 2002).

"The Importance of the Normality Assumption in Large Public Health Data Sets" .

Annual Review of Public Health .

23 (1): 151– 169.

doi : 10.1146/annurev.publhealth.23.100901.140546 .

ISSN 0163-7525 .

PMID 11910059 .

^ Conover, William J.; Iman, Ronald L.

(1981). "Rank Transformations as a Bridge Between Parametric and Nonparametric Statistics".

The American Statistician .

35 (3): 124– 129.

doi : 10.2307/2683975 .

JSTOR 2683975 .

^ Vaart, A. W. van der (1998-10-13).

Asymptotic Statistics . Cambridge University Press.

doi : 10.1017/cbo9780511802256 .

ISBN 978-0-511-80225-6 .

^ Brunner, Edgar; Bathke, Arne C.; Konietschke, Frank (2018).

Rank and pseudo-rank procedures for independent observations in factorial designs: Using R and SAS . Springer Series in Statistics. Cham: Springer International Publishing.

doi : 10.1007/978-3-030-02914-2 .

ISBN 978-3-030-02912-8 .

^ a b Karch, Julian D. (2021).

"Psychologists Should Use Brunner–Munzel's Instead of Mann–Whitney's U Test as the Default Nonparametric Procedure" .

Advances in Methods and Practices in Psychological Science .

4 (2).

doi : 10.1177/2515245921999602 .

hdl : 1887/3209569 .

ISSN 2515-2459 .

^ Kasuya, Eiiti (2001). "Mann–Whitney U test when variances are unequal".

Animal Behaviour .

61 (6): 1247– 1249.

doi : 10.1006/anbe.2001.1691 .

S2CID 140209347 .

^ Karch, Julian (2021).

"Psychologists Should Use Brunner–Munzel's Instead of Mann–Whitney's U Test as the Default Nonparametric Procedure" .

Advances in Methods and Practices in Psychological Science .

4 (2).

doi : 10.1177/2515245921999602 .

hdl : 1887/3209569 .

S2CID 235521799 .

^ Harrell, Frank (20 September 2020).

"Violation of Proportional Odds is Not Fatal" .

{{ cite journal }} : Cite journal requires |journal= ( help ) ^ Bergmann, Reinhard; Ludbrook, John; Spooren, Will P.J.M. (2000). "Different Outcomes of the Wilcoxon–Mann–Whitney Test from Different Statistics Packages".

The American Statistician .

54 (1): 72– 77.

doi : 10.1080/00031305.2000.10474513 .

JSTOR 2685616 .

S2CID 120473946 .

^ "scipy.stats.mannwhitneyu" .

SciPy v0.16.0 Reference Guide . The Scipy community. 24 July 2015 . Retrieved 11 September 2015 .

scipy.stats.mannwhitneyu(x, y, use_continuity=True): Computes the Mann–Whitney rank test on samples x and y.

^ "MannWhitneyUTest (Apache Commons Math 3.3 API)" .

commons.apache.org . Archived from the original on 2017-02-28 . Retrieved 2017-02-27 .

^ "JuliaStats/HypothesisTests.jl" .

GitHub . 30 May 2021.

^ Kruskal, William H. (September 1957). "Historical Notes on the Wilcoxon Unpaired Two-Sample Test".

Journal of the American Statistical Association .

52 (279): 356– 360.

doi : 10.2307/2280906 .

JSTOR 2280906 .

^ Wilcoxon, Frank (1945). "Individual comparisons by ranking methods".

Biometrics Bulletin .

1 (6): 80– 83.

doi : 10.2307/3001968 .

hdl : 10338.dmlcz/135688 .

JSTOR 3001968 .

References [ edit ] Hettmansperger, T.P.; McKean, J.W. (1998).

Robust nonparametric statistical methods . Kendall's Library of Statistics. Vol. 5 (First ed., rather than Taylor and Francis (2010) second ed.). London; New York: Edward Arnold; John Wiley and Sons, Inc. pp. xiv+467.

ISBN 978-0-340-54937-7 .

MR 1604954 .

Corder, G.W.; Foreman, D.I. (2014).

Nonparametric Statistics: A Step-by-Step Approach . Wiley.

ISBN 978-1118840313 .

Hodges, J.L.; Lehmann, E.L.

(1963).

"Estimation of location based on ranks" .

Annals of Mathematical Statistics .

34 (2): 598– 611.

doi : 10.1214/aoms/1177704172 .

JSTOR 2238406 .

MR 0152070 .

Zbl 0203.21105 .

PE euclid.aoms/1177704172 .

Kerby, D.S. (2014).

"The simple difference formula: An approach to teaching nonparametric correlation" .

Comprehensive Psychology .

3 : 11.IT.3.1.

doi : 10.2466/11.IT.3.1 .

S2CID 120622013 .

Lehmann, Erich L.

(2006).

Nonparametrics: Statistical methods based on ranks . With the special assistance of H.J.M. D'Abrera (Reprinting of 1988 revision of 1975 Holden-Day ed.). New York: Springer. pp. xvi+463.

ISBN 978-0-387-35212-1 .

MR 0395032 .

Oja, Hannu (2010).

Multivariate nonparametric methods with R : An approach based on spatial signs and ranks . Lecture Notes in Statistics. Vol. 199. New York: Springer. pp. xiv+232.

doi : 10.1007/978-1-4419-0468-3 .

ISBN 978-1-4419-0467-6 .

MR 2598854 .

Sen, Pranab Kumar (December 1963). "On the estimation of relative potency in dilution(-direct) assays by distribution-free methods".

Biometrics .

19 (4): 532– 552.

doi : 10.2307/2527532 .

JSTOR 2527532 .

Zbl 0119.15604 .

External links [ edit ] Table of critical values of U (pdf) Archived 2011-07-06 at the Wayback Machine Interactive calculator for U and its significance Brief guide by experimental psychologist Karl L. Weunsch – Nonparametric effect size estimators (Copyright 2015 by Karl L. Weunsch) v t e Statistics Outline Index Descriptive statistics Continuous data Center Mean Arithmetic Arithmetic-Geometric Contraharmonic Cubic Generalized/power Geometric Harmonic Heronian Heinz Lehmer Median Mode Dispersion Average absolute deviation Coefficient of variation Interquartile range Percentile Range Standard deviation Variance Shape Central limit theorem Moments Kurtosis L-moments Skewness Count data Index of dispersion Summary tables Contingency table Frequency distribution Grouped data Dependence Partial correlation Pearson product-moment correlation Rank correlation Kendall's τ Spearman's ρ Scatter plot Graphics Bar chart Biplot Box plot Control chart Correlogram Fan chart Forest plot Histogram Pie chart Q–Q plot Radar chart Run chart Scatter plot Stem-and-leaf display Violin plot Data collection Study design Effect size Missing data Optimal design Population Replication Sample size determination Statistic Statistical power Survey methodology Sampling Cluster Stratified Opinion poll Questionnaire Standard error Controlled experiments Blocking Factorial experiment Interaction Random assignment Randomized controlled trial Randomized experiment Scientific control Adaptive designs Adaptive clinical trial Stochastic approximation Up-and-down designs Observational studies Cohort study Cross-sectional study Natural experiment Quasi-experiment Statistical inference Statistical theory Population Statistic Probability distribution Sampling distribution Order statistic Empirical distribution Density estimation Statistical model Model specification L p space Parameter location scale shape Parametric family Likelihood (monotone) Location–scale family Exponential family Completeness Sufficiency Statistical functional Bootstrap U V Optimal decision loss function Efficiency Statistical distance divergence Asymptotics Robustness Frequentist inference Point estimation Estimating equations Maximum likelihood Method of moments M-estimator Minimum distance Unbiased estimators Mean-unbiased minimum-variance Rao–Blackwellization Lehmann–Scheffé theorem Median unbiased Plug-in Interval estimation Confidence interval Pivot Likelihood interval Prediction interval Tolerance interval Resampling Bootstrap Jackknife Testing hypotheses 1- & 2-tails Power Uniformly most powerful test Permutation test Randomization test Multiple comparisons Parametric tests Likelihood-ratio Score/Lagrange multiplier Wald Specific tests Z -test (normal) Student's t -test F -test Goodness of fit Chi-squared G -test Kolmogorov–Smirnov Anderson–Darling Lilliefors Jarque–Bera Normality (Shapiro–Wilk) Likelihood-ratio test Model selection Cross validation AIC BIC Rank statistics Sign Sample median Signed rank (Wilcoxon) Hodges–Lehmann estimator Rank sum (Mann–Whitney) Nonparametric anova 1-way (Kruskal–Wallis) 2-way (Friedman) Ordered alternative (Jonckheere–Terpstra) Van der Waerden test Bayesian inference Bayesian probability prior posterior Credible interval Bayes factor Bayesian estimator Maximum posterior estimator Correlation Regression analysis Correlation Pearson product-moment Partial correlation Confounding variable Coefficient of determination Regression analysis Errors and residuals Regression validation Mixed effects models Simultaneous equations models Multivariate adaptive regression splines (MARS) Linear regression Simple linear regression Ordinary least squares General linear model Bayesian regression Non-standard predictors Nonlinear regression Nonparametric Semiparametric Isotonic Robust Homoscedasticity and Heteroscedasticity Generalized linear model Exponential families Logistic (Bernoulli) / Binomial / Poisson regressions Partition of variance Analysis of variance (ANOVA, anova) Analysis of covariance Multivariate ANOVA Degrees of freedom Categorical / multivariate / time-series / survival analysis Categorical Cohen's kappa Contingency table Graphical model Log-linear model McNemar's test Cochran–Mantel–Haenszel statistics Multivariate Regression Manova Principal components Canonical correlation Discriminant analysis Cluster analysis Classification Structural equation model Factor analysis Multivariate distributions Elliptical distributions Normal Time-series General Decomposition Trend Stationarity Seasonal adjustment Exponential smoothing Cointegration Structural break Granger causality Specific tests Dickey–Fuller Johansen Q-statistic (Ljung–Box) Durbin–Watson Breusch–Godfrey Time domain Autocorrelation (ACF) partial (PACF) Cross-correlation (XCF) ARMA model ARIMA model (Box–Jenkins) Autoregressive conditional heteroskedasticity (ARCH) Vector autoregression (VAR) Frequency domain Spectral density estimation Fourier analysis Least-squares spectral analysis Wavelet Whittle likelihood Survival Survival function Kaplan–Meier estimator (product limit) Proportional hazards models Accelerated failure time (AFT) model First hitting time Hazard function Nelson–Aalen estimator Test Log-rank test Applications Biostatistics Bioinformatics Clinical trials / studies Epidemiology Medical statistics Engineering statistics Chemometrics Methods engineering Probabilistic design Process / quality control Reliability System identification Social statistics Actuarial science Census Crime statistics Demography Econometrics Jurimetrics National accounts Official statistics Population statistics Psychometrics Spatial statistics Cartography Environmental statistics Geographic information system Geostatistics Kriging Category Mathematics portal Commons WikiProject Retrieved from " https://en.wikipedia.org/w/index.php?title=Mann–Whitney_U_test&oldid=1306384166 " Categories : Statistical tests Nonparametric statistics U-statistics Hidden categories: CS1:Vancouver names with accept markup CS1 maint: numeric names: authors list CS1 errors: missing periodical Articles with short description Short description is different from Wikidata All articles with unsourced statements Articles with unsourced statements from February 2012 Webarchive template wayback links This page was last edited on 17 August 2025, at 12:44 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Mann–Whitney U test 24 languages Add topic

