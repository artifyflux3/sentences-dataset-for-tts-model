Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Relation with partitions 2 Franklin's bijective proof 3 Partition recurrence 4 See also 5 References 6 External links Toggle the table of contents Pentagonal number theorem 11 languages Deutsch Español Français Galego 한국어 Italiano עברית 日本語 Русский 粵語 中文 Edit links Article Talk English Read View source View history Tools Tools move to sidebar hide Actions Read View source View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Theorem in number theory In mathematics , Euler 's pentagonal number theorem relates the product and series representations of the Euler function . It states that ∏ ∏ n = 1 ∞ ∞ ( 1 − − x n ) = ∑ ∑ k = − − ∞ ∞ ∞ ∞ ( − − 1 ) k x k ( 3 k − − 1 ) / 2 = 1 + ∑ ∑ k = 1 ∞ ∞ ( − − 1 ) k ( x k ( 3 k + 1 ) / 2 + x k ( 3 k − − 1 ) / 2 ) .

{\displaystyle \prod _{n=1}^{\infty }\left(1-x^{n}\right)=\sum _{k=-\infty }^{\infty }\left(-1\right)^{k}x^{k\left(3k-1\right)/2}=1+\sum _{k=1}^{\infty }(-1)^{k}\left(x^{k(3k+1)/2}+x^{k(3k-1)/2}\right).} In other words, ( 1 − − x ) ( 1 − − x 2 ) ( 1 − − x 3 ) ⋯ ⋯ = 1 − − x − − x 2 + x 5 + x 7 − − x 12 − − x 15 + x 22 + x 26 − − ⋯ ⋯ .

{\displaystyle (1-x)(1-x^{2})(1-x^{3})\cdots =1-x-x^{2}+x^{5}+x^{7}-x^{12}-x^{15}+x^{22}+x^{26}-\cdots .} The exponents 1, 2, 5, 7, 12, ...  on the right hand side are given by the formula g k = k (3 k − 1)/2 for k = 1, −1, 2, −2, 3, ... and are called (generalized) pentagonal numbers (sequence A001318 in the OEIS ). (The constant term 1 corresponds to k = 0 {\displaystyle k=0} .)
This holds as an identity of convergent power series for | x | < 1 {\displaystyle |x|<1} , and also as an identity of formal power series .

A striking feature of this formula is the amount of cancellation in the expansion of the product.

Relation with partitions The identity implies a recurrence for calculating p ( n ) {\displaystyle p(n)} , the number of partitions of n : p ( n ) = p ( n − − 1 ) + p ( n − − 2 ) − − p ( n − − 5 ) − − p ( n − − 7 ) + ⋯ ⋯ {\displaystyle p(n)=p(n-1)+p(n-2)-p(n-5)-p(n-7)+\cdots } or more formally, p ( n ) = ∑ ∑ k ≠ ≠ 0 ( − − 1 ) k − − 1 p ( n − − g k ) {\displaystyle p(n)=\sum _{k\neq 0}(-1)^{k-1}p(n-g_{k})} where the summation is over all nonzero integers k (positive and negative) and g k {\displaystyle g_{k}} is the k th generalized pentagonal number. Since p ( n ) = 0 {\displaystyle p(n)=0} for all n < 0 {\displaystyle n<0} , the apparently infinite series on the right has only finitely many non-zero terms, enabling an efficient calculation of p ( n ).

Franklin's bijective proof The theorem can be interpreted combinatorially in terms of partitions .  In particular, the left hand side is a generating function for the number of partitions of n into an even number of distinct parts minus the number of partitions of n into an odd number of distinct parts. Each partition of n into an even number of distinct parts contributes +1 to the coefficient of x n ; each partition into an odd number of distinct parts contributes −1. (The article on unrestricted partition functions discusses this type of generating function.) For example, the coefficient of x 5 is +1 because there are two ways to split 5 into an even number of distinct parts (4 + 1 and 3 + 2), but only one way to do so for an odd number of distinct parts (the one-part partition 5). However, the coefficient of x 12 is −1 because there are seven ways to partition 12 into an even number of distinct parts, but there are eight ways to partition 12 into an odd number of distinct parts, and 7 − 8 = −1.

This interpretation leads to a proof of the identity by canceling pairs of matched terms ( involution method).

[ 1 ] Consider the Ferrers diagram of any partition of n into distinct parts.  For example, the diagram below shows n = 20 and the partition 20 = 7 + 6 + 4 + 3.

Let m be the number of elements in the smallest row of the diagram ( m = 3 in the above example). Let s be the number of elements in the rightmost 45 degree line of the diagram ( s = 2 dots in red above, since 7 − 1 = 6, but 6 − 1 > 4). If m > s , take the rightmost 45-degree line and move it to form a new row, as in the matching diagram below.

If m ≤ s (as in our newly formed diagram where m = 2, s = 5) we may reverse the process by moving the bottom row to form a new 45 degree line (adding 1 element to each of the first m rows), taking us back to the first diagram.

A bit of thought shows that this process always changes the parity of the number of rows, and applying the process twice brings us back to the original diagram.  This enables us to pair off Ferrers diagrams contributing 1 and −1 to the x n term of the series, resulting in a net coefficient of 0 for x n . This holds for every term except when the process cannot be performed on every Ferrers diagram with n dots.  There are two such cases: 1) m = s and the rightmost diagonal and bottom row meet.  For example, Attempting to perform the operation would lead us to: which fails to change the parity of the number of rows, and is not reversible in the sense that performing the operation again does not take us back to the original diagram.  If there are m elements in the last row of the original diagram, then n = m + ( m + 1 ) + ( m + 2 ) + ⋯ ⋯ + ( 2 m − − 1 ) = m ( 3 m − − 1 ) 2 = k ( 3 k − − 1 ) 2 {\displaystyle n=m+(m+1)+(m+2)+\cdots +(2m-1)={\frac {m(3m-1)}{2}}={\frac {k(3k-1)}{2}}} where the new index k is taken to equal m .  Note that the sign associated with this partition is (−1) s , which by construction equals (−1) m and (−1) k .

2) m = s + 1 and the rightmost diagonal and bottom row meet.  For example, Our operation requires us to move the right diagonal to the bottom row, but that would lead to two rows of three elements, forbidden since we're counting partitions into distinct parts.  This is the previous case but with one fewer row, so n = m + ( m + 1 ) + ( m + 2 ) + ⋯ ⋯ + ( 2 m − − 2 ) = ( m − − 1 ) ( 3 m − − 2 ) 2 = k ( 3 k − − 1 ) 2 , {\displaystyle n=m+(m+1)+(m+2)+\cdots +(2m-2)={\frac {(m-1)(3m-2)}{2}}={\frac {k(3k-1)}{2}},} where we take k = 1− m (a negative integer).  Here the associated sign is (−1) s with s = m − 1 = − k , therefore the sign is again (−1) k .

In summary, it has been shown that partitions into an even number of distinct parts and an odd number of distinct parts exactly cancel each other, producing null terms 0 x n , except if n is a generalized pentagonal number n = g k = k ( 3 k − − 1 ) / 2 {\displaystyle n=g_{k}=k(3k-1)/2} , in which case there is exactly one Ferrers diagram left over, producing a term (−1) k x n .  But this is precisely what the right side of the identity says should happen, so we are finished.

Partition recurrence We can rephrase the above proof, using integer partitions , which we denote as: n = λ λ 1 + λ λ 2 + ⋯ ⋯ + λ λ ℓ ℓ {\displaystyle n=\lambda _{1}+\lambda _{2}+\cdots +\lambda _{\ell }} , 
where λ λ 1 ≥ ≥ λ λ 2 ≥ ≥ … … ≥ ≥ λ λ ℓ ℓ > 0 {\displaystyle \lambda _{1}\geq \lambda _{2}\geq \ldots \geq \lambda _{\ell }>0} .
The number of partitions of n is the partition function p ( n ) having generating function: ∑ ∑ n = 0 ∞ ∞ p ( n ) x n = ∏ ∏ k = 1 ∞ ∞ ( 1 − − x k ) − − 1 {\displaystyle \sum _{n=0}^{\infty }p(n)x^{n}=\prod _{k=1}^{\infty }(1-x^{k})^{-1}} Note that is the reciprocal of the product on the left hand side of our identity: ( ∑ ∑ n = 0 ∞ ∞ p ( n ) x n ) ⋅ ⋅ ( ∏ ∏ n = 1 ∞ ∞ ( 1 − − x n ) ) = 1 {\displaystyle \left(\sum _{n=0}^{\infty }p(n)x^{n}\right)\cdot \left(\prod _{n=1}^{\infty }(1-x^{n})\right)=1} Let us denote the expansion of our product by ∏ ∏ n = 1 ∞ ∞ ( 1 − − x n ) = ∑ ∑ n = 0 ∞ ∞ a n x n , {\displaystyle \prod _{n=1}^{\infty }(1-x^{n})=\sum _{n=0}^{\infty }a_{n}x^{n},} so that ( ∑ ∑ n = 0 ∞ ∞ p ( n ) x n ) ⋅ ⋅ ( ∑ ∑ n = 0 ∞ ∞ a n x n ) = 1.

{\displaystyle \left(\sum _{n=0}^{\infty }p(n)x^{n}\right)\cdot \left(\sum _{n=0}^{\infty }a_{n}x^{n}\right)=1.} Multiplying out the left hand side and equating coefficients on the two sides, we obtain a 0 p (0) = 1 and ∑ ∑ i = 0 n p ( n − − i ) a i = 0 {\displaystyle \sum _{i=0}^{n}p(n-i)a_{i}=0} for all n ≥ ≥ 1 {\displaystyle n\geq 1} . This gives a recurrence relation defining p ( n ) in terms of a n , and vice versa a recurrence for a n in terms of p ( n ). Thus, our desired result: a i := { 1 if i = 1 2 ( 3 k 2 ± ± k ) and k is even − − 1 if i = 1 2 ( 3 k 2 ± ± k ) and k is odd 0 otherwise {\displaystyle a_{i}:={\begin{cases}1&{\text{ if }}i={\frac {1}{2}}(3k^{2}\pm k){\text{ and }}k{\text{ is even}}\\-1&{\text{ if }}i={\frac {1}{2}}(3k^{2}\pm k){\text{ and }}k{\text{ is odd }}\\0&{\text{ otherwise }}\end{cases}}} for i ≥ ≥ 1 {\displaystyle i\geq 1} is equivalent to the identity ∑ ∑ i ( − − 1 ) i p ( n − − g i ) = 0 , {\displaystyle \sum _{i}(-1)^{i}p(n-g_{i})=0,} where g i := 1 2 ( 3 i 2 − − i ) {\displaystyle g_{i}:=\textstyle {\frac {1}{2}}(3i^{2}-i)} and i ranges over all integers such that g i ≤ ≤ n {\displaystyle g_{i}\leq n} (this range includes both positive and negative i, so as to use both kinds of generalized pentagonal numbers). This in turn means: ∑ ∑ i e v e n p ( n − − g i ) = ∑ ∑ i o d d p ( n − − g i ) .

{\displaystyle \sum _{i\mathrm {\ even} }p(n-g_{i})=\sum _{i\mathrm {\ odd} }p(n-g_{i}).} In terms of sets of partitions, this is equivalent to saying that the following sets are of equal cardinality: X := ⋃ ⋃ i e v e n P ( n − − g i ) {\displaystyle {\mathcal {X}}:=\bigcup _{i\mathrm {\ even} }{\mathcal {P}}(n-g_{i})} and Y := ⋃ ⋃ i odd P ( n − − g i ) , {\displaystyle {\mathcal {Y}}:=\bigcup _{i{\text{ odd}}}{\mathcal {P}}(n-g_{i}),} where P ( n ) {\displaystyle {\mathcal {P}}(n)} denotes the set of all partitions of n {\displaystyle n} .
All that remains is to give a bijection from one set to the other, which is accomplished by the function φ from X to Y which maps the partition P ( n − − g i ) ∋ ∋ λ λ : n − − g i = λ λ 1 + λ λ 2 + ⋯ ⋯ + λ λ ℓ ℓ {\displaystyle {\mathcal {P}}(n-g_{i})\ni \lambda :n-g_{i}=\lambda _{1}+\lambda _{2}+\dotsb +\lambda _{\ell }} to the partition λ λ ′ = φ φ ( λ λ ) {\displaystyle \lambda '=\varphi (\lambda )} defined by: φ φ ( λ λ ) := { λ λ ′ : n − − g i − − 1 = ( ℓ ℓ + 3 i − − 2 ) + ( λ λ 1 − − 1 ) + ⋯ ⋯ + ( λ λ ℓ ℓ − − 1 ) if ℓ ℓ + 3 i > λ λ 1 λ λ ′ : n − − g i + 1 = ( λ λ 2 + 1 ) + ⋯ ⋯ + ( λ λ ℓ ℓ + 1 ) + 1 + ⋯ ⋯ + 1 ⏟ ⏟ λ λ 1 − − ℓ ℓ − − 3 i if ℓ ℓ + 3 i ≤ ≤ λ λ 1 .

{\displaystyle \varphi (\lambda ):={\begin{cases}\lambda ':n-g_{i-1}=(\ell +3i-2)+(\lambda _{1}-1)+\dotsb +(\lambda _{\ell }-1)&{\text{ if }}\ell +3i>\lambda _{1}\\\\\lambda ':n-g_{i+1}=(\lambda _{2}+1)+\dotsb +(\lambda _{\ell }+1)+\underbrace {1+\dotsb +1} _{\lambda _{1}-\ell -3i}&{\text{ if }}\ell +3i\leq \lambda _{1}.\end{cases}}} This is an involution (a self-inverse mapping), and thus in particular a bijection, which proves our claim and the identity.

See also The pentagonal number theorem occurs as a special case of the Jacobi triple product .

Q-series generalize Euler's function, which is closely related to the Dedekind eta function , and occurs in the study of modular forms . The modulus of the Euler function (see there for picture) shows the fractal modular group symmetry and occurs in the study of the interior of the Mandelbrot set .

References ^ Franklin, F. (1881). "Sur le developpement du produit (1 – x )(1 – x 2 )(1 − x 3 ) ...".

Comptes Rendus de l'Académie des Sciences, Série A .

92 : 448– 450.

Apostol, Tom M.

(1976), Introduction to analytic number theory , Undergraduate Texts in Mathematics, New York-Heidelberg: Springer-Verlag, ISBN 978-0-387-90163-3 , MR 0434929 , Zbl 0335.10001 Hardy, G. H.

; Wright, E. M.

(2008) [1938].

An Introduction to the Theory of Numbers . Revised by D. R. Heath-Brown and J. H. Silverman .  Foreword by Andrew Wiles . (6th ed.). Oxford: Oxford University Press .

ISBN 978-0-19-921986-5 .

MR 2445243 .

Zbl 1159.11001 .

External links Jordan Bell (2005). "Euler and the pentagonal number theorem".

arXiv : math.HO/0510054 .

On Euler's Pentagonal Theorem at MathPages OEIS sequence A000041 (a(n) = number of partitions of n (the partition numbers)) De mirabilis proprietatibus numerorum pentagonalium at Scholarly Commons.

Retrieved from " https://en.wikipedia.org/w/index.php?title=Pentagonal_number_theorem&oldid=1299665962 " Categories : Theorems in number theory Integer partitions Hidden categories: Articles with short description Short description is different from Wikidata Wikipedia pages semi-protected from banned users Articles containing proofs This page was last edited on 9 July 2025, at 18:14 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Pentagonal number theorem 11 languages Add topic

