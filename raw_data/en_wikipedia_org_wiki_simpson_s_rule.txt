Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Simpson's 1/3 rule Toggle Simpson's 1/3 rule subsection 1.1 Derivations 1.1.1 Quadratic interpolation 1.1.2 Averaging the midpoint and the trapezoidal rules 1.1.3 Undetermined coefficients 1.2 Composite Simpson's 1/3 rule 1.3 Numerical Example 2 Simpson's 3/8 rule Toggle Simpson's 3/8 rule subsection 2.1 Composite Simpson's 3/8 rule 3 Alternative extended Simpson's rule Toggle Alternative extended Simpson's rule subsection 3.1 Simpson's rules in the case of narrow peaks 4 Composite Simpson's rule for irregularly spaced data 5 See also 6 Notes 7 References 8 External links Toggle the table of contents Simpson's rule 28 languages العربية Беларуская (тарашкевіца) Català Čeština Dansk Deutsch Español فارسی Français Galego 한국어 Bahasa Indonesia Íslenska Italiano Lietuvių Magyar Nederlands 日本語 Norsk bokmål Polski Português Русский Српски / srpski Suomi Svenska Türkçe Українська 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikimedia Commons Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Method for numerical integration For Simpson's voting rule, see Minimax Condorcet .  For the rules in naval architecture, see Simpson's rules (ship stability) .

Simpson's rule can be derived by approximating the integrand f ( x ) (in blue) by the quadratic interpolant P ( x ) (in red) .

An animation showing how Simpson's rule approximates the function with a parabola and the reduction in error with decreased step size An animation showing how Simpson's rule approximation improves with more subdivisions.

In numerical integration , Simpson's rules are several approximations for definite integrals , named after Thomas Simpson (1710–1761).

The most basic of these rules, called Simpson's 1/3 rule , or just Simpson's rule , reads ∫ ∫ a b f ( x ) d x ≈ ≈ b − − a 6 [ f ( a ) + 4 f ( a + b 2 ) + f ( b ) ] .

{\displaystyle \int _{a}^{b}f(x)\,dx\approx {\frac {b-a}{6}}\left[f(a)+4f\left({\frac {a+b}{2}}\right)+f(b)\right].} In German and some other languages, it is named after Johannes Kepler , who derived it in 1615 after seeing it used for wine barrels (barrel rule, Keplersche Fassregel ). The approximate equality in the rule becomes exact if f is a polynomial up to and including 3rd degree.

If the 1/3 rule is applied to n equal subdivisions of the integration range [ a , b ], one obtains the composite Simpson's 1/3 rule . Points inside the integration range are given alternating weights 4/3 and 2/3.

Simpson's 3/8 rule , also called Simpson's second rule , requires one more function evaluation inside the integration range and gives lower error bounds, but does not improve the order of the error.

If the 3/8 rule is applied to n equal subdivisions of the integration range [ a , b ], one obtains the composite Simpson's 3/8 rule .

Simpson's 1/3 and 3/8 rules are two special cases of closed Newton–Cotes formulas .

In naval architecture and ship stability estimation, there also exists Simpson's third rule , which has no special importance in general numerical analysis , see Simpson's rules (ship stability) .

Simpson's 1/3 rule [ edit ] Simpson's 1/3 rule, also simply called Simpson's rule, is a method for numerical integration proposed by Thomas Simpson. It is based upon a quadratic interpolation and is the composite Simpson's 1/3 rule evaluated for n = 2 {\displaystyle n=2} . Simpson's 1/3 rule is as follows: ∫ ∫ a b f ( x ) d x ≈ ≈ b − − a 6 [ f ( a ) + 4 f ( a + b 2 ) + f ( b ) ] = 1 3 h [ f ( a ) + 4 f ( a + h ) + f ( b ) ] , {\displaystyle {\begin{aligned}\int _{a}^{b}f(x)\,dx&\approx {\frac {b-a}{6}}\left[f(a)+4f\left({\frac {a+b}{2}}\right)+f(b)\right]\\&={\frac {1}{3}}h\left[f(a)+4f\left(a+h\right)+f(b)\right],\end{aligned}}} where h = ( b − − a ) / n {\displaystyle h=(b-a)/n} is the step size for n = 2 {\displaystyle n=2} .

The error in approximating an integral by Simpson's rule for n = 2 {\displaystyle n=2} is − − 1 90 h 5 f ( 4 ) ( ξ ξ ) = − − ( b − − a ) 5 2880 f ( 4 ) ( ξ ξ ) , {\displaystyle -{\frac {1}{90}}h^{5}f^{(4)}(\xi )=-{\frac {(b-a)^{5}}{2880}}f^{(4)}(\xi ),} where ξ ξ {\displaystyle \xi } (the Greek letter xi ) is some number between a {\displaystyle a} and b {\displaystyle b} .

[ 1 ] [ 2 ] The error is asymptotically proportional to ( b − − a ) 5 {\displaystyle (b-a)^{5}} . However, the above derivations suggest an error proportional to ( b − − a ) 4 {\displaystyle (b-a)^{4}} . Simpson's rule gains an extra order because the points at which the integrand is evaluated are distributed symmetrically in the interval [ a , b ] {\displaystyle [a,\ b]} .

Since the error term is proportional to the fourth derivative of f {\displaystyle f} at ξ ξ {\displaystyle \xi } , this shows that Simpson's rule provides exact results for any polynomial f {\displaystyle f} of degree three or less, since the fourth derivative of such a polynomial is zero at all points. Another way to see this result is to note that any interpolating cubic polynomial can be expressed as the sum of the unique interpolating quadratic polynomial plus an arbitrarily scaled cubic polynomial that vanishes at all three points in the interval, and the integral of this second term vanishes because it is odd within the interval.

If the second derivative f ″ {\displaystyle f''} exists and is convex in the interval ( a , b ) {\displaystyle (a,\ b)} , then ( b − − a ) f ( a + b 2 ) + 1 3 ( b − − a 2 ) 3 f ″ ( a + b 2 ) ≤ ≤ ∫ ∫ a b f ( x ) d x ≤ ≤ b − − a 6 [ f ( a ) + 4 f ( a + b 2 ) + f ( b ) ] .

{\displaystyle (b-a)f\left({\frac {a+b}{2}}\right)+{\frac {1}{3}}\left({\frac {b-a}{2}}\right)^{3}f''\left({\frac {a+b}{2}}\right)\leq \int _{a}^{b}f(x)\,dx\leq {\frac {b-a}{6}}\left[f(a)+4f\left({\frac {a+b}{2}}\right)+f(b)\right].} Derivations [ edit ] Quadratic interpolation [ edit ] One derivation replaces the integrand f ( x ) {\displaystyle f(x)} by the quadratic polynomial (i.e. parabola) P ( x ) {\displaystyle P(x)} that takes the same values as f ( x ) {\displaystyle f(x)} at the end points a {\displaystyle a} and b {\displaystyle b} and the midpoint a + h {\displaystyle a+h} , where h = ( b − − a ) / 2 {\displaystyle h=(b-a)/2} . One can use Lagrange polynomial interpolation to find an expression for this polynomial, P ( x ) = f ( a ) ( x − − a − − h ) ( x − − b ) − − h ( a − − b ) + f ( a + h ) ( x − − a ) ( x − − b ) h ( a + h − − b ) + f ( b ) ( x − − a ) ( x − − a − − h ) ( b − − a ) ( b − − a − − h ) .

{\displaystyle P(x)=f(a){\frac {(x-a-h)(x-b)}{-h(a-b)}}+f(a+h){\frac {(x-a)(x-b)}{h(a+h-b)}}+f(b){\frac {(x-a)(x-a-h)}{(b-a)(b-a-h)}}.} Define: A 1 ( x ) = f ( a ) ( x − − a − − h ) ( x − − b ) − − h ( a − − b ) , {\displaystyle A_{1}(x)=f(a){\frac {(x-a-h)(x-b)}{-h(a-b)}},} A 2 ( x ) = f ( a + h ) ( x − − a ) ( x − − b ) h ( a + h − − b ) , {\displaystyle A_{2}(x)=f(a+h){\frac {(x-a)(x-b)}{h(a+h-b)}},} and A 3 ( x ) = f ( b ) ( x − − a ) ( x − − a − − h ) ( b − − a ) ( b − − a − − h ) .

{\displaystyle A_{3}(x)=f(b){\frac {(x-a)(x-a-h)}{(b-a)(b-a-h)}}.} By making the substitution u = x − − a − − h {\displaystyle u=x-a-h} , one can calculate: ∫ ∫ a b A 1 ( x ) d x = ∫ ∫ − − h h A 1 ( u ) d u = f ( a ) ( ∫ ∫ − − h h u ( u − − h ) 2 h 2 d u ) = f ( a ) 2 h 2 ( ∫ ∫ − − h h u 2 − − h u d u ) = f ( a ) 2 h 2 [ 1 3 u 3 − − 1 2 h u 2 ] u = − − h u = h = f ( a ) 2 h 2 [ ( 1 3 h 3 − − 1 2 h 3 ) − − ( − − 1 3 h 3 − − 1 2 h 3 ) ] = f ( a ) 2 h 2 ( 1 3 h 3 − − 1 2 h 3 + 1 3 h 3 + 1 2 h 3 ) = f ( a ) 2 h 2 ( 2 3 h 3 ) = h 3 f ( a ) .

{\displaystyle {\begin{aligned}\int _{a}^{b}A_{1}(x)\,dx=&\int _{-h}^{h}A_{1}(u)\,du\\&=f(a)\left(\int _{-h}^{h}{\frac {u(u-h)}{2h^{2}}}\,du\right)\\&={\frac {f(a)}{2h^{2}}}\left(\int _{-h}^{h}u^{2}-hu\,du\right)\\&={\frac {f(a)}{2h^{2}}}\left[{\frac {1}{3}}u^{3}-{\frac {1}{2}}hu^{2}\right]_{u=-h}^{u=h}\\&={\frac {f(a)}{2h^{2}}}\left[\left({\frac {1}{3}}h^{3}-{\frac {1}{2}}h^{3}\right)-\left(-{\frac {1}{3}}h^{3}-{\frac {1}{2}}h^{3}\right)\right]\\&={\frac {f(a)}{2h^{2}}}\left({\frac {1}{3}}h^{3}-{\frac {1}{2}}h^{3}+{\frac {1}{3}}h^{3}+{\frac {1}{2}}h^{3}\right)\\&={\frac {f(a)}{2h^{2}}}\left({\frac {2}{3}}h^{3}\right)\\&={\frac {h}{3}}f(a).\end{aligned}}} ∫ ∫ a b A 2 ( x ) d x = ∫ ∫ − − h h A 2 ( u ) d u = f ( a + h ) ( ∫ ∫ − − h h ( u + h ) ( u + a + h − − b ) h ( a + h − − b ) d u ) = f ( a + h ) ( ∫ ∫ − − h h ( u + h ) ( u − − h ) − − h 2 d u ) = − − f ( a + h ) h 2 ( ∫ ∫ − − h h u 2 − − h 2 d u ) = − − f ( a + h ) h 2 [ 1 3 u 3 − − h 2 u ] u = − − h u = h = − − f ( a + h ) h 2 [ 1 3 h 3 − − h 3 − − ( − − 1 3 h 3 + h 3 ) ] = − − f ( a + h ) h 2 ( − − 2 3 h 3 + 1 3 h 3 − − h 3 ) = − − f ( a + h ) h 2 ( − − 4 3 h 3 ) = 4 h 3 f ( a + h ) .

{\displaystyle {\begin{aligned}\int _{a}^{b}A_{2}(x)\,dx=&\int _{-h}^{h}A_{2}(u)\,du\\&=f(a+h)\left(\int _{-h}^{h}{\frac {(u+h)(u+a+h-b)}{h(a+h-b)}}\,du\right)\\&=f(a+h)\left(\int _{-h}^{h}{\frac {(u+h)(u-h)}{-h^{2}}}\,du\right)\\&=-{\frac {f(a+h)}{h^{2}}}\left(\int _{-h}^{h}u^{2}-h^{2}\,du\right)\\&=-{\frac {f(a+h)}{h^{2}}}\left[{\frac {1}{3}}u^{3}-h^{2}u\right]_{u=-h}^{u=h}\\&=-{\frac {f(a+h)}{h^{2}}}\left[{\frac {1}{3}}h^{3}-h^{3}-\left(-{\frac {1}{3}}h^{3}+h^{3}\right)\right]\\&=-{\frac {f(a+h)}{h^{2}}}\left(-{\frac {2}{3}}h^{3}+{\frac {1}{3}}h^{3}-h^{3}\right)\\&=-{\frac {f(a+h)}{h^{2}}}\left({\frac {-4}{3}}h^{3}\right)\\&={\frac {4h}{3}}f(a+h).\end{aligned}}} ∫ ∫ a b A 3 ( x ) d x = ∫ ∫ − − h h A 3 ( u ) d u = f ( b ) ( ∫ ∫ − − h h u ( u + h ) ( b − − a ) ( b − − a − − h ) d u ) = f ( b ) ( ∫ ∫ − − h h u ( u + h ) 2 h 2 d u ) = f ( b ) 2 h 2 ( ∫ ∫ − − h h u 2 + h u d u ) = f ( b ) 2 h 2 [ 1 3 u 3 + 1 2 h u 2 ] u = − − h u = h = f ( b ) 2 h 2 [ 1 3 h 3 + 1 2 h 3 − − ( − − 1 3 h 3 + 1 2 h 3 ) ] = f ( b ) 2 h 2 ( 5 6 h 3 − − 1 6 h 3 ) = f ( b ) 2 h 2 ( 2 3 h 3 ) = h 3 f ( b ) .

{\displaystyle {\begin{aligned}\int _{a}^{b}A_{3}(x)\,dx=&\int _{-h}^{h}A_{3}(u)\,du\\&=f(b)\left(\int _{-h}^{h}{\frac {u(u+h)}{(b-a)(b-a-h)}}\,du\right)\\&=f(b)\left(\int _{-h}^{h}{\frac {u(u+h)}{2h^{2}}}\,du\right)\\&={\frac {f(b)}{2h^{2}}}\left(\int _{-h}^{h}u^{2}+hu\,du\right)\\&={\frac {f(b)}{2h^{2}}}\left[{\frac {1}{3}}u^{3}+{\frac {1}{2}}hu^{2}\right]_{u=-h}^{u=h}\\&={\frac {f(b)}{2h^{2}}}\left[{\frac {1}{3}}h^{3}+{\frac {1}{2}}h^{3}-\left(-{\frac {1}{3}}h^{3}+{\frac {1}{2}}h^{3}\right)\right]\\&={\frac {f(b)}{2h^{2}}}\left({\frac {5}{6}}h^{3}-{\frac {1}{6}}h^{3}\right)\\&={\frac {f(b)}{2h^{2}}}\left({\frac {2}{3}}h^{3}\right)\\&={\frac {h}{3}}f(b).\end{aligned}}} Therefore, ∫ ∫ a b f ( x ) d x ≈ ≈ ∫ ∫ a b P ( x ) d x = ∫ ∫ a b A 1 ( x ) d x + ∫ ∫ a b A 2 ( x ) d x + ∫ ∫ a b A 3 ( x ) d x = h 3 f ( a ) + 4 h 3 f ( a + h ) + h 3 f ( b ) = 1 3 h [ f ( a ) + 4 f ( a + h ) + f ( b ) ] .

{\displaystyle {\begin{aligned}\int _{a}^{b}f(x)\,dx\approx &\int _{a}^{b}P(x)\,dx\\&=\int _{a}^{b}A_{1}(x)\,dx+\int _{a}^{b}A_{2}(x)\,dx+\int _{a}^{b}A_{3}(x)\,dx\\&={\frac {h}{3}}f(a)+{\frac {4h}{3}}f(a+h)+{\frac {h}{3}}f(b)\\&={\frac {1}{3}}h\left[f(a)+4f(a+h)+f(b)\right].\end{aligned}}} Because of the 1 / 3 {\displaystyle 1/3} factor, Simpson's rule is also referred to as "Simpson's 1/3 rule" (see below for generalization).

Averaging the midpoint and the trapezoidal rules [ edit ] Another derivation constructs Simpson's rule from two simpler approximations: the midpoint rule M = ( b − − a ) f ( a + b 2 ) {\displaystyle M=(b-a)f\left({\frac {a+b}{2}}\right)} and the trapezoidal rule T = 1 2 ( b − − a ) ( f ( a ) + f ( b ) ) .

{\displaystyle T={\frac {1}{2}}(b-a){\big (}f(a)+f(b){\big )}.} The errors in these approximations are 1 24 ( b − − a ) 3 f ″ ( a ) + O ( ( b − − a ) 4 ) {\displaystyle {\frac {1}{24}}(b-a)^{3}f''(a)+O{\big (}(b-a)^{4}{\big )}} and − − 1 12 ( b − − a ) 3 f ″ ( a ) + O ( ( b − − a ) 4 ) {\displaystyle -{\frac {1}{12}}(b-a)^{3}f''(a)+O{\big (}(b-a)^{4}{\big )}} respectively, where O ( ( b − − a ) 4 ) {\displaystyle O{\big (}(b-a)^{4}{\big )}} denotes a term asymptotically proportional to ( b − − a ) 4 {\displaystyle (b-a)^{4}} . The two O ( ( b − − a ) 4 ) {\displaystyle O{\big (}(b-a)^{4}{\big )}} terms are not equal; see Big O notation for more details. It follows from the above formulas for the errors of the midpoint and trapezoidal rule that the leading error term vanishes if we take the weighted average 2 M + T 3 .

{\displaystyle {\frac {2M+T}{3}}.} This weighted average is exactly Simpson's rule.

Using another approximation (for example, the trapezoidal rule with twice as many points), it is possible to take a suitable weighted average and eliminate another error term. This is Romberg's method .

Undetermined coefficients [ edit ] The third derivation starts from the ansatz 1 b − − a ∫ ∫ a b f ( x ) d x ≈ ≈ α α f ( a ) + β β f ( a + b 2 ) + γ γ f ( b ) .

{\displaystyle {\frac {1}{b-a}}\int _{a}^{b}f(x)\,dx\approx \alpha f(a)+\beta f\left({\frac {a+b}{2}}\right)+\gamma f(b).} The coefficients α , β and γ can be fixed by requiring that this approximation be exact for all quadratic polynomials. This yields Simpson's rule. (This derivation is essentially a less rigorous version of the quadratic interpolation derivation, where one saves significant calculation effort by guessing the correct functional form.) Composite Simpson's 1/3 rule [ edit ] If the interval of integration [ a , b ] {\displaystyle [a,b]} is in some sense "small", then Simpson's rule with n = 2 {\displaystyle n=2} subintervals will provide an adequate approximation to the exact integral. By "small" we mean that the function being integrated is relatively smooth over the interval [ a , b ] {\displaystyle [a,b]} . For such a function, a smooth quadratic interpolant like the one used in Simpson's rule will give good results.

However, it is often the case that the function we are trying to integrate is not smooth over the interval. Typically, this means that either the function is highly oscillatory or lacks derivatives at certain points. In these cases, Simpson's rule may give very poor results. One common way of handling this problem is by breaking up the interval [ a , b ] {\displaystyle [a,b]} into n > 2 {\displaystyle n>2} small subintervals. Simpson's rule is then applied to each subinterval, with the results being summed to produce an approximation for the integral over the entire interval. This sort of approach is termed the composite Simpson's 1/3 rule , or just composite Simpson's rule .

Suppose that the interval [ a , b ] {\displaystyle [a,b]} is split up into n {\displaystyle n} subintervals, with n {\displaystyle n} an even number . Then, the composite Simpson's rule is given by Dividing the interval [ a , b ] {\displaystyle [a,b]} into n {\displaystyle n} subintervals of length h = ( b − − a ) / n {\displaystyle h=(b-a)/n} and introducing the points x i = a + i h {\displaystyle x_{i}=a+ih} for 0 ≤ ≤ i ≤ ≤ n {\displaystyle 0\leq i\leq n} (in particular, x 0 = a {\displaystyle x_{0}=a} and x n = b {\displaystyle x_{n}=b} ), we have ∫ ∫ a b f ( x ) d x ≈ ≈ 1 3 h ∑ ∑ i = 1 n / 2 [ f ( x 2 i − − 2 ) + 4 f ( x 2 i − − 1 ) + f ( x 2 i ) ] = 1 3 h [ f ( x 0 ) + 4 f ( x 1 ) + 2 f ( x 2 ) + 4 f ( x 3 ) + 2 f ( x 4 ) + ⋯ ⋯ + 2 f ( x n − − 2 ) + 4 f ( x n − − 1 ) + f ( x n ) ] = 1 3 h [ f ( x 0 ) + 4 ∑ ∑ i = 1 n / 2 f ( x 2 i − − 1 ) + 2 ∑ ∑ i = 1 n / 2 − − 1 f ( x 2 i ) + f ( x n ) ] .

{\displaystyle {\begin{aligned}\int _{a}^{b}f(x)\,dx&\approx {\frac {1}{3}}h\sum _{i=1}^{n/2}{\big [}f(x_{2i-2})+4f(x_{2i-1})+f(x_{2i}){\big ]}\\&={\frac {1}{3}}h{\big [}f(x_{0})+4f(x_{1})+2f(x_{2})+4f(x_{3})+2f(x_{4})+\dots +2f(x_{n-2})+4f(x_{n-1})+f(x_{n}){\big ]}\\&={\frac {1}{3}}h\left[f(x_{0})+4\sum _{i=1}^{n/2}f(x_{2i-1})+2\sum _{i=1}^{n/2-1}f(x_{2i})+f(x_{n})\right].\end{aligned}}} This composite rule with n = 2 {\displaystyle n=2} corresponds with the regular Simpson's rule of the preceding section.

The error committed by the composite Simpson's rule is − − 1 180 h 4 ( b − − a ) f ( 4 ) ( ξ ξ ) , {\displaystyle -{\frac {1}{180}}h^{4}(b-a)f^{(4)}(\xi ),} where ξ ξ {\displaystyle \xi } is some number between a {\displaystyle a} and b {\displaystyle b} , and h = ( b − − a ) / n {\displaystyle h=(b-a)/n} is the "step length".

[ 3 ] [ 4 ] The error is bounded (in absolute value ) by 1 180 h 4 ( b − − a ) max ξ ξ ∈ ∈ [ a , b ] | f ( 4 ) ( ξ ξ ) | .

{\displaystyle {\frac {1}{180}}h^{4}(b-a)\max _{\xi \in [a,b]}\left|f^{(4)}(\xi )\right|.} This formulation splits the interval [ a , b ] {\displaystyle [a,b]} in subintervals of equal length. In practice, it is often advantageous to use subintervals of different lengths and concentrate the efforts on the places where the integrand is less well-behaved. This leads to the adaptive Simpson's method .

Numerical Example [ edit ] Consider the integral ∫ ∫ − − 1 2 6 x 2 + 1 d x {\displaystyle \int _{-1}^{2}{\frac {6}{x^{2}+1}}\,dx} . This can be calculated analytically as ∫ ∫ − − 1 2 6 x 2 + 1 d x = 6 [ arctan ⁡ ⁡ ( x ) ] ˙ ˙ x = − − 1 x = 2 = 6 [ arctan ⁡ ⁡ ( 2 ) − − arctan ⁡ ⁡ ( − − 1 ) ] ˙ ˙ ≈ ≈ 11.35528.

{\displaystyle {\begin{aligned}\int _{-1}^{2}{\frac {6}{x^{2}+1}}\,dx&=6{\dot {\left[\arctan(x)\right]}}_{x=-1}^{x=2}\\&=6{\dot {\left[\arctan(2)-\arctan(-1)\right]}}\\&\approx 11.35528.\end{aligned}}} Applying Composite Simpson's 1/3 rule with n = 6 {\displaystyle n=6} intervals gives ∫ ∫ − − 1 2 6 x 2 + 1 d x ≈ ≈ 1 6 ( 3 + 96 5 + 12 + 96 5 + 6 + 96 13 + 6 5 ) ˙ ˙ ≈ ≈ 11.33076 {\displaystyle {\begin{aligned}\int _{-1}^{2}{\frac {6}{x^{2}+1}}\,dx&\approx {\frac {1}{6}}{\dot {\left(3+{\frac {96}{5}}+12+{\frac {96}{5}}+6+{\frac {96}{13}}+{\frac {6}{5}}\right)}}\\&\approx 11.33076\end{aligned}}} which has a relative error of about 0.21 % % {\displaystyle 0.21\%} .

Approximating the integral using the same number of intervals via the Trapezoidal Rule results in an approximation of 11.27307 {\displaystyle 11.27307} , which has a higher relative error of 0.72 % % {\displaystyle 0.72\%} .

Simpson's 3/8 rule [ edit ] Simpson's 3/8 rule, also called Simpson's second rule, is another method for numerical integration proposed by Thomas Simpson. It is based upon a cubic interpolation rather than a quadratic interpolation. Simpson's 3/8 rule is as follows: ∫ ∫ a b f ( x ) d x ≈ ≈ b − − a 8 [ f ( a ) + 3 f ( 2 a + b 3 ) + 3 f ( a + 2 b 3 ) + f ( b ) ] = 3 8 h [ f ( a ) + 3 f ( a + h ) + 3 f ( a + 2 h ) + f ( b ) ] , {\displaystyle {\begin{aligned}\int _{a}^{b}f(x)\,dx&\approx {\frac {b-a}{8}}\left[f(a)+3f\left({\frac {2a+b}{3}}\right)+3f\left({\frac {a+2b}{3}}\right)+f(b)\right]\\&={\frac {3}{8}}h\left[f(a)+3f\left(a+h\right)+3f\left(a+2h\right)+f(b)\right],\end{aligned}}} where h = ( b − − a ) / 3 {\displaystyle h=(b-a)/3} is the step size.

The error of this method is − − 3 80 h 5 f ( 4 ) ( ξ ξ ) = − − ( b − − a ) 5 6480 f ( 4 ) ( ξ ξ ) , {\displaystyle -{\frac {3}{80}}h^{5}f^{(4)}(\xi )=-{\frac {(b-a)^{5}}{6480}}f^{(4)}(\xi ),} where ξ ξ {\displaystyle \xi } is some number between a {\displaystyle a} and b {\displaystyle b} . Thus, the 3/8 rule is about twice as accurate as the standard method, but it uses one more function value. A composite 3/8 rule also exists, similarly as above.

[ 5 ] A further generalization of this concept for interpolation with arbitrary-degree polynomials are the Newton–Cotes formulas .

Composite Simpson's 3/8 rule [ edit ] Dividing the interval [ a , b ] {\displaystyle [a,b]} into n {\displaystyle n} subintervals of length h = ( b − − a ) / n {\displaystyle h=(b-a)/n} and introducing the points x i = a + i h {\displaystyle x_{i}=a+ih} for 0 ≤ ≤ i ≤ ≤ n {\displaystyle 0\leq i\leq n} (in particular, x 0 = a {\displaystyle x_{0}=a} and x n = b {\displaystyle x_{n}=b} ), we have ∫ ∫ a b f ( x ) d x ≈ ≈ 3 8 h ∑ ∑ i = 1 n / 3 [ f ( x 3 i − − 3 ) + 3 f ( x 3 i − − 2 ) + 3 f ( x 3 i − − 1 ) + f ( x 3 i ) ] = 3 8 h [ f ( x 0 ) + 3 f ( x 1 ) + 3 f ( x 2 ) + 2 f ( x 3 ) + 3 f ( x 4 ) + 3 f ( x 5 ) + 2 f ( x 6 ) + … … + 2 f ( x n − − 3 ) + 3 f ( x n − − 2 ) + 3 f ( x n − − 1 ) + f ( x n ) ] = 3 8 h [ f ( x 0 ) + 3 ∑ ∑ i = 1 , 3 ∤ ∤ i n − − 1 f ( x i ) + 2 ∑ ∑ i = 1 n / 3 − − 1 f ( x 3 i ) + f ( x n ) ] .

{\displaystyle {\begin{aligned}\int _{a}^{b}f(x)\,dx&\approx {\frac {3}{8}}h\sum _{i=1}^{n/3}{\big [}f(x_{3i-3})+3f(x_{3i-2})+3f(x_{3i-1})+f(x_{3i}){\big ]}\\&={\frac {3}{8}}h{\big [}f(x_{0})+3f(x_{1})+3f(x_{2})+2f(x_{3})+3f(x_{4})+3f(x_{5})+2f(x_{6})+\dots \\&\qquad +2f(x_{n-3})+3f(x_{n-2})+3f(x_{n-1})+f(x_{n}){\big ]}\\&={\frac {3}{8}}h\left[f(x_{0})+3\sum _{i=1,\ 3\nmid i}^{n-1}f(x_{i})+2\sum _{i=1}^{n/3-1}f(x_{3i})+f(x_{n})\right].\end{aligned}}} While the remainder for the rule is shown as [ 5 ] − − 1 80 h 4 ( b − − a ) f ( 4 ) ( ξ ξ ) , {\displaystyle -{\frac {1}{80}}h^{4}(b-a)f^{(4)}(\xi ),} we can only use this if n {\displaystyle n} is a multiple of three. The 1/3 rule can be used for the remaining subintervals without changing the order of the error term (conversely, the 3/8 rule can be used with a composite 1/3 rule for odd-numbered subintervals).

Alternative extended Simpson's rule [ edit ] This is another formulation of a composite Simpson's rule: instead of applying Simpson's rule to disjoint segments of the integral to be approximated, Simpson's rule is applied to overlapping segments, yielding [ 6 ] ∫ ∫ a b f ( x ) d x ≈ ≈ 1 48 h [ 17 f ( x 0 ) + 59 f ( x 1 ) + 43 f ( x 2 ) + 49 f ( x 3 ) + 48 ∑ ∑ i = 4 n − − 4 f ( x i ) + 49 f ( x n − − 3 ) + 43 f ( x n − − 2 ) + 59 f ( x n − − 1 ) + 17 f ( x n ) ] {\displaystyle {\begin{aligned}\int _{a}^{b}f(x)\,dx\approx {\frac {1}{48}}h{\bigg [}&17f(x_{0})+59f(x_{1})+43f(x_{2})+49f(x_{3})\\+&48\sum _{i=4}^{n-4}f(x_{i})\\+&49f(x_{n-3})+43f(x_{n-2})+59f(x_{n-1})+17f(x_{n}){\bigg ]}\end{aligned}}} The formula above is obtained by combining the composite Simpson's 1/3 rule with the one consisting of using Simpson's 3/8 rule in the extreme subintervals and Simpson's 1/3 rule in the remaining subintervals. The result is then obtained by taking the mean of the two formulas.

Simpson's rules in the case of narrow peaks [ edit ] In the task of estimation of full area of narrow peak-like functions, Simpson's rules are much less efficient than trapezoidal rule . Namely, composite Simpson's 1/3 rule requires 1.8 times more points to achieve the same accuracy as trapezoidal rule.

[ 7 ] Composite Simpson's 3/8 rule is even less accurate. Integration by Simpson's 1/3 rule can be represented as a weighted average with 2/3 of the value coming from integration by the trapezoidal rule with step h and 1/3 of the value coming from integration by the rectangle rule with step 2 h . The accuracy is governed by the second (2 h step) term. Averaging of Simpson's 1/3 rule composite sums with properly shifted frames produces the following rules: ∫ ∫ a b f ( x ) d x ≈ ≈ 1 24 h [ − − f ( x − − 1 ) + 12 f ( x 0 ) + 25 f ( x 1 ) + 24 ∑ ∑ i = 2 n − − 2 f ( x i ) + 25 f ( x n − − 1 ) + 12 f ( x n ) − − f ( x n + 1 ) ] , {\displaystyle \int _{a}^{b}f(x)\,dx\approx {\frac {1}{24}}h\left[-f(x_{-1})+12f(x_{0})+25f(x_{1})+24\sum _{i=2}^{n-2}f(x_{i})+25f(x_{n-1})+12f(x_{n})-f(x_{n+1})\right],} where two points outside of the integrated region are exploited, and ∫ ∫ a b f ( x ) d x ≈ ≈ 1 24 h [ 9 f ( x 0 ) + 28 f ( x 1 ) + 23 f ( x 2 ) + 24 ∑ ∑ i = 3 n − − 3 f ( x i ) + 23 f ( x n − − 2 ) + 28 f ( x n − − 1 ) + 9 f ( x n ) ] , {\displaystyle \int _{a}^{b}f(x)\,dx\approx {\frac {1}{24}}h\left[9f(x_{0})+28f(x_{1})+23f(x_{2})+24\sum _{i=3}^{n-3}f(x_{i})+23f(x_{n-2})+28f(x_{n-1})+9f(x_{n})\right],} where only points within integration region are used. Application of the second rule to the region of 3 points generates 1/3 Simpson's rule, 4 points - 3/8 rule.

These rules are very much similar to the alternative extended Simpson's rule. The coefficients within the major part of the region being integrated are one with non-unit coefficients only at the edges. These two rules can be associated with Euler–MacLaurin formula with the first derivative term and named First order Euler–MacLaurin integration rules .

[ 7 ] The two rules presented above differ only in the way how the first derivative at the region end is calculated. The first derivative term in the Euler–MacLaurin integration rules accounts for integral of the second derivative , which equals the difference of the first derivatives at the edges of the integration region. It is possible to generate higher order Euler–Maclaurin rules by adding a difference of 3rd, 5th, and so on derivatives with coefficients, as defined by Euler–MacLaurin formula .

Composite Simpson's rule for irregularly spaced data [ edit ] For some applications, the integration interval I = [ a , b ] {\displaystyle I=[a,b]} needs to be divided into uneven intervals – perhaps due to uneven sampling of data, or missing or corrupted data points. Suppose we divide the interval I {\displaystyle I} into an even number N {\displaystyle N} of subintervals of widths h k {\displaystyle h_{k}} . Then the composite Simpson's rule is given by [ 8 ] ∫ ∫ a b f ( x ) d x ≈ ≈ ∑ ∑ i = 0 N / 2 − − 1 h 2 i + h 2 i + 1 6 [ ( 2 − − h 2 i + 1 h 2 i ) f 2 i + ( h 2 i + h 2 i + 1 ) 2 h 2 i h 2 i + 1 f 2 i + 1 + ( 2 − − h 2 i h 2 i + 1 ) f 2 i + 2 ] , {\displaystyle \int _{a}^{b}f(x)\,dx\approx \sum _{i=0}^{N/2-1}{\frac {h_{2i}+h_{2i+1}}{6}}\left[\left(2-{\frac {h_{2i+1}}{h_{2i}}}\right)f_{2i}+{\frac {(h_{2i}+h_{2i+1})^{2}}{h_{2i}h_{2i+1}}}f_{2i+1}+\left(2-{\frac {h_{2i}}{h_{2i+1}}}\right)f_{2i+2}\right],} where f k = f ( a + ∑ ∑ i = 0 k − − 1 h i ) {\displaystyle f_{k}=f\left(a+\sum _{i=0}^{k-1}h_{i}\right)} are the function values at the k {\displaystyle k} th sampling point on the interval I {\displaystyle I} .

In case of an odd number N {\displaystyle N} of subintervals , the above formula is used up to the second to last interval, 
and the last interval is handled separately by adding the following to the result: [ 9 ] α α f N + β β f N − − 1 − − η η f N − − 2 , {\displaystyle \alpha f_{N}+\beta f_{N-1}-\eta f_{N-2},} where α α = 2 h N − − 1 2 + 3 h N − − 1 h N − − 2 6 ( h N − − 2 + h N − − 1 ) , β β = h N − − 1 2 + 3 h N − − 1 h N − − 2 6 h N − − 2 , η η = h N − − 1 3 6 h N − − 2 ( h N − − 2 + h N − − 1 ) .

{\displaystyle {\begin{aligned}\alpha &={\frac {2h_{N-1}^{2}+3h_{N-1}h_{N-2}}{6(h_{N-2}+h_{N-1})}},\\[1ex]\beta &={\frac {h_{N-1}^{2}+3h_{N-1}h_{N-2}}{6h_{N-2}}},\\[1ex]\eta &={\frac {h_{N-1}^{3}}{6h_{N-2}(h_{N-2}+h_{N-1})}}.\end{aligned}}} Example implementation in Python from collections.abc import Sequence def simpson_nonuniform ( x : Sequence [ float ], f : Sequence [ float ]) -> float : """ Simpson rule for irregularly spaced data.

:param x: Sampling points for the function values :param f: Function values at the sampling points :return: approximation for the integral See ``scipy.integrate.simpson`` and the underlying ``_basic_simpson`` for a more performant implementation utilizing numpy's broadcast.

""" N = len ( x ) - 1 h = [ x [ i + 1 ] - x [ i ] for i in range ( 0 , N )] assert N > 0 result = 0.0 for i in range ( 1 , N , 2 ): h0 , h1 = h [ i - 1 ], h [ i ] hph , hdh , hmh = h1 + h0 , h1 / h0 , h1 * h0 result += ( hph / 6 ) * ( ( 2 - hdh ) * f [ i - 1 ] + ( hph ** 2 / hmh ) * f [ i ] + ( 2 - 1 / hdh ) * f [ i + 1 ] ) if N % 2 == 1 : h0 , h1 = h [ N - 2 ], h [ N - 1 ] result += f [ N ] * ( 2 * h1 ** 2 + 3 * h0 * h1 ) / ( 6 * ( h0 + h1 )) result += f [ N - 1 ] * ( h1 ** 2 + 3 * h1 * h0 ) / ( 6 * h0 ) result -= f [ N - 2 ] * h1 ** 3 / ( 6 * h0 * ( h0 + h1 )) return result Example implementation in R SimpsonInt <- function ( fx , dx ) { n <- length ( dx ) h <- diff ( dx ) stopifnot ( exprs = { length ( fx ) == n all ( h >= 0 ) }) res <- 0 for ( i in seq ( 1L , n - 2L , 2L )) { hph <- h [ i ] + h [ i + 1L ] hdh <- h [ i + 1L ] / h [ i ] res <- res + hph / 6 * (( 2 - hdh ) * fx [ i ] + hph ^ 2 / ( h [ i ] * h [ i + 1L ]) * fx [ i + 1L ] + ( 2 - 1 / hdh ) * fx [ i + 2L ]) } if ( n %% 2 == 0 ) { hph <- h [ n - 1L ] + h [ n - 2L ] threehth <- 3 * h [ n - 1L ] * h [ n - 2L ] sixh2 <- 6 * h [ n - 2L ] h1sq <- h [ n - 1L ] ^ 2 res <- res + ( 2 * h1sq + threehth ) / ( 6 * hph ) * fx [ n ] + ( h1sq + threehth ) / sixh2 * fx [ n - 1L ] - ( h1sq * h [ n - 1L ]) / ( sixh2 * hph ) * fx [ n - 2L ] } res } See also [ edit ] Newton–Cotes formulas Gaussian quadrature Notes [ edit ] ^ Atkinson 1989 , equation (5.1.15).

^ Süli & Mayers 2003 , §7.2.

^ Atkinson 1989 , pp. 257–258.

^ Süli & Mayers 2003 , §7.5.

^ a b Matthews 2004 .

^ Weisstein , Equation 35.

^ a b Kalambet, Kozmin & Samokhin 2018 .

^ Shklov 1960 .

^ Cartwright 2017 , Equation 8. The equation in Cartwright is calculating the first interval whereas the equations in the Wikipedia article are adjusting for the last integral. If the proper algebraic substitutions are made, the equation results in the values shown.

References [ edit ] Atkinson, Kendall E. (1989).

An Introduction to Numerical Analysis (2nd ed.). John Wiley & Sons.

ISBN 0-471-50023-2 .

Burden, Richard L.; Faires, J. Douglas (2000).

Numerical Analysis (7th ed.). Brooks/Cole.

ISBN 0-534-38216-9 .

Cartwright, Kenneth V. (September 2017).

"Simpson's Rule Cumulative Integration with MS Excel and Irregularly-spaced Data" (PDF) .

Journal of Mathematical Sciences and Mathematics Education .

12 (2): 1– 9 . Retrieved 18 December 2022 .

Kalambet, Yuri; Kozmin, Yuri; Samokhin, Andrey (2018). "Comparison of integration rules in the case of very narrow chromatographic peaks".

Chemometrics and Intelligent Laboratory Systems .

179 : 22– 30.

doi : 10.1016/j.chemolab.2018.06.001 .

ISSN 0169-7439 .

Matthews, John H. (2004).

"Simpson's 3/8 Rule for Numerical Integration" .

Numerical Analysis - Numerical Methods Project . California State University, Fullerton. Archived from the original on 4 December 2008 . Retrieved 11 November 2008 .

Shklov, N. (December 1960). "Simpson's Rule for Unequally Spaced Ordinates".

The American Mathematical Monthly .

67 (10): 1022– 1023.

doi : 10.2307/2309244 .

JSTOR 2309244 .

Süli, Endre; Mayers, David (2003).

An Introduction to Numerical Analysis . Cambridge University Press.

ISBN 0-521-00794-1 .

Weisstein, Eric W.

"Newton-Cotes Formulas" .

MathWorld . Retrieved 14 December 2022 .

External links [ edit ] "Simpson formula" .

Encyclopedia of Mathematics .

EMS Press . 2001 [1994].

Weisstein, Eric W.

"Simpson's Rule" .

MathWorld .

Simpson's 1/3rd rule of integration — Notes, PPT, Mathcad, Matlab, Mathematica, Maple at Numerical Methods for STEM undergraduate A detailed description of a computer implementation is described by Dorai Sitaram in Teach Yourself Scheme in Fixnum Days , Appendix C v t e Numerical integration Newton–Cotes formulas Trapezoidal rule Simpson's rule Simpson's 3/8 rule Adaptive Simpson's method Boole's rule Romberg's method Gaussian quadrature Gauss–Hermite quadrature Gauss–Jacobi quadrature Gauss–Kronrod quadrature formula Gauss–Laguerre quadrature Gauss–Legendre quadrature Chebyshev–Gauss quadrature Other Barnes–Hut simulation Bayesian quadrature Clenshaw–Curtis quadrature Filon quadrature Lebedev quadrature Tanh-sinh quadrature Related Numerical methods for ordinary differential equations Numerical methods for partial differential equations This article incorporates material from Code for Simpson's rule on PlanetMath , which is licensed under the Creative Commons Attribution/Share-Alike License .

Retrieved from " https://en.wikipedia.org/w/index.php?title=Simpson%27s_rule&oldid=1305018771 " Categories : Integral calculus Numerical integration Numerical analysis Hidden categories: Articles with short description Short description is different from Wikidata Use dmy dates from January 2020 Articles containing German-language text Wikipedia articles incorporating text from PlanetMath Articles with example Python (programming language) code Articles with example R code Pages that use a deprecated format of the math tags This page was last edited on 9 August 2025, at 15:22 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Simpson's rule 28 languages Add topic

