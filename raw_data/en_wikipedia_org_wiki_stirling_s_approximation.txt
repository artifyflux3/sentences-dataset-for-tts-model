Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 History 2 Derivation 3 Alternative derivations Toggle Alternative derivations subsection 3.1 Higher orders 3.2 Complex-analytic version 3.3 Using the Central Limit Theorem and the Poisson distribution 4 Speed of convergence and error estimates 5 Stirling's formula for the gamma function 6 A convergent version of Stirling's formula 7 Versions suitable for calculators 8 See also 9 References 10 Further reading 11 External links Toggle the table of contents Stirling's approximation 40 languages العربية বাংলা Беларуская Български Català Čeština Deutsch Ελληνικά Español Euskara فارسی Français Galego 한국어 Bahasa Indonesia Italiano עברית Қазақша Latviešu Lietuvių Magyar Монгол Nederlands 日本語 Norsk bokmål Polski Português Română Русский Shqip Sicilianu Slovenčina کوردی Svenska Taclḥit Türkçe Українська اردو Tiếng Việt 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikimedia Commons Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Approximation for factorials Comparison of Stirling's approximation with the factorial In mathematics , Stirling's approximation (or Stirling's formula ) is an asymptotic approximation for factorials . It is a good approximation, leading to accurate results even for small values of n {\displaystyle n} . It is named after James Stirling , though a related but less precise result was first stated by Abraham de Moivre .

[ 1 ] [ 2 ] [ 3 ] One way of stating the approximation involves the logarithm of the factorial: ln ⁡ ⁡ ( n !

) = n ln ⁡ ⁡ n − − n + O ( ln ⁡ ⁡ n ) , {\displaystyle \ln(n!)=n\ln n-n+O(\ln n),} where the big O notation means that, for all sufficiently large values of n {\displaystyle n} , the difference between ln ⁡ ⁡ ( n !

) {\displaystyle \ln(n!)} and n ln ⁡ ⁡ n − − n {\displaystyle n\ln n-n} will be at most proportional to the logarithm of n {\displaystyle n} . In computer science applications such as the worst-case lower bound for comparison sorting , it is convenient to instead use the binary logarithm , giving the equivalent form log 2 ⁡ ⁡ ( n !

) = n log 2 ⁡ ⁡ n − − n log 2 ⁡ ⁡ e + O ( log 2 ⁡ ⁡ n ) .

{\displaystyle \log _{2}(n!)=n\log _{2}n-n\log _{2}e+O(\log _{2}n).} The error term in either base can be expressed more precisely as 1 2 log ⁡ ⁡ ( 2 π π n ) + O ( 1 n ) {\displaystyle {\tfrac {1}{2}}\log(2\pi n)+O({\tfrac {1}{n}})} , corresponding to an approximate formula for the factorial itself, n !

∼ ∼ 2 π π n ( n e ) n .

{\displaystyle n!\sim {\sqrt {2\pi n}}\left({\frac {n}{e}}\right)^{n}.} Here the sign ∼ ∼ {\displaystyle \sim } means that the two quantities are asymptotic, that is, their ratio tends to 1 as n {\displaystyle n} tends to infinity.

History [ edit ] The formula was first discovered by Abraham de Moivre [ 2 ] in the form n !

∼ ∼ [ c o n s t a n t ] ⋅ ⋅ n n + 1 2 e − − n .

{\displaystyle n!\sim [{\rm {constant}}]\cdot n^{n+{\frac {1}{2}}}e^{-n}.} De Moivre gave an approximate rational-number expression for the natural logarithm of the constant. Stirling's contribution consisted of showing that the constant is precisely 2 π π {\displaystyle {\sqrt {2\pi }}} .

[ 3 ] Derivation [ edit ] Roughly speaking, the simplest version of Stirling's formula can be quickly obtained by approximating the sum ln ⁡ ⁡ ( n !

) = ∑ ∑ j = 1 n ln ⁡ ⁡ j {\displaystyle \ln(n!)=\sum _{j=1}^{n}\ln j} with an integral : ∑ ∑ j = 1 n ln ⁡ ⁡ j ≈ ≈ ∫ ∫ 1 n ln ⁡ ⁡ x d x = n ln ⁡ ⁡ n − − n + 1.

{\displaystyle \sum _{j=1}^{n}\ln j\approx \int _{1}^{n}\ln x\,{\rm {d}}x=n\ln n-n+1.} The full formula, together with precise estimates of its error, can be derived as follows. Instead of approximating n !

{\displaystyle n!} , one considers its natural logarithm , as this is a slowly varying function : ln ⁡ ⁡ ( n !

) = ln ⁡ ⁡ 1 + ln ⁡ ⁡ 2 + ⋯ ⋯ + ln ⁡ ⁡ n .

{\displaystyle \ln(n!)=\ln 1+\ln 2+\cdots +\ln n.} The right-hand side of this equation minus 1 2 ( ln ⁡ ⁡ 1 + ln ⁡ ⁡ n ) = 1 2 ln ⁡ ⁡ n {\displaystyle {\tfrac {1}{2}}(\ln 1+\ln n)={\tfrac {1}{2}}\ln n} is the approximation by the trapezoid rule of the integral ln ⁡ ⁡ ( n !

) − − 1 2 ln ⁡ ⁡ n ≈ ≈ ∫ ∫ 1 n ln ⁡ ⁡ x d x = n ln ⁡ ⁡ n − − n + 1 , {\displaystyle \ln(n!)-{\tfrac {1}{2}}\ln n\approx \int _{1}^{n}\ln x\,{\rm {d}}x=n\ln n-n+1,} and the error in this approximation is given by the Euler–Maclaurin formula : ln ⁡ ⁡ ( n !

) − − 1 2 ln ⁡ ⁡ n = 1 2 ln ⁡ ⁡ 1 + ln ⁡ ⁡ 2 + ln ⁡ ⁡ 3 + ⋯ ⋯ + ln ⁡ ⁡ ( n − − 1 ) + 1 2 ln ⁡ ⁡ n = n ln ⁡ ⁡ n − − n + 1 + ∑ ∑ k = 2 m ( − − 1 ) k B k k ( k − − 1 ) ( 1 n k − − 1 − − 1 ) + R m , n , {\displaystyle {\begin{aligned}\ln(n!)-{\tfrac {1}{2}}\ln n&={\tfrac {1}{2}}\ln 1+\ln 2+\ln 3+\cdots +\ln(n-1)+{\tfrac {1}{2}}\ln n\\&=n\ln n-n+1+\sum _{k=2}^{m}{\frac {(-1)^{k}B_{k}}{k(k-1)}}\left({\frac {1}{n^{k-1}}}-1\right)+R_{m,n},\end{aligned}}} where B k {\displaystyle B_{k}} is a Bernoulli number , and R m , n is the remainder term in the Euler–Maclaurin formula. Take limits to find that lim n → → ∞ ∞ ( ln ⁡ ⁡ ( n !

) − − n ln ⁡ ⁡ n + n − − 1 2 ln ⁡ ⁡ n ) = 1 − − ∑ ∑ k = 2 m ( − − 1 ) k B k k ( k − − 1 ) + lim n → → ∞ ∞ R m , n .

{\displaystyle \lim _{n\to \infty }\left(\ln(n!)-n\ln n+n-{\tfrac {1}{2}}\ln n\right)=1-\sum _{k=2}^{m}{\frac {(-1)^{k}B_{k}}{k(k-1)}}+\lim _{n\to \infty }R_{m,n}.} Denote this limit as y {\displaystyle y} .  Because the remainder R m , n in the Euler–Maclaurin formula satisfies R m , n = lim n → → ∞ ∞ R m , n + O ( 1 n m ) , {\displaystyle R_{m,n}=\lim _{n\to \infty }R_{m,n}+O\left({\frac {1}{n^{m}}}\right),} where big-O notation is used, combining the equations above yields the approximation formula in its logarithmic form: ln ⁡ ⁡ ( n !

) = n ln ⁡ ⁡ ( n e ) + 1 2 ln ⁡ ⁡ n + y + ∑ ∑ k = 2 m ( − − 1 ) k B k k ( k − − 1 ) n k − − 1 + O ( 1 n m ) .

{\displaystyle \ln(n!)=n\ln \left({\frac {n}{e}}\right)+{\tfrac {1}{2}}\ln n+y+\sum _{k=2}^{m}{\frac {(-1)^{k}B_{k}}{k(k-1)n^{k-1}}}+O\left({\frac {1}{n^{m}}}\right).} Taking the exponential of both sides and choosing any positive integer m {\displaystyle m} , one obtains a formula involving an unknown quantity e y {\displaystyle e^{y}} . For m = 1 , the formula is n !

= e y n ( n e ) n ( 1 + O ( 1 n ) ) .

{\displaystyle n!=e^{y}{\sqrt {n}}\left({\frac {n}{e}}\right)^{n}\left(1+O\left({\frac {1}{n}}\right)\right).} The quantity e y {\displaystyle e^{y}} can be found by taking the limit on both sides as n {\displaystyle n} tends to infinity and using Wallis' product , which shows that e y = 2 π π {\displaystyle e^{y}={\sqrt {2\pi }}} . Therefore, one obtains Stirling's formula: n !

= 2 π π n ( n e ) n ( 1 + O ( 1 n ) ) .

{\displaystyle n!={\sqrt {2\pi n}}\left({\frac {n}{e}}\right)^{n}\left(1+O\left({\frac {1}{n}}\right)\right).} Alternative derivations [ edit ] An alternative formula for n !

{\displaystyle n!} using the gamma function is n !

= ∫ ∫ 0 ∞ ∞ x n e − − x d x .

{\displaystyle n!=\int _{0}^{\infty }x^{n}e^{-x}\,{\rm {d}}x.} (as can be seen by repeated integration by parts). Rewriting and changing variables x = ny , one obtains n !

= ∫ ∫ 0 ∞ ∞ e n ln ⁡ ⁡ x − − x d x = e n ln ⁡ ⁡ n n ∫ ∫ 0 ∞ ∞ e n ( ln ⁡ ⁡ y − − y ) d y .

{\displaystyle n!=\int _{0}^{\infty }e^{n\ln x-x}\,{\rm {d}}x=e^{n\ln n}n\int _{0}^{\infty }e^{n(\ln y-y)}\,{\rm {d}}y.} Applying Laplace's method one has ∫ ∫ 0 ∞ ∞ e n ( ln ⁡ ⁡ y − − y ) d y ∼ ∼ 2 π π n e − − n , {\displaystyle \int _{0}^{\infty }e^{n(\ln y-y)}\,{\rm {d}}y\sim {\sqrt {\frac {2\pi }{n}}}e^{-n},} which recovers Stirling's formula: n !

∼ ∼ e n ln ⁡ ⁡ n n 2 π π n e − − n = 2 π π n ( n e ) n .

{\displaystyle n!\sim e^{n\ln n}n{\sqrt {\frac {2\pi }{n}}}e^{-n}={\sqrt {2\pi n}}\left({\frac {n}{e}}\right)^{n}.} Higher orders [ edit ] In fact, further corrections can also be obtained using Laplace's method. From previous result, we know that Γ Γ ( x ) ∼ ∼ x x e − − x {\displaystyle \Gamma (x)\sim x^{x}e^{-x}} , so we "peel off" this dominant term, then perform two changes of variables, to obtain: x − − x e x Γ Γ ( x ) = ∫ ∫ R e x ( 1 + t − − e t ) d t {\displaystyle x^{-x}e^{x}\Gamma (x)=\int _{\mathbb {R} }e^{x(1+t-e^{t})}dt} To verify this: ∫ ∫ R e x ( 1 + t − − e t ) d t = t ↦ ↦ ln ⁡ ⁡ t e x ∫ ∫ 0 ∞ ∞ t x − − 1 e − − x t d t = t ↦ ↦ t / x x − − x e x ∫ ∫ 0 ∞ ∞ e − − t t x − − 1 d t = x − − x e x Γ Γ ( x ) {\displaystyle \int _{\mathbb {R} }e^{x(1+t-e^{t})}dt{\overset {t\mapsto \ln t}{=}}e^{x}\int _{0}^{\infty }t^{x-1}e^{-xt}dt{\overset {t\mapsto t/x}{=}}x^{-x}e^{x}\int _{0}^{\infty }e^{-t}t^{x-1}dt=x^{-x}e^{x}\Gamma (x)} .

Now the function t ↦ ↦ 1 + t − − e t {\displaystyle t\mapsto 1+t-e^{t}} is unimodal, with maximum value zero. Locally around zero, it looks like − − t 2 / 2 {\displaystyle -t^{2}/2} , which is why we are able to perform Laplace's method. In order to extend Laplace's method to higher orders, we perform another change of variables by 1 + t − − e t = − − τ τ 2 / 2 {\displaystyle 1+t-e^{t}=-\tau ^{2}/2} . This equation cannot be solved in closed form, but it can be solved by serial expansion, which gives us t = τ τ − − τ τ 2 / 6 + τ τ 3 / 36 + a 4 τ τ 4 + O ( τ τ 5 ) {\displaystyle t=\tau -\tau ^{2}/6+\tau ^{3}/36+a_{4}\tau ^{4}+O(\tau ^{5})} . Now plug back to the equation to obtain x − − x e x Γ Γ ( x ) = ∫ ∫ R e − − x τ τ 2 / 2 ( 1 − − τ τ / 3 + τ τ 2 / 12 + 4 a 4 τ τ 3 + O ( τ τ 4 ) ) d τ τ = 2 π π ( x − − 1 / 2 + x − − 3 / 2 / 12 ) + O ( x − − 5 / 2 ) {\displaystyle x^{-x}e^{x}\Gamma (x)=\int _{\mathbb {R} }e^{-x\tau ^{2}/2}(1-\tau /3+\tau ^{2}/12+4a_{4}\tau ^{3}+O(\tau ^{4}))d\tau ={\sqrt {2\pi }}(x^{-1/2}+x^{-3/2}/12)+O(x^{-5/2})} notice how we don't need to actually find a 4 {\displaystyle a_{4}} , since it is cancelled out by the integral. Higher orders can be achieved by computing more terms in t = τ τ + ⋯ ⋯ {\displaystyle t=\tau +\cdots } , which can be obtained programmatically.

[ note 1 ] Thus we get Stirling's formula to two orders: n !

= 2 π π n ( n e ) n ( 1 + 1 12 n + O ( 1 n 2 ) ) .

{\displaystyle n!={\sqrt {2\pi n}}\left({\frac {n}{e}}\right)^{n}\left(1+{\frac {1}{12n}}+O\left({\frac {1}{n^{2}}}\right)\right).} Complex-analytic version [ edit ] A complex-analysis version of this method [ 4 ] is to consider 1 n !

{\displaystyle {\frac {1}{n!}}} as a Taylor coefficient of the exponential function e z = ∑ ∑ n = 0 ∞ ∞ z n n !

{\displaystyle e^{z}=\sum _{n=0}^{\infty }{\frac {z^{n}}{n!}}} , computed by Cauchy's integral formula as 1 n !

= 1 2 π π i ∮ ∮ | z | = r e z z n + 1 d z .

{\displaystyle {\frac {1}{n!}}={\frac {1}{2\pi i}}\oint \limits _{|z|=r}{\frac {e^{z}}{z^{n+1}}}\,\mathrm {d} z.} This line integral can then be approximated using the saddle-point method with an appropriate choice of contour radius r = r n {\displaystyle r=r_{n}} . The dominant portion of the integral near the saddle point is then approximated by a real integral and Laplace's method, while the remaining portion of the integral can be bounded above to give an error term.

Using the Central Limit Theorem and the Poisson distribution [ edit ] An alternative version uses the fact that the Poisson distribution converges to a normal distribution by the Central Limit Theorem .

[ 5 ] Since the Poisson distribution with parameter λ λ {\displaystyle \lambda } converges to a normal distribution with mean λ λ {\displaystyle \lambda } and variance λ λ {\displaystyle \lambda } , their density functions will be approximately the same: exp ⁡ ⁡ ( − − μ μ ) μ μ x x !

≈ ≈ 1 2 π π μ μ exp ⁡ ⁡ ( − − 1 2 ( x − − μ μ μ μ ) 2 ) {\displaystyle {\frac {\exp(-\mu )\mu ^{x}}{x!}}\approx {\frac {1}{\sqrt {2\pi \mu }}}\exp \left(-{\frac {1}{2}}\left({\frac {x-\mu }{\sqrt {\mu }}}\right)^{2}\right)} Evaluating this expression at the mean, at which the approximation is particularly accurate, simplifies this expression to: exp ⁡ ⁡ ( − − μ μ ) μ μ μ μ μ μ !

≈ ≈ 1 2 π π μ μ {\displaystyle {\frac {\exp(-\mu )\mu ^{\mu }}{\mu !}}\approx {\frac {1}{\sqrt {2\pi \mu }}}} Taking logs then results in: − − μ μ + μ μ ln ⁡ ⁡ μ μ − − ln ⁡ ⁡ μ μ !

≈ ≈ − − 1 2 ln ⁡ ⁡ 2 π π μ μ {\displaystyle -\mu +\mu \ln \mu -\ln \mu !\approx -{\frac {1}{2}}\ln 2\pi \mu } which can easily be rearranged to give: ln ⁡ ⁡ μ μ !

≈ ≈ μ μ ln ⁡ ⁡ μ μ − − μ μ + 1 2 ln ⁡ ⁡ 2 π π μ μ {\displaystyle \ln \mu !\approx \mu \ln \mu -\mu +{\frac {1}{2}}\ln 2\pi \mu } Evaluating at μ μ = n {\displaystyle \mu =n} gives the usual, more precise form of Stirling's approximation.

Speed of convergence and error estimates [ edit ] The relative error in a truncated Stirling series vs.

n {\displaystyle n} , for 0 to 5 terms. The kinks in the curves represent points where the truncated series coincides with Γ( n + 1) .

Stirling's formula is in fact the first approximation to the following series (now called the Stirling series ): [ 6 ] n !

∼ ∼ 2 π π n ( n e ) n ( 1 + 1 12 n + 1 288 n 2 − − 139 51840 n 3 − − 571 2488320 n 4 + ⋯ ⋯ ) .

{\displaystyle n!\sim {\sqrt {2\pi n}}\left({\frac {n}{e}}\right)^{n}\left(1+{\frac {1}{12n}}+{\frac {1}{288n^{2}}}-{\frac {139}{51840n^{3}}}-{\frac {571}{2488320n^{4}}}+\cdots \right).} An explicit formula for the coefficients in this series was given by G. Nemes.

[ 7 ] Further terms are listed in the On-Line Encyclopedia of Integer Sequences as A001163 and A001164 . The first graph in this section shows the relative error vs.

n {\displaystyle n} , for 1 through all 5 terms listed above. (Bender and Orszag [ 8 ] p. 218) gives the asymptotic formula for the coefficients: A 2 j + 1 ∼ ∼ ( − − 1 ) j 2 ( 2 j ) !

/ ( 2 π π ) 2 ( j + 1 ) {\displaystyle A_{2j+1}\sim (-1)^{j}2(2j)!/(2\pi )^{2(j+1)}} which shows that it grows superexponentially, and that by the ratio test the radius of convergence is zero.

The relative error in a truncated Stirling series vs. the number of terms used As n → ∞ , the error in the truncated series is asymptotically equal to the first omitted term. This is an example of an asymptotic expansion . It is not a convergent series ; for any particular value of n {\displaystyle n} there are only so many terms of the series that improve accuracy, after which accuracy worsens.  This is shown in the next graph, which shows the relative error versus the number of terms in the series, for larger numbers of terms. More precisely, let S ( n , t ) be the Stirling series to t {\displaystyle t} terms evaluated at n {\displaystyle n} .  The graphs show | ln ⁡ ⁡ ( S ( n , t ) n !

) | , {\displaystyle \left|\ln \left({\frac {S(n,t)}{n!}}\right)\right|,} which, when small, is essentially the relative error.

Writing Stirling's series in the form ln ⁡ ⁡ ( n !

) ∼ ∼ n ln ⁡ ⁡ n − − n + 1 2 ln ⁡ ⁡ ( 2 π π n ) + 1 12 n − − 1 360 n 3 + 1 1260 n 5 − − 1 1680 n 7 + ⋯ ⋯ , {\displaystyle \ln(n!)\sim n\ln n-n+{\tfrac {1}{2}}\ln(2\pi n)+{\frac {1}{12n}}-{\frac {1}{360n^{3}}}+{\frac {1}{1260n^{5}}}-{\frac {1}{1680n^{7}}}+\cdots ,} it is known that the error in truncating the series is always of the opposite sign and at most the same magnitude as the first omitted term.

[ citation needed ] Other bounds, due to Robbins, [ 9 ] valid for all positive integers n {\displaystyle n} are 2 π π n ( n e ) n e 1 12 n + 1 < n !

< 2 π π n ( n e ) n e 1 12 n .

{\displaystyle {\sqrt {2\pi n}}\left({\frac {n}{e}}\right)^{n}e^{\frac {1}{12n+1}}<n!<{\sqrt {2\pi n}}\left({\frac {n}{e}}\right)^{n}e^{\frac {1}{12n}}.} This upper bound corresponds to stopping the above series for ln ⁡ ⁡ ( n !

) {\displaystyle \ln(n!)} after the 1 n {\displaystyle {\frac {1}{n}}} term. The lower bound is weaker than that obtained by stopping the series after the 1 n 3 {\displaystyle {\frac {1}{n^{3}}}} term. A looser version of this bound is that n !

e n n n + 1 2 ∈ ∈ ( 2 π π , e ] {\displaystyle {\frac {n!e^{n}}{n^{n+{\frac {1}{2}}}}}\in ({\sqrt {2\pi }},e]} for all n ≥ ≥ 1 {\displaystyle n\geq 1} .

Stirling's formula for the gamma function [ edit ] For all positive integers, n !

= Γ Γ ( n + 1 ) , {\displaystyle n!=\Gamma (n+1),} where Γ denotes the gamma function .

However, the gamma function, unlike the factorial, is more broadly defined for all complex numbers other than non-positive integers; nevertheless, Stirling's formula may still be applied. If Re( z ) > 0 , then ln ⁡ ⁡ Γ Γ ( z ) = z ln ⁡ ⁡ z − − z + 1 2 ln ⁡ ⁡ 2 π π z + ∫ ∫ 0 ∞ ∞ 2 arctan ⁡ ⁡ ( t z ) e 2 π π t − − 1 d t .

{\displaystyle \ln \Gamma (z)=z\ln z-z+{\tfrac {1}{2}}\ln {\frac {2\pi }{z}}+\int _{0}^{\infty }{\frac {2\arctan \left({\frac {t}{z}}\right)}{e^{2\pi t}-1}}\,{\rm {d}}t.} Repeated integration by parts gives ln ⁡ ⁡ Γ Γ ( z ) ∼ ∼ z ln ⁡ ⁡ z − − z + 1 2 ln ⁡ ⁡ 2 π π z + ∑ ∑ n = 1 N − − 1 B 2 n 2 n ( 2 n − − 1 ) z 2 n − − 1 = z ln ⁡ ⁡ z − − z + 1 2 ln ⁡ ⁡ 2 π π z + 1 12 z − − 1 360 z 3 + 1 1260 z 5 + … … , {\displaystyle {\begin{aligned}\ln \Gamma (z)\sim z\ln z-z+{\tfrac {1}{2}}\ln {\frac {2\pi }{z}}+\sum _{n=1}^{N-1}{\frac {B_{2n}}{2n(2n-1)z^{2n-1}}}\\=z\ln z-z+{\tfrac {1}{2}}\ln {\frac {2\pi }{z}}+{\frac {1}{12z}}-{\frac {1}{360z^{3}}}+{\frac {1}{1260z^{5}}}+\dots ,\end{aligned}}} where B n {\displaystyle B_{n}} is the n {\displaystyle n} th Bernoulli number (note that the limit of the sum as N → → ∞ ∞ {\displaystyle N\to \infty } is not convergent, so this formula is just an asymptotic expansion ). The formula is valid for z {\displaystyle z} large enough in absolute value, when | arg( z ) | < π − ε , where ε is positive, with an error term of O ( z −2 N + 1 ) . The corresponding approximation may now be written: Γ Γ ( z ) = 2 π π z ( z e ) z ( 1 + O ( 1 z ) ) .

{\displaystyle \Gamma (z)={\sqrt {\frac {2\pi }{z}}}\,{\left({\frac {z}{e}}\right)}^{z}\left(1+O\left({\frac {1}{z}}\right)\right).} where the expansion is identical to that of Stirling's series above for n !

{\displaystyle n!} , except that n {\displaystyle n} is replaced with z − 1 .

[ 10 ] A further application of this asymptotic expansion is for complex argument z with constant Re( z ) . See for example the Stirling formula applied in Im( z ) = t of the Riemann–Siegel theta function on the straight line ⁠ 1 / 4 ⁠ + it .

A convergent version of Stirling's formula [ edit ] Thomas Bayes showed, in a letter to John Canton published by the Royal Society in 1763, that Stirling's formula did not give a convergent series .

[ 11 ] Obtaining a convergent version of Stirling's formula entails evaluating Binet's formula : ∫ ∫ 0 ∞ ∞ 2 arctan ⁡ ⁡ ( t x ) e 2 π π t − − 1 d t = ln ⁡ ⁡ Γ Γ ( x ) − − x ln ⁡ ⁡ x + x − − 1 2 ln ⁡ ⁡ 2 π π x .

{\displaystyle \int _{0}^{\infty }{\frac {2\arctan \left({\frac {t}{x}}\right)}{e^{2\pi t}-1}}\,{\rm {d}}t=\ln \Gamma (x)-x\ln x+x-{\tfrac {1}{2}}\ln {\frac {2\pi }{x}}.} One way to do this is by means of a convergent series of inverted rising factorials . If z n ¯ ¯ = z ( z + 1 ) ⋯ ⋯ ( z + n − − 1 ) , {\displaystyle z^{\bar {n}}=z(z+1)\cdots (z+n-1),} then ∫ ∫ 0 ∞ ∞ 2 arctan ⁡ ⁡ ( t x ) e 2 π π t − − 1 d t = ∑ ∑ n = 1 ∞ ∞ c n ( x + 1 ) n ¯ ¯ , {\displaystyle \int _{0}^{\infty }{\frac {2\arctan \left({\frac {t}{x}}\right)}{e^{2\pi t}-1}}\,{\rm {d}}t=\sum _{n=1}^{\infty }{\frac {c_{n}}{(x+1)^{\bar {n}}}},} where c n = 1 n ∫ ∫ 0 1 x n ¯ ¯ ( x − − 1 2 ) d x = 1 2 n ∑ ∑ k = 1 n k | s ( n , k ) | ( k + 1 ) ( k + 2 ) , {\displaystyle c_{n}={\frac {1}{n}}\int _{0}^{1}x^{\bar {n}}\left(x-{\tfrac {1}{2}}\right)\,{\rm {d}}x={\frac {1}{2n}}\sum _{k=1}^{n}{\frac {k|s(n,k)|}{(k+1)(k+2)}},} where s ( n , k ) denotes the Stirling numbers of the first kind . From this one obtains a version of Stirling's series ln ⁡ ⁡ Γ Γ ( x ) = x ln ⁡ ⁡ x − − x + 1 2 ln ⁡ ⁡ 2 π π x + 1 12 ( x + 1 ) + 1 12 ( x + 1 ) ( x + 2 ) + + 59 360 ( x + 1 ) ( x + 2 ) ( x + 3 ) + 29 60 ( x + 1 ) ( x + 2 ) ( x + 3 ) ( x + 4 ) + ⋯ ⋯ , {\displaystyle {\begin{aligned}\ln \Gamma (x)&=x\ln x-x+{\tfrac {1}{2}}\ln {\frac {2\pi }{x}}+{\frac {1}{12(x+1)}}+{\frac {1}{12(x+1)(x+2)}}+\\&\quad +{\frac {59}{360(x+1)(x+2)(x+3)}}+{\frac {29}{60(x+1)(x+2)(x+3)(x+4)}}+\cdots ,\end{aligned}}} which converges when Re( x ) > 0 . 
Stirling's formula may also be given in convergent form as [ 12 ] Γ Γ ( x ) = 2 π π x x − − 1 2 e − − x + μ μ ( x ) {\displaystyle \Gamma (x)={\sqrt {2\pi }}x^{x-{\frac {1}{2}}}e^{-x+\mu (x)}} where μ μ ( x ) = ∑ ∑ n = 0 ∞ ∞ ( ( x + n + 1 2 ) ln ⁡ ⁡ ( 1 + 1 x + n ) − − 1 ) .

{\displaystyle \mu \left(x\right)=\sum _{n=0}^{\infty }\left(\left(x+n+{\frac {1}{2}}\right)\ln \left(1+{\frac {1}{x+n}}\right)-1\right).} Versions suitable for calculators [ edit ] The approximation Γ Γ ( z ) ≈ ≈ 2 π π z ( z e z sinh ⁡ ⁡ 1 z + 1 810 z 6 ) z {\displaystyle \Gamma (z)\approx {\sqrt {\frac {2\pi }{z}}}\left({\frac {z}{e}}{\sqrt {z\sinh {\frac {1}{z}}+{\frac {1}{810z^{6}}}}}\right)^{z}} and its equivalent form 2 ln ⁡ ⁡ Γ Γ ( z ) ≈ ≈ ln ⁡ ⁡ ( 2 π π ) − − ln ⁡ ⁡ z + z ( 2 ln ⁡ ⁡ z + ln ⁡ ⁡ ( z sinh ⁡ ⁡ 1 z + 1 810 z 6 ) − − 2 ) {\displaystyle 2\ln \Gamma (z)\approx \ln(2\pi )-\ln z+z\left(2\ln z+\ln \left(z\sinh {\frac {1}{z}}+{\frac {1}{810z^{6}}}\right)-2\right)} can be obtained by rearranging Stirling's extended formula and observing a coincidence between the resultant power series and the Taylor series expansion of the hyperbolic sine function. This approximation is good to more than 8 decimal digits for z with a real part greater than 8. Robert H. Windschitl suggested it in 2002 for computing the gamma function with fair accuracy on calculators with limited program or register memory.

[ 13 ] Gergő Nemes proposed in 2007 an approximation which gives the same number of exact digits as the Windschitl approximation but is much simpler: [ 14 ] Γ Γ ( z ) ≈ ≈ 2 π π z ( 1 e ( z + 1 12 z − − 1 10 z ) ) z , {\displaystyle \Gamma (z)\approx {\sqrt {\frac {2\pi }{z}}}\left({\frac {1}{e}}\left(z+{\frac {1}{12z-{\frac {1}{10z}}}}\right)\right)^{z},} or equivalently, ln ⁡ ⁡ Γ Γ ( z ) ≈ ≈ 1 2 ( ln ⁡ ⁡ ( 2 π π ) − − ln ⁡ ⁡ z ) + z ( ln ⁡ ⁡ ( z + 1 12 z − − 1 10 z ) − − 1 ) .

{\displaystyle \ln \Gamma (z)\approx {\tfrac {1}{2}}\left(\ln(2\pi )-\ln z\right)+z\left(\ln \left(z+{\frac {1}{12z-{\frac {1}{10z}}}}\right)-1\right).} An alternative approximation for the gamma function stated by Srinivasa Ramanujan in Ramanujan's lost notebook [ 15 ] is Γ Γ ( 1 + x ) ≈ ≈ π π ( x e ) x ( 8 x 3 + 4 x 2 + x + 1 30 ) 1 6 {\displaystyle \Gamma (1+x)\approx {\sqrt {\pi }}\left({\frac {x}{e}}\right)^{x}\left(8x^{3}+4x^{2}+x+{\frac {1}{30}}\right)^{\frac {1}{6}}} for x ≥ 0 . The equivalent approximation for ln n !

has an asymptotic error of ⁠ 1 / 1400 n 3 ⁠ and is given by ln ⁡ ⁡ n !

≈ ≈ n ln ⁡ ⁡ n − − n + 1 6 ln ⁡ ⁡ ( 8 n 3 + 4 n 2 + n + 1 30 ) + 1 2 ln ⁡ ⁡ π π .

{\displaystyle \ln n!\approx n\ln n-n+{\tfrac {1}{6}}\ln(8n^{3}+4n^{2}+n+{\tfrac {1}{30}})+{\tfrac {1}{2}}\ln \pi .} The approximation may be made precise by giving paired upper and lower bounds; one such inequality is [ 16 ] [ 17 ] [ 18 ] [ 19 ] π π ( x e ) x ( 8 x 3 + 4 x 2 + x + 1 100 ) 1 / 6 < Γ Γ ( 1 + x ) < π π ( x e ) x ( 8 x 3 + 4 x 2 + x + 1 30 ) 1 / 6 .

{\displaystyle {\sqrt {\pi }}\left({\frac {x}{e}}\right)^{x}\left(8x^{3}+4x^{2}+x+{\frac {1}{100}}\right)^{1/6}<\Gamma (1+x)<{\sqrt {\pi }}\left({\frac {x}{e}}\right)^{x}\left(8x^{3}+4x^{2}+x+{\frac {1}{30}}\right)^{1/6}.} See also [ edit ] Lanczos approximation Spouge's approximation References [ edit ] ^ Dutka, Jacques (1991), "The early history of the factorial function", Archive for History of Exact Sciences , 43 (3): 225– 249, doi : 10.1007/BF00389433 , S2CID 122237769 ^ a b Le Cam, L.

(1986), "The central limit theorem around 1935", Statistical Science , 1 (1): 78– 96, doi : 10.1214/ss/1177013818 , JSTOR 2245503 , MR 0833276 ; see p. 81, "The result, obtained using a formula originally proved by de Moivre but now called Stirling's formula, occurs in his 'Doctrine of Chances' of 1733." ^ a b Pearson, Karl (1924), "Historical note on the origin of the normal curve of errors", Biometrika , 16 (3/4): 402–404 [p. 403], doi : 10.2307/2331714 , JSTOR 2331714 , I consider that the fact that Stirling showed that De Moivre's arithmetical constant was 2 π π {\displaystyle {\sqrt {2\pi }}} does not entitle him to claim the theorem, [...] ^ Flajolet, Philippe; Sedgewick, Robert (2009), Analytic Combinatorics , Cambridge, UK: Cambridge University Press, p. 555, doi : 10.1017/CBO9780511801655 , ISBN 978-0-521-89806-5 , MR 2483235 , S2CID 27509971 ^ MacKay, David J. C. (2019).

Information theory, inference, and learning algorithms (22nd printing ed.). Cambridge: Cambridge University Press.

ISBN 978-0-521-64298-9 .

^ Olver, F. W. J.; Olde Daalhuis, A. B.; Lozier, D. W.; Schneider, B. I.; Boisvert, R. F.; Clark, C. W.; Miller, B. R. & Saunders, B. V., "5.11 Gamma function properties: Asymptotic Expansions" , NIST Digital Library of Mathematical Functions , Release 1.0.13 of 2016-09-16 ^ Nemes, Gergő (2010), "On the coefficients of the asymptotic expansion of n !

{\displaystyle n!} ", Journal of Integer Sequences , 13 (6): 5 ^ Bender, Carl M.; Orszag, Steven A. (2009).

Advanced mathematical methods for scientists and engineers. 1: Asymptotic methods and perturbation theory (Nachdr. ed.). New York, NY: Springer.

ISBN 978-0-387-98931-0 .

^ Robbins, Herbert (1955), "A Remark on Stirling's Formula", The American Mathematical Monthly , 62 (1): 26– 29, doi : 10.2307/2308012 , JSTOR 2308012 ^ Spiegel, M. R. (1999), Mathematical handbook of formulas and tables , McGraw-Hill, p. 148 ^ Bayes, Thomas (24 November 1763), "A letter from the late Reverend Mr. Thomas Bayes, F. R. S. to John Canton, M. A. and F. R. S." (PDF) , Philosophical Transactions , 53 : 269, Bibcode : 1763RSPT...53..269B , archived (PDF) from the original on 2012-01-28 , retrieved 2012-03-01 ^ Artin, Emil (2015).

The Gamma Function . Dover. p. 24.

^ Toth, V. T.

Programmable Calculators: Calculators and the Gamma Function (2006) Archived 2005-12-31 at the Wayback Machine .

^ Nemes, Gergő (2010), "New asymptotic expansion for the Gamma function", Archiv der Mathematik , 95 (2): 161– 169, doi : 10.1007/s00013-010-0146-9 , S2CID 121820640 ^ Ramanujan, Srinivasa (14 August 1920), Lost Notebook and Other Unpublished Papers , p. 339 – via Internet Archive ^ Karatsuba, Ekatherina A. (2001), "On the asymptotic representation of the Euler gamma function by Ramanujan", Journal of Computational and Applied Mathematics , 135 (2): 225– 240, Bibcode : 2001JCoAM.135..225K , doi : 10.1016/S0377-0427(00)00586-0 , MR 1850542 ^ Mortici, Cristinel (2011), "Ramanujan's estimate for the gamma function via monotonicity arguments", Ramanujan J.

, 25 (2): 149– 154, doi : 10.1007/s11139-010-9265-y , S2CID 119530041 ^ Mortici, Cristinel (2011), "Improved asymptotic formulas for the gamma function", Comput. Math. Appl.

, 61 (11): 3364– 3369, doi : 10.1016/j.camwa.2011.04.036 .

^ Mortici, Cristinel (2011), "On Ramanujan's large argument formula for the gamma function", Ramanujan J.

, 26 (2): 185– 192, doi : 10.1007/s11139-010-9281-y , S2CID 120371952 .

Further reading [ edit ] Abramowitz, M. & Stegun, I. (2002), Handbook of Mathematical Functions Paris, R. B. & Kaminski, D. (2001), Asymptotics and Mellin–Barnes Integrals , New York: Cambridge University Press, ISBN 978-0-521-79001-7 Whittaker, E. T. & Watson, G. N. (1996), A Course in Modern Analysis (4th ed.), New York: Cambridge University Press, ISBN 978-0-521-58807-2 Romik, Dan (2000), "Stirling's approximation for n !

{\displaystyle n!} : the ultimate short proof?", The American Mathematical Monthly , 107 (6): 556– 557, doi : 10.2307/2589351 , JSTOR 2589351 , MR 1767064 Li, Yuan-Chuan (July 2006), "A note on an identity of the gamma function and Stirling's formula" , Real Analysis Exchange , 32 (1): 267– 271, MR 2329236 ^ For example, a program in Mathematica: series = tau - tau ^ 2 / 6 + tau ^ 3 / 36 + tau ^ 4 * a + tau ^ 5 * b ; (*pick the right a,b to make the series equal 0 at higher orders*) Series [ tau ^ 2 / 2 + 1 + t - Exp [ t ] /.

t -> series , { tau , 0 , 8 }] (*now do the integral*) integral = Integrate [ Exp [ - x * tau ^ 2 / 2 ] * D [ series /.

a -> 0 /.

b -> 0 , tau ], { tau , - Infinity , Infinity }]; Simplify [ integral / Sqrt [ 2 * Pi ] * Sqrt [ x ]] External links [ edit ] Wikimedia Commons has media related to Stirling's approximation .

"Stirling_formula" , Encyclopedia of Mathematics , EMS Press , 2001 [1994] Peter Luschny, Approximation formulas for the factorial function n!

Weisstein, Eric W.

, "Stirling's Approximation" , MathWorld Stirling's approximation at PlanetMath .

v t e Calculus Precalculus Binomial theorem Concave function Continuous function Factorial Finite difference Free variables and bound variables Graph of a function Linear function Radian Rolle's theorem Secant Slope Tangent Limits Indeterminate form Limit of a function One-sided limit Limit of a sequence Order of approximation (ε, δ)-definition of limit Differential calculus Derivative Second derivative Partial derivative Differential Differential operator Mean value theorem Notation Leibniz's notation Newton's notation Rules of differentiation linearity Power Sum Chain L'Hôpital's Product General Leibniz's rule Quotient Other techniques Implicit differentiation Inverse functions and differentiation Logarithmic derivative Related rates Stationary points First derivative test Second derivative test Extreme value theorem Maximum and minimum Further applications Newton's method Taylor's theorem Differential equation Ordinary differential equation Partial differential equation Stochastic differential equation Integral calculus Antiderivative Arc length Riemann integral Basic properties Constant of integration Fundamental theorem of calculus Differentiating under the integral sign Integration by parts Integration by substitution trigonometric Euler Tangent half-angle substitution Partial fractions in integration Quadratic integral Trapezoidal rule Volumes Washer method Shell method Integral equation Integro-differential equation Vector calculus Derivatives Curl Directional derivative Divergence Gradient Laplacian Basic theorems Line integrals Green's Stokes' Gauss' Multivariable calculus Divergence theorem Geometric Hessian matrix Jacobian matrix and determinant Lagrange multiplier Line integral Matrix Multiple integral Partial derivative Surface integral Volume integral Advanced topics Differential forms Exterior derivative Generalized Stokes' theorem Tensor calculus Sequences and series Arithmetico-geometric sequence Types of series Alternating Binomial Fourier Geometric Harmonic Infinite Power Maclaurin Taylor Telescoping Tests of convergence Abel's Alternating series Cauchy condensation Direct comparison Dirichlet's Integral Limit comparison Ratio Root Term Special functions and numbers Bernoulli numbers e (mathematical constant) Exponential function Natural logarithm Stirling's approximation History of calculus Adequality Brook Taylor Colin Maclaurin Generality of algebra Gottfried Wilhelm Leibniz Infinitesimal Infinitesimal calculus Isaac Newton Fluxion Law of Continuity Leonhard Euler Method of Fluxions The Method of Mechanical Theorems Lists Integrals rational functions irrational algebraic functions exponential functions logarithmic functions hyperbolic functions inverse trigonometric functions inverse Secant Secant cubed List of limits List of derivatives Miscellaneous topics Complex calculus Contour integral Differential geometry Manifold Curvature of curves of surfaces Tensor Euler–Maclaurin formula Gabriel's horn Integration Bee Proof that 22/7 exceeds π Regiomontanus' angle maximization problem Steinmetz solid Retrieved from " https://en.wikipedia.org/w/index.php?title=Stirling%27s_approximation&oldid=1304162714 " Categories : Approximations Asymptotic analysis Analytic number theory Gamma and related functions Theorems in mathematical analysis Hidden categories: Webarchive template wayback links Articles with short description Short description matches Wikidata All articles with unsourced statements Articles with unsourced statements from December 2024 Commons category link from Wikidata This page was last edited on 4 August 2025, at 10:45 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Stirling's approximation 40 languages Add topic

