Title: Diffusion equation

URL Source: https://en.wikipedia.org/wiki/Diffusion_equation

Published Time: 2004-05-10T01:54:30Z

Markdown Content:
From Wikipedia, the free encyclopedia

The **diffusion equation** is a [parabolic partial differential equation](https://en.wikipedia.org/wiki/Parabolic_partial_differential_equation "Parabolic partial differential equation"). In physics, it describes the macroscopic behavior of many micro-particles in [Brownian motion](https://en.wikipedia.org/wiki/Brownian_motion "Brownian motion"), resulting from the random movements and collisions of the particles (see [Fick's laws of diffusion](https://en.wikipedia.org/wiki/Fick%27s_laws_of_diffusion "Fick's laws of diffusion")). In mathematics, it is related to [Markov processes](https://en.wikipedia.org/wiki/Markov_process "Markov process"), such as [random walks](https://en.wikipedia.org/wiki/Random_walk "Random walk"), and applied in many other fields, such as [materials science](https://en.wikipedia.org/wiki/Materials_science "Materials science"), [information theory](https://en.wikipedia.org/wiki/Information_theory "Information theory"), and [biophysics](https://en.wikipedia.org/wiki/Biophysics "Biophysics"). The diffusion equation is a special case of the [convection–diffusion equation](https://en.wikipedia.org/wiki/Convection%E2%80%93diffusion_equation "Convection–diffusion equation") when bulk velocity is zero. It is equivalent to the [heat equation](https://en.wikipedia.org/wiki/Heat_equation "Heat equation") under some circumstances.

The equation is usually written as: ![Image 1: {\displaystyle {\frac {\partial \phi (\mathbf {r} ,t)}{\partial t}}=\nabla \cdot {\big [}D(\phi ,\mathbf {r} )\ \nabla \phi (\mathbf {r} ,t){\big ]},}](https://wikimedia.org/api/rest_v1/media/math/render/svg/948a15942a9ac71f7c08edb85cb28c88d3d3cfdf) where _ϕ_(**r**, _t_) is the [density](https://en.wikipedia.org/wiki/Density "Density") of the diffusing material at location **r** and time t and _D_(_ϕ_, **r**) is the collective [diffusion coefficient](https://en.wikipedia.org/wiki/Diffusion_coefficient "Diffusion coefficient") for density ϕ at location **r**; and ∇ represents the vector [differential operator](https://en.wikipedia.org/wiki/Differential_operator "Differential operator")[del](https://en.wikipedia.org/wiki/Del "Del"). If the diffusion coefficient depends on the density then the equation is nonlinear, otherwise it is linear.

The equation above applies when the diffusion coefficient is [isotropic](https://en.wikipedia.org/wiki/Isotropy "Isotropy"); in the case of anisotropic diffusion, D is a symmetric [positive definite matrix](https://en.wikipedia.org/wiki/Positive_definite_matrix "Positive definite matrix"), and the equation is written (for three dimensional diffusion) as: ![Image 2: {\displaystyle {\frac {\partial \phi (\mathbf {r} ,t)}{\partial t}}=\sum _{i=1}^{3}\sum _{j=1}^{3}{\frac {\partial }{\partial x_{i}}}\left[D_{ij}(\phi ,\mathbf {r} ){\frac {\partial \phi (\mathbf {r} ,t)}{\partial x_{j}}}\right]}](https://wikimedia.org/api/rest_v1/media/math/render/svg/4a834bc395bf7a4cbc476fc91c39c7b89c49092f) The diffusion equation has numerous analytic solutions.[[1]](https://en.wikipedia.org/wiki/Diffusion_equation#cite_note-1)

If D is constant, then the equation reduces to the following [linear differential equation](https://en.wikipedia.org/wiki/Linear_differential_equation "Linear differential equation"):

![Image 3: {\displaystyle {\frac {\partial \phi (\mathbf {r} ,t)}{\partial t}}=D\nabla ^{2}\phi (\mathbf {r} ,t),}](https://wikimedia.org/api/rest_v1/media/math/render/svg/7c223846a05763066b3ecbcda30bf3282438f573)
which is identical to the [heat equation](https://en.wikipedia.org/wiki/Heat_equation "Heat equation").

The [particle diffusion equation](https://en.wikipedia.org/wiki/Fick%27s_law_of_diffusion "Fick's law of diffusion") was originally derived by [Adolf Fick](https://en.wikipedia.org/wiki/Adolf_Fick "Adolf Fick") in 1855.[[2]](https://en.wikipedia.org/wiki/Diffusion_equation#cite_note-Fick1855-2)

The diffusion equation can be trivially derived from the [continuity equation](https://en.wikipedia.org/wiki/Continuity_equation "Continuity equation"), which states that a change in density in any part of the system is due to inflow and outflow of material into and out of that part of the system. Effectively, no material is created or destroyed: ![Image 4: {\displaystyle {\frac {\partial \phi }{\partial t}}+\nabla \cdot \mathbf {j} =0,}](https://wikimedia.org/api/rest_v1/media/math/render/svg/f2987fd6cd7291106becc2dd49f2942f1e30181a) where **j** is the flux of the diffusing material. The diffusion equation can be obtained easily from this when combined with the phenomenological [Fick's first law](https://en.wikipedia.org/wiki/Fick%27s_law "Fick's law"), which states that the flux of the diffusing material in any part of the system is proportional to the local density gradient: ![Image 5: {\displaystyle \mathbf {j} =-D(\phi ,\mathbf {r} )\,\nabla \phi (\mathbf {r} ,t).}](https://wikimedia.org/api/rest_v1/media/math/render/svg/cc11362d3d11992d993971a6b95d7676557167a3)

If drift must be taken into account, the [Fokker–Planck equation](https://en.wikipedia.org/wiki/Fokker%E2%80%93Planck_equation "Fokker–Planck equation") provides an appropriate generalization.

The diffusion equation is continuous in both space and time. One may discretize space, time, or both space and time, which arise in application. Discretizing time alone just corresponds to taking time slices of the continuous system, and no new phenomena arise. In discretizing space alone, the [Green's function](https://en.wikipedia.org/wiki/Green%27s_function "Green's function") becomes the [discrete Gaussian kernel](https://en.wikipedia.org/wiki/Discrete_Gaussian_kernel "Discrete Gaussian kernel"), rather than the continuous [Gaussian kernel](https://en.wikipedia.org/wiki/Gaussian_kernel "Gaussian kernel"). In discretizing both time and space, one obtains the [random walk](https://en.wikipedia.org/wiki/Random_walk "Random walk").

Discretization in image processing
----------------------------------

[[edit](https://en.wikipedia.org/w/index.php?title=Diffusion_equation&action=edit&section=5 "Edit section: Discretization in image processing")]

The [product rule](https://en.wikipedia.org/wiki/Product_rule "Product rule") is used to rewrite the anisotropic tensor diffusion equation, in standard discretization schemes, because direct discretization of the diffusion equation with only first order spatial central differences leads to checkerboard artifacts. The rewritten diffusion equation used in image filtering: ![Image 6: {\displaystyle {\frac {\partial \phi (\mathbf {r} ,t)}{\partial t}}=\nabla \cdot \left[D(\phi ,\mathbf {r} )\right]\nabla \phi (\mathbf {r} ,t)+{\rm {tr}}{\Big [}D(\phi ,\mathbf {r} ){\big (}\nabla \nabla ^{\text{T}}\phi (\mathbf {r} ,t){\big )}{\Big ]}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/57d7a01952a98ef98842a774946434e851c2b176) where "tr" denotes the [trace](https://en.wikipedia.org/wiki/Trace_(linear_algebra) "Trace (linear algebra)") of the 2nd rank [tensor](https://en.wikipedia.org/wiki/Tensor "Tensor"), and superscript "T" denotes [transpose](https://en.wikipedia.org/wiki/Transpose "Transpose"), in which in image filtering _D_(_ϕ_, **r**) are symmetric matrices constructed from the [eigenvectors](https://en.wikipedia.org/wiki/Eigenvectors "Eigenvectors") of the image [structure tensors](https://en.wikipedia.org/wiki/Structure_tensor "Structure tensor"). The spatial derivatives can then be approximated by two first order and a second order central [finite differences](https://en.wikipedia.org/wiki/Finite_difference "Finite difference"). The resulting diffusion algorithm can be written as an image [convolution](https://en.wikipedia.org/wiki/Convolution "Convolution") with a varying kernel (stencil) of size 3 × 3 in 2D and 3 × 3 × 3 in 3D.

*   [Continuity equation](https://en.wikipedia.org/wiki/Continuity_equation "Continuity equation")
*   [Heat equation](https://en.wikipedia.org/wiki/Heat_equation "Heat equation")
*   [Self-similar solutions](https://en.wikipedia.org/wiki/Self-similar_solution "Self-similar solution")
*   [Reaction-diffusion equation](https://en.wikipedia.org/wiki/Reaction-diffusion_equation "Reaction-diffusion equation")
*   [Fokker–Planck equation](https://en.wikipedia.org/wiki/Fokker%E2%80%93Planck_equation "Fokker–Planck equation")
*   [Fick's laws of diffusion](https://en.wikipedia.org/wiki/Fick%27s_laws_of_diffusion "Fick's laws of diffusion")
*   [Maxwell–Stefan equation](https://en.wikipedia.org/wiki/Maxwell%E2%80%93Stefan_equation "Maxwell–Stefan equation")
*   [Radiative transfer equation and diffusion theory for photon transport in biological tissue](https://en.wikipedia.org/wiki/Radiative_transfer_equation_and_diffusion_theory_for_photon_transport_in_biological_tissue "Radiative transfer equation and diffusion theory for photon transport in biological tissue")
*   [Streamline diffusion](https://en.wikipedia.org/wiki/Streamline_diffusion "Streamline diffusion")
*   [Numerical solution of the convection–diffusion equation](https://en.wikipedia.org/wiki/Numerical_solution_of_the_convection%E2%80%93diffusion_equation "Numerical solution of the convection–diffusion equation")

1.   **[^](https://en.wikipedia.org/wiki/Diffusion_equation#cite_ref-1 "Jump up")**Barna, I.F.; Mátyás, L. (2022). ["Advanced Analytic Self-Similar Solutions of Regular and Irregular Diffusion Equations"](https://doi.org/10.3390%2Fmath10183281). _Mathematics_. **10** (18): 3281. [arXiv](https://en.wikipedia.org/wiki/ArXiv_(identifier) "ArXiv (identifier)"):[2204.04895](https://arxiv.org/abs/2204.04895). [doi](https://en.wikipedia.org/wiki/Doi_(identifier) "Doi (identifier)"):[10.3390/math10183281](https://doi.org/10.3390%2Fmath10183281).
2.   **[^](https://en.wikipedia.org/wiki/Diffusion_equation#cite_ref-Fick1855_2-0 "Jump up")**Fick, Adolf (1855). ["Ueber Diffusion"](https://doi.org/10.1002%2Fandp.18551700105). _Annalen der Physik und Chemie_. **170** (1): 59–86. [Bibcode](https://en.wikipedia.org/wiki/Bibcode_(identifier) "Bibcode (identifier)"):[1855AnP...170...59F](https://ui.adsabs.harvard.edu/abs/1855AnP...170...59F). [doi](https://en.wikipedia.org/wiki/Doi_(identifier) "Doi (identifier)"):[10.1002/andp.18551700105](https://doi.org/10.1002%2Fandp.18551700105). [ISSN](https://en.wikipedia.org/wiki/ISSN_(identifier) "ISSN (identifier)")[0003-3804](https://search.worldcat.org/issn/0003-3804).

*   Mehrer, H.; Stolwijk, A (2009). ["Heroes and Highlights in the History of Diffusion"](https://www.diffusion-fundamentals.org/journal/11/index11.html). _Diffusion Fundamentals_. **11**: 1–32. [doi](https://en.wikipedia.org/wiki/Doi_(identifier) "Doi (identifier)"):[10.62721/diffusion-fundamentals.11.453](https://doi.org/10.62721%2Fdiffusion-fundamentals.11.453).
*   Carslaw, H. S. and Jaeger, J. C. (1959). _Conduction of Heat in Solids_ Oxford: Clarendon Press
*   Jacobs, M.H. (1935). _Diffusion Processes_ Berlin/Heidelberg: Springer
*   Crank, J. (1956). _The Mathematics of Diffusion_ Oxford: Clarendon Press
*   Mathews, Jon; Walker, Robert L. (1970). _Mathematical methods of physics_ (2nd ed.), New York: W. A. Benjamin, [ISBN](https://en.wikipedia.org/wiki/ISBN_(identifier) "ISBN (identifier)")[0-8053-7002-1](https://en.wikipedia.org/wiki/Special:BookSources/0-8053-7002-1 "Special:BookSources/0-8053-7002-1")
*   Thambynayagam, R. K. M (2011). _The Diffusion Handbook: Applied Solutions for Engineers_. McGraw-Hill
*   Ghez, R. (1988). _A Primer Of Diffusion Problems,_ Wiley
*   Ghez, R. (2001). _Diffusion Phenomena_. Long Island, NY, USA: Dover Publication Inc
*   Pekalski, A. (1994). _Diffusion Processes: Experiment, Theory, Simulations,_ Springer
*   Bennett, T.D. (2013). _Transport by Advection and Diffusion._ John Wiley & Sons
*   Vogel, G. (2019). _Adventure Diffusion_ Springer
*   Gillespie, D.T.; Seitaridou, E (2013). _Simple Brownian Diffusion,_ Oxford University Press
*   Nakicenovic, N.; Griübler, A.: (1991). _Diffusion of Technologies and Social Behavior_; Springer
*   Michaud, G.; Alecian, G.; Richer, G.: (2013). _Atomic Diffusion in Stars_, Springer
*   Stroock, D. W.:, Varadhan, S.R.S.: (2006). _Multidimensional diffusion processes,_ Springer
*   Zhuoqun, W., Yin J., Li H., Zhao J., Jingxue Y., and Huilai L. (2001). _Nonlinear diffusion equations,_ World Scientific
*   Shewmon, P. (1989). _Diffusion in Solids_, Wiley
*   Banks, R.B. (2010). _Growth and diffusion phenomena,_ Springer
*   Roque-Malherbe, R.M.A. (2007). _Adsorption and Diffusion in Nanoporous Materials,_ CRC Press
*   Cunningham, R. (1980). _Diffusion in gases and porous media,_ Plenum
*   Pasquill, F., Smith, F.B. (1983). _Atmospheric diffusion,_ Horwood
*   Ikeda, N., Watanabe, S. (1981). _Stochastic Differential Equations and Diffusion Processes, Elsevier,_ Academic Press
*   Philibert, J., Laskar, A.L., Bocquet, J.L., Brebec, G., Monty, C. (1990). _Diffusion in Materials,_ Springer Netherlands
*   Freedman, D., (1983). _Brownian Motion and Diffusion_, Springer-Verlag New York
*   Nagasawa, M., (1993). _Schrödinger Equations and Diffusion Theory,_ Birkhäuser
*   [Burgers, J.M.](https://en.wikipedia.org/wiki/J._M._Burgers "J. M. Burgers"), (1974). T _he Nonlinear Diffusion Equation: Asymptotic Solutions and Statistical Problems,_ Springer Netherlands
*   Ito, S., (1992). _Diffusion Equations_, American Mathematical Society
*   Krylov, N. V. (1994). _Introduction to the Theory of Diffusion Processes,_ American Mathematical Society
*   Knight, F.B., (1981). _Essentials of Brownian Motion and Diffusion,_ American Mathematical Society
*   Ibe, O.C., (2013 _). Elements of random walk and diffusion processes,_ Wiley
*   Dattagupta, S. (2013). _Diffusion: Formalism and Applications_, CRC Press

*   [Diffusion Calculator for Impurities & Dopants in Silicon](http://www.ee.byu.edu/cleanroom/DopConCalc.phtml)[Archived](https://web.archive.org/web/20090502033108/http://ee.byu.edu/cleanroom/DopConCalc.phtml) 2009-05-02 at the [Wayback Machine](https://en.wikipedia.org/wiki/Wayback_Machine "Wayback Machine")
*   [A tutorial on the theory behind and solution of the Diffusion Equation.](https://www.dropbox.com/s/s0470m594llwcc7/diffusion.pdf?raw=1)
*   [Classical and nanoscale diffusion (with figures and animations)](https://dragon.unideb.hu/~zerdelyi/Diffusion-on-the-nanoscale/index.html)
