Title: Line–line intersection

URL Source: https://en.wikipedia.org/wiki/Two_intersecting_lines

Published Time: 2006-12-03T00:20:23Z

Markdown Content:
From Wikipedia, the free encyclopedia

[![Image 1](https://upload.wikimedia.org/wikipedia/commons/thumb/f/ff/Line-Line_Intersection.png/500px-Line-Line_Intersection.png)](https://en.wikipedia.org/wiki/File:Line-Line_Intersection.png)

Two intersecting lines

In [Euclidean geometry](https://en.wikipedia.org/wiki/Euclidean_geometry "Euclidean geometry"), the **intersection of a line and a line** can be the [empty set](https://en.wikipedia.org/wiki/Empty_set "Empty set"), a [point](https://en.wikipedia.org/wiki/Point_(geometry) "Point (geometry)"), or another [line](https://en.wikipedia.org/wiki/Line_(geometry) "Line (geometry)"). Distinguishing these cases and finding the [intersection](https://en.wikipedia.org/wiki/Intersection_(Euclidean_geometry) "Intersection (Euclidean geometry)") have uses, for example, in [computer graphics](https://en.wikipedia.org/wiki/Computer_graphics "Computer graphics"), [motion planning](https://en.wikipedia.org/wiki/Motion_planning "Motion planning"), and [collision detection](https://en.wikipedia.org/wiki/Collision_detection "Collision detection").

In [three-dimensional](https://en.wikipedia.org/wiki/Three-dimensional "Three-dimensional") Euclidean geometry, if two lines are not in the same [plane](https://en.wikipedia.org/wiki/Plane_(geometry) "Plane (geometry)"), they have no point of intersection [[1]](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_note-1) and are called [skew lines](https://en.wikipedia.org/wiki/Skew_lines "Skew lines"). If they are in the same plane, however, there are three possibilities: if they coincide (are not distinct lines), they have an [infinitude](https://en.wikipedia.org/wiki/Infinitude "Infinitude") of points in common (namely all of the points on either of them); if they are distinct but have the same [slope](https://en.wikipedia.org/wiki/Slope "Slope"), they are said to be [parallel](https://en.wikipedia.org/wiki/Parallel_(geometry) "Parallel (geometry)") and have no points in common; otherwise, they have a single point of intersection.

The distinguishing features of [non-Euclidean geometry](https://en.wikipedia.org/wiki/Non-Euclidean_geometry "Non-Euclidean geometry") are the number and locations of possible intersections between two lines and the number of possible lines with no intersections (parallel lines) with a given line.[_[further explanation needed](https://en.wikipedia.org/wiki/Wikipedia:Please\_clarify "Wikipedia:Please clarify")_]

A [necessary condition](https://en.wikipedia.org/wiki/Necessary_condition "Necessary condition") for two lines to intersect is that they are in the same plane—that is, are not skew lines. Satisfaction of this condition is equivalent to the [tetrahedron](https://en.wikipedia.org/wiki/Tetrahedron "Tetrahedron") with vertices at two of the points on one line and two of the points on the other line being [degenerate](https://en.wikipedia.org/wiki/Degeneracy_(mathematics) "Degeneracy (mathematics)") in the sense of having zero [volume](https://en.wikipedia.org/wiki/Volume "Volume"). For the algebraic form of this condition, see [Skew lines §Testing for skewness](https://en.wikipedia.org/wiki/Skew_lines#Testing_for_skewness "Skew lines").

### Given two points on each line

[[edit](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=2 "Edit section: Given two points on each line")]

First we consider the intersection of two lines _L_ 1 and _L_ 2 in two-dimensional space, with line _L_ 1 being defined by two distinct points (_x_ 1, _y_ 1) and (_x_ 2, _y_ 2), and line _L_ 2 being defined by two distinct points (_x_ 3, _y_ 3) and (_x_ 4, _y_ 4).[[2]](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_note-Wolfram-2)

The intersection P of line _L_ 1 and _L_ 2 can be defined using [determinants](https://en.wikipedia.org/wiki/Determinant "Determinant").

![Image 2: {\displaystyle P_{x}={\frac {\begin{vmatrix}{\begin{vmatrix}x_{1}&y_{1}\\x_{2}&y_{2}\end{vmatrix}}&{\begin{vmatrix}x_{1}&1\\x_{2}&1\end{vmatrix}}\\\\{\begin{vmatrix}x_{3}&y_{3}\\x_{4}&y_{4}\end{vmatrix}}&{\begin{vmatrix}x_{3}&1\\x_{4}&1\end{vmatrix}}\end{vmatrix}}{\begin{vmatrix}{\begin{vmatrix}x_{1}&1\\x_{2}&1\end{vmatrix}}&{\begin{vmatrix}y_{1}&1\\y_{2}&1\end{vmatrix}}\\\\{\begin{vmatrix}x_{3}&1\\x_{4}&1\end{vmatrix}}&{\begin{vmatrix}y_{3}&1\\y_{4}&1\end{vmatrix}}\end{vmatrix}}}\,\!\qquad P_{y}={\frac {\begin{vmatrix}{\begin{vmatrix}x_{1}&y_{1}\\x_{2}&y_{2}\end{vmatrix}}&{\begin{vmatrix}y_{1}&1\\y_{2}&1\end{vmatrix}}\\\\{\begin{vmatrix}x_{3}&y_{3}\\x_{4}&y_{4}\end{vmatrix}}&{\begin{vmatrix}y_{3}&1\\y_{4}&1\end{vmatrix}}\end{vmatrix}}{\begin{vmatrix}{\begin{vmatrix}x_{1}&1\\x_{2}&1\end{vmatrix}}&{\begin{vmatrix}y_{1}&1\\y_{2}&1\end{vmatrix}}\\\\{\begin{vmatrix}x_{3}&1\\x_{4}&1\end{vmatrix}}&{\begin{vmatrix}y_{3}&1\\y_{4}&1\end{vmatrix}}\end{vmatrix}}}\,\!}](https://wikimedia.org/api/rest_v1/media/math/render/svg/e750e00a5179c59dd228cc3dcdb1818a4bb89c9d)
The determinants can be written out as:

![Image 3: {\displaystyle {\begin{aligned}P_{x}&={\frac {(x_{1}y_{2}-y_{1}x_{2})(x_{3}-x_{4})-(x_{1}-x_{2})(x_{3}y_{4}-y_{3}x_{4})}{(x_{1}-x_{2})(y_{3}-y_{4})-(y_{1}-y_{2})(x_{3}-x_{4})}}\\[4px]P_{y}&={\frac {(x_{1}y_{2}-y_{1}x_{2})(y_{3}-y_{4})-(y_{1}-y_{2})(x_{3}y_{4}-y_{3}x_{4})}{(x_{1}-x_{2})(y_{3}-y_{4})-(y_{1}-y_{2})(x_{3}-x_{4})}}\end{aligned}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/013a4193eae935296d58199bf902574a99c34a5f)
When the two lines are parallel or coincident, the denominator is zero.

### Given two points on each line segment

[[edit](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=3 "Edit section: Given two points on each line segment")]

The intersection point above is for the infinitely long lines defined by the points, rather than the [line segments](https://en.wikipedia.org/wiki/Line_segment "Line segment") between the points, and can produce an intersection point not contained in either of the two line segments. In order to find the position of the intersection in respect to the line segments, we can define lines _L_ 1 and _L_ 2 in terms of first degree [Bézier](https://en.wikipedia.org/wiki/B%C3%A9zier_curve#Linear_curves "Bézier curve") parameters:

![Image 4: {\displaystyle L_{1}={\begin{bmatrix}x_{1}\\y_{1}\end{bmatrix}}+t{\begin{bmatrix}x_{2}-x_{1}\\y_{2}-y_{1}\end{bmatrix}},\qquad L_{2}={\begin{bmatrix}x_{3}\\y_{3}\end{bmatrix}}+u{\begin{bmatrix}x_{4}-x_{3}\\y_{4}-y_{3}\end{bmatrix}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/b180feb8dad306a549cc755223444e3c9f010f95)
(where t and u are real numbers). The intersection point of the lines is found with one of the following values of t or u, where

![Image 5: {\displaystyle t={\frac {\begin{vmatrix}x_{1}-x_{3}&x_{3}-x_{4}\\y_{1}-y_{3}&y_{3}-y_{4}\end{vmatrix}}{\begin{vmatrix}x_{1}-x_{2}&x_{3}-x_{4}\\y_{1}-y_{2}&y_{3}-y_{4}\end{vmatrix}}}={\frac {(x_{1}-x_{3})(y_{3}-y_{4})-(y_{1}-y_{3})(x_{3}-x_{4})}{(x_{1}-x_{2})(y_{3}-y_{4})-(y_{1}-y_{2})(x_{3}-x_{4})}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/3037b45bc402892dc1273dc0c3b70532f3bcda39)
and

![Image 6: {\displaystyle u=-{\frac {\begin{vmatrix}x_{1}-x_{2}&x_{1}-x_{3}\\y_{1}-y_{2}&y_{1}-y_{3}\end{vmatrix}}{\begin{vmatrix}x_{1}-x_{2}&x_{3}-x_{4}\\y_{1}-y_{2}&y_{3}-y_{4}\end{vmatrix}}}=-{\frac {(x_{1}-x_{2})(y_{1}-y_{3})-(y_{1}-y_{2})(x_{1}-x_{3})}{(x_{1}-x_{2})(y_{3}-y_{4})-(y_{1}-y_{2})(x_{3}-x_{4})}},}](https://wikimedia.org/api/rest_v1/media/math/render/svg/d2febaeb9de5a981322cdba521b33934dbfe62ce)
with

![Image 7: {\displaystyle (P_{x},P_{y})={\bigl (}x_{1}+t(x_{2}-x_{1}),\;y_{1}+t(y_{2}-y_{1}){\bigr )}\quad {\text{or}}\quad (P_{x},P_{y})={\bigl (}x_{3}+u(x_{4}-x_{3}),\;y_{3}+u(y_{4}-y_{3}){\bigr )}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/47fdf67cdcdd9e9cc4be4ed0bc638c959df90635)
There will be an intersection if 0 ≤ _t_ ≤ 1 and 0 ≤ _u_ ≤ 1. The intersection point falls within the first line segment if 0 ≤ _t_ ≤ 1, and it falls within the second line segment if 0 ≤ _u_ ≤ 1. These inequalities can be tested without the need for division, allowing rapid determination of the existence of any line segment intersection before calculating its exact point.[[3]](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_note-GGIII-3)

In the case where the two line segments share an x axis and ![Image 8: {\displaystyle x_{2}=x_{1}+1}](https://wikimedia.org/api/rest_v1/media/math/render/svg/fb0180f001a6838cd26956584ebc47815829c09d), ![Image 9: {\displaystyle t}](https://wikimedia.org/api/rest_v1/media/math/render/svg/65658b7b223af9e1acc877d848888ecdb4466560) and ![Image 10: {\displaystyle u}](https://wikimedia.org/api/rest_v1/media/math/render/svg/c3e6bb763d22c20916ed4f0bb6bd49d7470cffd8) simplify to ![Image 11: {\displaystyle t=u={\frac {y_{1}-y_{3}}{y_{1}-y_{2}-y_{3}+y_{4}}},}](https://wikimedia.org/api/rest_v1/media/math/render/svg/a7464e878ed62a1d782ef932f4247ea65aa08aae) with ![Image 12: {\displaystyle (P_{x},P_{y})={\bigl (}x_{1}+t,\;y_{1}+t(y_{2}-y_{1}){\bigr )}\quad {\text{or}}\quad (P_{x},P_{y})={\bigl (}x_{1}+t,\;y_{3}+t(y_{4}-y_{3}){\bigr )}.}](https://wikimedia.org/api/rest_v1/media/math/render/svg/c925e4ab9a8456662b6328758fcf8be89514c739)

### Given two line equations

[[edit](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=4 "Edit section: Given two line equations")]

The x and y coordinates of the point of intersection of two non-vertical lines can easily be found using the following substitutions and rearrangements.

Suppose that two lines have the equations _y_ = _ax_ + _c_ and _y_ = _bx_ + _d_ where a and b are the [slopes](https://en.wikipedia.org/wiki/Slope "Slope") (gradients) of the lines and where c and d are the y-intercepts of the lines. At the point where the two lines intersect (if they do), both y coordinates will be the same, hence the following equality:

![Image 13: {\displaystyle ax+c=bx+d.}](https://wikimedia.org/api/rest_v1/media/math/render/svg/d6d09b52dff9b1354e1d0d1e383680799f9530e3)
We can rearrange this expression in order to extract the value of x,

![Image 14: {\displaystyle ax-bx=d-c,}](https://wikimedia.org/api/rest_v1/media/math/render/svg/8220888be24a3f2bb735c2e7613fe0d651ea29b1)
and so,

![Image 15: {\displaystyle x={\frac {d-c}{a-b}}.}](https://wikimedia.org/api/rest_v1/media/math/render/svg/b648fabd05ebf1703f11a55fcc29f3a438b84534)
To find the y coordinate, all we need to do is substitute the value of x into either one of the two line equations, for example, into the first:

![Image 16: {\displaystyle y=a{\frac {d-c}{a-b}}+c.}](https://wikimedia.org/api/rest_v1/media/math/render/svg/c4807b1aada38c4daf9f4d187f9594c82ed72365)
Hence, the point of intersection is

![Image 17: {\displaystyle P=\left({\frac {d-c}{a-b}},a{\frac {d-c}{a-b}}+c\right).}](https://wikimedia.org/api/rest_v1/media/math/render/svg/dd0c8920e7d05a752bb8084ddf066f3ac1196f26)
Note that if _a_ = _b_ then the two lines are [parallel](https://en.wikipedia.org/wiki/Parallel_(geometry) "Parallel (geometry)") and they do not intersect, unless _c_ = _d_ as well, in which case the lines are coincident and they intersect at every point.

### Using homogeneous coordinates

[[edit](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=5 "Edit section: Using homogeneous coordinates")]

By using [homogeneous coordinates](https://en.wikipedia.org/wiki/Homogeneous_coordinates "Homogeneous coordinates"), the intersection point of two implicitly defined lines can be determined quite easily. In 2D, every point can be defined as a projection of a 3D point, given as the ordered triple (_x_, _y_, _w_). The mapping from 3D to 2D coordinates is (_x_′, _y_′) = (⁠_x_/_w_⁠, ⁠_y_/_w_⁠). We can convert 2D points to homogeneous coordinates by defining them as (_x_, _y_, 1).

Assume that we want to find intersection of two infinite lines in 2-dimensional space, defined as _a_ 1 _x_ + _b_ 1 _y_ + _c_ 1 = 0 and _a_ 2 _x_ + _b_ 2 _y_ + _c_ 2 = 0. We can represent these two lines in [line coordinates](https://en.wikipedia.org/wiki/Line_coordinates "Line coordinates") as _U_ 1 = (_a_ 1, _b_ 1, _c_ 1) and _U_ 2 = (_a_ 2, _b_ 2, _c_ 2). The intersection _P_′ of two lines is then simply given by[[4]](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_note-4)

![Image 18: {\displaystyle P'=(a_{p},b_{p},c_{p})=U_{1}\times U_{2}=(b_{1}c_{2}-b_{2}c_{1},a_{2}c_{1}-a_{1}c_{2},a_{1}b_{2}-a_{2}b_{1})}](https://wikimedia.org/api/rest_v1/media/math/render/svg/64a98c8d2431dd018fafc1b9083f8fa6fe856639)
If _c p_ = 0, the lines do not intersect.

More than two lines
-------------------

[[edit](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=6 "Edit section: More than two lines")]

The intersection of two lines can be generalized to involve additional lines. The existence of and expression for the n-line intersection problem are as follows.

In two dimensions, more than two lines [almost certainly](https://en.wikipedia.org/wiki/Almost_certainly "Almost certainly") do not intersect at a single point. To determine if they do and, if so, to find the intersection point, write the i th equation (_i_ = 1, …, _n_) as

![Image 19: {\displaystyle {\begin{bmatrix}a_{i1}&a_{i2}\end{bmatrix}}{\begin{bmatrix}x\\y\end{bmatrix}}=b_{i},}](https://wikimedia.org/api/rest_v1/media/math/render/svg/298a26cf6811e0247994cd227688e2a3f8b1dc6d)
and stack these equations into matrix form as

![Image 20: {\displaystyle \mathbf {A} \mathbf {w} =\mathbf {b} ,}](https://wikimedia.org/api/rest_v1/media/math/render/svg/518868e98c6a7166eb0312feb0c1485d9e09664f)
where the i th row of the _n_ × 2 matrix **A** is [_a_ _i_ 1, _a_ _i_ 2], **w** is the 2 × 1 vector [_x_

_y_], and the i th element of the column vector **b** is _b_ _i_. If **A** has independent columns, its [rank](https://en.wikipedia.org/wiki/Matrix_rank "Matrix rank") is 2. Then if and only if the rank of the [augmented matrix](https://en.wikipedia.org/wiki/Augmented_matrix "Augmented matrix")[**A** | **b**] is also 2, there exists a solution of the matrix equation and thus an intersection point of the n lines. The intersection point, if it exists, is given by

![Image 21: {\displaystyle \mathbf {w} =\mathbf {A} ^{\mathrm {g} }\mathbf {b} =\left(\mathbf {A} ^{\mathsf {T}}\mathbf {A} \right)^{-1}\mathbf {A} ^{\mathsf {T}}\mathbf {b} ,}](https://wikimedia.org/api/rest_v1/media/math/render/svg/db7a77f3c0c561597672d6bbab223389fbeb265e)
where **A**g is the [Moore–Penrose generalized inverse](https://en.wikipedia.org/wiki/Moore%E2%80%93Penrose_inverse "Moore–Penrose inverse") of **A** (which has the form shown because **A** has full column rank). Alternatively, the solution can be found by jointly solving any two independent equations. But if the rank of **A** is only 1, then if the rank of the augmented matrix is 2 there is no solution but if its rank is 1 then all of the lines coincide with each other.

### In three dimensions

[[edit](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=8 "Edit section: In three dimensions")]

The above approach can be readily extended to three dimensions. In three or more dimensions, even two lines almost certainly do not intersect; pairs of non-parallel lines that do not intersect are called [skew lines](https://en.wikipedia.org/wiki/Skew_lines "Skew lines"). But if an intersection does exist it can be found, as follows.

In three dimensions a line is represented by the intersection of two planes, each of which has an equation of the form

![Image 22: {\displaystyle {\begin{bmatrix}a_{i1}&a_{i2}&a_{i3}\end{bmatrix}}{\begin{bmatrix}x\\y\\z\end{bmatrix}}=b_{i}.}](https://wikimedia.org/api/rest_v1/media/math/render/svg/602b520329d25a88d529d641c55abfe7878b7ebd)
Thus a set of n lines can be represented by 2 _n_ equations in the 3-dimensional coordinate vector **w**:

![Image 23: {\displaystyle \mathbf {A} \mathbf {w} =\mathbf {b} }](https://wikimedia.org/api/rest_v1/media/math/render/svg/916c1f6081563dfc96d29f08660ab0b00d6f9fbf)
where now **A** is 2 _n_ × 3 and **b** is 2 _n_ × 1. As before there is a unique intersection point if and only if **A** has full column rank and the augmented matrix [**A** | **b**] does not, and the unique intersection if it exists is given by

![Image 24: {\displaystyle \mathbf {w} =\left(\mathbf {A} ^{\mathsf {T}}\mathbf {A} \right)^{-1}\mathbf {A} ^{\mathsf {T}}\mathbf {b} .}](https://wikimedia.org/api/rest_v1/media/math/render/svg/b30ef9641ae1df1fb02047cedd808b9286f66607)

Nearest points to skew lines
----------------------------

[[edit](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=9 "Edit section: Nearest points to skew lines")]

[![Image 25](https://upload.wikimedia.org/wikipedia/commons/thumb/e/ee/Skew_lines_shortest_distance.svg/330px-Skew_lines_shortest_distance.svg.png)](https://en.wikipedia.org/wiki/File:Skew_lines_shortest_distance.svg)

PQ, the shortest distance between two skew lines AB and CD is perpendicular to both AB and CD

In two or more dimensions, we can usually find a point that is mutually closest to two or more lines in a [least-squares](https://en.wikipedia.org/wiki/Least-squares "Least-squares") sense.

In the two-dimensional case, first, represent line i as a point **p**_i_ on the line and a [unit](https://en.wikipedia.org/wiki/Unit_vector "Unit vector")[normal vector](https://en.wikipedia.org/wiki/Normal_vector "Normal vector")**n̂**_i_, perpendicular to that line. That is, if **x**1 and **x**2 are points on line 1, then let **p**1 = **x**1 and let

![Image 26: {\displaystyle \mathbf {\hat {n}} _{1}:={\begin{bmatrix}0&-1\\1&0\end{bmatrix}}{\frac {\mathbf {x} _{2}-\mathbf {x} _{1}}{\|\mathbf {x} _{2}-\mathbf {x} _{1}\|}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/274aa7f73379f17bce3903650683e8a7827fabd6)
which is the unit vector along the line, rotated by a right angle.

The distance from a point **x** to the line (**p**, **n̂**) is given by

![Image 27: {\displaystyle d{\bigl (}\mathbf {x} ,(\mathbf {p} ,\mathbf {\hat {n}} ){\bigr )}={\bigl |}(\mathbf {x} -\mathbf {p} )\cdot \mathbf {\hat {n}} {\bigr |}=\left|(\mathbf {x} -\mathbf {p} )^{\mathsf {T}}\mathbf {\hat {n}} \right|=\left|\mathbf {\hat {n}} ^{\mathsf {T}}(\mathbf {x} -\mathbf {p} )\right|={\sqrt {(\mathbf {x} -\mathbf {p} )^{\mathsf {T}}\mathbf {\hat {n}} \mathbf {\hat {n}} ^{\mathsf {T}}(\mathbf {x} -\mathbf {p} )}}.}](https://wikimedia.org/api/rest_v1/media/math/render/svg/14e42c1e230c36db7733149bbeb0a22d60299f3e)
And so the squared distance from a point **x** to a line is

![Image 28: {\displaystyle d{\bigl (}\mathbf {x} ,(\mathbf {p} ,\mathbf {\hat {n}} ){\bigr )}^{2}=(\mathbf {x} -\mathbf {p} )^{\mathsf {T}}\left(\mathbf {\hat {n}} \mathbf {\hat {n}} ^{\mathsf {T}}\right)(\mathbf {x} -\mathbf {p} ).}](https://wikimedia.org/api/rest_v1/media/math/render/svg/32f15e8a0f8a966f2a093b887ec301c18903e076)
The sum of squared distances to many lines is the [cost function](https://en.wikipedia.org/wiki/Loss_function "Loss function"):

![Image 29: {\displaystyle E(\mathbf {x} )=\sum _{i}(\mathbf {x} -\mathbf {p} _{i})^{\mathsf {T}}\left(\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\right)(\mathbf {x} -\mathbf {p} _{i}).}](https://wikimedia.org/api/rest_v1/media/math/render/svg/0ee99345dd74a1b056833780e0e3e3b5649d4fa6)
This can be rearranged:

![Image 30: {\displaystyle {\begin{aligned}E(\mathbf {x} )&=\sum _{i}\mathbf {x} ^{\mathsf {T}}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\mathbf {x} -\mathbf {x} ^{\mathsf {T}}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\mathbf {p} _{i}-\mathbf {p} _{i}^{\mathsf {T}}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\mathbf {x} +\mathbf {p} _{i}^{\mathsf {T}}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\mathbf {p} _{i}\\&=\mathbf {x} ^{\mathsf {T}}\left(\sum _{i}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\right)\mathbf {x} -2\mathbf {x} ^{\mathsf {T}}\left(\sum _{i}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\mathbf {p} _{i}\right)+\sum _{i}\mathbf {p} _{i}^{\mathsf {T}}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\mathbf {p} _{i}.\end{aligned}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/efbc8441860702bab338097c323c73ee9057cb39)
To find the minimum, we differentiate with respect to **x** and set the result equal to the zero vector:

![Image 31: {\displaystyle {\frac {\partial E(\mathbf {x} )}{\partial \mathbf {x} }}={\boldsymbol {0}}=2\left(\sum _{i}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\right)\mathbf {x} -2\left(\sum _{i}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\mathbf {p} _{i}\right)}](https://wikimedia.org/api/rest_v1/media/math/render/svg/424f0b34f839b19fc40878fe7aba1bafd45e749e)
so

![Image 32: {\displaystyle \left(\sum _{i}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\right)\mathbf {x} =\sum _{i}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\mathbf {p} _{i}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/525909b22e699148d2a4ad6c9ff895056f267c97)
and so

![Image 33: {\displaystyle \mathbf {x} =\left(\sum _{i}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\right)^{-1}\left(\sum _{i}\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\mathbf {p} _{i}\right).}](https://wikimedia.org/api/rest_v1/media/math/render/svg/59933487d2480701381930215278b1abb55dd234)

### In more than two dimensions

[[edit](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=11 "Edit section: In more than two dimensions")]

While **n̂**_i_ is not well-defined in more than two dimensions, this can be generalized to any number of dimensions by noting that **n̂**_i_**n̂**_i_ T is simply the symmetric matrix with all eigenvalues unity except for a zero eigenvalue in the direction along the line providing a [seminorm](https://en.wikipedia.org/wiki/Seminorm "Seminorm") on the distance between **p**_i_ and another point giving the distance to the line. In any number of dimensions, if **v̂**_i_ is a unit vector _along_ the i th line, then

![Image 34: {\displaystyle \mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/b7559e75c74d9c8df3e20ec175e23ebcbe4e7908) becomes ![Image 35: {\displaystyle \mathbf {I} -\mathbf {\hat {v}} _{i}\mathbf {\hat {v}} _{i}^{\mathsf {T}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/98d0b18b738c16ff6b319b0b2f35cafa8ca825cf)
where **I** is the [identity matrix](https://en.wikipedia.org/wiki/Identity_matrix "Identity matrix"), and so[[5]](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_note-5)

![Image 36: {\displaystyle x=\left(\sum _{i}\mathbf {I} -\mathbf {\hat {v}} _{i}\mathbf {\hat {v}} _{i}^{\mathsf {T}}\right)^{-1}\left(\sum _{i}\left(\mathbf {I} -\mathbf {\hat {v}} _{i}\mathbf {\hat {v}} _{i}^{\mathsf {T}}\right)\mathbf {p} _{i}\right).}](https://wikimedia.org/api/rest_v1/media/math/render/svg/59b6dd18514dfd3297afdc77848b78bdc719c659)
In order to find the intersection point of a set of lines, we calculate the point with minimum distance to them. Each line is defined by an origin **a**_i_ and a unit direction vector **n̂**_i_. The square of the distance from a point **p** to one of the lines is given from Pythagoras:

![Image 37: {\displaystyle d_{i}^{2}=\left\|\mathbf {p} -\mathbf {a} _{i}\right\|^{2}-\left(\left(\mathbf {p} -\mathbf {a} _{i}\right)^{\mathsf {T}}\mathbf {\hat {n}} _{i}\right)^{2}=\left(\mathbf {p} -\mathbf {a} _{i}\right)^{\mathsf {T}}\left(\mathbf {p} -\mathbf {a} _{i}\right)-\left(\left(\mathbf {p} -\mathbf {a} _{i}\right)^{\mathsf {T}}\mathbf {\hat {n}} _{i}\right)^{2}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/7abdcab4695060f64e75e6881643c4fdc6ff0af9)
where (**p** − **a**_i_)T**n̂**_i_ is the projection of **p** − **a**_i_ on line i. The sum of distances to the square to all lines is

![Image 38: {\displaystyle \sum _{i}d_{i}^{2}=\sum _{i}\left({\left(\mathbf {p} -\mathbf {a} _{i}\right)^{\mathsf {T}}}\left(\mathbf {p} -\mathbf {a} _{i}\right)-{\left(\left(\mathbf {p} -\mathbf {a} _{i}\right)^{\mathsf {T}}\mathbf {\hat {n}} _{i}\right)^{2}}\right)}](https://wikimedia.org/api/rest_v1/media/math/render/svg/f02661a600d95c6a793fac3a0ad65554b0436f9b)
To minimize this expression, we differentiate it with respect to **p**.

![Image 39: {\displaystyle \sum _{i}\left(2\left(\mathbf {p} -\mathbf {a} _{i}\right)-2\left(\left(\mathbf {p} -\mathbf {a} _{i}\right)^{\mathsf {T}}\mathbf {\hat {n}} _{i}\right)\mathbf {\hat {n}} _{i}\right)={\boldsymbol {0}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/80a0b924e667c22a1b64d075aae8fdda547ec1f1)![Image 40: {\displaystyle \sum _{i}\left(\mathbf {p} -\mathbf {a} _{i}\right)=\sum _{i}\left(\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\right)\left(\mathbf {p} -\mathbf {a} _{i}\right)}](https://wikimedia.org/api/rest_v1/media/math/render/svg/32c1a8d36fe851f3d33a670233c53f62f94e21d3)
which results in

![Image 41: {\displaystyle \left(\sum _{i}\left(\mathbf {I} -\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\right)\right)\mathbf {p} =\sum _{i}\left(\mathbf {I} -\mathbf {\hat {n}} _{i}\mathbf {\hat {n}} _{i}^{\mathsf {T}}\right)\mathbf {a} _{i}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/196fe20984524b15ca8f392ae9c43368289a7b71)
where **I** is the [identity matrix](https://en.wikipedia.org/wiki/Identity_matrix "Identity matrix"). This is a matrix **Sp** = **C**, with solution **p** = **S**+**C**, where **S**+ is the [pseudo-inverse](https://en.wikipedia.org/wiki/Pseudo-inverse "Pseudo-inverse") of **S**.

Non-Euclidean geometry
----------------------

[[edit](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=13 "Edit section: Non-Euclidean geometry")]

[![Image 42: [icon]](https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/Wiki_letter_w_cropped.svg/20px-Wiki_letter_w_cropped.svg.png)](https://en.wikipedia.org/wiki/File:Wiki_letter_w_cropped.svg)This section **needs expansion**. You can help by [adding to it](https://en.wikipedia.org/w/index.php?title=Line%E2%80%93line_intersection&action=edit&section=). _(June 2022)_
[![Image 43: From left to right: Euclidean geometry, spherical geometry, and hyperbolic geometry](https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Euclidian_and_non_euclidian_geometry.png/250px-Euclidian_and_non_euclidian_geometry.png)](https://en.wikipedia.org/wiki/File:Euclidian_and_non_euclidian_geometry.png)

From left to right: Euclidean geometry, spherical geometry, and hyperbolic geometry

In [spherical geometry](https://en.wikipedia.org/wiki/Spherical_geometry "Spherical geometry"), any two great circles intersect.[[6]](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_note-:0-6)

In [hyperbolic geometry](https://en.wikipedia.org/wiki/Hyperbolic_geometry "Hyperbolic geometry"), given any line and any point, there are infinitely many lines through that point that do not intersect the given line.[[6]](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_note-:0-6)

*   [Line segment intersection](https://en.wikipedia.org/wiki/Line_segment_intersection "Line segment intersection")
*   [Line intersection in projective space](https://en.wikipedia.org/wiki/Projective_plane#Lines_joining_points_and_intersection_of_lines_.28using_duality.29 "Projective plane")
*   [Distance between two parallel lines](https://en.wikipedia.org/wiki/Distance_between_two_parallel_lines "Distance between two parallel lines")
*   [Distance from a point to a line](https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line "Distance from a point to a line")
*   [Line–plane intersection](https://en.wikipedia.org/wiki/Line%E2%80%93plane_intersection "Line–plane intersection")
*   [Parallel postulate](https://en.wikipedia.org/wiki/Parallel_postulate "Parallel postulate")
*   [Triangulation (computer vision)](https://en.wikipedia.org/wiki/Triangulation_(computer_vision) "Triangulation (computer vision)")
*   [Intersection (Euclidean geometry) §Two line segments](https://en.wikipedia.org/wiki/Intersection_(Euclidean_geometry)#Two_line_segments "Intersection (Euclidean geometry)")

1.   **[^](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_ref-1)**Cook, Jeremy (November 21, 2023). ["Coplanar Lines in Geometry | Definition, Diagrams & Examples"](https://study.com/academy/lesson/coplanar-lines-in-geometry-definition-lesson-quiz.html#:~:text=Non%2Dcoplanar%20lines%20are%20lines%20that%20are%20not%20on%20the,not%20in%20the%20same%20plane.). Retrieved November 1, 2024.
2.   **[^](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_ref-Wolfram_2-0)**[Weisstein, Eric W.](https://en.wikipedia.org/wiki/Eric_W._Weisstein "Eric W. Weisstein")["Line-Line Intersection"](https://mathworld.wolfram.com/Line-LineIntersection.html). _[MathWorld](https://en.wikipedia.org/wiki/MathWorld "MathWorld")_. Retrieved 2008-01-10.
3.   **[^](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_ref-GGIII_3-0)**Antonio, Franklin (1992). "Chapter IV.6: Faster Line Segment Intersection". In Kirk, David (ed.). _Graphics Gems III_. Academic Press, Inc. pp.199–202. [ISBN](https://en.wikipedia.org/wiki/ISBN_(identifier) "ISBN (identifier)")[0-12-059756-X](https://en.wikipedia.org/wiki/Special:BookSources/0-12-059756-X "Special:BookSources/0-12-059756-X").
4.   **[^](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_ref-4)**Birchfield, Stanley (1998-04-23). ["Homogeneous coordinates"](http://robotics.stanford.edu/~birch/projective/node4.html). _robotics.stanford.edu_. [Archived](https://web.archive.org/web/20000929025956/http://robotics.stanford.edu/~birch/projective/node4.html) from the original on 2000-09-29. Retrieved 2015-08-18.
5.   **[^](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_ref-5)**Traa, Johannes (2013). ["Least-Squares Intersection of Lines"](https://web.archive.org/web/20170912055605/http://cal.cs.illinois.edu/~johannes/research/LS_line_intersect.pdf)(PDF). _cal.cs.illinois.edu_. Archived from [the original](http://cal.cs.illinois.edu/~johannes/research/LS_line_intersect.pdf)(PDF) on 2017-09-12. Retrieved 2018-08-30.
6.   ^ [_**a**_](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_ref-:0_6-0)[_**b**_](https://en.wikipedia.org/wiki/Two_intersecting_lines#cite_ref-:0_6-1)["Exploring Hyperbolic Space"](https://math.berkeley.edu/~kpmann/Hyperbolic%20and%20Spherical%20geometries.pdf)(PDF). _math.berkeley.edu_. Retrieved 2022-06-03.

*   [Distance between Lines and Segments with their Closest Point of Approach](http://softsurfer.com/Archive/algorithm_0106/algorithm_0106.htm), applicable to two, three, or more dimensions.
