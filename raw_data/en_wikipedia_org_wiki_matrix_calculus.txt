Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Scope Toggle Scope subsection 1.1 Relation to other derivatives 1.2 Usages 2 Notation Toggle Notation subsection 2.1 Alternatives 3 Derivatives with vectors Toggle Derivatives with vectors subsection 3.1 Vector-by-scalar 3.2 Scalar-by-vector 3.3 Vector-by-vector 4 Derivatives with matrices Toggle Derivatives with matrices subsection 4.1 Matrix-by-scalar 4.2 Scalar-by-matrix 4.3 Other matrix derivatives 5 Layout conventions Toggle Layout conventions subsection 5.1 Numerator-layout notation 5.2 Denominator-layout notation 6 Identities Toggle Identities subsection 6.1 Vector-by-vector identities 6.2 Scalar-by-vector identities 6.3 Vector-by-scalar identities 6.4 Scalar-by-matrix identities 6.5 Matrix-by-scalar identities 6.6 Scalar-by-scalar identities 6.6.1 With vectors involved 6.6.2 With matrices involved 6.7 Identities in differential form 7 Applications 8 See also 9 Notes 10 References 11 Further reading 12 External links Toggle External links subsection 12.1 Software 12.2 Information Toggle the table of contents Matrix calculus 8 languages العربية Čeština Español فارسی Bahasa Indonesia Português தமிழ் 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Specialized notation for multivariable calculus Not to be confused with geometric calculus or vector calculus .

Part of a series of articles about Calculus ∫ ∫ a b f ′ ( t ) d t = f ( b ) − − f ( a ) {\displaystyle \int _{a}^{b}f'(t)\,dt=f(b)-f(a)} Fundamental theorem Limits Continuity Rolle's theorem Mean value theorem Inverse function theorem Differential Definitions Derivative ( generalizations ) Differential infinitesimal of a function total Concepts Differentiation notation Second derivative Implicit differentiation Logarithmic differentiation Related rates Taylor's theorem Rules and identities Sum Product Chain Power Quotient L'Hôpital's rule Inverse General Leibniz Faà di Bruno's formula Reynolds Integral Lists of integrals Integral transform Leibniz integral rule Definitions Antiderivative Integral ( improper ) Riemann integral Lebesgue integration Contour integration Integral of inverse functions Integration by Parts Discs Cylindrical shells Substitution ( trigonometric , tangent half-angle , Euler ) Euler's formula Partial fractions ( Heaviside's method ) Changing order Reduction formulae Differentiating under the integral sign Risch algorithm Series Geometric ( arithmetico-geometric ) Harmonic Alternating Power Binomial Taylor Convergence tests Summand limit (term test) Ratio Root Integral Direct comparison Limit comparison Alternating series Cauchy condensation Dirichlet Abel Vector Gradient Divergence Curl Laplacian Directional derivative Identities Theorems Gradient Green's Stokes' Divergence Generalized Stokes Helmholtz decomposition Multivariable Formalisms Matrix Tensor Exterior Geometric Definitions Partial derivative Multiple integral Line integral Surface integral Volume integral Jacobian Hessian Advanced Calculus on Euclidean space Generalized functions Limit of distributions Specialized Fractional Malliavin Stochastic Variations Miscellanea Precalculus History Glossary List of topics Integration Bee Mathematical analysis Nonstandard analysis v t e In mathematics , matrix calculus is a specialized notation for doing multivariable calculus , especially over spaces of matrices .  It collects the various partial derivatives of a single function with respect to many variables , and/or of a multivariate function with respect to a single variable, into vectors and matrices that can be treated as single entities.  This greatly simplifies operations such as finding the maximum or minimum of a multivariate function and solving systems of differential equations . The notation used here is commonly used in statistics and engineering , while the tensor index notation is preferred in physics .

Two competing notational conventions split the field of matrix calculus into two separate groups. The two groups can be distinguished by whether they write the derivative of a scalar with respect to a vector as a column vector or a row vector . Both of these conventions are possible even when the common assumption is made that vectors should be treated as column vectors when combined with matrices (rather than row vectors). A single convention can be somewhat standard throughout a single field that commonly uses matrix calculus (e.g.

econometrics , statistics, estimation theory and machine learning ). However, even within a given field different authors can be found using competing conventions. Authors of both groups often write as though their specific conventions were standard. Serious mistakes can result when combining results from different authors without carefully verifying that compatible notations have been used. Definitions of these two conventions and comparisons between them are collected in the layout conventions section.

Scope [ edit ] Matrix calculus refers to a number of different notations that use matrices and vectors to collect the derivative of each component of the dependent variable with respect to each component of the independent variable. In general, the independent variable can be a scalar, a vector, or a matrix while the dependent variable can be any of these as well. Each different situation will lead to a different set of rules, or a separate calculus , using the broader sense of the term. Matrix notation serves as a convenient way to collect the many derivatives in an organized way.

As a first example, consider the gradient from vector calculus . For a scalar function of three independent variables, f ( x 1 , x 2 , x 3 ) {\displaystyle f(x_{1},x_{2},x_{3})} , the gradient is given by the vector equation ∇ ∇ f = ∂ ∂ f ∂ ∂ x 1 x ^ ^ 1 + ∂ ∂ f ∂ ∂ x 2 x ^ ^ 2 + ∂ ∂ f ∂ ∂ x 3 x ^ ^ 3 , {\displaystyle \nabla f={\frac {\partial f}{\partial x_{1}}}{\hat {x}}_{1}+{\frac {\partial f}{\partial x_{2}}}{\hat {x}}_{2}+{\frac {\partial f}{\partial x_{3}}}{\hat {x}}_{3},} where x ^ ^ i {\displaystyle {\hat {x}}_{i}} represents a unit vector in the x i {\displaystyle x_{i}} direction for 1 ≤ ≤ i ≤ ≤ 3 {\displaystyle 1\leq i\leq 3} . This type of generalized derivative can be seen as the derivative of a scalar, f , with respect to a vector, x {\displaystyle \mathbf {x} } , and its result can be easily collected in vector form.

∇ ∇ f = ( ∂ ∂ f ∂ ∂ x ) T = [ ∂ ∂ f ∂ ∂ x 1 ∂ ∂ f ∂ ∂ x 2 ∂ ∂ f ∂ ∂ x 3 ] T .

{\displaystyle \nabla f=\left({\frac {\partial f}{\partial \mathbf {x} }}\right)^{\mathsf {T}}={\begin{bmatrix}{\dfrac {\partial f}{\partial x_{1}}}&{\dfrac {\partial f}{\partial x_{2}}}&{\dfrac {\partial f}{\partial x_{3}}}\\\end{bmatrix}}^{\textsf {T}}.} More complicated examples include the derivative of a scalar function with respect to a matrix, known as the gradient matrix , which collects the derivative with respect to each matrix element in the corresponding position in the resulting matrix. In that case the scalar must be a function of each of the independent variables in the matrix. As another example, if we have an n -vector of dependent variables, or functions, of m independent variables we might consider the derivative of the dependent vector with respect to the independent vector. The result could be collected in an m × n matrix consisting of all of the possible derivative combinations.

There are a total of nine possibilities using scalars, vectors, and matrices. Notice that as we consider higher numbers of components in each of the independent and dependent variables we can be left with a very large number of possibilities. The six kinds of derivatives that can be most neatly organized in matrix form are collected in the following table.

[ 1 ] Types of matrix derivative Types Scalar Vector Matrix Scalar ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial y}{\partial x}}} ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}}} ∂ ∂ Y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}} Vector ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}} ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}} Matrix ∂ ∂ y ∂ ∂ X {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}} Here, we have used the term "matrix" in its most general sense, recognizing that vectors are simply matrices with one column (and scalars are simply vectors with one row). Moreover, we have used bold letters to indicate vectors and bold capital letters for matrices. This notation is used throughout.

Notice that we could also talk about the derivative of a vector with respect to a matrix, or any of the other unfilled cells in our table. However, these derivatives are most naturally organized in a tensor of rank higher than 2, so that they do not fit neatly into a matrix. In the following three sections we will define each one of these derivatives and relate them to other branches of mathematics. See the layout conventions section for a more detailed table.

Relation to other derivatives [ edit ] The matrix derivative is a convenient notation for keeping track of partial derivatives for doing calculations. The Fréchet derivative is the standard way in the setting of functional analysis to take derivatives with respect to vectors. In the case that a matrix function of a matrix is Fréchet differentiable, the two derivatives will agree up to translation of notations. As is the case in general for partial derivatives , some formulae may extend under weaker analytic conditions than the existence of the derivative as approximating linear mapping.

Usages [ edit ] Matrix calculus is used for deriving optimal stochastic estimators, often involving the use of Lagrange multipliers . This includes the derivation of: Kalman filter Wiener filter Expectation-maximization algorithm for Gaussian mixture Gradient descent Notation [ edit ] The vector and matrix derivatives presented in the sections to follow take full advantage of matrix notation , using a single variable to represent a large number of variables. In what follows we will distinguish scalars, vectors and matrices by their typeface. We will let M ( n , m ) denote the space of real n × m matrices with n rows and m columns.  Such matrices will be denoted using bold capital letters: A , X , Y , etc.  An element of M ( n ,1) , that is, a column vector , is denoted with a boldface lowercase letter: a , x , y , etc. An element of M (1,1) is a scalar, denoted with lowercase italic typeface: a , t , x , etc.

X T denotes matrix transpose , tr( X ) is the trace , and det( X ) or | X | is the determinant . All functions are assumed to be of differentiability class C 1 unless otherwise noted. Generally letters from the first half of the alphabet (a, b, c, ...) will be used to denote constants, and from the second half (t, x, y, ...) to denote variables.

NOTE : As mentioned above, there are competing notations for laying out systems of partial derivatives in vectors and matrices, and no standard appears to be emerging yet.  The next two introductory sections use the numerator layout convention simply for the purposes of convenience, to avoid overly complicating the discussion.  The section after them discusses layout conventions in more detail.  It is important to realize the following: Despite the use of the terms "numerator layout" and "denominator layout", there are actually more than two possible notational choices involved.  The reason is that the choice of numerator vs. denominator (or in some situations, numerator vs. mixed) can be made independently for scalar-by-vector, vector-by-scalar, vector-by-vector, and scalar-by-matrix derivatives, and a number of authors mix and match their layout choices in various ways.

The choice of numerator layout in the introductory sections below does not imply that this is the "correct" or "superior" choice.  There are advantages and disadvantages to the various layout types.  Serious mistakes can result from carelessly combining formulas written in different layouts, and converting from one layout to another requires care to avoid errors.  As a result, when working with existing formulas the best policy is probably to identify whichever layout is used and maintain consistency with it, rather than attempting to use the same layout in all situations.

Alternatives [ edit ] The tensor index notation with its Einstein summation convention is very similar to the matrix calculus, except one writes only a single component at a time.  It has the advantage that one can easily manipulate arbitrarily high rank tensors, whereas tensors of rank higher than two are quite unwieldy with matrix notation.  All of the work here can be done in this notation without use of the single-variable matrix notation. However, many problems in estimation theory and other areas of applied mathematics would result in too many indices to properly keep track of, pointing in favor of matrix calculus in those areas.  Also, Einstein notation can be very useful in proving the identities presented here (see section on differentiation ) as an alternative to typical element notation, which can become cumbersome when the explicit sums are carried around. Note that a matrix can be considered a tensor of rank two.

Derivatives with vectors [ edit ] Main article: Vector calculus Because vectors are matrices with only one column, the simplest matrix derivatives are vector derivatives.

The notations developed here can accommodate the usual operations of vector calculus by identifying the space M ( n ,1) of n -vectors with the Euclidean space R n , and the scalar M (1,1) is identified with R . The corresponding concept from vector calculus is indicated at the end of each subsection.

NOTE : The discussion in this section assumes the numerator layout convention for pedagogical purposes.  Some authors use different conventions.  The section on layout conventions discusses this issue in greater detail.  The identities given further down are presented in forms that can be used in conjunction with all common layout conventions.

Vector-by-scalar [ edit ] The derivative of a vector y = [ y 1 y 2 ⋯ ⋯ y m ] T {\displaystyle \mathbf {y} ={\begin{bmatrix}y_{1}&y_{2}&\cdots &y_{m}\end{bmatrix}}^{\mathsf {T}}} , by a scalar x is written (in numerator layout notation ) as d y d x = [ d y 1 d x d y 2 d x ⋮ ⋮ d y m d x ] .

{\displaystyle {\frac {d\mathbf {y} }{dx}}={\begin{bmatrix}{\frac {dy_{1}}{dx}}\\{\frac {dy_{2}}{dx}}\\\vdots \\{\frac {dy_{m}}{dx}}\\\end{bmatrix}}.} In vector calculus the derivative of a vector y with respect to a scalar x is known as the tangent vector of the vector y , ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}}} . Notice here that y : R 1 → R m .

Example Simple examples of this include the velocity vector in Euclidean space , which is the tangent vector of the position vector (considered as a function of time). Also, the acceleration is the tangent vector of the velocity.

Scalar-by-vector [ edit ] The derivative of a scalar y by a vector x = [ x 1 x 2 ⋯ ⋯ x n ] {\displaystyle \mathbf {x} ={\begin{bmatrix}x_{1}&x_{2}&\cdots &x_{n}\end{bmatrix}}} , is written (in numerator layout notation ) as ∂ ∂ y ∂ ∂ x = [ ∂ ∂ y ∂ ∂ x 1 ∂ ∂ y ∂ ∂ x 2 ⋯ ⋯ ∂ ∂ y ∂ ∂ x n ] .

{\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}={\begin{bmatrix}{\dfrac {\partial y}{\partial x_{1}}}&{\dfrac {\partial y}{\partial x_{2}}}&\cdots &{\dfrac {\partial y}{\partial x_{n}}}\end{bmatrix}}.} In vector calculus , the gradient of a scalar field f : R n → R (whose independent coordinates are the components of x ) is the transpose of the derivative of a scalar by a vector.

∇ ∇ f = [ ∂ ∂ f ∂ ∂ x 1 ⋮ ⋮ ∂ ∂ f ∂ ∂ x n ] = ( ∂ ∂ f ∂ ∂ x ) T {\displaystyle \nabla f={\begin{bmatrix}{\frac {\partial f}{\partial x_{1}}}\\\vdots \\{\frac {\partial f}{\partial x_{n}}}\end{bmatrix}}=\left({\frac {\partial f}{\partial \mathbf {x} }}\right)^{\mathsf {T}}} By example, in physics, the electric field is the negative vector gradient of the electric potential .

The directional derivative of a scalar function f ( x ) of the space vector x in the direction of the unit vector u (represented in this case as a column vector) is defined using the gradient as follows.

∇ ∇ u f ( x ) = ∇ ∇ f ( x ) ⋅ ⋅ u {\displaystyle \nabla _{\mathbf {u} }{f}(\mathbf {x} )=\nabla f(\mathbf {x} )\cdot \mathbf {u} } Using the notation just defined for the derivative of a scalar with respect to a vector we can re-write the directional derivative as ∇ ∇ u f = ∂ ∂ f ∂ ∂ x u .

{\displaystyle \nabla _{\mathbf {u} }f={\frac {\partial f}{\partial \mathbf {x} }}\mathbf {u} .} This type of notation will be nice when proving product rules and chain rules that come out looking similar to what we are familiar with for the scalar derivative .

Vector-by-vector [ edit ] Each of the previous two cases can be considered as an application of the derivative of a vector with respect to a vector, using a vector of size one appropriately. Similarly we will find that the derivatives involving matrices will reduce to derivatives involving vectors in a corresponding way.

The derivative of a vector function (a vector whose components are functions) y = [ y 1 y 2 ⋯ ⋯ y m ] T {\displaystyle \mathbf {y} ={\begin{bmatrix}y_{1}&y_{2}&\cdots &y_{m}\end{bmatrix}}^{\mathsf {T}}} , with respect to an input vector, x = [ x 1 x 2 ⋯ ⋯ x n ] T {\displaystyle \mathbf {x} ={\begin{bmatrix}x_{1}&x_{2}&\cdots &x_{n}\end{bmatrix}}^{\mathsf {T}}} , is written (in numerator layout notation ) as ∂ ∂ y ∂ ∂ x = [ ∂ ∂ y 1 ∂ ∂ x 1 ∂ ∂ y 1 ∂ ∂ x 2 ⋯ ⋯ ∂ ∂ y 1 ∂ ∂ x n ∂ ∂ y 2 ∂ ∂ x 1 ∂ ∂ y 2 ∂ ∂ x 2 ⋯ ⋯ ∂ ∂ y 2 ∂ ∂ x n ⋮ ⋮ ⋮ ⋮ ⋱ ⋱ ⋮ ⋮ ∂ ∂ y m ∂ ∂ x 1 ∂ ∂ y m ∂ ∂ x 2 ⋯ ⋯ ∂ ∂ y m ∂ ∂ x n ] .

{\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x_{1}}}&{\frac {\partial y_{1}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{1}}{\partial x_{n}}}\\{\frac {\partial y_{2}}{\partial x_{1}}}&{\frac {\partial y_{2}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{2}}{\partial x_{n}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{m}}{\partial x_{1}}}&{\frac {\partial y_{m}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{n}}}\\\end{bmatrix}}.} In vector calculus , the derivative of a vector function y with respect to a vector x whose components represent a space is known as the pushforward (or differential) , or the Jacobian matrix .

The pushforward along a vector function f with respect to vector v in R n is given by d f ( v ) = ∂ ∂ f ∂ ∂ v d v .

{\displaystyle d\mathbf {f} (\mathbf {v} )={\frac {\partial \mathbf {f} }{\partial \mathbf {v} }}d\mathbf {v} .} Derivatives with matrices [ edit ] There are two types of derivatives with matrices that can be organized into a matrix of the same size. These are the derivative of a matrix by a scalar and the derivative of a scalar by a matrix. These can be useful in minimization problems found in many areas of applied mathematics and have adopted the names tangent matrix and gradient matrix respectively after their analogs for vectors.

Note : The discussion in this section assumes the numerator layout convention for pedagogical purposes.  Some authors use different conventions.  The section on layout conventions discusses this issue in greater detail.  The identities given further down are presented in forms that can be used in conjunction with all common layout conventions.

Matrix-by-scalar [ edit ] The derivative of a matrix function Y by a scalar x is known as the tangent matrix and is given (in numerator layout notation ) by ∂ ∂ Y ∂ ∂ x = [ ∂ ∂ y 11 ∂ ∂ x ∂ ∂ y 12 ∂ ∂ x ⋯ ⋯ ∂ ∂ y 1 n ∂ ∂ x ∂ ∂ y 21 ∂ ∂ x ∂ ∂ y 22 ∂ ∂ x ⋯ ⋯ ∂ ∂ y 2 n ∂ ∂ x ⋮ ⋮ ⋮ ⋮ ⋱ ⋱ ⋮ ⋮ ∂ ∂ y m 1 ∂ ∂ x ∂ ∂ y m 2 ∂ ∂ x ⋯ ⋯ ∂ ∂ y m n ∂ ∂ x ] .

{\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}={\begin{bmatrix}{\frac {\partial y_{11}}{\partial x}}&{\frac {\partial y_{12}}{\partial x}}&\cdots &{\frac {\partial y_{1n}}{\partial x}}\\{\frac {\partial y_{21}}{\partial x}}&{\frac {\partial y_{22}}{\partial x}}&\cdots &{\frac {\partial y_{2n}}{\partial x}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{m1}}{\partial x}}&{\frac {\partial y_{m2}}{\partial x}}&\cdots &{\frac {\partial y_{mn}}{\partial x}}\\\end{bmatrix}}.} Scalar-by-matrix [ edit ] The derivative of a scalar function y , with respect to a p × q matrix X of independent variables, is given (in numerator layout notation ) by ∂ ∂ y ∂ ∂ X = [ ∂ ∂ y ∂ ∂ x 11 ∂ ∂ y ∂ ∂ x 21 ⋯ ⋯ ∂ ∂ y ∂ ∂ x p 1 ∂ ∂ y ∂ ∂ x 12 ∂ ∂ y ∂ ∂ x 22 ⋯ ⋯ ∂ ∂ y ∂ ∂ x p 2 ⋮ ⋮ ⋮ ⋮ ⋱ ⋱ ⋮ ⋮ ∂ ∂ y ∂ ∂ x 1 q ∂ ∂ y ∂ ∂ x 2 q ⋯ ⋯ ∂ ∂ y ∂ ∂ x p q ] .

{\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}={\begin{bmatrix}{\frac {\partial y}{\partial x_{11}}}&{\frac {\partial y}{\partial x_{21}}}&\cdots &{\frac {\partial y}{\partial x_{p1}}}\\{\frac {\partial y}{\partial x_{12}}}&{\frac {\partial y}{\partial x_{22}}}&\cdots &{\frac {\partial y}{\partial x_{p2}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y}{\partial x_{1q}}}&{\frac {\partial y}{\partial x_{2q}}}&\cdots &{\frac {\partial y}{\partial x_{pq}}}\\\end{bmatrix}}.} Important examples of scalar functions of matrices include the trace of a matrix and the determinant .

In analog with vector calculus this derivative is often written as the following.

∇ ∇ X y ( X ) = ∂ ∂ y ( X ) ∂ ∂ X {\displaystyle \nabla _{\mathbf {X} }y(\mathbf {X} )={\frac {\partial y(\mathbf {X} )}{\partial \mathbf {X} }}} Also in analog with vector calculus , the directional derivative of a scalar f ( X ) of a matrix X in the direction of matrix Y is given by ∇ ∇ Y f = tr ⁡ ⁡ ( ∂ ∂ f ∂ ∂ X Y ) .

{\displaystyle \nabla _{\mathbf {Y} }f=\operatorname {tr} \left({\frac {\partial f}{\partial \mathbf {X} }}\mathbf {Y} \right).} It is the gradient matrix, in particular, that finds many uses in minimization problems in estimation theory , particularly in the derivation of the Kalman filter algorithm, which is of great importance in the field.

Other matrix derivatives [ edit ] The three types of derivatives that have not been considered are those involving vectors-by-matrices, matrices-by-vectors, and matrices-by-matrices. These are not as widely considered and a notation is not widely agreed upon.

Layout conventions [ edit ] This section discusses the similarities and differences between notational conventions that are used in the various fields that take advantage of matrix calculus. Although there are largely two consistent conventions, some authors find it convenient to mix the two conventions in forms that are discussed below. After this section, equations will be listed in both competing forms separately.

The fundamental issue is that the derivative of a vector with respect to a vector, i.e.

∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}} , is often written in two competing ways.  If the numerator y is of size m and the denominator x of size n , then the result can be laid out as either an m × n matrix or n × m matrix, i.e. the m elements of y laid out in rows and the n elements of x laid out in columns, or vice versa.  This leads to the following possibilities: Numerator layout , i.e.  lay out according to y and x T (i.e. contrarily to x ).  This is sometimes known as the Jacobian formulation . This corresponds to the m × n layout in the previous example, which means that the row number of ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}} equals to the size of the numerator y {\displaystyle \mathbf {y} } and the column number of ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}} equals to the size of x T .

Denominator layout , i.e. lay out according to y T and x (i.e. contrarily to y ).  This is sometimes known as the Hessian formulation .  Some authors term this layout the gradient , in distinction to the Jacobian (numerator layout), which is its transpose. (However, gradient more commonly means the derivative ∂ ∂ y ∂ ∂ x , {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }},} regardless of layout.). This corresponds to the n×m layout in the previous example, which means that the row number of ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}} equals to the size of x (the denominator).

A third possibility sometimes seen is to insist on writing the derivative as ∂ ∂ y ∂ ∂ x ′ , {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} '}},} (i.e. the derivative is taken with respect to the transpose of x ) and follow the numerator layout.  This makes it possible to claim that the matrix is laid out according to both numerator and denominator.  In practice this produces results the same as the numerator layout.

When handling the gradient ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}} and the opposite case ∂ ∂ y ∂ ∂ x , {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}},} we have the same issues.  To be consistent, we should do one of the following: If we choose numerator layout for ∂ ∂ y ∂ ∂ x , {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }},} we should lay out the gradient ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}} as a row vector, and ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}}} as a column vector.

If we choose denominator layout for ∂ ∂ y ∂ ∂ x , {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }},} we should lay out the gradient ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}} as a column vector, and ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}}} as a row vector.

In the third possibility above, we write ∂ ∂ y ∂ ∂ x ′ {\displaystyle {\frac {\partial y}{\partial \mathbf {x} '}}} and ∂ ∂ y ∂ ∂ x , {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}},} and use numerator layout.

Not all math textbooks and papers are consistent in this respect throughout. That is, sometimes different conventions are used in different contexts within the same book or paper. For example, some choose denominator layout for gradients (laying them out as column vectors), but numerator layout for the vector-by-vector derivative ∂ ∂ y ∂ ∂ x .

{\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}.} Similarly, when it comes to scalar-by-matrix derivatives ∂ ∂ y ∂ ∂ X {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}} and matrix-by-scalar derivatives ∂ ∂ Y ∂ ∂ x , {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}},} then consistent numerator layout lays out according to Y and X T , while consistent denominator layout lays out according to Y T and X .  In practice, however, following a denominator layout for ∂ ∂ Y ∂ ∂ x , {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}},} and laying the result out according to Y T , is rarely seen because it makes for ugly formulas that do not correspond to the scalar formulas.  As a result, the following layouts can often be found: Consistent numerator layout , which lays out ∂ ∂ Y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}} according to Y and ∂ ∂ y ∂ ∂ X {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}} according to X T .

Mixed layout , which lays out ∂ ∂ Y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}} according to Y and ∂ ∂ y ∂ ∂ X {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}} according to X .

Use the notation ∂ ∂ y ∂ ∂ X ′ , {\displaystyle {\frac {\partial y}{\partial \mathbf {X} '}},} with results the same as consistent numerator layout.

In the following formulas, we handle the five possible combinations ∂ ∂ y ∂ ∂ x , ∂ ∂ y ∂ ∂ x , ∂ ∂ y ∂ ∂ x , ∂ ∂ y ∂ ∂ X {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }},{\frac {\partial \mathbf {y} }{\partial x}},{\frac {\partial \mathbf {y} }{\partial \mathbf {x} }},{\frac {\partial y}{\partial \mathbf {X} }}} and ∂ ∂ Y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}} separately.  We also handle cases of scalar-by-scalar derivatives that involve an intermediate vector or matrix. (This can arise, for example, if a multi-dimensional parametric curve is defined in terms of a scalar variable, and then a derivative of a scalar function of the curve is taken with respect to the scalar that parameterizes the curve.) For each of the various combinations, we give numerator-layout and denominator-layout results, except in the cases above where denominator layout rarely occurs. In cases involving matrices where it makes sense, we give numerator-layout and mixed-layout results.  As noted above, cases where vector and matrix denominators are written in transpose notation are equivalent to numerator layout with the denominators written without the transpose.

Keep in mind that various authors use different combinations of numerator and denominator layouts for different types of derivatives, and there is no guarantee that an author will consistently use either numerator or denominator layout for all types.  Match up the formulas below with those quoted in the source to determine the layout used for that particular type of derivative, but be careful not to assume that derivatives of other types necessarily follow the same kind of layout.

When taking derivatives with an aggregate (vector or matrix) denominator in order to find a maximum or minimum of the aggregate, it should be kept in mind that using numerator layout will produce results that are transposed with respect to the aggregate.  For example, in attempting to find the maximum likelihood estimate of a multivariate normal distribution using matrix calculus, if the domain is a k ×1 column vector, then the result using the numerator layout will be in the form of a 1× k row vector. Thus, either the results should be transposed at the end or the denominator layout (or mixed layout) should be used.

Result of differentiating various kinds of aggregates with other kinds of aggregates Scalar y Column vector y (size m ×1 ) Matrix Y (size m × n ) Notation Type Notation Type Notation Type Scalar x Numerator ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial y}{\partial x}}} Scalar ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}}} Size- m column vector ∂ ∂ Y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}} m × n matrix Denominator Size- m row vector Column vector x (size n × 1 ) Numerator ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}} Size- n row vector ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}} m × n matrix ∂ ∂ Y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {Y} }{\partial \mathbf {x} }}} Denominator Size- n column vector n × m matrix Matrix X (size p × q ) Numerator ∂ ∂ y ∂ ∂ X {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}} q × p matrix ∂ ∂ y ∂ ∂ X {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {X} }}} ∂ ∂ Y ∂ ∂ X {\displaystyle {\frac {\partial \mathbf {Y} }{\partial \mathbf {X} }}} Denominator p × q matrix The results of operations will be transposed when switching between numerator-layout and denominator-layout notation.

Numerator-layout notation [ edit ] Using numerator-layout notation, we have: [ 1 ] ∂ ∂ y ∂ ∂ x = [ ∂ ∂ y ∂ ∂ x 1 ∂ ∂ y ∂ ∂ x 2 ⋯ ⋯ ∂ ∂ y ∂ ∂ x n ] .

∂ ∂ y ∂ ∂ x = [ ∂ ∂ y 1 ∂ ∂ x ∂ ∂ y 2 ∂ ∂ x ⋮ ⋮ ∂ ∂ y m ∂ ∂ x ] .

∂ ∂ y ∂ ∂ x = [ ∂ ∂ y 1 ∂ ∂ x 1 ∂ ∂ y 1 ∂ ∂ x 2 ⋯ ⋯ ∂ ∂ y 1 ∂ ∂ x n ∂ ∂ y 2 ∂ ∂ x 1 ∂ ∂ y 2 ∂ ∂ x 2 ⋯ ⋯ ∂ ∂ y 2 ∂ ∂ x n ⋮ ⋮ ⋮ ⋮ ⋱ ⋱ ⋮ ⋮ ∂ ∂ y m ∂ ∂ x 1 ∂ ∂ y m ∂ ∂ x 2 ⋯ ⋯ ∂ ∂ y m ∂ ∂ x n ] .

∂ ∂ y ∂ ∂ X = [ ∂ ∂ y ∂ ∂ x 11 ∂ ∂ y ∂ ∂ x 21 ⋯ ⋯ ∂ ∂ y ∂ ∂ x p 1 ∂ ∂ y ∂ ∂ x 12 ∂ ∂ y ∂ ∂ x 22 ⋯ ⋯ ∂ ∂ y ∂ ∂ x p 2 ⋮ ⋮ ⋮ ⋮ ⋱ ⋱ ⋮ ⋮ ∂ ∂ y ∂ ∂ x 1 q ∂ ∂ y ∂ ∂ x 2 q ⋯ ⋯ ∂ ∂ y ∂ ∂ x p q ] .

{\displaystyle {\begin{aligned}{\frac {\partial y}{\partial \mathbf {x} }}&={\begin{bmatrix}{\frac {\partial y}{\partial x_{1}}}&{\frac {\partial y}{\partial x_{2}}}&\cdots &{\frac {\partial y}{\partial x_{n}}}\end{bmatrix}}.\\{\frac {\partial \mathbf {y} }{\partial x}}&={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x}}\\{\frac {\partial y_{2}}{\partial x}}\\\vdots \\{\frac {\partial y_{m}}{\partial x}}\\\end{bmatrix}}.\\{\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}&={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x_{1}}}&{\frac {\partial y_{1}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{1}}{\partial x_{n}}}\\{\frac {\partial y_{2}}{\partial x_{1}}}&{\frac {\partial y_{2}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{2}}{\partial x_{n}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{m}}{\partial x_{1}}}&{\frac {\partial y_{m}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{n}}}\\\end{bmatrix}}.\\{\frac {\partial y}{\partial \mathbf {X} }}&={\begin{bmatrix}{\frac {\partial y}{\partial x_{11}}}&{\frac {\partial y}{\partial x_{21}}}&\cdots &{\frac {\partial y}{\partial x_{p1}}}\\{\frac {\partial y}{\partial x_{12}}}&{\frac {\partial y}{\partial x_{22}}}&\cdots &{\frac {\partial y}{\partial x_{p2}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y}{\partial x_{1q}}}&{\frac {\partial y}{\partial x_{2q}}}&\cdots &{\frac {\partial y}{\partial x_{pq}}}\\\end{bmatrix}}.\end{aligned}}} The following definitions are only provided in numerator-layout notation: ∂ ∂ Y ∂ ∂ x = [ ∂ ∂ y 11 ∂ ∂ x ∂ ∂ y 12 ∂ ∂ x ⋯ ⋯ ∂ ∂ y 1 n ∂ ∂ x ∂ ∂ y 21 ∂ ∂ x ∂ ∂ y 22 ∂ ∂ x ⋯ ⋯ ∂ ∂ y 2 n ∂ ∂ x ⋮ ⋮ ⋮ ⋮ ⋱ ⋱ ⋮ ⋮ ∂ ∂ y m 1 ∂ ∂ x ∂ ∂ y m 2 ∂ ∂ x ⋯ ⋯ ∂ ∂ y m n ∂ ∂ x ] .

d X = [ d x 11 d x 12 ⋯ ⋯ d x 1 n d x 21 d x 22 ⋯ ⋯ d x 2 n ⋮ ⋮ ⋮ ⋮ ⋱ ⋱ ⋮ ⋮ d x m 1 d x m 2 ⋯ ⋯ d x m n ] .

{\displaystyle {\begin{aligned}{\frac {\partial \mathbf {Y} }{\partial x}}&={\begin{bmatrix}{\frac {\partial y_{11}}{\partial x}}&{\frac {\partial y_{12}}{\partial x}}&\cdots &{\frac {\partial y_{1n}}{\partial x}}\\{\frac {\partial y_{21}}{\partial x}}&{\frac {\partial y_{22}}{\partial x}}&\cdots &{\frac {\partial y_{2n}}{\partial x}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{m1}}{\partial x}}&{\frac {\partial y_{m2}}{\partial x}}&\cdots &{\frac {\partial y_{mn}}{\partial x}}\\\end{bmatrix}}.\\d\mathbf {X} &={\begin{bmatrix}dx_{11}&dx_{12}&\cdots &dx_{1n}\\dx_{21}&dx_{22}&\cdots &dx_{2n}\\\vdots &\vdots &\ddots &\vdots \\dx_{m1}&dx_{m2}&\cdots &dx_{mn}\\\end{bmatrix}}.\end{aligned}}} Denominator-layout notation [ edit ] Using denominator-layout notation, we have: [ 2 ] ∂ ∂ y ∂ ∂ x = [ ∂ ∂ y ∂ ∂ x 1 ∂ ∂ y ∂ ∂ x 2 ⋮ ⋮ ∂ ∂ y ∂ ∂ x n ] .

∂ ∂ y ∂ ∂ x = [ ∂ ∂ y 1 ∂ ∂ x ∂ ∂ y 2 ∂ ∂ x ⋯ ⋯ ∂ ∂ y m ∂ ∂ x ] .

∂ ∂ y ∂ ∂ x = [ ∂ ∂ y 1 ∂ ∂ x 1 ∂ ∂ y 2 ∂ ∂ x 1 ⋯ ⋯ ∂ ∂ y m ∂ ∂ x 1 ∂ ∂ y 1 ∂ ∂ x 2 ∂ ∂ y 2 ∂ ∂ x 2 ⋯ ⋯ ∂ ∂ y m ∂ ∂ x 2 ⋮ ⋮ ⋮ ⋮ ⋱ ⋱ ⋮ ⋮ ∂ ∂ y 1 ∂ ∂ x n ∂ ∂ y 2 ∂ ∂ x n ⋯ ⋯ ∂ ∂ y m ∂ ∂ x n ] .

∂ ∂ y ∂ ∂ X = [ ∂ ∂ y ∂ ∂ x 11 ∂ ∂ y ∂ ∂ x 12 ⋯ ⋯ ∂ ∂ y ∂ ∂ x 1 q ∂ ∂ y ∂ ∂ x 21 ∂ ∂ y ∂ ∂ x 22 ⋯ ⋯ ∂ ∂ y ∂ ∂ x 2 q ⋮ ⋮ ⋮ ⋮ ⋱ ⋱ ⋮ ⋮ ∂ ∂ y ∂ ∂ x p 1 ∂ ∂ y ∂ ∂ x p 2 ⋯ ⋯ ∂ ∂ y ∂ ∂ x p q ] .

{\displaystyle {\begin{aligned}{\frac {\partial y}{\partial \mathbf {x} }}&={\begin{bmatrix}{\frac {\partial y}{\partial x_{1}}}\\{\frac {\partial y}{\partial x_{2}}}\\\vdots \\{\frac {\partial y}{\partial x_{n}}}\\\end{bmatrix}}.\\{\frac {\partial \mathbf {y} }{\partial x}}&={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x}}&{\frac {\partial y_{2}}{\partial x}}&\cdots &{\frac {\partial y_{m}}{\partial x}}\end{bmatrix}}.\\{\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}&={\begin{bmatrix}{\frac {\partial y_{1}}{\partial x_{1}}}&{\frac {\partial y_{2}}{\partial x_{1}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{1}}}\\{\frac {\partial y_{1}}{\partial x_{2}}}&{\frac {\partial y_{2}}{\partial x_{2}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{2}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y_{1}}{\partial x_{n}}}&{\frac {\partial y_{2}}{\partial x_{n}}}&\cdots &{\frac {\partial y_{m}}{\partial x_{n}}}\\\end{bmatrix}}.\\{\frac {\partial y}{\partial \mathbf {X} }}&={\begin{bmatrix}{\frac {\partial y}{\partial x_{11}}}&{\frac {\partial y}{\partial x_{12}}}&\cdots &{\frac {\partial y}{\partial x_{1q}}}\\{\frac {\partial y}{\partial x_{21}}}&{\frac {\partial y}{\partial x_{22}}}&\cdots &{\frac {\partial y}{\partial x_{2q}}}\\\vdots &\vdots &\ddots &\vdots \\{\frac {\partial y}{\partial x_{p1}}}&{\frac {\partial y}{\partial x_{p2}}}&\cdots &{\frac {\partial y}{\partial x_{pq}}}\\\end{bmatrix}}.\end{aligned}}} Identities [ edit ] As noted above, in general, the results of operations will be transposed when switching between numerator-layout and denominator-layout notation.

To help make sense of all the identities below, keep in mind the most important rules: the chain rule , product rule and sum rule .  The sum rule applies universally, and the product rule applies in most of the cases below, provided that the order of matrix products is maintained, since matrix products are not commutative.  The chain rule applies in some of the cases, but unfortunately does not apply in matrix-by-scalar derivatives or scalar-by-matrix derivatives (in the latter case, mostly involving the trace operator applied to matrices).  In the latter case, the product rule can't quite be applied directly, either, but the equivalent can be done with a bit more work using the differential identities.

The following identities adopt the following conventions: the scalars, a , b , c , d , and e are constant in respect of, and the scalars, u , and v are functions of one of x , x , or X ; the vectors, a , b , c , d , and e are constant in respect of, and the vectors, u , and v are functions of one of x , x , or X ; the matrices, A , B , C , D , and E are constant in respect of, and the matrices, U and V are functions of one of x , x , or X .

Vector-by-vector identities [ edit ] This is presented first because all of the operations that apply to vector-by-vector differentiation apply directly to vector-by-scalar or scalar-by-vector differentiation simply by reducing the appropriate vector in the numerator or denominator to a scalar.

Identities: vector-by-vector ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial \mathbf {x} }}} Condition Expression Numerator layout, i.e. by y and x T Denominator layout, i.e. by y T and x a is not a function of x ∂ ∂ a ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {a} }{\partial \mathbf {x} }}=} 0 {\displaystyle \mathbf {0} } ∂ ∂ x ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {x} }{\partial \mathbf {x} }}=} I {\displaystyle \mathbf {I} } A is not a function of x ∂ ∂ A x ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {A} \mathbf {x} }{\partial \mathbf {x} }}=} A {\displaystyle \mathbf {A} } A ⊤ ⊤ {\displaystyle \mathbf {A} ^{\top }} A is not a function of x ∂ ∂ x ⊤ ⊤ A ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {x} ^{\top }\mathbf {A} }{\partial \mathbf {x} }}=} A ⊤ ⊤ {\displaystyle \mathbf {A} ^{\top }} A {\displaystyle \mathbf {A} } a is not a function of x , u = u ( x ) ∂ ∂ a u ∂ ∂ x = {\displaystyle {\frac {\partial a\mathbf {u} }{\partial \,\mathbf {x} }}=} a ∂ ∂ u ∂ ∂ x {\displaystyle a{\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}} v = v ( x ) , a is not a function of x ∂ ∂ v a ∂ ∂ x = {\displaystyle {\frac {\partial v\mathbf {a} }{\partial \mathbf {x} }}=} a ∂ ∂ v ∂ ∂ x {\displaystyle \mathbf {a} {\frac {\partial v}{\partial \mathbf {x} }}} ∂ ∂ v ∂ ∂ x a ⊤ ⊤ {\displaystyle {\frac {\partial v}{\partial \mathbf {x} }}\mathbf {a} ^{\top }} v = v ( x ) , u = u ( x ) ∂ ∂ v u ∂ ∂ x = {\displaystyle {\frac {\partial v\mathbf {u} }{\partial \mathbf {x} }}=} v ∂ ∂ u ∂ ∂ x + u ∂ ∂ v ∂ ∂ x {\displaystyle v{\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}+\mathbf {u} {\frac {\partial v}{\partial \mathbf {x} }}} v ∂ ∂ u ∂ ∂ x + ∂ ∂ v ∂ ∂ x u ⊤ ⊤ {\displaystyle v{\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}+{\frac {\partial v}{\partial \mathbf {x} }}\mathbf {u} ^{\top }} A is not a function of x , u = u ( x ) ∂ ∂ A u ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {A} \mathbf {u} }{\partial \mathbf {x} }}=} A ∂ ∂ u ∂ ∂ x {\displaystyle \mathbf {A} {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}} ∂ ∂ u ∂ ∂ x A ⊤ ⊤ {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}\mathbf {A} ^{\top }} u = u ( x ) , v = v ( x ) ∂ ∂ ( u + v ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {u} +\mathbf {v} )}{\partial \mathbf {x} }}=} ∂ ∂ u ∂ ∂ x + ∂ ∂ v ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}+{\frac {\partial \mathbf {v} }{\partial \mathbf {x} }}} u = u ( x ) ∂ ∂ g ( u ) ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {x} }}=} ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ u ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}{\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}} ∂ ∂ u ∂ ∂ x ∂ ∂ g ( u ) ∂ ∂ u {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}{\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}} u = u ( x ) ∂ ∂ f ( g ( u ) ) ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {f} (\mathbf {g} (\mathbf {u} ))}{\partial \mathbf {x} }}=} ∂ ∂ f ( g ) ∂ ∂ g ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ u ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {f} (\mathbf {g} )}{\partial \mathbf {g} }}{\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}{\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}} ∂ ∂ u ∂ ∂ x ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ f ( g ) ∂ ∂ g {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}{\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}{\frac {\partial \mathbf {f} (\mathbf {g} )}{\partial \mathbf {g} }}} Scalar-by-vector identities [ edit ] The fundamental identities are placed above the thick black line.

Identities: scalar-by-vector ∂ ∂ y ∂ ∂ x = ∇ ∇ x y {\displaystyle {\frac {\partial y}{\partial \mathbf {x} }}=\nabla _{\mathbf {x} }y} Condition Expression Numerator layout, i.e. by x T ; result is row vector Denominator layout, i.e. by x ; result is column vector a is not a function of x ∂ ∂ a ∂ ∂ x = {\displaystyle {\frac {\partial a}{\partial \mathbf {x} }}=} 0 ⊤ ⊤ {\displaystyle \mathbf {0} ^{\top }} [ nb 1 ] 0 {\displaystyle \mathbf {0} } [ nb 1 ] a is not a function of x , u = u ( x ) ∂ ∂ a u ∂ ∂ x = {\displaystyle {\frac {\partial au}{\partial \mathbf {x} }}=} a ∂ ∂ u ∂ ∂ x {\displaystyle a{\frac {\partial u}{\partial \mathbf {x} }}} u = u ( x ) , v = v ( x ) ∂ ∂ ( u + v ) ∂ ∂ x = {\displaystyle {\frac {\partial (u+v)}{\partial \mathbf {x} }}=} ∂ ∂ u ∂ ∂ x + ∂ ∂ v ∂ ∂ x {\displaystyle {\frac {\partial u}{\partial \mathbf {x} }}+{\frac {\partial v}{\partial \mathbf {x} }}} u = u ( x ) , v = v ( x ) ∂ ∂ u v ∂ ∂ x = {\displaystyle {\frac {\partial uv}{\partial \mathbf {x} }}=} u ∂ ∂ v ∂ ∂ x + v ∂ ∂ u ∂ ∂ x {\displaystyle u{\frac {\partial v}{\partial \mathbf {x} }}+v{\frac {\partial u}{\partial \mathbf {x} }}} u = u ( x ) ∂ ∂ g ( u ) ∂ ∂ x = {\displaystyle {\frac {\partial g(u)}{\partial \mathbf {x} }}=} ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ u ∂ ∂ x {\displaystyle {\frac {\partial g(u)}{\partial u}}{\frac {\partial u}{\partial \mathbf {x} }}} u = u ( x ) ∂ ∂ f ( g ( u ) ) ∂ ∂ x = {\displaystyle {\frac {\partial f(g(u))}{\partial \mathbf {x} }}=} ∂ ∂ f ( g ) ∂ ∂ g ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ u ∂ ∂ x {\displaystyle {\frac {\partial f(g)}{\partial g}}{\frac {\partial g(u)}{\partial u}}{\frac {\partial u}{\partial \mathbf {x} }}} u = u ( x ) , v = v ( x ) ∂ ∂ ( u ⋅ ⋅ v ) ∂ ∂ x = ∂ ∂ u ⊤ ⊤ v ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {u} \cdot \mathbf {v} )}{\partial \mathbf {x} }}={\frac {\partial \mathbf {u} ^{\top }\mathbf {v} }{\partial \mathbf {x} }}=} u ⊤ ⊤ ∂ ∂ v ∂ ∂ x + v ⊤ ⊤ ∂ ∂ u ∂ ∂ x {\displaystyle \mathbf {u} ^{\top }{\frac {\partial \mathbf {v} }{\partial \mathbf {x} }}+\mathbf {v} ^{\top }{\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}} ∂ ∂ u ∂ ∂ x , ∂ ∂ v ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }},{\frac {\partial \mathbf {v} }{\partial \mathbf {x} }}} in numerator layout ∂ ∂ u ∂ ∂ x v + ∂ ∂ v ∂ ∂ x u {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}\mathbf {v} +{\frac {\partial \mathbf {v} }{\partial \mathbf {x} }}\mathbf {u} } ∂ ∂ u ∂ ∂ x , ∂ ∂ v ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }},{\frac {\partial \mathbf {v} }{\partial \mathbf {x} }}} in denominator layout u = u ( x ) , v = v ( x ) , A is not a function of x ∂ ∂ ( u ⋅ ⋅ A v ) ∂ ∂ x = ∂ ∂ u ⊤ ⊤ A v ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {u} \cdot \mathbf {A} \mathbf {v} )}{\partial \mathbf {x} }}={\frac {\partial \mathbf {u} ^{\top }\mathbf {A} \mathbf {v} }{\partial \mathbf {x} }}=} u ⊤ ⊤ A ∂ ∂ v ∂ ∂ x + v ⊤ ⊤ A ⊤ ⊤ ∂ ∂ u ∂ ∂ x {\displaystyle \mathbf {u} ^{\top }\mathbf {A} {\frac {\partial \mathbf {v} }{\partial \mathbf {x} }}+\mathbf {v} ^{\top }\mathbf {A} ^{\top }{\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}} ∂ ∂ u ∂ ∂ x , ∂ ∂ v ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }},{\frac {\partial \mathbf {v} }{\partial \mathbf {x} }}} in numerator layout ∂ ∂ u ∂ ∂ x A v + ∂ ∂ v ∂ ∂ x A ⊤ ⊤ u {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}\mathbf {A} \mathbf {v} +{\frac {\partial \mathbf {v} }{\partial \mathbf {x} }}\mathbf {A} ^{\top }\mathbf {u} } ∂ ∂ u ∂ ∂ x , ∂ ∂ v ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }},{\frac {\partial \mathbf {v} }{\partial \mathbf {x} }}} in denominator layout ∂ ∂ 2 f ∂ ∂ x ∂ ∂ x ⊤ ⊤ = {\displaystyle {\frac {\partial ^{2}f}{\partial \mathbf {x} \partial \mathbf {x} ^{\top }}}=} H ⊤ ⊤ {\displaystyle \mathbf {H} ^{\top }} H {\displaystyle \mathbf {H} } , the Hessian matrix [ 3 ] a is not a function of x ∂ ∂ ( a ⋅ ⋅ x ) ∂ ∂ x = ∂ ∂ ( x ⋅ ⋅ a ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {a} \cdot \mathbf {x} )}{\partial \mathbf {x} }}={\frac {\partial (\mathbf {x} \cdot \mathbf {a} )}{\partial \mathbf {x} }}=} ∂ ∂ a ⊤ ⊤ x ∂ ∂ x = ∂ ∂ x ⊤ ⊤ a ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {a} ^{\top }\mathbf {x} }{\partial \mathbf {x} }}={\frac {\partial \mathbf {x} ^{\top }\mathbf {a} }{\partial \mathbf {x} }}=} a ⊤ ⊤ {\displaystyle \mathbf {a} ^{\top }} a {\displaystyle \mathbf {a} } A is not a function of x b is not a function of x ∂ ∂ b ⊤ ⊤ A x ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {b} ^{\top }\mathbf {A} \mathbf {x} }{\partial \mathbf {x} }}=} b ⊤ ⊤ A {\displaystyle \mathbf {b} ^{\top }\mathbf {A} } A ⊤ ⊤ b {\displaystyle \mathbf {A} ^{\top }\mathbf {b} } A is not a function of x ∂ ∂ x ⊤ ⊤ A x ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {x} ^{\top }\mathbf {A} \mathbf {x} }{\partial \mathbf {x} }}=} x ⊤ ⊤ ( A + A ⊤ ⊤ ) {\displaystyle \mathbf {x} ^{\top }\left(\mathbf {A} +\mathbf {A} ^{\top }\right)} ( A + A ⊤ ⊤ ) x {\displaystyle \left(\mathbf {A} +\mathbf {A} ^{\top }\right)\mathbf {x} } A is not a function of x A is symmetric ∂ ∂ x ⊤ ⊤ A x ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {x} ^{\top }\mathbf {A} \mathbf {x} }{\partial \mathbf {x} }}=} 2 x ⊤ ⊤ A {\displaystyle 2\mathbf {x} ^{\top }\mathbf {A} } 2 A x {\displaystyle 2\mathbf {A} \mathbf {x} } A is not a function of x ∂ ∂ 2 x ⊤ ⊤ A x ∂ ∂ x ∂ ∂ x ⊤ ⊤ = {\displaystyle {\frac {\partial ^{2}\mathbf {x} ^{\top }\mathbf {A} \mathbf {x} }{\partial \mathbf {x} \partial \mathbf {x} ^{\top }}}=} A + A ⊤ ⊤ {\displaystyle \mathbf {A} +\mathbf {A} ^{\top }} A is not a function of x A is symmetric ∂ ∂ 2 x ⊤ ⊤ A x ∂ ∂ x ∂ ∂ x ⊤ ⊤ = {\displaystyle {\frac {\partial ^{2}\mathbf {x} ^{\top }\mathbf {A} \mathbf {x} }{\partial \mathbf {x} \partial \mathbf {x} ^{\top }}}=} 2 A {\displaystyle 2\mathbf {A} } ∂ ∂ ( x ⋅ ⋅ x ) ∂ ∂ x = ∂ ∂ x ⊤ ⊤ x ∂ ∂ x = ∂ ∂ ‖ x ‖ 2 ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {x} \cdot \mathbf {x} )}{\partial \mathbf {x} }}={\frac {\partial \mathbf {x} ^{\top }\mathbf {x} }{\partial \mathbf {x} }}={\frac {\partial \left\Vert \mathbf {x} \right\Vert ^{2}}{\partial \mathbf {x} }}=} 2 x ⊤ ⊤ {\displaystyle 2\mathbf {x} ^{\top }} 2 x {\displaystyle 2\mathbf {x} } a is not a function of x , u = u ( x ) ∂ ∂ ( a ⋅ ⋅ u ) ∂ ∂ x = ∂ ∂ a ⊤ ⊤ u ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {a} \cdot \mathbf {u} )}{\partial \mathbf {x} }}={\frac {\partial \mathbf {a} ^{\top }\mathbf {u} }{\partial \mathbf {x} }}=} a ⊤ ⊤ ∂ ∂ u ∂ ∂ x {\displaystyle \mathbf {a} ^{\top }{\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}} ∂ ∂ u ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}} in numerator layout ∂ ∂ u ∂ ∂ x a {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}\mathbf {a} } ∂ ∂ u ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {u} }{\partial \mathbf {x} }}} in denominator layout a , b are not functions of x ∂ ∂ a ⊤ ⊤ x x ⊤ ⊤ b ∂ ∂ x = {\displaystyle {\frac {\partial \;{\textbf {a}}^{\top }{\textbf {x}}{\textbf {x}}^{\top }{\textbf {b}}}{\partial \;{\textbf {x}}}}=} x ⊤ ⊤ ( a b ⊤ ⊤ + b a ⊤ ⊤ ) {\displaystyle {\textbf {x}}^{\top }\left({\textbf {a}}{\textbf {b}}^{\top }+{\textbf {b}}{\textbf {a}}^{\top }\right)} ( a b ⊤ ⊤ + b a ⊤ ⊤ ) x {\displaystyle \left({\textbf {a}}{\textbf {b}}^{\top }+{\textbf {b}}{\textbf {a}}^{\top }\right){\textbf {x}}} A , b , C , D , e are not functions of x ∂ ∂ ( A x + b ) ⊤ ⊤ C ( D x + e ) ∂ ∂ x = {\displaystyle {\frac {\partial \;({\textbf {A}}{\textbf {x}}+{\textbf {b}})^{\top }{\textbf {C}}({\textbf {D}}{\textbf {x}}+{\textbf {e}})}{\partial \;{\textbf {x}}}}=} ( D x + e ) ⊤ ⊤ C ⊤ ⊤ A + ( A x + b ) ⊤ ⊤ C D {\displaystyle ({\textbf {D}}{\textbf {x}}+{\textbf {e}})^{\top }{\textbf {C}}^{\top }{\textbf {A}}+({\textbf {A}}{\textbf {x}}+{\textbf {b}})^{\top }{\textbf {C}}{\textbf {D}}} D ⊤ ⊤ C ⊤ ⊤ ( A x + b ) + A ⊤ ⊤ C ( D x + e ) {\displaystyle {\textbf {D}}^{\top }{\textbf {C}}^{\top }({\textbf {A}}{\textbf {x}}+{\textbf {b}})+{\textbf {A}}^{\top }{\textbf {C}}({\textbf {D}}{\textbf {x}}+{\textbf {e}})} a is not a function of x ∂ ∂ ‖ ‖ x − − a ‖ ‖ ∂ ∂ x = {\displaystyle {\frac {\partial \;\|\mathbf {x} -\mathbf {a} \|}{\partial \;\mathbf {x} }}=} ( x − − a ) ⊤ ⊤ ‖ ‖ x − − a ‖ ‖ {\displaystyle {\frac {(\mathbf {x} -\mathbf {a} )^{\top }}{\|\mathbf {x} -\mathbf {a} \|}}} x − − a ‖ ‖ x − − a ‖ ‖ {\displaystyle {\frac {\mathbf {x} -\mathbf {a} }{\|\mathbf {x} -\mathbf {a} \|}}} Vector-by-scalar identities [ edit ] Identities: vector-by-scalar ∂ ∂ y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {y} }{\partial x}}} Condition Expression Numerator layout, i.e. by y , result is column vector Denominator layout, i.e. by y T , result is row vector a is not a function of x ∂ ∂ a ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {a} }{\partial x}}=} 0 {\displaystyle \mathbf {0} } [ nb 1 ] a is not a function of x , u = u ( x ) ∂ ∂ a u ∂ ∂ x = {\displaystyle {\frac {\partial a\mathbf {u} }{\partial x}}=} a ∂ ∂ u ∂ ∂ x {\displaystyle a{\frac {\partial \mathbf {u} }{\partial x}}} A is not a function of x , u = u ( x ) ∂ ∂ A u ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {A} \mathbf {u} }{\partial x}}=} A ∂ ∂ u ∂ ∂ x {\displaystyle \mathbf {A} {\frac {\partial \mathbf {u} }{\partial x}}} ∂ ∂ u ∂ ∂ x A ⊤ ⊤ {\displaystyle {\frac {\partial \mathbf {u} }{\partial x}}\mathbf {A} ^{\top }} u = u ( x ) ∂ ∂ u ⊤ ⊤ ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {u} ^{\top }}{\partial x}}=} ( ∂ ∂ u ∂ ∂ x ) ⊤ ⊤ {\displaystyle \left({\frac {\partial \mathbf {u} }{\partial x}}\right)^{\top }} u = u ( x ) , v = v ( x ) ∂ ∂ ( u + v ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {u} +\mathbf {v} )}{\partial x}}=} ∂ ∂ u ∂ ∂ x + ∂ ∂ v ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {u} }{\partial x}}+{\frac {\partial \mathbf {v} }{\partial x}}} u = u ( x ) , v = v ( x ) ∂ ∂ ( u ⊤ ⊤ × × v ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {u} ^{\top }\times \mathbf {v} )}{\partial x}}=} ( ∂ ∂ u ∂ ∂ x ) ⊤ ⊤ × × v + u ⊤ ⊤ × × ∂ ∂ v ∂ ∂ x {\displaystyle \left({\frac {\partial \mathbf {u} }{\partial x}}\right)^{\top }\times \mathbf {v} +\mathbf {u} ^{\top }\times {\frac {\partial \mathbf {v} }{\partial x}}} ∂ ∂ u ∂ ∂ x × × v + u ⊤ ⊤ × × ( ∂ ∂ v ∂ ∂ x ) ⊤ ⊤ {\displaystyle {\frac {\partial \mathbf {u} }{\partial x}}\times \mathbf {v} +\mathbf {u} ^{\top }\times \left({\frac {\partial \mathbf {v} }{\partial x}}\right)^{\top }} u = u ( x ) ∂ ∂ g ( u ) ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial x}}=} ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ u ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}{\frac {\partial \mathbf {u} }{\partial x}}} ∂ ∂ u ∂ ∂ x ∂ ∂ g ( u ) ∂ ∂ u {\displaystyle {\frac {\partial \mathbf {u} }{\partial x}}{\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}} Assumes consistent matrix layout; see below.

u = u ( x ) ∂ ∂ f ( g ( u ) ) ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {f} (\mathbf {g} (\mathbf {u} ))}{\partial x}}=} ∂ ∂ f ( g ) ∂ ∂ g ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ u ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {f} (\mathbf {g} )}{\partial \mathbf {g} }}{\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}{\frac {\partial \mathbf {u} }{\partial x}}} ∂ ∂ u ∂ ∂ x ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ f ( g ) ∂ ∂ g {\displaystyle {\frac {\partial \mathbf {u} }{\partial x}}{\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}{\frac {\partial \mathbf {f} (\mathbf {g} )}{\partial \mathbf {g} }}} Assumes consistent matrix layout; see below.

U = U ( x ) , v = v ( x ) ∂ ∂ ( U × × v ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {U} \times \mathbf {v} )}{\partial x}}=} ∂ ∂ U ∂ ∂ x × × v + U × × ∂ ∂ v ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {U} }{\partial x}}\times \mathbf {v} +\mathbf {U} \times {\frac {\partial \mathbf {v} }{\partial x}}} v ⊤ ⊤ × × ( ∂ ∂ U ∂ ∂ x ) + ∂ ∂ v ∂ ∂ x × × U ⊤ ⊤ {\displaystyle \mathbf {v} ^{\top }\times \left({\frac {\partial \mathbf {U} }{\partial x}}\right)+{\frac {\partial \mathbf {v} }{\partial x}}\times \mathbf {U} ^{\top }} NOTE : The formulas involving the vector-by-vector derivatives ∂ ∂ g ( u ) ∂ ∂ u {\displaystyle {\frac {\partial \mathbf {g} (\mathbf {u} )}{\partial \mathbf {u} }}} and ∂ ∂ f ( g ) ∂ ∂ g {\displaystyle {\frac {\partial \mathbf {f} (\mathbf {g} )}{\partial \mathbf {g} }}} (whose outputs are matrices) assume the matrices are laid out consistent with the vector layout, i.e. numerator-layout matrix when numerator-layout vector and vice versa; otherwise, transpose the vector-by-vector derivatives.

Scalar-by-matrix identities [ edit ] Note that exact equivalents of the scalar product rule and chain rule do not exist when applied to matrix-valued functions of matrices.  However, the product rule of this sort does apply to the differential form (see below), and this is the way to derive many of the identities below involving the trace function, combined with the fact that the trace function allows transposing and cyclic permutation, i.e.: tr ⁡ ⁡ ( A ) = tr ⁡ ⁡ ( A ⊤ ⊤ ) tr ⁡ ⁡ ( A B C D ) = tr ⁡ ⁡ ( B C D A ) = tr ⁡ ⁡ ( C D A B ) = tr ⁡ ⁡ ( D A B C ) {\displaystyle {\begin{aligned}\operatorname {tr} (\mathbf {A} )&=\operatorname {tr} \left(\mathbf {A^{\top }} \right)\\\operatorname {tr} (\mathbf {ABCD} )&=\operatorname {tr} (\mathbf {BCDA} )=\operatorname {tr} (\mathbf {CDAB} )=\operatorname {tr} (\mathbf {DABC} )\end{aligned}}} For example, to compute ∂ ∂ tr ⁡ ⁡ ( A X B X ⊤ ⊤ C ) ∂ ∂ X : {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {AXBX^{\top }C} )}{\partial \mathbf {X} }}:} d tr ⁡ ⁡ ( A X B X ⊤ ⊤ C ) = d tr ⁡ ⁡ ( C A X B X ⊤ ⊤ ) = tr ⁡ ⁡ ( d ( C A X B X ⊤ ⊤ ) ) = tr ⁡ ⁡ ( C A X d ( B X ⊤ ⊤ ) + d ( C A X ) B X ⊤ ⊤ ) = tr ⁡ ⁡ ( C A X d ( B X ⊤ ⊤ ) ) + tr ⁡ ⁡ ( d ( C A X ) B X ⊤ ⊤ ) = tr ⁡ ⁡ ( C A X B d ( X ⊤ ⊤ ) ) + tr ⁡ ⁡ ( C A ( d X ) B X ⊤ ⊤ ) = tr ⁡ ⁡ ( C A X B ( d X ) ⊤ ⊤ ) + tr ⁡ ⁡ ( C A ( d X ) B X ⊤ ⊤ ) = tr ⁡ ⁡ ( ( C A X B ( d X ) ⊤ ⊤ ) ⊤ ⊤ ) + tr ⁡ ⁡ ( C A ( d X ) B X ⊤ ⊤ ) = tr ⁡ ⁡ ( ( d X ) B ⊤ ⊤ X ⊤ ⊤ A ⊤ ⊤ C ⊤ ⊤ ) + tr ⁡ ⁡ ( C A ( d X ) B X ⊤ ⊤ ) = tr ⁡ ⁡ ( B ⊤ ⊤ X ⊤ ⊤ A ⊤ ⊤ C ⊤ ⊤ ( d X ) ) + tr ⁡ ⁡ ( B X ⊤ ⊤ C A ( d X ) ) = tr ⁡ ⁡ ( ( B ⊤ ⊤ X ⊤ ⊤ A ⊤ ⊤ C ⊤ ⊤ + B X ⊤ ⊤ C A ) d X ) = tr ⁡ ⁡ ( ( C A X B + A ⊤ ⊤ C ⊤ ⊤ X B ⊤ ⊤ ) ⊤ ⊤ d X ) {\displaystyle {\begin{aligned}d\operatorname {tr} (\mathbf {AXBX^{\top }C} )&=d\operatorname {tr} \left(\mathbf {CAXBX^{\top }} \right)=\operatorname {tr} \left(d\left(\mathbf {CAXBX^{\top }} \right)\right)\\[1ex]&=\operatorname {tr} \left(\mathbf {CAX} d(\mathbf {BX^{\top }} \right)+d\left(\mathbf {CAX} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\mathbf {CAX} d\left(\mathbf {BX^{\top }} \right)\right)+\operatorname {tr} \left(d(\mathbf {CAX} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\mathbf {CAXB} d\left(\mathbf {X^{\top }} \right)\right)+\operatorname {tr} \left(\mathbf {CA} (d\mathbf {X} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\mathbf {CAXB} (d\mathbf {X} )^{\top }\right)+\operatorname {tr} (\mathbf {CA} \left(d\mathbf {X} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\left(\mathbf {CAXB} (d\mathbf {X} )^{\top }\right)^{\top }\right)+\operatorname {tr} \left(\mathbf {CA} (d\mathbf {X} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left((d\mathbf {X} )\mathbf {B^{\top }X^{\top }A^{\top }C^{\top }} \right)+\operatorname {tr} \left(\mathbf {CA} (d\mathbf {X} )\mathbf {BX^{\top }} \right)\\[1ex]&=\operatorname {tr} \left(\mathbf {B^{\top }X^{\top }A^{\top }C^{\top }} (d\mathbf {X} )\right)+\operatorname {tr} \left(\mathbf {BX^{\top }} \mathbf {CA} (d\mathbf {X} )\right)\\[1ex]&=\operatorname {tr} \left(\left(\mathbf {B^{\top }X^{\top }A^{\top }C^{\top }} +\mathbf {BX^{\top }} \mathbf {CA} \right)d\mathbf {X} \right)\\[1ex]&=\operatorname {tr} \left(\left(\mathbf {CAXB} +\mathbf {A^{\top }C^{\top }XB^{\top }} \right)^{\top }d\mathbf {X} \right)\end{aligned}}} Therefore, ∂ ∂ tr ⁡ ⁡ ( A X B X ⊤ ⊤ C ) ∂ ∂ X = B ⊤ ⊤ X ⊤ ⊤ A ⊤ ⊤ C ⊤ ⊤ + B X ⊤ ⊤ C A .

{\displaystyle {\frac {\partial \operatorname {tr} \left(\mathbf {AXBX^{\top }C} \right)}{\partial \mathbf {X} }}=\mathbf {B^{\top }X^{\top }A^{\top }C^{\top }} +\mathbf {BX^{\top }CA} .} (numerator layout) ∂ ∂ tr ⁡ ⁡ ( A X B X ⊤ ⊤ C ) ∂ ∂ X = C A X B + A ⊤ ⊤ C ⊤ ⊤ X B ⊤ ⊤ .

{\displaystyle {\frac {\partial \operatorname {tr} \left(\mathbf {AXBX^{\top }C} \right)}{\partial \mathbf {X} }}=\mathbf {CAXB} +\mathbf {A^{\top }C^{\top }XB^{\top }} .} (denominator layout) (For the last step, see the Conversion from differential to derivative form section.) Identities: scalar-by-matrix ∂ ∂ y ∂ ∂ X {\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}} Condition Expression Numerator layout, i.e. by X T Denominator layout, i.e. by X a is not a function of X ∂ ∂ a ∂ ∂ X = {\displaystyle {\frac {\partial a}{\partial \mathbf {X} }}=} 0 ⊤ ⊤ {\displaystyle \mathbf {0} ^{\top }} [ nb 2 ] 0 {\displaystyle \mathbf {0} } [ nb 2 ] a is not a function of X , u = u ( X ) ∂ ∂ a u ∂ ∂ X = {\displaystyle {\frac {\partial au}{\partial \mathbf {X} }}=} a ∂ ∂ u ∂ ∂ X {\displaystyle a{\frac {\partial u}{\partial \mathbf {X} }}} u = u ( X ) , v = v ( X ) ∂ ∂ ( u + v ) ∂ ∂ X = {\displaystyle {\frac {\partial (u+v)}{\partial \mathbf {X} }}=} ∂ ∂ u ∂ ∂ X + ∂ ∂ v ∂ ∂ X {\displaystyle {\frac {\partial u}{\partial \mathbf {X} }}+{\frac {\partial v}{\partial \mathbf {X} }}} u = u ( X ) , v = v ( X ) ∂ ∂ u v ∂ ∂ X = {\displaystyle {\frac {\partial uv}{\partial \mathbf {X} }}=} u ∂ ∂ v ∂ ∂ X + v ∂ ∂ u ∂ ∂ X {\displaystyle u{\frac {\partial v}{\partial \mathbf {X} }}+v{\frac {\partial u}{\partial \mathbf {X} }}} u = u ( X ) ∂ ∂ g ( u ) ∂ ∂ X = {\displaystyle {\frac {\partial g(u)}{\partial \mathbf {X} }}=} ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ u ∂ ∂ X {\displaystyle {\frac {\partial g(u)}{\partial u}}{\frac {\partial u}{\partial \mathbf {X} }}} u = u ( X ) ∂ ∂ f ( g ( u ) ) ∂ ∂ X = {\displaystyle {\frac {\partial f(g(u))}{\partial \mathbf {X} }}=} ∂ ∂ f ( g ) ∂ ∂ g ∂ ∂ g ( u ) ∂ ∂ u ∂ ∂ u ∂ ∂ X {\displaystyle {\frac {\partial f(g)}{\partial g}}{\frac {\partial g(u)}{\partial u}}{\frac {\partial u}{\partial \mathbf {X} }}} U = U ( X ) [ 3 ] ∂ ∂ g ( U ) ∂ ∂ X i j = {\displaystyle {\frac {\partial g(\mathbf {U} )}{\partial X_{ij}}}=} tr ⁡ ⁡ ( ∂ ∂ g ( U ) ∂ ∂ U ∂ ∂ U ∂ ∂ X i j ) {\displaystyle \operatorname {tr} \left({\frac {\partial g(\mathbf {U} )}{\partial \mathbf {U} }}{\frac {\partial \mathbf {U} }{\partial X_{ij}}}\right)} tr ⁡ ⁡ ( ( ∂ ∂ g ( U ) ∂ ∂ U ) ⊤ ⊤ ∂ ∂ U ∂ ∂ X i j ) {\displaystyle \operatorname {tr} \left(\left({\frac {\partial g(\mathbf {U} )}{\partial \mathbf {U} }}\right)^{\top }{\frac {\partial \mathbf {U} }{\partial X_{ij}}}\right)} Both forms assume numerator layout for ∂ ∂ U ∂ ∂ X i j , {\displaystyle {\frac {\partial \mathbf {U} }{\partial X_{ij}}},} i.e. mixed layout if denominator layout for X is being used.

a and b are not functions of X ∂ ∂ a ⊤ ⊤ X b ∂ ∂ X = {\displaystyle {\frac {\partial \mathbf {a} ^{\top }\mathbf {X} \mathbf {b} }{\partial \mathbf {X} }}=} b a ⊤ ⊤ {\displaystyle \mathbf {b} \mathbf {a} ^{\top }} a b ⊤ ⊤ {\displaystyle \mathbf {a} \mathbf {b} ^{\top }} a and b are not functions of X ∂ ∂ a ⊤ ⊤ X ⊤ ⊤ b ∂ ∂ X = {\displaystyle {\frac {\partial \mathbf {a} ^{\top }\mathbf {X} ^{\top }\mathbf {b} }{\partial \mathbf {X} }}=} a b ⊤ ⊤ {\displaystyle \mathbf {a} \mathbf {b} ^{\top }} b a ⊤ ⊤ {\displaystyle \mathbf {b} \mathbf {a} ^{\top }} a and b are not functions of X , f( v ) is a real-valued differentiable function ∂ ∂ f ( X a + b ) ∂ ∂ X = {\displaystyle {\frac {\partial f(\mathbf {Xa+b} )}{\partial \mathbf {X} }}=} a ∂ ∂ f ∂ ∂ v {\displaystyle \mathbf {a} {\frac {\partial f}{\partial \mathbf {v} }}} ∂ ∂ f ∂ ∂ v a ⊤ ⊤ {\displaystyle {\frac {\partial f}{\partial \mathbf {v} }}\mathbf {a} ^{\top }} a , b and C are not functions of X ∂ ∂ ( X a + b ) ⊤ ⊤ C ( X a + b ) ∂ ∂ X = {\displaystyle {\frac {\partial (\mathbf {X} \mathbf {a} +\mathbf {b} )^{\top }\mathbf {C} (\mathbf {X} \mathbf {a} +\mathbf {b} )}{\partial \mathbf {X} }}=} ( ( C + C ⊤ ⊤ ) ( X a + b ) a ⊤ ⊤ ) ⊤ ⊤ {\displaystyle \left(\left(\mathbf {C} +\mathbf {C} ^{\top }\right)(\mathbf {X} \mathbf {a} +\mathbf {b} )\mathbf {a} ^{\top }\right)^{\top }} ( C + C ⊤ ⊤ ) ( X a + b ) a ⊤ ⊤ {\displaystyle \left(\mathbf {C} +\mathbf {C} ^{\top }\right)(\mathbf {X} \mathbf {a} +\mathbf {b} )\mathbf {a} ^{\top }} a , b and C are not functions of X ∂ ∂ ( X a ) ⊤ ⊤ C ( X b ) ∂ ∂ X = {\displaystyle {\frac {\partial (\mathbf {X} \mathbf {a} )^{\top }\mathbf {C} (\mathbf {X} \mathbf {b} )}{\partial \mathbf {X} }}=} ( C X b a ⊤ ⊤ + C ⊤ ⊤ X a b ⊤ ⊤ ) ⊤ ⊤ {\displaystyle \left(\mathbf {C} \mathbf {X} \mathbf {b} \mathbf {a} ^{\top }+\mathbf {C} ^{\top }\mathbf {X} \mathbf {a} \mathbf {b} ^{\top }\right)^{\top }} C X b a ⊤ ⊤ + C ⊤ ⊤ X a b ⊤ ⊤ {\displaystyle \mathbf {C} \mathbf {X} \mathbf {b} \mathbf {a} ^{\top }+\mathbf {C} ^{\top }\mathbf {X} \mathbf {a} \mathbf {b} ^{\top }} ∂ ∂ tr ⁡ ⁡ ( X ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {X} )}{\partial \mathbf {X} }}=} I {\displaystyle \mathbf {I} } U = U ( X ) , V = V ( X ) ∂ ∂ tr ⁡ ⁡ ( U + V ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {U} +\mathbf {V} )}{\partial \mathbf {X} }}=} ∂ ∂ tr ⁡ ⁡ ( U ) ∂ ∂ X + ∂ ∂ tr ⁡ ⁡ ( V ) ∂ ∂ X {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {U} )}{\partial \mathbf {X} }}+{\frac {\partial \operatorname {tr} (\mathbf {V} )}{\partial \mathbf {X} }}} a is not a function of X , U = U ( X ) ∂ ∂ tr ⁡ ⁡ ( a U ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} (a\mathbf {U} )}{\partial \mathbf {X} }}=} a ∂ ∂ tr ⁡ ⁡ ( U ) ∂ ∂ X {\displaystyle a{\frac {\partial \operatorname {tr} (\mathbf {U} )}{\partial \mathbf {X} }}} g ( X ) is any polynomial with scalar coefficients, or any matrix function defined by an infinite polynomial series (e.g.

e X , sin( X ) , cos( X ) , ln( X ) , etc. using a Taylor series ); g ( x ) is the equivalent scalar function, g ′ ( x ) is its derivative, and g ′ ( X ) is the corresponding matrix function ∂ ∂ tr ⁡ ⁡ ( g ( X ) ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {g(X)} )}{\partial \mathbf {X} }}=} g ′ ( X ) {\displaystyle \mathbf {g} '(\mathbf {X} )} ( g ′ ( X ) ) ⊤ ⊤ {\displaystyle \left(\mathbf {g} '(\mathbf {X} )\right)^{\top }} A is not a function of X [ 4 ] ∂ ∂ tr ⁡ ⁡ ( A X ) ∂ ∂ X = ∂ ∂ tr ⁡ ⁡ ( X A ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {AX} )}{\partial \mathbf {X} }}={\frac {\partial \operatorname {tr} (\mathbf {XA} )}{\partial \mathbf {X} }}=} A {\displaystyle \mathbf {A} } A ⊤ ⊤ {\displaystyle \mathbf {A} ^{\top }} A is not a function of X [ 3 ] ∂ ∂ tr ⁡ ⁡ ( A X ⊤ ⊤ ) ∂ ∂ X = ∂ ∂ tr ⁡ ⁡ ( X ⊤ ⊤ A ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} \left(\mathbf {AX^{\top }} \right)}{\partial \mathbf {X} }}={\frac {\partial \operatorname {tr} \left(\mathbf {X^{\top }A} \right)}{\partial \mathbf {X} }}=} A ⊤ ⊤ {\displaystyle \mathbf {A} ^{\top }} A {\displaystyle \mathbf {A} } A is not a function of X [ 3 ] ∂ ∂ tr ⁡ ⁡ ( X ⊤ ⊤ A X ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} \left(\mathbf {X^{\top }AX} \right)}{\partial \mathbf {X} }}=} X ⊤ ⊤ ( A + A ⊤ ⊤ ) {\displaystyle \mathbf {X} ^{\top }\left(\mathbf {A} +\mathbf {A} ^{\top }\right)} ( A + A ⊤ ⊤ ) X {\displaystyle \left(\mathbf {A} +\mathbf {A} ^{\top }\right)\mathbf {X} } A is not a function of X [ 3 ] ∂ ∂ tr ⁡ ⁡ ( X − − 1 A ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {X^{-1}A} )}{\partial \mathbf {X} }}=} − − X − − 1 A X − − 1 {\displaystyle -\mathbf {X} ^{-1}\mathbf {A} \mathbf {X} ^{-1}} − − ( X − − 1 ) ⊤ ⊤ A ⊤ ⊤ ( X − − 1 ) ⊤ ⊤ {\displaystyle -\left(\mathbf {X} ^{-1}\right)^{\top }\mathbf {A} ^{\top }\left(\mathbf {X} ^{-1}\right)^{\top }} A , B are not functions of X ∂ ∂ tr ⁡ ⁡ ( A X B ) ∂ ∂ X = ∂ ∂ tr ⁡ ⁡ ( B A X ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {AXB} )}{\partial \mathbf {X} }}={\frac {\partial \operatorname {tr} (\mathbf {BAX} )}{\partial \mathbf {X} }}=} B A {\displaystyle \mathbf {BA} } A ⊤ ⊤ B ⊤ ⊤ {\displaystyle \mathbf {A^{\top }B^{\top }} } A , B , C are not functions of X ∂ ∂ tr ⁡ ⁡ ( A X B X ⊤ ⊤ C ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} \left(\mathbf {AXBX^{\top }C} \right)}{\partial \mathbf {X} }}=} B X ⊤ ⊤ C A + B ⊤ ⊤ X ⊤ ⊤ A ⊤ ⊤ C ⊤ ⊤ {\displaystyle \mathbf {BX^{\top }CA} +\mathbf {B^{\top }X^{\top }A^{\top }C^{\top }} } A ⊤ ⊤ C ⊤ ⊤ X B ⊤ ⊤ + C A X B {\displaystyle \mathbf {A^{\top }C^{\top }XB^{\top }} +\mathbf {CAXB} } n is a positive integer [ 3 ] ∂ ∂ tr ⁡ ⁡ ( X n ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} \left(\mathbf {X} ^{n}\right)}{\partial \mathbf {X} }}=} n X n − − 1 {\displaystyle n\mathbf {X} ^{n-1}} n ( X n − − 1 ) ⊤ ⊤ {\displaystyle n\left(\mathbf {X} ^{n-1}\right)^{\top }} A is not a function of X , n is a positive integer [ 3 ] ∂ ∂ tr ⁡ ⁡ ( A X n ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} \left(\mathbf {A} \mathbf {X} ^{n}\right)}{\partial \mathbf {X} }}=} ∑ ∑ i = 0 n − − 1 X i A X n − − i − − 1 {\displaystyle \sum _{i=0}^{n-1}\mathbf {X} ^{i}\mathbf {A} \mathbf {X} ^{n-i-1}} ∑ ∑ i = 0 n − − 1 ( X i A X n − − i − − 1 ) ⊤ ⊤ {\displaystyle \sum _{i=0}^{n-1}\left(\mathbf {X} ^{i}\mathbf {A} \mathbf {X} ^{n-i-1}\right)^{\top }} [ 3 ] ∂ ∂ tr ⁡ ⁡ ( e X ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} \left(e^{\mathbf {X} }\right)}{\partial \mathbf {X} }}=} e X {\displaystyle e^{\mathbf {X} }} ( e X ) ⊤ ⊤ {\displaystyle \left(e^{\mathbf {X} }\right)^{\top }} [ 3 ] ∂ ∂ tr ⁡ ⁡ ( sin ⁡ ⁡ ( X ) ) ∂ ∂ X = {\displaystyle {\frac {\partial \operatorname {tr} (\sin(\mathbf {X} ))}{\partial \mathbf {X} }}=} cos ⁡ ⁡ ( X ) {\displaystyle \cos(\mathbf {X} )} ( cos ⁡ ⁡ ( X ) ) ⊤ ⊤ {\displaystyle (\cos(\mathbf {X} ))^{\top }} [ 5 ] ∂ ∂ | X | ∂ ∂ X = {\displaystyle {\frac {\partial |\mathbf {X} |}{\partial \mathbf {X} }}=} cofactor ⁡ ⁡ ( X ) ⊤ ⊤ = | X | X − − 1 {\displaystyle \operatorname {cofactor} (X)^{\top }=|\mathbf {X} |\mathbf {X} ^{-1}} cofactor ⁡ ⁡ ( X ) = | X | ( X − − 1 ) ⊤ ⊤ {\displaystyle \operatorname {cofactor} (X)=|\mathbf {X} |\left(\mathbf {X} ^{-1}\right)^{\top }} a is not a function of X [ 3 ] ∂ ∂ ln ⁡ ⁡ | a X | ∂ ∂ X = {\displaystyle {\frac {\partial \ln |a\mathbf {X} |}{\partial \mathbf {X} }}=} [ nb 3 ] X − − 1 {\displaystyle \mathbf {X} ^{-1}} ( X − − 1 ) ⊤ ⊤ {\displaystyle \left(\mathbf {X} ^{-1}\right)^{\top }} A , B are not functions of X [ 3 ] ∂ ∂ | A X B | ∂ ∂ X = {\displaystyle {\frac {\partial |\mathbf {AXB} |}{\partial \mathbf {X} }}=} | A X B | X − − 1 {\displaystyle |\mathbf {AXB} |\mathbf {X} ^{-1}} | A X B | ( X − − 1 ) ⊤ ⊤ {\displaystyle |\mathbf {AXB} |\left(\mathbf {X} ^{-1}\right)^{\top }} n is a positive integer [ 3 ] ∂ ∂ | X n | ∂ ∂ X = {\displaystyle {\frac {\partial \left|\mathbf {X} ^{n}\right|}{\partial \mathbf {X} }}=} n | X n | X − − 1 {\displaystyle n\left|\mathbf {X} ^{n}\right|\mathbf {X} ^{-1}} n | X n | ( X − − 1 ) ⊤ ⊤ {\displaystyle n\left|\mathbf {X} ^{n}\right|\left(\mathbf {X} ^{-1}\right)^{\top }} (see pseudo-inverse ) [ 3 ] ∂ ∂ ln ⁡ ⁡ | X ⊤ ⊤ X | ∂ ∂ X = {\displaystyle {\frac {\partial \ln \left|\mathbf {X} ^{\top }\mathbf {X} \right|}{\partial \mathbf {X} }}=} 2 X + {\displaystyle 2\mathbf {X} ^{+}} 2 ( X + ) ⊤ ⊤ {\displaystyle 2\left(\mathbf {X} ^{+}\right)^{\top }} (see pseudo-inverse ) [ 3 ] ∂ ∂ ln ⁡ ⁡ | X ⊤ ⊤ X | ∂ ∂ X + = {\displaystyle {\frac {\partial \ln \left|\mathbf {X} ^{\top }\mathbf {X} \right|}{\partial \mathbf {X} ^{+}}}=} − − 2 X {\displaystyle -2\mathbf {X} } − − 2 X ⊤ ⊤ {\displaystyle -2\mathbf {X} ^{\top }} A is not a function of X , X is square and invertible ∂ ∂ | X ⊤ ⊤ A X | ∂ ∂ X = {\displaystyle {\frac {\partial \left|\mathbf {X^{\top }} \mathbf {A} \mathbf {X} \right|}{\partial \mathbf {X} }}=} 2 | X ⊤ ⊤ A X | X − − 1 = 2 | X ⊤ ⊤ | | A | | X | X − − 1 {\displaystyle 2\left|\mathbf {X^{\top }} \mathbf {A} \mathbf {X} \right|\mathbf {X} ^{-1}=2\left|\mathbf {X^{\top }} \right||\mathbf {A} ||\mathbf {X} |\mathbf {X} ^{-1}} 2 | X ⊤ ⊤ A X | ( X − − 1 ) ⊤ ⊤ {\displaystyle 2\left|\mathbf {X^{\top }} \mathbf {A} \mathbf {X} \right|\left(\mathbf {X} ^{-1}\right)^{\top }} A is not a function of X , X is non-square, A is symmetric ∂ ∂ | X ⊤ ⊤ A X | ∂ ∂ X = {\displaystyle {\frac {\partial \left|\mathbf {X^{\top }} \mathbf {A} \mathbf {X} \right|}{\partial \mathbf {X} }}=} 2 | X ⊤ ⊤ A X | ( X ⊤ ⊤ A ⊤ ⊤ X ) − − 1 X ⊤ ⊤ A ⊤ ⊤ {\displaystyle 2\left|\mathbf {X^{\top }} \mathbf {A} \mathbf {X} \right|\left(\mathbf {X^{\top }A^{\top }X} \right)^{-1}\mathbf {X^{\top }A^{\top }} } 2 | X ⊤ ⊤ A X | A X ( X ⊤ ⊤ A X ) − − 1 {\displaystyle 2\left|\mathbf {X^{\top }} \mathbf {A} \mathbf {X} \right|\mathbf {AX} \left(\mathbf {X^{\top }AX} \right)^{-1}} A is not a function of X , X is non-square, A is non-symmetric ∂ ∂ | X ⊤ ⊤ A X | ∂ ∂ X = {\displaystyle {\frac {\partial |\mathbf {X^{\top }} \mathbf {A} \mathbf {X} |}{\partial \mathbf {X} }}=} | X ⊤ ⊤ A X | ( ( X ⊤ ⊤ A X ) − − 1 X ⊤ ⊤ A + ( X ⊤ ⊤ A ⊤ ⊤ X ) − − 1 X ⊤ ⊤ A ⊤ ⊤ ) {\displaystyle {\begin{aligned}\left|\mathbf {X^{\top }} \mathbf {A} \mathbf {X} \right|{\Big (}&\left(\mathbf {X^{\top }AX} \right)^{-1}\mathbf {X^{\top }A} +{}\\&\left(\mathbf {X^{\top }A^{\top }X} \right)^{-1}\mathbf {X^{\top }A^{\top }} {\Big )}\end{aligned}}} | X ⊤ ⊤ A X | ( A X ( X ⊤ ⊤ A X ) − − 1 + A ⊤ ⊤ X ( X ⊤ ⊤ A ⊤ ⊤ X ) − − 1 ) {\displaystyle {\begin{aligned}\left|\mathbf {X^{\top }} \mathbf {A} \mathbf {X} \right|{\Big (}&\mathbf {AX} \left(\mathbf {X^{\top }AX} \right)^{-1}+{}\\&\mathbf {A^{\top }X} \left(\mathbf {X^{\top }A^{\top }X} \right)^{-1}{\Big )}\end{aligned}}} Matrix-by-scalar identities [ edit ] Identities: matrix-by-scalar ∂ ∂ Y ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}}} Condition Expression Numerator layout, i.e. by Y U = U ( x ) ∂ ∂ a U ∂ ∂ x = {\displaystyle {\frac {\partial a\mathbf {U} }{\partial x}}=} a ∂ ∂ U ∂ ∂ x {\displaystyle a{\frac {\partial \mathbf {U} }{\partial x}}} A , B are not functions of x , U = U ( x ) ∂ ∂ A U B ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {AUB} }{\partial x}}=} A ∂ ∂ U ∂ ∂ x B {\displaystyle \mathbf {A} {\frac {\partial \mathbf {U} }{\partial x}}\mathbf {B} } U = U ( x ) , V = V ( x ) ∂ ∂ ( U + V ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {U} +\mathbf {V} )}{\partial x}}=} ∂ ∂ U ∂ ∂ x + ∂ ∂ V ∂ ∂ x {\displaystyle {\frac {\partial \mathbf {U} }{\partial x}}+{\frac {\partial \mathbf {V} }{\partial x}}} U = U ( x ) , V = V ( x ) ∂ ∂ ( U V ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {U} \mathbf {V} )}{\partial x}}=} U ∂ ∂ V ∂ ∂ x + ∂ ∂ U ∂ ∂ x V {\displaystyle \mathbf {U} {\frac {\partial \mathbf {V} }{\partial x}}+{\frac {\partial \mathbf {U} }{\partial x}}\mathbf {V} } U = U ( x ) , V = V ( x ) ∂ ∂ ( U ⊗ ⊗ V ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {U} \otimes \mathbf {V} )}{\partial x}}=} U ⊗ ⊗ ∂ ∂ V ∂ ∂ x + ∂ ∂ U ∂ ∂ x ⊗ ⊗ V {\displaystyle \mathbf {U} \otimes {\frac {\partial \mathbf {V} }{\partial x}}+{\frac {\partial \mathbf {U} }{\partial x}}\otimes \mathbf {V} } U = U ( x ) , V = V ( x ) ∂ ∂ ( U ∘ ∘ V ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {U} \circ \mathbf {V} )}{\partial x}}=} U ∘ ∘ ∂ ∂ V ∂ ∂ x + ∂ ∂ U ∂ ∂ x ∘ ∘ V {\displaystyle \mathbf {U} \circ {\frac {\partial \mathbf {V} }{\partial x}}+{\frac {\partial \mathbf {U} }{\partial x}}\circ \mathbf {V} } U = U ( x ) ∂ ∂ U − − 1 ∂ ∂ x = {\displaystyle {\frac {\partial \mathbf {U} ^{-1}}{\partial x}}=} − − U − − 1 ∂ ∂ U ∂ ∂ x U − − 1 {\displaystyle -\mathbf {U} ^{-1}{\frac {\partial \mathbf {U} }{\partial x}}\mathbf {U} ^{-1}} U = U ( x , y ) ∂ ∂ 2 U − − 1 ∂ ∂ x ∂ ∂ y = {\displaystyle {\frac {\partial ^{2}\mathbf {U} ^{-1}}{\partial x\partial y}}=} U − − 1 ( ∂ ∂ U ∂ ∂ x U − − 1 ∂ ∂ U ∂ ∂ y − − ∂ ∂ 2 U ∂ ∂ x ∂ ∂ y + ∂ ∂ U ∂ ∂ y U − − 1 ∂ ∂ U ∂ ∂ x ) U − − 1 {\displaystyle \mathbf {U} ^{-1}\left({\frac {\partial \mathbf {U} }{\partial x}}\mathbf {U} ^{-1}{\frac {\partial \mathbf {U} }{\partial y}}-{\frac {\partial ^{2}\mathbf {U} }{\partial x\partial y}}+{\frac {\partial \mathbf {U} }{\partial y}}\mathbf {U} ^{-1}{\frac {\partial \mathbf {U} }{\partial x}}\right)\mathbf {U} ^{-1}} A is not a function of x , g ( X ) is any polynomial with scalar coefficients, or any matrix function defined by an infinite polynomial series (e.g.

e X , sin( X ) , cos( X ) , ln( X ) , etc.); g ( x ) is the equivalent scalar function, g ′ ( x ) is its derivative, and g ′ ( X ) is the corresponding matrix function ∂ ∂ g ( x A ) ∂ ∂ x = {\displaystyle {\frac {\partial \,\mathbf {g} (x\mathbf {A} )}{\partial x}}=} A g ′ ( x A ) = g ′ ( x A ) A {\displaystyle \mathbf {A} \mathbf {g} '(x\mathbf {A} )=\mathbf {g} '(x\mathbf {A} )\mathbf {A} } A is not a function of x ∂ ∂ e x A ∂ ∂ x = {\displaystyle {\frac {\partial e^{x\mathbf {A} }}{\partial x}}=} A e x A = e x A A {\displaystyle \mathbf {A} e^{x\mathbf {A} }=e^{x\mathbf {A} }\mathbf {A} } See also: Derivative of the exponential map Scalar-by-scalar identities [ edit ] With vectors involved [ edit ] Identities: scalar-by-scalar, with vectors involved Condition Expression Any layout (assumes dot product ignores row vs. column layout) u = u ( x ) ∂ ∂ g ( u ) ∂ ∂ x = {\displaystyle {\frac {\partial g(\mathbf {u} )}{\partial x}}=} ∂ ∂ g ( u ) ∂ ∂ u ⋅ ⋅ ∂ ∂ u ∂ ∂ x {\displaystyle {\frac {\partial g(\mathbf {u} )}{\partial \mathbf {u} }}\cdot {\frac {\partial \mathbf {u} }{\partial x}}} u = u ( x ) , v = v ( x ) ∂ ∂ ( u ⋅ ⋅ v ) ∂ ∂ x = {\displaystyle {\frac {\partial (\mathbf {u} \cdot \mathbf {v} )}{\partial x}}=} u ⋅ ⋅ ∂ ∂ v ∂ ∂ x + ∂ ∂ u ∂ ∂ x ⋅ ⋅ v {\displaystyle \mathbf {u} \cdot {\frac {\partial \mathbf {v} }{\partial x}}+{\frac {\partial \mathbf {u} }{\partial x}}\cdot \mathbf {v} } With matrices involved [ edit ] Identities: scalar-by-scalar, with matrices involved [ 3 ] Condition Expression Consistent numerator layout, i.e. by Y and X T Mixed layout, i.e. by Y and X U = U ( x ) ∂ ∂ | U | ∂ ∂ x = {\displaystyle {\frac {\partial |\mathbf {U} |}{\partial x}}=} | U | tr ⁡ ⁡ ( U − − 1 ∂ ∂ U ∂ ∂ x ) {\displaystyle |\mathbf {U} |\operatorname {tr} \left(\mathbf {U} ^{-1}{\frac {\partial \mathbf {U} }{\partial x}}\right)} U = U ( x ) ∂ ∂ ln ⁡ ⁡ | U | ∂ ∂ x = {\displaystyle {\frac {\partial \ln |\mathbf {U} |}{\partial x}}=} tr ⁡ ⁡ ( U − − 1 ∂ ∂ U ∂ ∂ x ) {\displaystyle \operatorname {tr} \left(\mathbf {U} ^{-1}{\frac {\partial \mathbf {U} }{\partial x}}\right)} U = U ( x ) ∂ ∂ 2 | U | ∂ ∂ x 2 = {\displaystyle {\frac {\partial ^{2}|\mathbf {U} |}{\partial x^{2}}}=} | U | [ tr ⁡ ⁡ ( U − − 1 ∂ ∂ 2 U ∂ ∂ x 2 ) + tr 2 ⁡ ⁡ ( U − − 1 ∂ ∂ U ∂ ∂ x ) − − tr ⁡ ⁡ ( ( U − − 1 ∂ ∂ U ∂ ∂ x ) 2 ) ] {\displaystyle \left|\mathbf {U} \right|\left[\operatorname {tr} \left(\mathbf {U} ^{-1}{\frac {\partial ^{2}\mathbf {U} }{\partial x^{2}}}\right)+\operatorname {tr} ^{2}\left(\mathbf {U} ^{-1}{\frac {\partial \mathbf {U} }{\partial x}}\right)-\operatorname {tr} \left(\left(\mathbf {U} ^{-1}{\frac {\partial \mathbf {U} }{\partial x}}\right)^{2}\right)\right]} U = U ( x ) ∂ ∂ g ( U ) ∂ ∂ x = {\displaystyle {\frac {\partial g(\mathbf {U} )}{\partial x}}=} tr ⁡ ⁡ ( ∂ ∂ g ( U ) ∂ ∂ U ∂ ∂ U ∂ ∂ x ) {\displaystyle \operatorname {tr} \left({\frac {\partial g(\mathbf {U} )}{\partial \mathbf {U} }}{\frac {\partial \mathbf {U} }{\partial x}}\right)} tr ⁡ ⁡ ( ( ∂ ∂ g ( U ) ∂ ∂ U ) ⊤ ⊤ ∂ ∂ U ∂ ∂ x ) {\displaystyle \operatorname {tr} \left(\left({\frac {\partial g(\mathbf {U} )}{\partial \mathbf {U} }}\right)^{\top }{\frac {\partial \mathbf {U} }{\partial x}}\right)} A is not a function of x , g ( X ) is any polynomial with scalar coefficients, or any matrix function defined by an infinite polynomial series (e.g.

e X , sin( X ) , cos( X ) , ln( X ) , etc.); g ( x ) is the equivalent scalar function, g ′ ( x ) is its derivative, and g ′ ( X ) is the corresponding matrix function.

∂ ∂ tr ⁡ ⁡ ( g ( x A ) ) ∂ ∂ x = {\displaystyle {\frac {\partial \operatorname {tr} (\mathbf {g} (x\mathbf {A} ))}{\partial x}}=} tr ⁡ ⁡ ( A g ′ ( x A ) ) {\displaystyle \operatorname {tr} \left(\mathbf {A} \mathbf {g} '(x\mathbf {A} )\right)} A is not a function of x ∂ ∂ tr ⁡ ⁡ ( e x A ) ∂ ∂ x = {\displaystyle {\frac {\partial \operatorname {tr} \left(e^{x\mathbf {A} }\right)}{\partial x}}=} tr ⁡ ⁡ ( A e x A ) {\displaystyle \operatorname {tr} \left(\mathbf {A} e^{x\mathbf {A} }\right)} Identities in differential form [ edit ] It is often easier to work in differential form and then convert back to normal derivatives.  This only works well using the numerator layout. In these rules, a is a scalar.

Differential identities: scalar involving matrix [ 1 ] [ 3 ] Expression Result (numerator layout) d ( tr ⁡ ⁡ ( X ) ) = {\displaystyle d(\operatorname {tr} (\mathbf {X} ))=} tr ⁡ ⁡ ( d X ) {\displaystyle \operatorname {tr} (d\mathbf {X} )} d ( | X | ) = {\displaystyle d(|\mathbf {X} |)=} | X | tr ⁡ ⁡ ( X − − 1 d X ) = tr ⁡ ⁡ ( adj ⁡ ⁡ ( X ) d X ) {\displaystyle |\mathbf {X} |\operatorname {tr} \left(\mathbf {X} ^{-1}d\mathbf {X} \right)=\operatorname {tr} (\operatorname {adj} (\mathbf {X} )d\mathbf {X} )} d ( ln ⁡ ⁡ | X | ) = {\displaystyle d(\ln |\mathbf {X} |)=} tr ⁡ ⁡ ( X − − 1 d X ) {\displaystyle \operatorname {tr} \left(\mathbf {X} ^{-1}d\mathbf {X} \right)} Differential identities: matrix [ 1 ] [ 3 ] [ 6 ] [ 7 ] Condition Expression Result (numerator layout) A is not a function of X d ( A ) = {\displaystyle d(\mathbf {A} )=} 0 {\displaystyle 0} a is not a function of X d ( a X ) = {\displaystyle d(a\mathbf {X} )=} a d X {\displaystyle a\,d\mathbf {X} } d ( X + Y ) = {\displaystyle d(\mathbf {X} +\mathbf {Y} )=} d X + d Y {\displaystyle d\mathbf {X} +d\mathbf {Y} } d ( X Y ) = {\displaystyle d(\mathbf {X} \mathbf {Y} )=} ( d X ) Y + X ( d Y ) {\displaystyle (d\mathbf {X} )\mathbf {Y} +\mathbf {X} (d\mathbf {Y} )} ( Kronecker product ) d ( X ⊗ ⊗ Y ) = {\displaystyle d(\mathbf {X} \otimes \mathbf {Y} )=} ( d X ) ⊗ ⊗ Y + X ⊗ ⊗ ( d Y ) {\displaystyle (d\mathbf {X} )\otimes \mathbf {Y} +\mathbf {X} \otimes (d\mathbf {Y} )} ( Hadamard product ) d ( X ∘ ∘ Y ) = {\displaystyle d(\mathbf {X} \circ \mathbf {Y} )=} ( d X ) ∘ ∘ Y + X ∘ ∘ ( d Y ) {\displaystyle (d\mathbf {X} )\circ \mathbf {Y} +\mathbf {X} \circ (d\mathbf {Y} )} d ( X ⊤ ⊤ ) = {\displaystyle d\left(\mathbf {X} ^{\top }\right)=} ( d X ) ⊤ ⊤ {\displaystyle (d\mathbf {X} )^{\top }} d ( X − − 1 ) = {\displaystyle d\left(\mathbf {X} ^{-1}\right)=} − − X − − 1 ( d X ) X − − 1 {\displaystyle -\mathbf {X} ^{-1}\left(d\mathbf {X} \right)\mathbf {X} ^{-1}} ( conjugate transpose ) d ( X H ) = {\displaystyle d\left(\mathbf {X} ^{\mathrm {H} }\right)=} ( d X ) H {\displaystyle (d\mathbf {X} )^{\mathrm {H} }} n is a positive integer d ( X n ) = {\displaystyle d\left(\mathbf {X} ^{n}\right)=} ∑ ∑ i = 0 n − − 1 X i ( d X ) X n − − i − − 1 {\displaystyle \sum _{i=0}^{n-1}\mathbf {X} ^{i}(d\mathbf {X} )\mathbf {X} ^{n-i-1}} d ( e X ) = {\displaystyle d\left(e^{\mathbf {X} }\right)=} ∫ ∫ 0 1 e a X ( d X ) e ( 1 − − a ) X d a {\displaystyle \int _{0}^{1}e^{a\mathbf {X} }(d\mathbf {X} )e^{(1-a)\mathbf {X} }\,da} d ( log ⁡ ⁡ X ) = {\displaystyle d\left(\log {X}\right)=} ∫ ∫ 0 ∞ ∞ ( X + z I ) − − 1 ( d X ) ( X + z I ) − − 1 d z {\displaystyle \int _{0}^{\infty }(\mathbf {X} +z\,\mathbf {I} )^{-1}(d\mathbf {X} )(\mathbf {X} +z\,\mathbf {I} )^{-1}\,dz} X = ∑ ∑ i λ λ i P i {\displaystyle \mathbf {X} =\sum _{i}\lambda _{i}\mathbf {P} _{i}} is diagonalizable P i P j = δ δ i j P i {\displaystyle \mathbf {P} _{i}\mathbf {P} _{j}=\delta _{ij}\mathbf {P} _{i}} f is differentiable at every eigenvalue λ λ i {\displaystyle \lambda _{i}} d ( f ( X ) ) = {\displaystyle d\left(f(\mathbf {X} )\right)=} ∑ ∑ i j P i ( d X ) P j { f ′ ( λ λ i ) λ λ i = λ λ j f ( λ λ i ) − − f ( λ λ j ) λ λ i − − λ λ j λ λ i ≠ ≠ λ λ j {\displaystyle \sum _{ij}\mathbf {P} _{i}(d\mathbf {X} )\mathbf {P} _{j}{\begin{cases}f'(\lambda _{i})&\lambda _{i}=\lambda _{j}\\{\frac {f(\lambda _{i})-f(\lambda _{j})}{\lambda _{i}-\lambda _{j}}}&\lambda _{i}\neq \lambda _{j}\end{cases}}} In the last row, δ δ i j {\displaystyle \delta _{ij}} is the Kronecker delta and ( P k ) i j = ( Q ) i k ( Q − − 1 ) k j {\displaystyle (\mathbf {P} _{k})_{ij}=(\mathbf {Q} )_{ik}(\mathbf {Q} ^{-1})_{kj}} is the set of orthogonal projection operators that project onto the k -th eigenvector of X .

Q is the matrix of eigenvectors of X = Q Λ Λ Q − − 1 {\displaystyle \mathbf {X} =\mathbf {Q} {\boldsymbol {\Lambda }}\mathbf {Q} ^{-1}} , and ( Λ Λ ) i i = λ λ i {\displaystyle ({\boldsymbol {\Lambda }})_{ii}=\lambda _{i}} are the eigenvalues.
The matrix function f ( X ) {\displaystyle f(\mathbf {X} )} is defined in terms of the scalar function f ( x ) {\displaystyle f(x)} for diagonalizable matrices by f ( X ) = ∑ ∑ i f ( λ λ i ) P i {\textstyle f(\mathbf {X} )=\sum _{i}f(\lambda _{i})\mathbf {P} _{i}} where X = ∑ ∑ i λ λ i P i {\textstyle \mathbf {X} =\sum _{i}\lambda _{i}\mathbf {P} _{i}} with P i P j = δ δ i j P i {\displaystyle \mathbf {P} _{i}\mathbf {P} _{j}=\delta _{ij}\mathbf {P} _{i}} .

To convert to normal derivative form, first convert it to one of the following canonical forms, and then use these identities: Conversion from differential to derivative form [ 1 ] Canonical differential form Equivalent derivative form (numerator layout) d y = a d x {\displaystyle dy=a\,dx} d y d x = a {\displaystyle {\frac {dy}{dx}}=a} d y = a ⊤ ⊤ d x {\displaystyle dy=\mathbf {a} ^{\top }d\mathbf {x} } d y d x = a ⊤ ⊤ {\displaystyle {\frac {dy}{d\mathbf {x} }}=\mathbf {a} ^{\top }} d y = tr ⁡ ⁡ ( A d X ) {\displaystyle dy=\operatorname {tr} (\mathbf {A} \,d\mathbf {X} )} d y d X = A {\displaystyle {\frac {dy}{d\mathbf {X} }}=\mathbf {A} } d y = a d x {\displaystyle d\mathbf {y} =\mathbf {a} \,dx} d y d x = a {\displaystyle {\frac {d\mathbf {y} }{dx}}=\mathbf {a} } d y = A d x {\displaystyle d\mathbf {y} =\mathbf {A} \,d\mathbf {x} } d y d x = A {\displaystyle {\frac {d\mathbf {y} }{d\mathbf {x} }}=\mathbf {A} } d Y = A d x {\displaystyle d\mathbf {Y} =\mathbf {A} \,dx} d Y d x = A {\displaystyle {\frac {d\mathbf {Y} }{dx}}=\mathbf {A} } Applications [ edit ] Matrix differential calculus is used in statistics and econometrics, particularly for the statistical analysis of multivariate distributions , especially the multivariate normal distribution and other elliptical distributions .

[ 8 ] [ 9 ] [ 10 ] It is used in regression analysis to compute, for example, the ordinary least squares regression formula for the case of multiple explanatory variables .

[ 11 ] It is also used in random matrices, statistical moments, local sensitivity and statistical diagnostics.

[ 12 ] [ 13 ] See also [ edit ] Mathematics portal Derivative (generalizations) Product integral Ricci calculus Tensor derivative Notes [ edit ] ^ a b c Here, 0 {\displaystyle \mathbf {0} } refers to a column vector of all 0's, of size n , where n is the length of x .

^ a b Here, 0 {\displaystyle \mathbf {0} } refers to a matrix of all 0's, of the same shape as X .

^ The constant a disappears in the result.  This is intentional.  In general, d ln ⁡ ⁡ a u d x = 1 a u d ( a u ) d x = 1 a u a d u d x = 1 u d u d x = d ln ⁡ ⁡ u d x .

{\displaystyle {\frac {d\ln au}{dx}}={\frac {1}{au}}{\frac {d(au)}{dx}}={\frac {1}{au}}a{\frac {du}{dx}}={\frac {1}{u}}{\frac {du}{dx}}={\frac {d\ln u}{dx}}.} or, also d ln ⁡ ⁡ a u d x = d ( ln ⁡ ⁡ a + ln ⁡ ⁡ u ) d x = d ln ⁡ ⁡ a d x + d ln ⁡ ⁡ u d x = d ln ⁡ ⁡ u d x .

{\displaystyle {\frac {d\ln au}{dx}}={\frac {d(\ln a+\ln u)}{dx}}={\frac {d\ln a}{dx}}+{\frac {d\ln u}{dx}}={\frac {d\ln u}{dx}}.} References [ edit ] ^ a b c d e Thomas P., Minka (December 28, 2000).

"Old and New Matrix Algebra Useful for Statistics" . MIT Media Lab note (1997; revised 12/00) . Retrieved 5 February 2016 .

^ Felippa, Carlos A.

"Appendix D, Linear Algebra: Determinants, Inverses, Rank" (PDF) .

ASEN 5007: Introduction To Finite Element Methods . Boulder, Colorado: University of Colorado . Retrieved 5 February 2016 .

Uses the Hessian ( transpose to Jacobian ) definition of vector and matrix derivatives.

^ a b c d e f g h i j k l m n o p q Petersen, Kaare Brandt; Pedersen, Michael Syskind.

The Matrix Cookbook (PDF) . Archived from the original on 2 March 2010 . Retrieved 5 February 2016 .

This book uses a mixed layout, i.e. by Y in ∂ ∂ Y ∂ ∂ x , {\displaystyle {\frac {\partial \mathbf {Y} }{\partial x}},} by X in ∂ ∂ y ∂ ∂ X .

{\displaystyle {\frac {\partial y}{\partial \mathbf {X} }}.} ^ Duchi, John C.

"Properties of the Trace and Matrix Derivatives" (PDF) . Stanford University . Retrieved 5 February 2016 .

^ See Determinant § Derivative for the derivation.

^ Giles, Mike B. (2008). "Collected matrix derivative results for forward and reverse mode algorithmic differentiation". In Bischof, Christian H.; Bücker, H. Martin; Hovland, Paul; Naumann, Uwe; Utke, Jean (eds.).

Advances in Automatic Differentiation . Lecture Notes in Computational Science and Engineering. Vol. 64. Berlin: Springer. pp.

35– 44.

doi : 10.1007/978-3-540-68942-3_4 .

ISBN 978-3-540-68935-5 .

MR 2531677 .

^ Unpublished memo by S Adler (IAS) ^ Fang, Kai-Tai ; Zhang, Yao-Ting (1990).

Generalized multivariate analysis . Science Press (Beijing) and Springer-Verlag (Berlin).

ISBN 3540176519 . 9783540176510.

^ Pan, Jianxin; Fang, Kaitai (2007).

Growth curve models and statistical diagnostics . Beijing: Science Press.

ISBN 9780387950532 .

^ Kollo, Tõnu; von Rosen, Dietrich (2005).

Advanced multivariate statistics with matrices . Dordrecht: Springer.

ISBN 978-1-4020-3418-3 .

^ Magnus, Jan; Neudecker, Heinz (2019).

Matrix differential calculus with applications in statistics and econometrics . New York: John Wiley.

ISBN 9781119541202 .

^ Liu, Shuangzhe; Leiva, Victor; Zhuang, Dan; Ma, Tiefeng; Figueroa-Zúñiga, Jorge I. (2022).

"Matrix differential calculus with applications in the multivariate linear model and its diagnostics" .

Journal of Multivariate Analysis .

188 : 104849.

doi : 10.1016/j.jmva.2021.104849 .

^ Liu, Shuangzhe; Trenkler, Götz; Kollo, Tõnu; von Rosen, Dietrich; Baksalary, Oskar Maria (2023). "Professor Heinz Neudecker and matrix differential calculus".

Statistical Papers .

65 (4): 2605– 2639.

doi : 10.1007/s00362-023-01499-w .

S2CID 263661094 .

Further reading [ edit ] Abadir, Karim M.; Magnus, Jan R. (2005).

Matrix algebra . Econometric Exercises. Cambridge: Cambridge University Press.

ISBN 978-0-511-64796-3 .

OCLC 569411497 .

Lax, Peter D. (2007). "9. Calculus of Vector- and Matrix-Valued Functions".

Linear algebra and its applications (2nd ed.). Hoboken, N.J.: Wiley-Interscience.

ISBN 978-0-471-75156-4 .

Magnus, Jan R. (October 2010). "On the concept of matrix derivative".

Journal of Multivariate Analysis .

101 (9): 2200– 2206.

doi : 10.1016/j.jmva.2010.05.005 .

. Note that this Wikipedia article has been nearly completely revised from the version criticized in this article.

External links [ edit ] Software [ edit ] MatrixCalculus.org , a website for evaluating matrix calculus expressions symbolically NCAlgebra , an open-source Mathematica package that has some matrix calculus functionality SymPy supports symbolic matrix derivatives in its matrix expression module , as well as symbolic tensor derivatives in its array expression module .

Tensorgrad , an open-source python package for matrix calculus. Supports general symbolic tensor derivatives using Penrose graphical notation .

Information [ edit ] Matrix Reference Manual , Mike Brookes, Imperial College London .

Matrix Differentiation (and some other stuff) , Randal J. Barnes, Department of Civil Engineering, University of Minnesota.

Notes on Matrix Calculus , Paul L. Fackler, North Carolina State University .

Matrix Differential Calculus Archived 2012-09-16 at the Wayback Machine (slide presentation), Zhang Le, University of Edinburgh .

Introduction to Vector and Matrix Differentiation (notes on matrix differentiation, in the context of Econometrics ), Heino Bohn Nielsen.

A note on differentiating matrices (notes on matrix differentiation), Pawel Koval, from Munich Personal RePEc Archive.

Vector/Matrix Calculus More notes on matrix differentiation.

Matrix Identities (notes on matrix differentiation), Sam Roweis.

Tensor Cookbook Matrix Calculus using Tensor Diagrams .

v t e Calculus Precalculus Binomial theorem Concave function Continuous function Factorial Finite difference Free variables and bound variables Graph of a function Linear function Radian Rolle's theorem Secant Slope Tangent Limits Indeterminate form Limit of a function One-sided limit Limit of a sequence Order of approximation (ε, δ)-definition of limit Differential calculus Derivative Second derivative Partial derivative Differential Differential operator Mean value theorem Notation Leibniz's notation Newton's notation Rules of differentiation linearity Power Sum Chain L'Hôpital's Product General Leibniz's rule Quotient Other techniques Implicit differentiation Inverse functions and differentiation Logarithmic derivative Related rates Stationary points First derivative test Second derivative test Extreme value theorem Maximum and minimum Further applications Newton's method Taylor's theorem Differential equation Ordinary differential equation Partial differential equation Stochastic differential equation Integral calculus Antiderivative Arc length Riemann integral Basic properties Constant of integration Fundamental theorem of calculus Differentiating under the integral sign Integration by parts Integration by substitution trigonometric Euler Tangent half-angle substitution Partial fractions in integration Quadratic integral Trapezoidal rule Volumes Washer method Shell method Integral equation Integro-differential equation Vector calculus Derivatives Curl Directional derivative Divergence Gradient Laplacian Basic theorems Line integrals Green's Stokes' Gauss' Multivariable calculus Divergence theorem Geometric Hessian matrix Jacobian matrix and determinant Lagrange multiplier Line integral Matrix Multiple integral Partial derivative Surface integral Volume integral Advanced topics Differential forms Exterior derivative Generalized Stokes' theorem Tensor calculus Sequences and series Arithmetico-geometric sequence Types of series Alternating Binomial Fourier Geometric Harmonic Infinite Power Maclaurin Taylor Telescoping Tests of convergence Abel's Alternating series Cauchy condensation Direct comparison Dirichlet's Integral Limit comparison Ratio Root Term Special functions and numbers Bernoulli numbers e (mathematical constant) Exponential function Natural logarithm Stirling's approximation History of calculus Adequality Brook Taylor Colin Maclaurin Generality of algebra Gottfried Wilhelm Leibniz Infinitesimal Infinitesimal calculus Isaac Newton Fluxion Law of Continuity Leonhard Euler Method of Fluxions The Method of Mechanical Theorems Lists Integrals rational functions irrational algebraic functions exponential functions logarithmic functions hyperbolic functions inverse trigonometric functions inverse Secant Secant cubed List of limits List of derivatives Miscellaneous topics Complex calculus Contour integral Differential geometry Manifold Curvature of curves of surfaces Tensor Euler–Maclaurin formula Gabriel's horn Integration Bee Proof that 22/7 exceeds π Regiomontanus' angle maximization problem Steinmetz solid Retrieved from " https://en.wikipedia.org/w/index.php?title=Matrix_calculus&oldid=1292205435 " Categories : Matrix theory Linear algebra Multivariable calculus Hidden categories: Articles with short description Short description matches Wikidata Pages using sidebar with the child parameter Webarchive template wayback links This page was last edited on 25 May 2025, at 19:08 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Matrix calculus 8 languages Add topic

