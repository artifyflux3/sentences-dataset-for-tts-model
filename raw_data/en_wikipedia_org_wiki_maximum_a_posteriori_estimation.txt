Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Description 2 Computation 3 Limitations 4 Example 5 References Toggle the table of contents Maximum a posteriori estimation 13 languages Català Deutsch Español فارسی Français 한국어 Italiano Nederlands 日本語 Русский Türkçe Українська 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Method of estimating the parameters of a statistical model This article needs additional citations for verification .

Please help improve this article by adding citations to reliable sources . Unsourced material may be challenged and removed.

Find sources: "Maximum a posteriori estimation" – news · newspapers · books · scholar · JSTOR ( September 2011 ) ( Learn how and when to remove this message ) Part of a series on Bayesian statistics Posterior = Likelihood × Prior ÷ Evidence Background Bayesian inference Bayesian probability Bayes' theorem Bernstein–von Mises theorem Coherence Cox's theorem Cromwell's rule Likelihood principle Principle of indifference Principle of maximum entropy Model building Conjugate prior Linear regression Empirical Bayes Hierarchical model Posterior approximation Markov chain Monte Carlo Laplace's approximation Integrated nested Laplace approximations Variational inference Approximate Bayesian computation Estimators Bayesian estimator Credible interval Maximum a posteriori estimation Evidence approximation Evidence lower bound Nested sampling Model evaluation Bayes factor ( Schwarz criterion ) Model averaging Posterior predictive Mathematics portal v t e An estimation procedure that is often claimed to be part of Bayesian statistics is the maximum a posteriori ( MAP ) estimate of an unknown quantity, that equals the mode of the posterior density with respect to some reference measure, typically the Lebesgue measure . The MAP can be used to obtain a point estimate of an unobserved quantity on the basis of empirical data. It is closely related to the method of maximum likelihood (ML) estimation, but employs an augmented optimization objective which incorporates a prior density over the quantity one wants to estimate.  MAP estimation is therefore a regularization of maximum likelihood estimation, so is not a well-defined statistic of the Bayesian posterior distribution.

Description [ edit ] Assume that we want to estimate an unobserved population parameter θ θ {\displaystyle \theta } on the basis of observations x {\displaystyle x} . Let f {\displaystyle f} be the sampling distribution of x {\displaystyle x} , so that f ( x ∣ ∣ θ θ ) {\displaystyle f(x\mid \theta )} is the probability of x {\displaystyle x} when the underlying population parameter is θ θ {\displaystyle \theta } .  Then the function: θ θ ↦ ↦ f ( x ∣ ∣ θ θ ) {\displaystyle \theta \mapsto f(x\mid \theta )\!} is known as the likelihood function and the estimate: θ θ ^ ^ M L E ( x ) = a r g m a x θ θ f ( x ∣ ∣ θ θ ) {\displaystyle {\hat {\theta }}_{\mathrm {MLE} }(x)={\underset {\theta }{\operatorname {arg\,max} }}\ f(x\mid \theta )\!} is the maximum likelihood estimate of θ θ {\displaystyle \theta } .

Now assume that a prior distribution g {\displaystyle g} over θ θ {\displaystyle \theta } exists.  This allows us to treat θ θ {\displaystyle \theta } as a random variable as in Bayesian statistics .  We can calculate the posterior density of θ θ {\displaystyle \theta } using Bayes' theorem : θ θ ↦ ↦ f ( θ θ ∣ ∣ x ) = f ( x ∣ ∣ θ θ ) g ( θ θ ) ∫ ∫ Θ Θ f ( x ∣ ∣ ϑ ϑ ) g ( ϑ ϑ ) d ϑ ϑ {\displaystyle \theta \mapsto f(\theta \mid x)={\frac {f(x\mid \theta )\,g(\theta )}{\displaystyle \int _{\Theta }f(x\mid \vartheta )\,g(\vartheta )\,d\vartheta }}\!} where g {\displaystyle g} is density function of θ θ {\displaystyle \theta } , Θ Θ {\displaystyle \Theta } is the domain of g {\displaystyle g} .

The method of maximum a posteriori estimation then estimates θ θ {\displaystyle \theta } as the mode of the posterior density of this random variable: θ θ ^ ^ M A P ( x ) = a r g m a x θ θ f ( θ θ ∣ ∣ x ) = a r g m a x θ θ f ( x ∣ ∣ θ θ ) g ( θ θ ) ∫ ∫ Θ Θ f ( x ∣ ∣ ϑ ϑ ) g ( ϑ ϑ ) d ϑ ϑ = a r g m a x θ θ f ( x ∣ ∣ θ θ ) g ( θ θ ) .

{\displaystyle {\begin{aligned}{\hat {\theta }}_{\mathrm {MAP} }(x)&={\underset {\theta }{\operatorname {arg\,max} }}\ f(\theta \mid x)\\&={\underset {\theta }{\operatorname {arg\,max} }}\ {\frac {f(x\mid \theta )\,g(\theta )}{\displaystyle \int _{\Theta }f(x\mid \vartheta )\,g(\vartheta )\,d\vartheta }}\\&={\underset {\theta }{\operatorname {arg\,max} }}\ f(x\mid \theta )\,g(\theta ).\end{aligned}}\!} The denominator of the posterior density (the marginal likelihood of the model) is always positive and does not depend on θ θ {\displaystyle \theta } and therefore plays no role in the optimization. Observe that the MAP estimate of θ θ {\displaystyle \theta } coincides with the ML estimate when the prior g {\displaystyle g} is uniform (i.e., g {\displaystyle g} is a constant function ), which occurs whenever the prior distribution is taken as the reference measure, as is typical in function-space applications.

When the loss function is of the form L ( θ θ , a ) = { 0 , if | a − − θ θ | < c , 1 , otherwise , {\displaystyle L(\theta ,a)={\begin{cases}0,&{\text{if }}|a-\theta |<c,\\1,&{\text{otherwise}},\\\end{cases}}} as c {\displaystyle c} goes to 0, the Bayes estimator approaches the MAP estimator, provided that the distribution of θ θ {\displaystyle \theta } is quasi-concave.

[ 1 ] But generally a MAP estimator is not a Bayes estimator unless θ θ {\displaystyle \theta } is discrete .

Computation [ edit ] MAP estimates can be computed in several ways: Analytically, when the mode(s) of the posterior density can be given in closed form .  This is the case when conjugate priors are used.

Via numerical optimization such as the conjugate gradient method or Newton's method . This usually requires first or second derivatives , which have to be evaluated analytically or numerically.

Via a modification of an expectation-maximization algorithm . This does not require derivatives of the posterior density.

Via a Monte Carlo method using simulated annealing Limitations [ edit ] While only mild conditions  are required for MAP estimation to be a limiting case of Bayes estimation (under the 0–1 loss function), [ 1 ] it is not representative of Bayesian methods in general.  This is because MAP estimates are point estimates, and depend on the arbitrary choice of reference measure, whereas Bayesian methods are characterized by the use of distributions to summarize data and draw inferences: thus, Bayesian methods tend to report the posterior mean or median instead, together with credible intervals .  This is both because these estimators are optimal under squared-error and linear-error loss respectively—which are more representative of typical loss functions —and for a continuous posterior distribution there is no loss function which suggests the MAP is the optimal point estimator. In addition, the posterior density may often not have a simple analytic form: in this case, the distribution can be simulated using Markov chain Monte Carlo techniques, while optimization to find the mode(s) of the density may be difficult or impossible.

[ citation needed ] An example of a density of a bimodal distribution in which the highest mode is uncharacteristic of the majority of the distribution In many types of models, such as mixture models , the posterior may be multi-modal . In such a case, the usual recommendation is that one should choose the highest mode: this is not always feasible ( global optimization is a difficult problem), nor in some cases even possible (such as when identifiability issues arise). Furthermore, the highest mode may be uncharacteristic of the majority of the posterior, especially in many dimensions.

Finally, unlike ML estimators, the MAP estimate is not invariant under reparameterization. Switching from one parameterization to another involves introducing a Jacobian that impacts on the location of the maximum.

[ 2 ] In contrast, Bayesian posterior expectations are invariant under reparameterization.

As an example of the difference between Bayes estimators mentioned above (mean and median estimators) and using a MAP estimate, consider the case where there is a  need to classify inputs x {\displaystyle x} as either positive or negative (for example, loans as risky or safe). Suppose there are just three possible hypotheses about the correct method of classification h 1 {\displaystyle h_{1}} , h 2 {\displaystyle h_{2}} and h 3 {\displaystyle h_{3}} with posteriors 0.4, 0.3 and 0.3 respectively. Suppose given a new instance, x {\displaystyle x} , h 1 {\displaystyle h_{1}} classifies it as positive, whereas the other two classify it as negative. Using the MAP estimate for the correct classifier h 1 {\displaystyle h_{1}} , x {\displaystyle x} is classified as positive, whereas the Bayes estimators would average over all hypotheses and classify x {\displaystyle x} as negative.

Example [ edit ] Suppose that we are given a sequence ( x 1 , … … , x n ) {\displaystyle (x_{1},\dots ,x_{n})} of IID N ( μ μ , σ σ v 2 ) {\displaystyle N(\mu ,\sigma _{v}^{2})} random variables and a prior distribution of μ μ {\displaystyle \mu } is given by N ( μ μ 0 , σ σ m 2 ) {\displaystyle N(\mu _{0},\sigma _{m}^{2})} .  We wish to find the MAP estimate of μ μ {\displaystyle \mu } . Note that the normal distribution is its own conjugate prior , so we will be able to find a closed-form solution analytically.

The function to be maximized is then given by [ 3 ] g ( μ μ ) f ( x ∣ ∣ μ μ ) = π π ( μ μ ) L ( μ μ ) = 1 2 π π σ σ m exp ⁡ ⁡ ( − − 1 2 ( μ μ − − μ μ 0 σ σ m ) 2 ) ∏ ∏ j = 1 n 1 2 π π σ σ v exp ⁡ ⁡ ( − − 1 2 ( x j − − μ μ σ σ v ) 2 ) , {\displaystyle g(\mu )f(x\mid \mu )=\pi (\mu )L(\mu )={\frac {1}{{\sqrt {2\pi }}\sigma _{m}}}\exp \left(-{\frac {1}{2}}\left({\frac {\mu -\mu _{0}}{\sigma _{m}}}\right)^{2}\right)\prod _{j=1}^{n}{\frac {1}{{\sqrt {2\pi }}\sigma _{v}}}\exp \left(-{\frac {1}{2}}\left({\frac {x_{j}-\mu }{\sigma _{v}}}\right)^{2}\right),} which is equivalent to minimizing the following function of μ μ {\displaystyle \mu } : ∑ ∑ j = 1 n ( x j − − μ μ σ σ v ) 2 + ( μ μ − − μ μ 0 σ σ m ) 2 .

{\displaystyle \sum _{j=1}^{n}\left({\frac {x_{j}-\mu }{\sigma _{v}}}\right)^{2}+\left({\frac {\mu -\mu _{0}}{\sigma _{m}}}\right)^{2}.} Thus, we see that the MAP estimator for μ is given by [ 3 ] μ μ ^ ^ M A P = σ σ m 2 n σ σ m 2 n + σ σ v 2 ( 1 n ∑ ∑ j = 1 n x j ) + σ σ v 2 σ σ m 2 n + σ σ v 2 μ μ 0 = σ σ m 2 ( ∑ ∑ j = 1 n x j ) + σ σ v 2 μ μ 0 σ σ m 2 n + σ σ v 2 .

{\displaystyle {\hat {\mu }}_{\mathrm {MAP} }={\frac {\sigma _{m}^{2}\,n}{\sigma _{m}^{2}\,n+\sigma _{v}^{2}}}\left({\frac {1}{n}}\sum _{j=1}^{n}x_{j}\right)+{\frac {\sigma _{v}^{2}}{\sigma _{m}^{2}\,n+\sigma _{v}^{2}}}\,\mu _{0}={\frac {\sigma _{m}^{2}\left(\sum _{j=1}^{n}x_{j}\right)+\sigma _{v}^{2}\,\mu _{0}}{\sigma _{m}^{2}\,n+\sigma _{v}^{2}}}.} which turns out to be a linear interpolation between the prior mean and the sample mean weighted by their respective covariances.

The case of σ σ m → → ∞ ∞ {\displaystyle \sigma _{m}\to \infty } is called a non-informative prior and leads to an improper probability distribution ; in this case μ μ ^ ^ M A P → → μ μ ^ ^ M L E .

{\displaystyle {\hat {\mu }}_{\mathrm {MAP} }\to {\hat {\mu }}_{\mathrm {MLE} }.} References [ edit ] ^ a b Bassett, Robert; Deride, Julio (2018-01-30). "Maximum a posteriori estimators as a limit of Bayes estimators".

Mathematical Programming : 1– 16.

arXiv : 1611.05917 .

doi : 10.1007/s10107-018-1241-0 .

ISSN 0025-5610 .

^ Murphy, Kevin P. (2012).

Machine learning : a probabilistic perspective . Cambridge, Massachusetts: MIT Press. pp.

151– 152.

ISBN 978-0-262-01802-9 .

^ a b Young, G. A.; Smith, R. L. (2005).

Essentials of Statistical Inference . Cambridge Series in Statistical and Probabilistic Mathematics. Cambridge: Cambridge University Press.

ISBN 978-0-521-83971-6 .

DeGroot, M. (1970).

Optimal Statistical Decisions . McGraw-Hill.

ISBN 0-07-016242-5 .

Sorenson, Harold W. (1980).

Parameter Estimation: Principles and Problems . Marcel Dekker.

ISBN 0-8247-6987-2 .

Hald, Anders (2007). "Gauss's Derivation of the Normal Distribution and the Method of Least Squares, 1809".

A History of Parametric Statistical Inference from Bernoulli to Fisher, 1713–1935 . New York: Springer. pp.

55– 61.

ISBN 978-0-387-46409-1 .

v t e Statistics Outline Index Descriptive statistics Continuous data Center Mean Arithmetic Arithmetic-Geometric Contraharmonic Cubic Generalized/power Geometric Harmonic Heronian Heinz Lehmer Median Mode Dispersion Average absolute deviation Coefficient of variation Interquartile range Percentile Range Standard deviation Variance Shape Central limit theorem Moments Kurtosis L-moments Skewness Count data Index of dispersion Summary tables Contingency table Frequency distribution Grouped data Dependence Partial correlation Pearson product-moment correlation Rank correlation Kendall's τ Spearman's ρ Scatter plot Graphics Bar chart Biplot Box plot Control chart Correlogram Fan chart Forest plot Histogram Pie chart Q–Q plot Radar chart Run chart Scatter plot Stem-and-leaf display Violin plot Data collection Study design Effect size Missing data Optimal design Population Replication Sample size determination Statistic Statistical power Survey methodology Sampling Cluster Stratified Opinion poll Questionnaire Standard error Controlled experiments Blocking Factorial experiment Interaction Random assignment Randomized controlled trial Randomized experiment Scientific control Adaptive designs Adaptive clinical trial Stochastic approximation Up-and-down designs Observational studies Cohort study Cross-sectional study Natural experiment Quasi-experiment Statistical inference Statistical theory Population Statistic Probability distribution Sampling distribution Order statistic Empirical distribution Density estimation Statistical model Model specification L p space Parameter location scale shape Parametric family Likelihood (monotone) Location–scale family Exponential family Completeness Sufficiency Statistical functional Bootstrap U V Optimal decision loss function Efficiency Statistical distance divergence Asymptotics Robustness Frequentist inference Point estimation Estimating equations Maximum likelihood Method of moments M-estimator Minimum distance Unbiased estimators Mean-unbiased minimum-variance Rao–Blackwellization Lehmann–Scheffé theorem Median unbiased Plug-in Interval estimation Confidence interval Pivot Likelihood interval Prediction interval Tolerance interval Resampling Bootstrap Jackknife Testing hypotheses 1- & 2-tails Power Uniformly most powerful test Permutation test Randomization test Multiple comparisons Parametric tests Likelihood-ratio Score/Lagrange multiplier Wald Specific tests Z -test (normal) Student's t -test F -test Goodness of fit Chi-squared G -test Kolmogorov–Smirnov Anderson–Darling Lilliefors Jarque–Bera Normality (Shapiro–Wilk) Likelihood-ratio test Model selection Cross validation AIC BIC Rank statistics Sign Sample median Signed rank (Wilcoxon) Hodges–Lehmann estimator Rank sum (Mann–Whitney) Nonparametric anova 1-way (Kruskal–Wallis) 2-way (Friedman) Ordered alternative (Jonckheere–Terpstra) Van der Waerden test Bayesian inference Bayesian probability prior posterior Credible interval Bayes factor Bayesian estimator Maximum posterior estimator Correlation Regression analysis Correlation Pearson product-moment Partial correlation Confounding variable Coefficient of determination Regression analysis Errors and residuals Regression validation Mixed effects models Simultaneous equations models Multivariate adaptive regression splines (MARS) Linear regression Simple linear regression Ordinary least squares General linear model Bayesian regression Non-standard predictors Nonlinear regression Nonparametric Semiparametric Isotonic Robust Homoscedasticity and Heteroscedasticity Generalized linear model Exponential families Logistic (Bernoulli) / Binomial / Poisson regressions Partition of variance Analysis of variance (ANOVA, anova) Analysis of covariance Multivariate ANOVA Degrees of freedom Categorical / multivariate / time-series / survival analysis Categorical Cohen's kappa Contingency table Graphical model Log-linear model McNemar's test Cochran–Mantel–Haenszel statistics Multivariate Regression Manova Principal components Canonical correlation Discriminant analysis Cluster analysis Classification Structural equation model Factor analysis Multivariate distributions Elliptical distributions Normal Time-series General Decomposition Trend Stationarity Seasonal adjustment Exponential smoothing Cointegration Structural break Granger causality Specific tests Dickey–Fuller Johansen Q-statistic (Ljung–Box) Durbin–Watson Breusch–Godfrey Time domain Autocorrelation (ACF) partial (PACF) Cross-correlation (XCF) ARMA model ARIMA model (Box–Jenkins) Autoregressive conditional heteroskedasticity (ARCH) Vector autoregression (VAR) Frequency domain Spectral density estimation Fourier analysis Least-squares spectral analysis Wavelet Whittle likelihood Survival Survival function Kaplan–Meier estimator (product limit) Proportional hazards models Accelerated failure time (AFT) model First hitting time Hazard function Nelson–Aalen estimator Test Log-rank test Applications Biostatistics Bioinformatics Clinical trials / studies Epidemiology Medical statistics Engineering statistics Chemometrics Methods engineering Probabilistic design Process / quality control Reliability System identification Social statistics Actuarial science Census Crime statistics Demography Econometrics Jurimetrics National accounts Official statistics Population statistics Psychometrics Spatial statistics Cartography Environmental statistics Geographic information system Geostatistics Kriging Category Mathematics portal Commons WikiProject Retrieved from " https://en.wikipedia.org/w/index.php?title=Maximum_a_posteriori_estimation&oldid=1263884525 " Categories : Bayesian estimation Logic and statistics A priori Hidden categories: Articles with short description Short description matches Wikidata Articles needing additional references from September 2011 All articles needing additional references All articles with unsourced statements Articles with unsourced statements from August 2012 This page was last edited on 19 December 2024, at 05:26 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Maximum a posteriori estimation 13 languages Add topic

