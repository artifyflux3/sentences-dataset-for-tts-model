Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 History 2 Gaussian primes 3 Related results 4 Algorithm Toggle Algorithm subsection 4.1 Description 4.2 Example 5 Proofs Toggle Proofs subsection 5.1 Euler's proof by infinite descent 5.2 Lagrange's proof through quadratic forms 5.3 Dedekind's two proofs using Gaussian integers 5.4 Proof by Minkowski's Theorem 5.5 Zagier's "one-sentence proof" 5.6 Proof with partition theory 6 See also 7 References 8 Notes 9 External links Toggle the table of contents Fermat's theorem on sums of two squares 20 languages العربية Беларуская Català Deutsch Español Français Galego 한국어 Italiano עברית Magyar Nederlands 日本語 Polski Русский தமிழ் Türkçe Українська Tiếng Việt 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Condition under which an odd prime is a sum of two squares For other theorems named after Pierre de Fermat, see Fermat's theorem .

In additive number theory , Fermat 's theorem on sums of two squares states that an odd prime p can be expressed as: p = x 2 + y 2 , {\displaystyle p=x^{2}+y^{2},} with x and y integers, if and only if p ≡ ≡ 1 ( mod 4 ) .

{\displaystyle p\equiv 1{\pmod {4}}.} The prime numbers for which this is true are called Pythagorean primes .
For example, the primes 5, 13, 17, 29, 37 and 41 are all congruent to 1 modulo 4, and they can be expressed as sums of two squares in the following ways: 5 = 1 2 + 2 2 , 13 = 2 2 + 3 2 , 17 = 1 2 + 4 2 , 29 = 2 2 + 5 2 , 37 = 1 2 + 6 2 , 41 = 4 2 + 5 2 .

{\displaystyle 5=1^{2}+2^{2},\quad 13=2^{2}+3^{2},\quad 17=1^{2}+4^{2},\quad 29=2^{2}+5^{2},\quad 37=1^{2}+6^{2},\quad 41=4^{2}+5^{2}.} On the other hand, the primes 3, 7, 11, 19, 23 and 31 are all congruent to 3 modulo 4, and none of them can be expressed as the sum of two squares. This is the easier part of the theorem, and follows immediately from the observation that all squares are congruent to 0 (if number squared is even) or 1 (if number squared is odd) modulo 4.

Since the Diophantus identity implies that the product of two integers each of which can be written as the sum of two squares is itself expressible as the sum of two squares, by applying Fermat's theorem to the prime factorization of any positive integer n , we see that if all  the prime factors of n congruent to 3 modulo 4 occur to an even exponent, then n is expressible as a sum of two squares. The converse also holds.

[ 1 ] This generalization of Fermat's theorem is known as the sum of two squares theorem .

History [ edit ] Albert Girard was the first to make the observation, characterizing the positive integers (not necessarily primes) that are expressible as the sum of two squares of positive integers; this was published in 1625.

[ 2 ] [ 3 ] The statement that every prime p of the form 4 n + 1 {\displaystyle 4n+1} is the sum of two squares is sometimes called Girard's theorem .

[ 4 ] For his part, Fermat wrote an elaborate version of the statement (in which he also gave the number of possible expressions of the powers of p as a sum of two squares)  in a letter to Marin Mersenne dated December 25, 1640: for this reason this version of the theorem is sometimes called Fermat's Christmas theorem.

Gaussian primes [ edit ] Fermat's theorem on sums of two squares is strongly related with the theory of Gaussian primes .

A Gaussian integer is a complex number a + i b {\displaystyle a+ib} such that a and b are integers. The norm N ( a + i b ) = a 2 + b 2 {\displaystyle N(a+ib)=a^{2}+b^{2}} of a Gaussian integer is an integer equal to the square of the absolute value of the Gaussian integer. The norm of a product of Gaussian integers is the product of their norms. This is the Diophantus identity , which results immediately from the similar property of the absolute value.

Gaussian integers form a principal ideal domain . This implies that Gaussian primes can be defined similarly as primes numbers, that is as those Gaussian integers that are not the product of two non-units (here the units are 1, −1, i and − i ).

The multiplicative property of the norm implies that a prime number p is either a Gaussian prime or the norm of a Gaussian prime. Fermat's theorem asserts that the first case occurs when p = 4 k + 3 , {\displaystyle p=4k+3,} and that the second case occurs when p = 4 k + 1 {\displaystyle p=4k+1} and p = 2.

{\displaystyle p=2.} The last case is not considered in Fermat's statement, but is trivial, as 2 = 1 2 + 1 2 = N ( 1 + i ) .

{\displaystyle 2=1^{2}+1^{2}=N(1+i).} Related results [ edit ] The above point of view on Fermat's theorem is a special case of the theory of factorization of ideals in rings of quadratic integers . In summary, if O d {\displaystyle {\mathcal {O}}_{\sqrt {d}}} is the ring of algebraic integers in the quadratic field , then an odd prime number p , not dividing d , is either a prime element in O d , {\displaystyle {\mathcal {O}}_{\sqrt {d}},} or the ideal norm of an ideal of O d , {\displaystyle {\mathcal {O}}_{\sqrt {d}},} which is necessarily prime. Moreover, the law of quadratic reciprocity allows distinguishing the two cases in terms of congruences. If O d {\displaystyle {\mathcal {O}}_{\sqrt {d}}} is a principal ideal domain , then p is an ideal norm if and only 4 p = a 2 − − d b 2 , {\displaystyle 4p=a^{2}-db^{2},} with a and b both integers.

In a letter to Blaise Pascal dated September 25,  1654 Fermat announced the following two results that are essentially the special cases d = − − 2 {\displaystyle d=-2} and d = − − 3.

{\displaystyle d=-3.} If p is an odd prime, then p = x 2 + 2 y 2 ⟺ ⟺ p ≡ ≡ 1 or p ≡ ≡ 3 ( mod 8 ) , {\displaystyle p=x^{2}+2y^{2}\iff p\equiv 1{\mbox{ or }}p\equiv 3{\pmod {8}},} p = x 2 + 3 y 2 ⟺ ⟺ p ≡ ≡ 1 ( mod 3 ) .

{\displaystyle p=x^{2}+3y^{2}\iff p\equiv 1{\pmod {3}}.} Fermat wrote also: If two primes which end in 3 or 7 and surpass by 3 a multiple of 4 are multiplied, then their product will be composed of a square and the quintuple of another square.

In other words, if p, q are of the form 20 k + 3 or 20 k + 7 , then pq = x 2 + 5 y 2 . Euler later extended this to the conjecture that p = x 2 + 5 y 2 ⟺ ⟺ p ≡ ≡ 1 or p ≡ ≡ 9 ( mod 20 ) , {\displaystyle p=x^{2}+5y^{2}\iff p\equiv 1{\mbox{ or }}p\equiv 9{\pmod {20}},} 2 p = x 2 + 5 y 2 ⟺ ⟺ p ≡ ≡ 3 or p ≡ ≡ 7 ( mod 20 ) .

{\displaystyle 2p=x^{2}+5y^{2}\iff p\equiv 3{\mbox{ or }}p\equiv 7{\pmod {20}}.} Both Fermat's assertion and Euler's conjecture were established by Joseph-Louis Lagrange . This more complicated formulation relies on the fact that O − − 5 {\displaystyle {\mathcal {O}}_{\sqrt {-5}}} is not a principal ideal domain, unlike O − − 2 {\displaystyle {\mathcal {O}}_{\sqrt {-2}}} and O − − 3 .

{\displaystyle {\mathcal {O}}_{\sqrt {-3}}.} Algorithm [ edit ] In 1990, Stan Wagon described a Las Vegas algorithm with a probabilistically polynomial complexity based on work by Serret and Hermite (1848), and Cornacchia (1908).

[ 5 ] The probabilistic part consists in finding a quadratic non-residue, which can be done with success probability ≈ ≈ 1 2 {\displaystyle \approx {\frac {1}{2}}} and then iterated if not successful. Conditionally this can also be done in deterministic polynomial time if the generalized Riemann hypothesis holds as explained for the Tonelli–Shanks algorithm .

Description [ edit ] Given an odd prime p {\displaystyle p} in the form 4 k + 1 {\displaystyle 4k+1} , first find x ∈ ∈ { 1 , … … , p − − 1 2 } {\displaystyle x\in \{1,\dots ,{\frac {p-1}{2}}\}} such that x 2 ≡ ≡ − − 1 ( mod p ) {\displaystyle x^{2}\equiv -1{\pmod {p}}} .
This can be done by finding a quadratic non-residue modulo p {\displaystyle p} , say q {\displaystyle q} , and letting x = q p − − 1 4 ( mod p ) {\displaystyle x=q^{\frac {p-1}{4}}{\pmod {p}}} .

Such an x {\displaystyle x} will satisfy the condition since quadratic non-residues satisfy q p − − 1 2 ≡ ≡ − − 1 ( mod p ) {\displaystyle q^{\frac {p-1}{2}}\equiv -1{\pmod {p}}} .

Once x {\displaystyle x} is determined, one can apply the Euclidean algorithm with p {\displaystyle p} and x {\displaystyle x} . Denote the first two remainders that are less than the square root of p {\displaystyle p} as a {\displaystyle a} and b {\displaystyle b} . Then it will be the case that a 2 + b 2 = p {\displaystyle a^{2}+b^{2}=p} .

[ 6 ] Proof of the algorithm In the Euclidean algorithm, we have a sequence of remainders r 0 , r 1 , r 2 , … … , r n {\displaystyle r_{0},r_{1},r_{2},\dots ,r_{n}} that end with the
greatest common divisor r n = gcd ( r 0 , r 1 ) {\displaystyle r_{n}=\gcd(r_{0},r_{1})} .

We compute these recursively with initial values r 0 = p , r 1 = x {\displaystyle r_{0}=p,r_{1}=x} : r i − − 1 = q i r i + r i + 1 where q i = ⌊ ⌊ r i − − 1 / r i ⌋ ⌋ .

{\displaystyle r_{i-1}=q_{i}r_{i}+r_{i+1}\quad {\text{ where }}q_{i}=\lfloor r_{i-1}/r_{i}\rfloor .} We can define another sequence ( t i ) {\displaystyle (t_{i})} by the same recurrence, but with initial values t 0 = 0 {\displaystyle t_{0}=0} , t 1 = 1 {\displaystyle t_{1}=1} : t i − − 1 = q i t i + t i + 1 where q i = ⌊ ⌊ r i − − 1 / r i ⌋ ⌋ .

{\displaystyle t_{i-1}=q_{i}t_{i}+t_{i+1}\quad {\text{ where }}q_{i}=\lfloor r_{i-1}/r_{i}\rfloor .} It turns out that the ( t i ) {\displaystyle (t_{i})} sequence is just the reverse of the sequence ( r i ) {\displaystyle (r_{i})} , up to signs.

Moreover, one can see using the recurrence that t i x ≡ ≡ r i ( mod p ) {\displaystyle t_{i}x\equiv r_{i}{\pmod {p}}} for all i {\displaystyle i} .

Square this equation and use x 2 ≡ ≡ − − 1 ( mod p ) {\displaystyle x^{2}\equiv -1{\pmod {p}}} to get t i 2 + r i 2 ≡ ≡ 0 ( mod p ) {\displaystyle t_{i}^{2}+r_{i}^{2}\equiv 0{\pmod {p}}} .

From there we just need to find the t i {\displaystyle t_{i}} and r i {\displaystyle r_{i}} that are the right size so that t i 2 + r i 2 = p {\displaystyle t_{i}^{2}+r_{i}^{2}=p} .

Example [ edit ] Take p = 97 {\displaystyle p=97} . A possible quadratic non-residue for 97 is 13, since 13 97 − − 1 2 ≡ ≡ − − 1 ( mod 97 ) {\displaystyle 13^{\frac {97-1}{2}}\equiv -1{\pmod {97}}} . so we let x = 13 97 − − 1 4 = 22 ( mod 97 ) {\displaystyle x=13^{\frac {97-1}{4}}=22{\pmod {97}}} .
The Euclidean algorithm applied to 97 and 22 yields: 97 = 22 ( 4 ) + 9 , {\displaystyle 97=22(4)+9,} 22 = 9 ( 2 ) + 4 , {\displaystyle 22=9(2)+4,} 9 = 4 ( 2 ) + 1 , {\displaystyle 9=4(2)+1,} 4 = 1 ( 4 ) .

{\displaystyle 4=1(4).} The first two remainders smaller than the square root of 97 are 9 and 4; and indeed we have 97 = 9 2 + 4 2 {\displaystyle 97=9^{2}+4^{2}} , as expected.

Proofs [ edit ] Fermat usually did not write down proofs of his claims, and he did not provide a proof of this statement. The first proof was found by Euler after much effort and is based on infinite descent .  He announced it in two letters to Goldbach , on May 6, 1747 and on April 12, 1749; he published the detailed proof in two articles (between 1752 and 1755).

[ 7 ] [ 8 ] Lagrange gave a proof in 1775 that was based on his study of quadratic forms . This proof was simplified by Gauss in his Disquisitiones Arithmeticae (art. 182).

Dedekind gave at least two proofs based on the arithmetic of the Gaussian integers . There is an elegant proof using Minkowski's theorem about convex sets. Simplifying an earlier short proof due to Heath-Brown (who was inspired by Liouville 's idea), Zagier presented a non-constructive one-sentence proof in 1990.

[ 9 ] And more recently Christopher gave a partition-theoretic proof.

[ 10 ] Euler's proof by infinite descent [ edit ] Euler succeeded in proving Fermat's theorem on sums of two squares in 1749, when he was forty-two years old. He communicated this in a letter to Goldbach dated 12 April 1749.

[ 11 ] The proof relies on infinite descent , and is only briefly sketched in the letter. The full proof consists in five steps and is published in two papers. The first four steps are Propositions 1 to 4 of the first paper [ 12 ] and do not correspond exactly to the four steps below. The fifth step below is from the second paper.

[ 13 ] [ 14 ] For the avoidance of ambiguity, zero will always be a valid possible constituent of "sums of two squares", so for example every square of an integer is trivially expressible as the sum of two squares by setting one of them to be zero.

1.

The product of two numbers, each of which is a sum of two squares, is itself a sum of two squares.

This is a well-known property, based on the identity ( a 2 + b 2 ) ( p 2 + q 2 ) = ( a p + b q ) 2 + ( a q − − b p ) 2 {\displaystyle (a^{2}+b^{2})(p^{2}+q^{2})=(ap+bq)^{2}+(aq-bp)^{2}} due to Diophantus .

2.

If a number which is a sum of two squares is divisible by a prime which is a sum of two squares, then the quotient is a sum of two squares.

(This is Euler's first Proposition).

Indeed, suppose for example that a 2 + b 2 {\displaystyle a^{2}+b^{2}} is divisible by p 2 + q 2 {\displaystyle p^{2}+q^{2}} and that this latter is a prime. Then p 2 + q 2 {\displaystyle p^{2}+q^{2}} divides ( p b − − a q ) ( p b + a q ) = p 2 b 2 − − a 2 q 2 = p 2 ( a 2 + b 2 ) − − a 2 ( p 2 + q 2 ) .

{\displaystyle (pb-aq)(pb+aq)=p^{2}b^{2}-a^{2}q^{2}=p^{2}(a^{2}+b^{2})-a^{2}(p^{2}+q^{2}).} Since p 2 + q 2 {\displaystyle p^{2}+q^{2}} is a prime, it divides one of the two factors. Suppose that it divides p b − − a q {\displaystyle pb-aq} . Since ( a 2 + b 2 ) ( p 2 + q 2 ) = ( a p + b q ) 2 + ( a q − − b p ) 2 {\displaystyle (a^{2}+b^{2})(p^{2}+q^{2})=(ap+bq)^{2}+(aq-bp)^{2}} (Diophantus's identity) it follows that p 2 + q 2 {\displaystyle p^{2}+q^{2}} must divide ( a p + b q ) 2 {\displaystyle (ap+bq)^{2}} . So the equation can be divided by the square of p 2 + q 2 {\displaystyle p^{2}+q^{2}} . Dividing the expression by ( p 2 + q 2 ) 2 {\displaystyle (p^{2}+q^{2})^{2}} yields: a 2 + b 2 p 2 + q 2 = ( a p + b q p 2 + q 2 ) 2 + ( a q − − b p p 2 + q 2 ) 2 {\displaystyle {\frac {a^{2}+b^{2}}{p^{2}+q^{2}}}=\left({\frac {ap+bq}{p^{2}+q^{2}}}\right)^{2}+\left({\frac {aq-bp}{p^{2}+q^{2}}}\right)^{2}} and thus expresses the quotient as a sum of two squares, as claimed.

On the other hand if p 2 + q 2 {\displaystyle p^{2}+q^{2}} divides p b + a q {\displaystyle pb+aq} , a similar argument holds by using the following variant of Diophantus's identity: ( a 2 + b 2 ) ( q 2 + p 2 ) = ( a q + b p ) 2 + ( a p − − b q ) 2 .

{\displaystyle (a^{2}+b^{2})(q^{2}+p^{2})=(aq+bp)^{2}+(ap-bq)^{2}.} 3.

If a number which can be written as a sum of two squares is divisible by a number which is not a sum of two squares, then the quotient has a factor which is not a sum of two squares.

(This is Euler's second Proposition).

Suppose q {\displaystyle q} is a number not expressible as a sum of two squares, which divides a 2 + b 2 {\displaystyle a^{2}+b^{2}} . Write the quotient, factored into its (possibly repeated) prime factors, as p 1 p 2 ⋯ ⋯ p n {\displaystyle p_{1}p_{2}\cdots p_{n}} so that a 2 + b 2 = q p 1 p 2 ⋯ ⋯ p n {\displaystyle a^{2}+b^{2}=qp_{1}p_{2}\cdots p_{n}} . If all factors p i {\displaystyle p_{i}} can be written as sums of two squares, then we can divide a 2 + b 2 {\displaystyle a^{2}+b^{2}} successively by p 1 {\displaystyle p_{1}} , p 2 {\displaystyle p_{2}} , etc., and applying step (2.) above we deduce that each successive, smaller, quotient is a sum of two squares. If we get all the way down to q {\displaystyle q} then q {\displaystyle q} itself would have to be equal to the sum of two squares, which is a contradiction. So at least one of the primes p i {\displaystyle p_{i}} is not the sum of two squares.

4.

If a {\displaystyle a} and b {\displaystyle b} are relatively prime positive integers then every factor of a 2 + b 2 {\displaystyle a^{2}+b^{2}} is a sum of two squares.

(This is the step that uses step (3.) to produce an 'infinite descent' and was Euler's Proposition 4. The proof sketched below also includes the proof of his Proposition 3).

Let a , b {\displaystyle a,b} be relatively prime positive integers: without loss of generality a 2 + b 2 {\displaystyle a^{2}+b^{2}} is not itself prime, otherwise there is nothing to prove. Let q {\displaystyle q} therefore be a proper factor of a 2 + b 2 {\displaystyle a^{2}+b^{2}} , not necessarily prime: we wish to show that q {\displaystyle q} is a sum of two squares. Again, we lose nothing by assuming q > 2 {\displaystyle q>2} since the case q = 2 = 1 2 + 1 2 {\displaystyle q=2=1^{2}+1^{2}} is obvious.

Let m , n {\displaystyle m,n} be non-negative integers such that m q , n q {\displaystyle mq,nq} are the closest multiples of q {\displaystyle q} (in absolute value) to a , b {\displaystyle a,b} respectively. Notice that the differences c = a − − m q {\displaystyle c=a-mq} and d = b − − n q {\displaystyle d=b-nq} are integers of absolute value strictly less than q / 2 {\displaystyle q/2} : indeed, when q > 2 {\displaystyle q>2} is even, gcd ( a , q / 2 ) = 1 {\displaystyle (a,q/2)=1} ; otherwise since gcd ( a , q / 2 ) ∣ ∣ q / 2 ∣ ∣ q ∣ ∣ a 2 + b 2 {\displaystyle (a,q/2)\mid q/2\mid q\mid a^{2}+b^{2}} , we would also have gcd ( a , q / 2 ) ∣ ∣ b {\displaystyle (a,q/2)\mid b} .

Multiplying out we obtain a 2 + b 2 = m 2 q 2 + 2 m q c + c 2 + n 2 q 2 + 2 n q d + d 2 = A q + ( c 2 + d 2 ) {\displaystyle a^{2}+b^{2}=m^{2}q^{2}+2mqc+c^{2}+n^{2}q^{2}+2nqd+d^{2}=Aq+(c^{2}+d^{2})} uniquely defining a non-negative integer A {\displaystyle A} . Since q {\displaystyle q} divides both ends of this equation sequence it follows that c 2 + d 2 {\displaystyle c^{2}+d^{2}} must also be divisible by q {\displaystyle q} : say c 2 + d 2 = q r {\displaystyle c^{2}+d^{2}=qr} . Let g {\displaystyle g} be the gcd of c {\displaystyle c} and d {\displaystyle d} which by the co-primeness of a , b {\displaystyle a,b} is relatively prime to q {\displaystyle q} . Thus g 2 {\displaystyle g^{2}} divides r {\displaystyle r} , so writing e = c / g {\displaystyle e=c/g} , f = d / g {\displaystyle f=d/g} and s = r / g 2 {\displaystyle s=r/g^{2}} , we obtain the expression e 2 + f 2 = q s {\displaystyle e^{2}+f^{2}=qs} for relatively prime e {\displaystyle e} and f {\displaystyle f} , and with s < q / 2 {\displaystyle s<q/2} , since q s = e 2 + f 2 ≤ ≤ c 2 + d 2 < ( q 2 ) 2 + ( q 2 ) 2 = q 2 / 2.

{\displaystyle qs=e^{2}+f^{2}\leq c^{2}+d^{2}<\left({\frac {q}{2}}\right)^{2}+\left({\frac {q}{2}}\right)^{2}=q^{2}/2.} Now finally, the descent step: if q {\displaystyle q} is not the sum of two squares, then by step (3.) there must be a factor q 1 {\displaystyle q_{1}} say of s {\displaystyle s} which is not the sum of two squares. But q 1 ≤ ≤ s < q / 2 < q {\displaystyle q_{1}\leq s<q/2<q} and so repeating these steps (initially with e , f ; q 1 {\displaystyle e,f;q_{1}} in place of a , b ; q {\displaystyle a,b;q} , and so on ad infinitum ) we shall be able to find a strictly decreasing infinite sequence q , q 1 , q 2 , … … {\displaystyle q,q_{1},q_{2},\ldots } of positive integers which are not themselves the sums of two squares but which divide into a sum of two relatively prime squares. Since such an infinite descent is impossible, we conclude that q {\displaystyle q} must be expressible as a sum of two squares, as claimed.

5.

Every prime of the form 4 n + 1 {\displaystyle 4n+1} is a sum of two squares.

(This is the main result of Euler's second paper).

If p = 4 n + 1 {\displaystyle p=4n+1} , then by Fermat's Little Theorem each of the numbers 1 , 2 4 n , 3 4 n , … … , ( 4 n ) 4 n {\displaystyle 1,2^{4n},3^{4n},\dots ,(4n)^{4n}} is congruent to one modulo p {\displaystyle p} . The differences 2 4 n − − 1 , 3 4 n − − 2 4 n , … … , ( 4 n ) 4 n − − ( 4 n − − 1 ) 4 n {\displaystyle 2^{4n}-1,3^{4n}-2^{4n},\dots ,(4n)^{4n}-(4n-1)^{4n}} are therefore all divisible by p {\displaystyle p} . Each of these differences can be factored as a 4 n − − b 4 n = ( a 2 n + b 2 n ) ( a 2 n − − b 2 n ) .

{\displaystyle a^{4n}-b^{4n}=\left(a^{2n}+b^{2n}\right)\left(a^{2n}-b^{2n}\right).} Since p {\displaystyle p} is prime, it must divide one of the two factors. If in any of the 4 n − − 1 {\displaystyle 4n-1} cases it divides the first factor, then by the previous step we conclude that p {\displaystyle p} is itself a sum of two squares (since a {\displaystyle a} and b {\displaystyle b} differ by 1 {\displaystyle 1} , they are relatively prime). So it is enough to show that p {\displaystyle p} cannot always divide the second factor. If it divides all 4 n − − 1 {\displaystyle 4n-1} differences 2 2 n − − 1 , 3 2 n − − 2 2 n , … … , ( 4 n ) 2 n − − ( 4 n − − 1 ) 2 n {\displaystyle 2^{2n}-1,3^{2n}-2^{2n},\dots ,(4n)^{2n}-(4n-1)^{2n}} , then it would divide all 4 n − − 2 {\displaystyle 4n-2} differences of successive terms, all 4 n − − 3 {\displaystyle 4n-3} differences of the differences, and so forth. Since the k {\displaystyle k} th differences of the sequence 1 k , 2 k , 3 k , … … {\displaystyle 1^{k},2^{k},3^{k},\dots } are all equal to k !

{\displaystyle k!} ( Finite difference ), the 2 n {\displaystyle 2n} th differences would all be constant and equal to ( 2 n ) !

{\displaystyle (2n)!} , which is certainly not divisible by p {\displaystyle p} . Therefore, p {\displaystyle p} cannot divide all the second factors which proves that p {\displaystyle p} is indeed the sum of two squares.

Lagrange's proof through quadratic forms [ edit ] Lagrange completed a proof in 1775 [ 15 ] based on his general theory of integral quadratic forms . The following presentation incorporates a slight simplification of his argument, due to Gauss , which appears in article 182 of the Disquisitiones Arithmeticae .

An (integral binary) quadratic form is an expression of the form a x 2 + b x y + c y 2 {\displaystyle ax^{2}+bxy+cy^{2}} with a , b , c {\displaystyle a,b,c} integers. A number n {\displaystyle n} is said to be represented by the form if there exist integers x , y {\displaystyle x,y} such that n = a x 2 + b x y + c y 2 {\displaystyle n=ax^{2}+bxy+cy^{2}} . Fermat's theorem on sums of two squares is then equivalent to the statement that a prime p {\displaystyle p} is represented by the form x 2 + y 2 {\displaystyle x^{2}+y^{2}} (i.e., a = c = 1 {\displaystyle a=c=1} , b = 0 {\displaystyle b=0} ) exactly when p {\displaystyle p} is congruent to 1 {\displaystyle 1} modulo 4 {\displaystyle 4} .

The discriminant of the quadratic form is defined to be b 2 − − 4 a c {\displaystyle b^{2}-4ac} . The discriminant of x 2 + y 2 {\displaystyle x^{2}+y^{2}} is then equal to − − 4 {\displaystyle -4} .

Two forms a x 2 + b x y + c y 2 {\displaystyle ax^{2}+bxy+cy^{2}} and a ′ x ′ 2 + b ′ x ′ y ′ + c ′ y ′ 2 {\displaystyle a'x'^{2}+b'x'y'+c'y'^{2}} are equivalent if and only if there exist substitutions with integer coefficients x = α α x ′ + β β y ′ {\displaystyle x=\alpha x'+\beta y'} y = γ γ x ′ + δ δ y ′ {\displaystyle y=\gamma x'+\delta y'} with α α δ δ − − β β γ γ = ± ± 1 {\displaystyle \alpha \delta -\beta \gamma =\pm 1} such that, when substituted into the first form, yield the second. Equivalent forms are readily seen to have the same discriminant, and hence also the same parity for the middle coefficient b {\displaystyle b} , which coincides with the parity of the discriminant. Moreover, it is clear that equivalent forms will represent exactly the same integers, because these kind of substitutions can be reversed by substitutions of the same kind.

Lagrange proved that all positive definite forms of discriminant −4 are equivalent. Thus, to prove Fermat's theorem it is enough to find any positive definite form of discriminant −4 that represents p {\displaystyle p} . For example, one can use a form p x 2 + 2 m x y + ( m 2 + 1 p ) y 2 , {\displaystyle px^{2}+2mxy+\left({\frac {m^{2}+1}{p}}\right)y^{2},} where the first coefficient a = p {\displaystyle p} was chosen so that the form represents p {\displaystyle p} by setting x = 1, and y = 0, the coefficient b = 2 m is an arbitrary even number (as it must be, to get an even discriminant), and finally c = m 2 + 1 p {\displaystyle c={\frac {m^{2}+1}{p}}} is chosen so that the discriminant b 2 − − 4 a c = 4 m 2 − − 4 p c {\displaystyle b^{2}-4ac=4m^{2}-4pc} is equal to −4, which guarantees that the form is indeed equivalent to x 2 + y 2 {\displaystyle x^{2}+y^{2}} . Of course, the coefficient c = m 2 + 1 p {\displaystyle c={\frac {m^{2}+1}{p}}} must be an integer, so the problem is reduced to finding some integer m such that p {\displaystyle p} divides m 2 + 1 {\displaystyle m^{2}+1} : or in other words, a 'square root of -1 modulo p {\displaystyle p} ' .

We claim such a square root of − − 1 {\displaystyle -1} is given by K = ∏ ∏ k = 1 p − − 1 2 k {\displaystyle K=\prod _{k=1}^{\frac {p-1}{2}}k} . Firstly it follows from Euclid's Fundamental Theorem of Arithmetic that a b ≡ ≡ 0 ( mod p ) ⟺ ⟺ a ≡ ≡ 0 ( mod p ) or b ≡ ≡ 0 ( mod p ) {\displaystyle ab\equiv 0{\pmod {p}}\iff a\equiv 0{\pmod {p}}\ \ {\hbox{or}}\ \ b\equiv 0{\pmod {p}}} . Consequently, a 2 ≡ ≡ 1 ( mod p ) ⟺ ⟺ a ≡ ≡ ± ± 1 ( mod p ) {\displaystyle a^{2}\equiv 1{\pmod {p}}\iff a\equiv \pm 1{\pmod {p}}} : that is, ± ± 1 {\displaystyle \pm 1} are their own inverses modulo p {\displaystyle p} and this property is unique to them. It then follows from the validity of Euclidean division in the integers, and the fact that p {\displaystyle p} is prime, that for every 2 ≤ ≤ a ≤ ≤ p − − 2 {\displaystyle 2\leq a\leq p-2} the gcd of a {\displaystyle a} and p {\displaystyle p} may be expressed via the Euclidean algorithm yielding a unique and distinct inverse a − − 1 ≠ ≠ a {\displaystyle a^{-1}\neq a} of a {\displaystyle a} modulo p {\displaystyle p} . In particular therefore the product of all non-zero residues modulo p {\displaystyle p} is − − 1 {\displaystyle -1} . Let L = ∏ ∏ l = p + 1 2 p − − 1 l {\displaystyle L=\prod _{l={\frac {p+1}{2}}}^{p-1}l} : from what has just been observed, K L ≡ ≡ − − 1 ( mod p ) {\displaystyle KL\equiv -1{\pmod {p}}} . But by definition, since each term in K {\displaystyle K} may be paired with its negative in L {\displaystyle L} , L = ( − − 1 ) p − − 1 2 K {\displaystyle L=(-1)^{\frac {p-1}{2}}K} , which since p {\displaystyle p} is odd shows that K 2 ≡ ≡ − − 1 ( mod p ) ⟺ ⟺ p ≡ ≡ 1 ( mod 4 ) {\displaystyle K^{2}\equiv -1{\pmod {p}}\iff p\equiv 1{\pmod {4}}} , as required.

Dedekind's two proofs using Gaussian integers [ edit ] Richard Dedekind gave at least two proofs of Fermat's theorem on sums of two squares, both using the arithmetical properties of the Gaussian integers , which are numbers of the form a + bi , where a and b are integers, and i is the square root of −1. One appears in section 27 of his exposition of ideals published in 1877; the second appeared in Supplement XI to Peter Gustav Lejeune Dirichlet 's Vorlesungen über Zahlentheorie , and was published in 1894.

1. First proof.

If p is an odd prime number , then we have i p − − 1 = ( − − 1 ) p − − 1 2 {\displaystyle i^{p-1}=(-1)^{\frac {p-1}{2}}} in the Gaussian integers. Consequently, writing a Gaussian integer ω = x + iy with x,y ∈ Z and applying the Frobenius automorphism in Z [ i ]/( p ), one finds ω ω p = ( x + y i ) p ≡ ≡ x p + y p i p ≡ ≡ x + ( − − 1 ) p − − 1 2 y i ( mod p ) , {\displaystyle \omega ^{p}=(x+yi)^{p}\equiv x^{p}+y^{p}i^{p}\equiv x+(-1)^{\frac {p-1}{2}}yi{\pmod {p}},} since the automorphism fixes the elements of Z /( p ). In the current case, p = 4 n + 1 {\displaystyle p=4n+1} for some integer n, and so in the above expression for ω p , the exponent ⁠ ( p − − 1 ) / 2 {\displaystyle (p-1)/2} ⁠ of −1 is even. Hence the right hand side equals ω, so in this case the Frobenius endomorphism of Z [ i ]/( p ) is the identity.

Kummer had already established that if f ∈ {1,2} is the order of the Frobenius automorphism of Z [ i ]/( p ), then the ideal ( p ) {\displaystyle (p)} in Z [ i ] would be a product of 2/ f distinct prime ideals . (In fact, Kummer had established a much more general result for any extension of Z obtained by adjoining a primitive m -th root of unity , where m was any positive integer; this is the case m = 4 of that result.) Therefore, the ideal ( p ) is the product of two different prime ideals in Z [ i ]. Since the Gaussian integers are a Euclidean domain for the norm function N ( x + i y ) = x 2 + y 2 {\displaystyle N(x+iy)=x^{2}+y^{2}} , every ideal is principal and generated by a nonzero element of the ideal of minimal norm. Since the norm is multiplicative, the norm of a generator α α {\displaystyle \alpha } of one of the ideal factors of ( p ) must be a strict divisor of N ( p ) = p 2 {\displaystyle N(p)=p^{2}} , so that we must have p = N ( α α ) = N ( a + b i ) = a 2 + b 2 {\displaystyle p=N(\alpha )=N(a+bi)=a^{2}+b^{2}} , which gives Fermat's theorem.

2. Second proof.

This proof builds on Lagrange's result that if p = 4 n + 1 {\displaystyle p=4n+1} is a prime number, then there must be an integer m such that m 2 + 1 {\displaystyle m^{2}+1} is divisible by p (we can also see this by Euler's criterion ); it also uses the fact that the Gaussian integers are a unique factorization domain (because they are a Euclidean domain). Since p ∈ Z does not divide either of the Gaussian integers m + i {\displaystyle m+i} and m − − i {\displaystyle m-i} (as it does not divide their imaginary parts ), but it does divide their product m 2 + 1 {\displaystyle m^{2}+1} , it follows that p cannot be a prime element in the Gaussian integers. We must therefore have a nontrivial factorization of p in the Gaussian integers, which in view of the norm can have only two factors (since the norm is multiplicative, and p 2 = N ( p ) {\displaystyle p^{2}=N(p)} , there can only be up to two factors of p), so it must be of the form p = ( x + y i ) ( x − − y i ) {\displaystyle p=(x+yi)(x-yi)} for some integers x and y . This immediately yields that p = x 2 + y 2 {\displaystyle p=x^{2}+y^{2}} .

Proof by Minkowski's Theorem [ edit ] For p {\displaystyle p} congruent to 1 {\displaystyle 1} mod 4 {\displaystyle 4} a prime, − − 1 {\displaystyle -1} is a quadratic residue mod p {\displaystyle p} by Euler's criterion . Therefore, there exists an integer m {\displaystyle m} such that p {\displaystyle p} divides m 2 + 1 {\displaystyle m^{2}+1} . Let i ^ ^ , j ^ ^ {\displaystyle {\hat {i}},{\hat {j}}} be the standard basis elements for the vector space R 2 {\displaystyle \mathbb {R} ^{2}} and set u → → = i ^ ^ + m j ^ ^ {\displaystyle {\vec {u}}={\hat {i}}+m{\hat {j}}} and v → → = 0 i ^ ^ + p j ^ ^ {\displaystyle {\vec {v}}=0{\hat {i}}+p{\hat {j}}} . Consider the lattice S = { a u → → + b v → → ∣ ∣ a , b ∈ ∈ Z } {\displaystyle S=\{a{\vec {u}}+b{\vec {v}}\mid a,b\in \mathbb {Z} \}} . If w → → = a u → → + b v → → = a i ^ ^ + ( a m + b p ) j ^ ^ ∈ ∈ S {\displaystyle {\vec {w}}=a{\vec {u}}+b{\vec {v}}=a{\hat {i}}+(am+bp){\hat {j}}\in S} then ‖ ‖ w → → ‖ ‖ 2 ≡ ≡ a 2 + ( a m + b p ) 2 ≡ ≡ a 2 ( 1 + m 2 ) ≡ ≡ 0 ( mod p ) {\displaystyle \|{\vec {w}}\|^{2}\equiv a^{2}+(am+bp)^{2}\equiv a^{2}(1+m^{2})\equiv 0{\pmod {p}}} . Thus p {\displaystyle p} divides ‖ ‖ w → → ‖ ‖ 2 {\displaystyle \|{\vec {w}}\|^{2}} for any w → → ∈ ∈ S {\displaystyle {\vec {w}}\in S} .

The area of the fundamental parallelogram of the lattice is p {\displaystyle p} . The area of the open disk, D {\displaystyle D} , of radius 2 p {\displaystyle {\sqrt {2p}}} centered around the origin is 2 π π p > 4 p {\displaystyle 2\pi p>4p} . Furthermore, D {\displaystyle D} is convex and symmetrical about the origin. Therefore, by Minkowski's theorem there exists a nonzero vector w → → ∈ ∈ S {\displaystyle {\vec {w}}\in S} such that w → → ∈ ∈ D {\displaystyle {\vec {w}}\in D} . Both ‖ ‖ w → → ‖ ‖ 2 < 2 p {\displaystyle \|{\vec {w}}\|^{2}<2p} and p ∣ ∣ ‖ ‖ w → → ‖ ‖ 2 {\displaystyle p\mid \|{\vec {w}}\|^{2}} so p = ‖ ‖ w → → ‖ ‖ 2 {\displaystyle p=\|{\vec {w}}\|^{2}} . Hence p {\displaystyle p} is the sum of the squares of the components of w → → {\displaystyle {\vec {w}}} .

Zagier's "one-sentence proof" [ edit ] Let p = 4 k + 1 {\displaystyle p=4k+1} be prime, let N {\displaystyle \mathbb {N} } denote the natural numbers (with or without zero), and consider the finite set S = { ( x , y , z ) ∈ ∈ N 3 : x 2 + 4 y z = p } {\displaystyle S=\{(x,y,z)\in \mathbb {N} ^{3}:x^{2}+4yz=p\}} of triples of numbers.
Then S {\displaystyle S} has two involutions : an obvious one ( x , y , z ) ↦ ↦ ( x , z , y ) {\displaystyle (x,y,z)\mapsto (x,z,y)} whose fixed points ( x , y , y ) {\displaystyle (x,y,y)} correspond to representations of p {\displaystyle p} as a sum of two squares, and a more complicated one, ( x , y , z ) ↦ ↦ { ( x + 2 z , z , y − − x − − z ) , if x < y − − z ( 2 y − − x , y , x − − y + z ) , if y − − z < x < 2 y ( x − − 2 y , x − − y + z , y ) , if x > 2 y {\displaystyle (x,y,z)\mapsto {\begin{cases}(x+2z,~z,~y-x-z),\quad {\textrm {if}}\,\,\,x<y-z\\(2y-x,~y,~x-y+z),\quad {\textrm {if}}\,\,\,y-z<x<2y\\(x-2y,~x-y+z,~y),\quad {\textrm {if}}\,\,\,x>2y\end{cases}}} which has exactly one fixed point ( 1 , 1 , k ) {\displaystyle (1,1,k)} . This proves that the cardinality of S {\displaystyle S} is odd. Hence, S {\displaystyle S} has also a fixed point with respect to the obvious involution.

This proof, due to Zagier , [ 9 ] is a simplification of an earlier proof by Heath-Brown , which in turn was inspired by a proof of Liouville . The technique of the proof is a combinatorial analogue of the topological principle that the Euler characteristics of a topological space with an involution and of its fixed-point set have the same parity and is reminiscent of the use of sign-reversing involutions in the proofs of combinatorial bijections.

This proof is equivalent to a geometric or "visual" proof using "windmill" figures, given by Alexander Spivak in 2006 and described in this MathOverflow post by Moritz Firsching and this YouTube video by Mathologer .

Proof with partition theory [ edit ] In 2016, A. David Christopher gave a partition-theoretic proof by considering partitions of the odd prime n {\displaystyle n} having exactly two sizes a i ( i = 1 , 2 ) {\displaystyle a_{i}(i=1,2)} , each occurring exactly a i {\displaystyle a_{i}} times, and by showing that at least one such partition exists if n {\displaystyle n} is congruent to 1 modulo 4.

[ 16 ] See also [ edit ] Legendre's three-square theorem Lagrange's four-square theorem Landau–Ramanujan constant Thue's lemma Friedlander–Iwaniec theorem References [ edit ] D. A. Cox (1989).

Primes of the Form x 2 + ny 2 . Wiley-Interscience.

ISBN 0-471-50654-0 .

*Richard Dedekind, The theory of algebraic integers .

L. E. Dickson .

History of the Theory of Numbers Vol. 2. Chelsea Publishing Co., New York 1920 Harold M. Edwards , Fermat's Last Theorem. A genetic introduction to algebraic number theory . Graduate Texts in Mathematics no. 50, Springer-Verlag, NY, 1977.

C. F. Gauss, Disquisitiones Arithmeticae (English Edition). Transl. by Arthur A. Clarke. Springer-Verlag, 1986.

Goldman, Jay R. (1998), The Queen of Mathematics: A historically motivated guide to Number Theory , A K Peters , ISBN 1-56881-006-7 D. R. Heath-Brown, Fermat's two squares theorem . Invariant, 11 (1984) pp. 3–5.

John Stillwell , Introduction to Theory of Algebraic Integers by Richard Dedekind. Cambridge Mathematical Library, Cambridge University Press, 1996.

ISBN 0-521-56518-9 Don Zagier , A one-sentence proof that every prime p ≡ 1 mod 4 is a sum of two squares . Amer. Math. Monthly 97 (1990), no. 2, 144, doi : 10.2307/2323918 Notes [ edit ] ^ For a proof of the converse see for instance 20.1, Theorems 367 and 368, in: G.H. Hardy and E.M. Wright. An introduction to the theory of numbers, Oxford 1938.

^ Simon Stevin .

l'Arithmétique de Simon Stevin de Bruges , annotated by Albert Girard, Leyde 1625, p. 622 .

^ L. E. Dickson, History of the Theory of Numbers, Vol. II,  Ch. VI, p. 227. "A. Girard ... had already made a determination of the numbers expressible as a sum of two integral squares: every square, every prime 4n+1, a product formed of such numbers, and the double of the foregoing" ^ L. E. Dickson, History of the Theory of Numbers, Vol. II,  Ch. VI, p. 228.

^ Wagon, Stan (1990), "Editor's Corner: The Euclidean Algorithm Strikes Again", American Mathematical Monthly , 97 (2): 125– 129, doi : 10.2307/2323912 , JSTOR 2323912 , MR 1041889 .

^ Wagon, Stan (1990).

"Editor's Corner: The Euclidean Algorithm Strikes Again" .

The American Mathematical Monthly .

97 (2): 125– 29.

doi : 10.2307/2323912 .

JSTOR 2323912 . Retrieved 2024-11-20 .

^ De numeris qui sunt aggregata duorum quadratorum. (Novi commentarii academiae scientiarum Petropolitanae 4 (1752/3), 1758, 3-40) ^ Demonstratio theorematis FERMATIANI omnem numerum primum formae 4n+1 esse summam duorum quadratorum. (Novi commentarii academiae scientiarum Petropolitanae 5 (1754/5), 1760, 3-13) ^ a b Zagier, D.

(1990), "A one-sentence proof that every prime p ≡ 1 (mod 4) is a sum of two squares", American Mathematical Monthly , 97 (2): 144, doi : 10.2307/2323918 , JSTOR 2323918 , MR 1041893 .

^ A. David Christopher. "A partition-theoretic proof of Fermat's Two Squares Theorem", Discrete Mathematics 339 :4:1410–1411 (6 April 2016) doi : 10.1016/j.disc.2015.12.002 ^ Euler à Goldbach, lettre CXXV ^ De numeris qui sunt aggregata duorum quadratorum. (Novi commentarii academiae scientiarum Petropolitanae 4 (1752/3), 1758, 3-40) [1] ^ Demonstratio theorematis FERMATIANI omnem numerum primum formae 4n+1 esse summam duorum quadratorum. (Novi commentarii academiae scientiarum Petropolitanae 5 (1754/5), 1760, 3-13) [2] ^ The summary is based on Edwards book, pages 45-48.

^ Nouv. Mém. Acad. Berlin, année 1771, 125; ibid. année 1773, 275; ibid année 1775, 351.

^ A. David Christopher, A partition-theoretic proof of Fermat's Two Squares Theorem", Discrete Mathematics, 339 (2016) 1410–1411.

External links [ edit ] Two more proofs at PlanetMath.org "A one-sentence proof of the theorem" . Archived from the original on 5 February 2012.

Fermat's two squares theorem , D. R. Heath-Brown, 1984.

Polster, Burkard (2019) "Fermat's Christmas theorem: Visualising the hidden circle in π/4 = 1 − 1/3 + 1/5 − 1/7 + ..." (Video).

Mathologer .

v t e Pierre de Fermat Work Fermat's Last Theorem Fermat number Fermat's principle Fermat's little theorem Fermat polygonal number theorem Fermat pseudoprime Fermat point Fermat's theorem (stationary points) Fermat's theorem on sums of two squares Fermat's spiral Fermat's right triangle theorem Related List of things named after Pierre de Fermat Wiles's proof of Fermat's Last Theorem Fermat's Last Theorem in fiction Fermat Prize Fermat's Last Tango (2000 musical) Fermat's Last Theorem (popular science book) Retrieved from " https://en.wikipedia.org/w/index.php?title=Fermat%27s_theorem_on_sums_of_two_squares&oldid=1303183213 " Categories : Additive number theory Squares in number theory Theorems in number theory Hidden categories: Articles with short description Short description is different from Wikidata CS1: unfit URL This page was last edited on 29 July 2025, at 14:24 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Fermat's theorem on sums of two squares 20 languages Add topic

