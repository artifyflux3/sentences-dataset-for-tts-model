Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Definitions Toggle Definitions subsection 1.1 Relation to unexplained variance 1.2 As explained variance 1.3 As squared correlation coefficient 2 Interpretation Toggle Interpretation subsection 2.1 In a multiple linear model 2.2 Inflation of R 2 2.3 Caveats 3 Extensions Toggle Extensions subsection 3.1 Adjusted R 2 3.2 Coefficient of partial determination 3.3 Generalizing and decomposing R 2 3.4 R 2 in logistic regression 4 Comparison with residual statistics 5 History 6 See also 7 Notes 8 Further reading Toggle the table of contents Coefficient of determination 19 languages العربية Català Čeština Deutsch Español Euskara فارسی Français 한국어 Italiano Nederlands 日本語 Norsk bokmål Polski Português Русский Українська 粵語 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikimedia Commons Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia (Redirected from R-squared ) Indicator for how well data points fit a line or curve Not to be confused with Coefficient of variation .

You can help expand this article with text translated from the corresponding article in German .

(September 2019) Click [show] for important translation instructions.

View a machine-translated version of the German article.

Machine translation, like DeepL or Google Translate , is a useful starting point for translations, but translators must revise errors as necessary and confirm that the translation is accurate, rather than simply copy-pasting machine-translated text into the English Wikipedia.

Consider adding a topic to this template: there are already 1,846 articles in the main category , and specifying |topic= will aid in categorization.

Do not translate text that appears unreliable or low-quality. If possible, verify the text with references provided in the foreign-language article.

You must provide copyright attribution in the edit summary accompanying your translation by providing an interlanguage link to the source of your translation. A model attribution edit summary is Content in this edit is translated from the existing German Wikipedia article at [[:de:Bestimmtheitsmaß]]; see its history for attribution.

You may also add the template {{Translated|de|Bestimmtheitsmaß}} to the talk page .

For more guidance, see Wikipedia:Translation .

Ordinary least squares regression of Okun's law . Since the regression line does not miss any of the points by very much, the R 2 of the regression is relatively high.

In statistics , the coefficient of determination , denoted R 2 or r 2 and pronounced "R squared", is the proportion of the variation in the dependent variable that is predictable from the independent variable(s).
It is a statistic used in the context of statistical models whose main purpose is either the prediction of future outcomes or the testing of hypotheses , on the basis of other related information. It provides a measure of how well observed outcomes are replicated by the model, based on the proportion of total variation of outcomes explained by the model.

[ 1 ] [ 2 ] [ 3 ] There are several definitions of R 2 that are only sometimes equivalent. In simple linear regression (which includes an intercept ), r 2 is simply the square of the sample correlation coefficient ( r ), between the observed outcomes and the observed predictor values.

[ 4 ] If additional regressors are included, R 2 is the square of the coefficient of multiple correlation . In both such cases, the coefficient of determination normally ranges from 0 to 1.

There are cases where R 2 can yield negative values. This can arise when the predictions that are being compared to the corresponding outcomes have not been derived from a model-fitting procedure using those data. Even if a model-fitting procedure has been used, R 2 may still be negative, for example when linear regression is conducted without including an intercept, [ 5 ] or when a non-linear function is used to fit the data.

[ 6 ] In cases where negative values arise, the mean of the data provides a better fit to the outcomes than do the fitted function values, according to this particular criterion.

The coefficient of determination can be more intuitively informative than MAE , MAPE , MSE , and RMSE in regression analysis evaluation, as the former can be expressed as a percentage, whereas the latter measures have arbitrary ranges. It also proved more robust for poor fits compared to SMAPE on certain test datasets.

[ 7 ] When evaluating the goodness-of-fit of simulated ( Y pred ) versus measured ( Y obs ) values, it is not appropriate to base this on the R 2 of the linear regression (i.e., Y obs = m · Y pred + b).

[ citation needed ] The R 2 quantifies the degree of any linear correlation between Y obs and Y pred , while for the goodness-of-fit evaluation only one specific linear correlation should be taken into consideration: Y obs = 1· Y pred + 0 (i.e., the 1:1 line).

[ 8 ] [ 9 ] Definitions [ edit ] R 2 = 1 − − S S res S S tot {\displaystyle R^{2}=1-{\frac {\color {blue}{SS_{\text{res}}}}{\color {red}{SS_{\text{tot}}}}}} The better the linear regression (on the right) fits the data in comparison to the simple average (on the left graph), the closer the value of R 2 is to 1. The areas of the blue squares represent the squared residuals with respect to the linear regression. The areas of the red squares represent the squared residuals with respect to the average value.

A data set has n values marked y 1 , ..., y n (collectively known as y i or as a vector y = [ y 1 , ..., y n ] T ), each associated with a fitted (or modeled, or predicted) value f 1 , ..., f n (known as f i , or sometimes ŷ i , as a vector f ).

Define the residuals as e i = y i − f i (forming a vector e ).

If y ¯ ¯ {\displaystyle {\bar {y}}} is the mean of the observed data: y ¯ ¯ = 1 n ∑ ∑ i = 1 n y i {\displaystyle {\bar {y}}={\frac {1}{n}}\sum _{i=1}^{n}y_{i}} then the variability of the data set can be measured with two sums of squares formulas: The sum of squares of residuals, also called the residual sum of squares : S S res = ∑ ∑ i ( y i − − f i ) 2 = ∑ ∑ i e i 2 {\displaystyle SS_{\text{res}}=\sum _{i}(y_{i}-f_{i})^{2}=\sum _{i}e_{i}^{2}\,} The total sum of squares (proportional to the variance of the data): S S tot = ∑ ∑ i ( y i − − y ¯ ¯ ) 2 {\displaystyle SS_{\text{tot}}=\sum _{i}(y_{i}-{\bar {y}})^{2}} The most general definition of the coefficient of determination is R 2 = 1 − − S S r e s S S t o t {\displaystyle R^{2}=1-{SS_{\rm {res}} \over SS_{\rm {tot}}}} In the best case, the modeled values exactly match the observed values, which results in S S res = 0 {\displaystyle SS_{\text{res}}=0} and R 2 = 1 . A baseline model, which always predicts y , will have R 2 = 0 .

Relation to unexplained variance [ edit ] Main article: Fraction of variance unexplained In a general form, R 2 can be seen to be related to the fraction of variance unexplained (FVU), since the second term compares the unexplained variance (variance of the model's errors) with the total variance (of the data): R 2 = 1 − − FVU {\displaystyle R^{2}=1-{\text{FVU}}} As explained variance [ edit ] A larger value of R 2 implies a more successful regression model.

[ 4 ] : 463 Suppose R 2 = 0.49 . This implies that 49% of the variability of the dependent variable in the data set has been accounted for, and the remaining 51% of the variability is still unaccounted for. 
For regression models, the regression sum of squares, also called the explained sum of squares , is defined as S S reg = ∑ ∑ i ( f i − − y ¯ ¯ ) 2 {\displaystyle SS_{\text{reg}}=\sum _{i}(f_{i}-{\bar {y}})^{2}} In some cases, as in simple linear regression , the total sum of squares equals the sum of the two other sums of squares defined above: S S res + S S reg = S S tot {\displaystyle SS_{\text{res}}+SS_{\text{reg}}=SS_{\text{tot}}} See Partitioning in the general OLS model for a derivation of this result for one case where the relation holds. When this relation does hold, the above definition of R 2 is equivalent to R 2 = S S reg S S tot = S S reg / n S S tot / n {\displaystyle R^{2}={\frac {SS_{\text{reg}}}{SS_{\text{tot}}}}={\frac {SS_{\text{reg}}/n}{SS_{\text{tot}}/n}}} where n is the number of observations (cases) on the variables.

In this form R 2 is expressed as the ratio of the explained variance (variance of the model's predictions, which is SS reg / n ) to the total variance (sample variance of the dependent variable, which is SS tot / n ).

This partition of the sum of squares holds for instance when the model values ƒ i have been obtained by linear regression . A milder sufficient condition reads as follows: The model has the form f i = α α ^ ^ + β β ^ ^ q i {\displaystyle f_{i}={\widehat {\alpha }}+{\widehat {\beta }}q_{i}} where the q i are arbitrary values that may or may not depend on i or on other free parameters (the common choice q i = x i is just one special case), and the coefficient estimates α α ^ ^ {\displaystyle {\widehat {\alpha }}} and β β ^ ^ {\displaystyle {\widehat {\beta }}} are obtained by minimizing the residual sum of squares.

This set of conditions is an important one and it has a number of implications for the properties of the fitted residuals and the modelled values. In particular, under these conditions: f ¯ ¯ = y ¯ ¯ .

{\displaystyle {\bar {f}}={\bar {y}}.\,} As squared correlation coefficient [ edit ] In linear least squares multiple regression (with fitted intercept and slope), R 2 equals ρ ρ 2 ( y , f ) {\displaystyle \rho ^{2}(y,f)} the square of the Pearson correlation coefficient between the observed y {\displaystyle y} and modeled (predicted) f {\displaystyle f} data values of the dependent variable.

In a linear least squares regression with a single explanator (with fitted intercept and slope), this is also equal to ρ ρ 2 ( y , x ) {\displaystyle \rho ^{2}(y,x)} the squared Pearson correlation coefficient between the dependent variable y {\displaystyle y} and explanatory variable x {\displaystyle x} .

It should not be confused with the correlation coefficient between two explanatory variables , defined as ρ ρ α α ^ ^ , β β ^ ^ = cov ⁡ ⁡ ( α α ^ ^ , β β ^ ^ ) σ σ α α ^ ^ σ σ β β ^ ^ , {\displaystyle \rho _{{\widehat {\alpha }},{\widehat {\beta }}}={\operatorname {cov} \left({\widehat {\alpha }},{\widehat {\beta }}\right) \over \sigma _{\widehat {\alpha }}\sigma _{\widehat {\beta }}},} where the covariance between two coefficient estimates, as well as their standard deviations , are obtained from the covariance matrix of the coefficient estimates, ( X T X ) − − 1 {\displaystyle (X^{T}X)^{-1}} .

Under more general modeling conditions, where the predicted values might be generated from a model different from linear least squares regression, an R 2 value can be calculated as the square of the correlation coefficient between the original y {\displaystyle y} and modeled f {\displaystyle f} data values. In this case, the value is not directly a measure of how good the modeled values are, but rather a measure of how good a predictor might be constructed from the modeled values (by creating a revised predictor of the form α + βƒ i ).

[ citation needed ] According to Everitt, [ 10 ] this usage is specifically the definition of the term "coefficient of determination": the square of the correlation between two (general) variables.

Interpretation [ edit ] R 2 is a measure of the goodness of fit of a model.

[ 11 ] In regression, the R 2 coefficient of determination is a statistical measure of how well the regression predictions approximate the real data points. An R 2 of 1 indicates that the regression predictions perfectly fit the data.

Values of R 2 outside the range 0 to 1 occur when the model fits the data worse than the worst possible least-squares predictor (equivalent to a horizontal hyperplane at a height equal to the mean of the observed data). This occurs when a wrong model was chosen, or nonsensical constraints were applied by mistake. If equation 1 of Kvålseth [ 12 ] is used (this is the equation used most often), R 2 can be less than zero. If equation 2 of Kvålseth is used, R 2 can be greater than one.

In all instances where R 2 is used, the predictors are calculated by ordinary least-squares regression: that is, by minimizing SS res . In this case, R 2 increases as the number of variables in the model is increased ( R 2 is monotone increasing with the number of variables included—it will never decrease). This illustrates a drawback to one possible use of R 2 , where one might keep adding variables ( kitchen sink regression ) to increase the R 2 value. For example, if one is trying to predict the sales of a model of car from the car's gas mileage, price, and engine power, one can include probably irrelevant factors such as the first letter of the model's name or the height of the lead engineer designing the car because the R 2 will never decrease as variables are added and will likely experience an increase due to chance alone.

This leads to the alternative approach of looking at the adjusted R 2 . The explanation of this statistic is almost the same as R 2 but it penalizes the statistic as extra variables are included in the model. For cases other than fitting by ordinary least squares, the R 2 statistic can be calculated as above and may still be a useful measure. If fitting is by weighted least squares or generalized least squares , alternative versions of R 2 can be calculated appropriate to those statistical frameworks, while the "raw" R 2 may still be useful if it is more easily interpreted. Values for R 2 can be calculated for any type of predictive model, which need not have a statistical basis.

In a multiple linear model [ edit ] Consider a linear model with more than a single explanatory variable , of the form Y i = β β 0 + ∑ ∑ j = 1 p β β j X i , j + ε ε i , {\displaystyle Y_{i}=\beta _{0}+\sum _{j=1}^{p}\beta _{j}X_{i,j}+\varepsilon _{i},} where, for the i th case, Y i {\displaystyle {Y_{i}}} is the response variable, X i , 1 , … … , X i , p {\displaystyle X_{i,1},\dots ,X_{i,p}} are p regressors, and ε ε i {\displaystyle \varepsilon _{i}} is a mean zero error term. The quantities β β 0 , … … , β β p {\displaystyle \beta _{0},\dots ,\beta _{p}} are unknown coefficients, whose values are estimated by least squares . The coefficient of determination R 2 is a measure of the global fit of the model. Specifically, R 2 is an element of [0, 1] and represents the proportion of variability in Y i that may be attributed to some linear combination of the regressors ( explanatory variables ) in X .

[ 13 ] R 2 is often interpreted as the proportion of response variation "explained" by the regressors in the model. Thus, R 2 = 1 indicates that the fitted model explains all variability in y {\displaystyle y} , while R 2 = 0 indicates no 'linear' relationship (for straight line regression, this means that the straight line model is a constant line (slope = 0, intercept = y ¯ ¯ {\displaystyle {\bar {y}}} ) between the response variable and regressors). An interior value such as R 2 = 0.7 may be interpreted as follows: "Seventy percent of the variance in the response variable can be explained by the explanatory variables. The remaining thirty percent can be attributed to unknown, lurking variables or inherent variability." A caution that applies to R 2 , as to other statistical descriptions of correlation and association is that " correlation does not imply causation ." In other words, while correlations may sometimes provide valuable clues in uncovering causal relationships among variables, a non-zero estimated correlation between two variables is not, on its own, evidence that changing the value of one variable would result in changes in the values of other variables. For example, the practice of carrying matches (or a lighter) is correlated with incidence of lung cancer, but carrying matches does not cause cancer (in the standard sense of "cause").

In case of a single regressor, fitted by least squares, R 2 is the square of the Pearson product-moment correlation coefficient relating the regressor and the response variable. More generally, R 2 is the square of the correlation between the constructed predictor and the response variable. With more than one regressor, the R 2 can be referred to as the coefficient of multiple determination .

Inflation of R 2 [ edit ] In least squares regression using typical data, R 2 is at least weakly increasing with an increase in number of regressors in the model. Because increases in the number of regressors increase the value of R 2 , R 2 alone cannot be used as a meaningful comparison of models with very different numbers of independent variables. For a meaningful comparison between two models, an F-test can be performed on the residual sum of squares [ citation needed ] , similar to the F-tests in Granger causality , though this is not always appropriate [ further explanation needed ] . As a reminder of this, some authors denote R 2 by R q 2 , where q is the number of columns in X (the number of explanators including the constant).

To demonstrate this property, first recall that the objective of least squares linear regression is min b S S res ( b ) ⇒ ⇒ min b ∑ ∑ i ( y i − − X i b ) 2 {\displaystyle \min _{b}SS_{\text{res}}(b)\Rightarrow \min _{b}\sum _{i}(y_{i}-X_{i}b)^{2}\,} where X i is a row vector of values of explanatory variables for case i and b is a column vector of coefficients of the respective elements of X i .

The optimal value of the objective is weakly smaller as more explanatory variables are added and hence additional columns of X {\displaystyle X} (the explanatory data matrix whose i th row is X i ) are added, by the fact that less constrained minimization leads to an optimal cost which is weakly smaller than more constrained minimization does. Given the previous conclusion and noting that S S t o t {\displaystyle SS_{tot}} depends only on y , the non-decreasing property of R 2 follows directly from the definition above.

The intuitive reason that using an additional explanatory variable cannot lower the R 2 is this: Minimizing S S res {\displaystyle SS_{\text{res}}} is equivalent to maximizing R 2 . When the extra variable is included, the data always have the option of giving it an estimated coefficient of zero, leaving the predicted values and the R 2 unchanged. The only way that the optimization problem will give a non-zero coefficient is if doing so improves the R 2 .

The above gives an analytical explanation of the inflation of R 2 . Next, an example based on ordinary least square from a geometric perspective is shown below.

[ 14 ] This is an example of residuals of regression models in smaller and larger spaces based on ordinary least square regression.

A simple case to be considered first: Y = β β 0 + β β 1 ⋅ ⋅ X 1 + ε ε {\displaystyle Y=\beta _{0}+\beta _{1}\cdot X_{1}+\varepsilon \,} This equation describes the ordinary least squares regression model with one regressor. The prediction is shown as the red vector in the figure on the right. Geometrically, it is the projection of true value onto a model space in R {\displaystyle \mathbb {R} } (without intercept). The residual is shown as the red line.

Y = β β 0 + β β 1 ⋅ ⋅ X 1 + β β 2 ⋅ ⋅ X 2 + ε ε {\displaystyle Y=\beta _{0}+\beta _{1}\cdot X_{1}+\beta _{2}\cdot X_{2}+\varepsilon \,} This equation corresponds to the ordinary least squares regression model with two regressors. The prediction is shown as the blue vector in the figure on the right. Geometrically, it is the projection of true value onto a larger model space in R 2 {\displaystyle \mathbb {R} ^{2}} (without intercept). Noticeably, the values of β β 0 {\displaystyle \beta _{0}} and β β 0 {\displaystyle \beta _{0}} are not the same as in the equation for smaller model space as long as X 1 {\displaystyle X_{1}} and X 2 {\displaystyle X_{2}} are not zero vectors. Therefore, the equations are expected to yield different predictions (i.e., the blue vector is expected to be different from the red vector). The least squares regression criterion ensures that the residual is minimized. In the figure, the blue line representing the residual is orthogonal to the model space in R 2 {\displaystyle \mathbb {R} ^{2}} , giving the minimal distance from the space.

The smaller model space is a subspace of the larger one, and thereby the residual of the smaller model is guaranteed to be larger. Comparing the red and blue lines in the figure, the blue line is orthogonal to the space, and any other line would be larger than the blue one. Considering the calculation for R 2 , a smaller value of S S t o t {\displaystyle SS_{tot}} will lead to a larger value of R 2 , meaning that adding regressors will result in inflation of R 2 .

Caveats [ edit ] R 2 does not indicate whether: the independent variables are a cause of the changes in the dependent variable ; omitted-variable bias exists; the correct regression was used; the most appropriate set of independent variables has been chosen; there is collinearity present in the data on the explanatory variables; the model might be improved by using transformed versions of the existing set of independent variables; there are enough data points to make a solid conclusion; there are a few outliers in an otherwise good sample.

Comparison of the Theil–Sen estimator (black) and simple linear regression (blue) for a set of points with outliers . Because of the many outliers, neither of the regression lines fits the data well, as measured by the fact that neither gives a very high R 2 .

Extensions [ edit ] Adjusted R 2 [ edit ] See also: Omega-squared (ω 2 ) The use of an adjusted R 2 (one common notation is R ¯ ¯ 2 {\displaystyle {\bar {R}}^{2}} , pronounced "R bar squared"; another is R a 2 {\displaystyle R_{\text{a}}^{2}} or R adj 2 {\displaystyle R_{\text{adj}}^{2}} ) is an attempt to account for the phenomenon of the R 2 automatically increasing when extra explanatory variables are added to the model. There are many different ways of adjusting.

[ 15 ] By far the most used one, to the point that it is typically just referred to as adjusted R , is the correction proposed by Mordecai Ezekiel .

[ 15 ] [ 16 ] [ 17 ] The adjusted R 2 is defined as R ¯ ¯ 2 = 1 − − S S res / df res S S tot / df tot {\displaystyle {\bar {R}}^{2}={1-{SS_{\text{res}}/{\text{df}}_{\text{res}} \over SS_{\text{tot}}/{\text{df}}_{\text{tot}}}}} where df res is the degrees of freedom of the estimate of the population variance around the model, and df tot is the degrees of freedom  of the estimate of the population variance around the mean. df res is given in terms of the sample size n and the number of variables p in the model, df res = n − p − 1 . df tot is given in the same way, but with p being zero for the mean, i.e.

df tot = n − 1 .

Inserting the degrees of freedom and using the definition of R 2 , it can be rewritten as: R ¯ ¯ 2 = 1 − − ( 1 − − R 2 ) n − − 1 n − − p − − 1 {\displaystyle {\bar {R}}^{2}=1-(1-R^{2}){n-1 \over n-p-1}} where p is the total number of explanatory variables in the model (excluding the intercept), and n is the sample size.

The adjusted R 2 can be negative, and its value will always be less than or equal to that of R 2 . Unlike R 2 , the adjusted R 2 increases only when the increase in R 2 (due to the inclusion of a new explanatory variable) is more than one would expect to see by chance. If a set of explanatory variables with a predetermined hierarchy of importance are introduced into a regression one at a time, with the adjusted R 2 computed each time, the level at which adjusted R 2 reaches a maximum, and decreases afterward, would be the regression with the ideal combination of having the best fit without excess/unnecessary terms.

Schematic of the bias and variance contribution into the total error The adjusted R 2 can be interpreted as an instance of the bias-variance tradeoff . When we consider the performance of a model, a lower error represents a better performance. When the model becomes more complex, the variance will increase whereas the square of bias will decrease, and these two metrics add up to be the total error. Combining these two trends, the bias-variance tradeoff describes a relationship between the performance of the model and its complexity, which is shown as a u-shape curve on the right. For the adjusted R 2 specifically, the model complexity (i.e. number of parameters) affects the R 2 and the term / frac and thereby captures their attributes in the overall performance of the model.

R 2 can be interpreted as the variance of the model, which is influenced by the model complexity. A high R 2 indicates a lower bias error because the model can better explain the change of Y with predictors. For this reason, we make fewer (erroneous) assumptions, and this results in a lower bias error. Meanwhile, to accommodate fewer assumptions, the model tends to be more complex. Based on bias-variance tradeoff, a higher complexity will lead to a decrease in bias and a better performance (below the optimal line). In R 2 , the term ( 1 − R 2 ) will be lower with high complexity and resulting in a higher R 2 , consistently indicating a better performance.

On the other hand, the term/frac term is reversely affected by the model complexity. The term/frac will increase when adding regressors (i.e. increased model complexity) and lead to worse performance. Based on bias-variance tradeoff, a higher model complexity (beyond the optimal line) leads to increasing errors and a worse performance.

Considering the calculation of R 2 , more parameters will increase the R 2 and lead to an increase in R 2 . Nevertheless, adding more parameters will increase the term/frac and thus decrease R 2 . These two trends construct a reverse u-shape relationship between model complexity and R 2 , which is in consistent with the u-shape trend of model complexity versus overall performance. Unlike R 2 , which will always increase when model complexity increases, R 2 will increase only when the bias eliminated by the added regressor is greater than the variance introduced simultaneously. Using R 2 instead of R 2 could thereby prevent overfitting.

Following the same logic, adjusted R 2 can be interpreted as a less biased estimator of the population R 2 , whereas the observed sample R 2 is a positively biased estimate of the population value.

[ 18 ] Adjusted R 2 is more appropriate when evaluating model fit (the variance in the dependent variable accounted for by the independent variables) and in comparing alternative models in the feature selection stage of model building.

[ 18 ] The principle behind the adjusted R 2 statistic can be seen by rewriting the ordinary R 2 as R 2 = 1 − − VAR res VAR tot {\displaystyle R^{2}={1-{{\text{VAR}}_{\text{res}} \over {\text{VAR}}_{\text{tot}}}}} where VAR res = S S res / n {\displaystyle {\text{VAR}}_{\text{res}}=SS_{\text{res}}/n} and VAR tot = S S tot / n {\displaystyle {\text{VAR}}_{\text{tot}}=SS_{\text{tot}}/n} are the sample variances of the estimated residuals and the dependent variable respectively, which can be seen as biased estimates of the population variances of the errors and of the dependent variable. These estimates are replaced by statistically unbiased versions: VAR res = S S res / ( n − − p ) {\displaystyle {\text{VAR}}_{\text{res}}=SS_{\text{res}}/(n-p)} and VAR tot = S S tot / ( n − − 1 ) {\displaystyle {\text{VAR}}_{\text{tot}}=SS_{\text{tot}}/(n-1)} .

Despite using unbiased estimators for the population variances of the error and the dependent variable,  adjusted R 2 is not an unbiased estimator of the population R 2 , [ 18 ] which results by using the population variances of the errors and the dependent variable instead of estimating them.

Ingram Olkin and John W. Pratt derived the minimum-variance unbiased estimator for the population R 2 , [ 19 ] which is known as Olkin–Pratt estimator. Comparisons of different approaches for adjusting R 2 concluded that in most situations either an approximate version of the Olkin–Pratt estimator [ 18 ] or the exact Olkin–Pratt estimator [ 20 ] should be preferred over (Ezekiel) adjusted R 2 .

Coefficient of partial determination [ edit ] See also: Partial correlation The coefficient of partial determination can be defined as the proportion of variation that cannot be explained in a reduced model, but can be explained by the predictors specified in a full model.

[ 21 ] [ 22 ] [ 23 ] This coefficient is used to provide insight into whether or not one or more additional predictors may be useful in a more fully specified regression model.

The calculation for the partial R 2 is relatively straightforward after estimating two models and generating the ANOVA tables for them. The calculation for the partial R 2 is S S res, reduced − − S S res, full S S res, reduced , {\displaystyle {\frac {SS_{\text{ res, reduced}}-SS_{\text{ res, full}}}{SS_{\text{ res, reduced}}}},} which is analogous to the usual coefficient of determination: S S tot − − S S res S S tot .

{\displaystyle {\frac {SS_{\text{tot}}-SS_{\text{res}}}{SS_{\text{tot}}}}.} Generalizing and decomposing R 2 [ edit ] As explained above, model selection heuristics such as the adjusted R 2 criterion and the F-test examine whether the total R 2 sufficiently increases to determine if a new regressor should be added to the model. If a regressor is added to the model that is highly correlated with other regressors which have already been included, then the total R 2 will hardly increase, even if the new regressor is of relevance. As a result, the above-mentioned heuristics will ignore relevant regressors when cross-correlations are high.

[ 24 ] Geometric representation of r 2 .

Alternatively, one can decompose a generalized version of R 2 to quantify the relevance of deviating from a hypothesis.

[ 24 ] As Hoornweg (2018) shows, several shrinkage estimators – such as Bayesian linear regression , ridge regression , and the (adaptive) lasso – make use of this decomposition of R 2 when they gradually shrink parameters from the unrestricted OLS solutions towards the hypothesized values. Let us first define the linear regression model as y = X β β + ε ε .

{\displaystyle y=X\beta +\varepsilon .} It is assumed that the matrix X is standardized with Z-scores and that the column vector y {\displaystyle y} is centered to have a mean of zero. Let the column vector β β 0 {\displaystyle \beta _{0}} refer to the hypothesized regression parameters and let the column vector b {\displaystyle b} denote the estimated parameters. We can then define R 2 = 1 − − ( y − − X b ) ′ ( y − − X b ) ( y − − X β β 0 ) ′ ( y − − X β β 0 ) .

{\displaystyle R^{2}=1-{\frac {(y-Xb)'(y-Xb)}{(y-X\beta _{0})'(y-X\beta _{0})}}.} An R 2 of 75% means that the in-sample accuracy improves by 75% if the data-optimized b solutions are used instead of the hypothesized β β 0 {\displaystyle \beta _{0}} values. In the special case that β β 0 {\displaystyle \beta _{0}} is a vector of zeros, we obtain the traditional R 2 again.

The individual effect on R 2 of deviating from a hypothesis can be computed with R ⊗ ⊗ {\displaystyle R^{\otimes }} ('R-outer'). This p {\displaystyle p} times p {\displaystyle p} matrix is given by R ⊗ ⊗ = ( X ′ y ~ ~ 0 ) ( X ′ y ~ ~ 0 ) ′ ( X ′ X ) − − 1 ( y ~ ~ 0 ′ y ~ ~ 0 ) − − 1 , {\displaystyle R^{\otimes }=(X'{\tilde {y}}_{0})(X'{\tilde {y}}_{0})'(X'X)^{-1}({\tilde {y}}_{0}'{\tilde {y}}_{0})^{-1},} where y ~ ~ 0 = y − − X β β 0 {\displaystyle {\tilde {y}}_{0}=y-X\beta _{0}} . The diagonal elements of R ⊗ ⊗ {\displaystyle R^{\otimes }} exactly add up to R 2 . If regressors are uncorrelated and β β 0 {\displaystyle \beta _{0}} is a vector of zeros, then the j th {\displaystyle j^{\text{th}}} diagonal element of R ⊗ ⊗ {\displaystyle R^{\otimes }} simply corresponds to the r 2 value between x j {\displaystyle x_{j}} and y {\displaystyle y} . When regressors x i {\displaystyle x_{i}} and x j {\displaystyle x_{j}} are correlated, R i i ⊗ ⊗ {\displaystyle R_{ii}^{\otimes }} might increase at the cost of a decrease in R j j ⊗ ⊗ {\displaystyle R_{jj}^{\otimes }} . As a result, the diagonal elements of R ⊗ ⊗ {\displaystyle R^{\otimes }} may be smaller than 0 and, in more exceptional cases, larger than 1. To deal with such uncertainties, several shrinkage estimators implicitly take a weighted average of the diagonal elements of R ⊗ ⊗ {\displaystyle R^{\otimes }} to quantify the relevance of deviating from a hypothesized value.

[ 24 ] Click on the lasso for an example.

R 2 in logistic regression [ edit ] In the case of logistic regression , usually fit by maximum likelihood , there are several choices of pseudo- R 2 .

One is the generalized R 2 originally proposed by Cox & Snell, [ 25 ] and independently by Magee: [ 26 ] R 2 = 1 − − ( L ( 0 ) L ( θ θ ^ ^ ) ) 2 / n {\displaystyle R^{2}=1-\left({{\mathcal {L}}(0) \over {\mathcal {L}}({\widehat {\theta }})}\right)^{2/n}} where L ( 0 ) {\displaystyle {\mathcal {L}}(0)} is the likelihood of the model with only the intercept, L ( θ θ ^ ^ ) {\displaystyle {{\mathcal {L}}({\widehat {\theta }})}} is the likelihood of the estimated model (i.e., the model with a given set of parameter estimates) and n is the sample size. It is easily rewritten to: R 2 = 1 − − e 2 n ( ln ⁡ ⁡ ( L ( 0 ) ) − − ln ⁡ ⁡ ( L ( θ θ ^ ^ ) ) ) = 1 − − e − − D / n {\displaystyle R^{2}=1-e^{{\frac {2}{n}}(\ln({\mathcal {L}}(0))-\ln({\mathcal {L}}({\widehat {\theta }})))}=1-e^{-D/n}} where D is the test statistic of the likelihood ratio test .

Nico Nagelkerke noted that it had the following properties: [ 27 ] [ 22 ] It is consistent with the classical coefficient of determination when both can be computed; Its value is maximised by the maximum likelihood estimation of a model; It is asymptotically independent of the sample size; The interpretation is the proportion of the variation explained by the model; The values are between 0 and 1, with 0 denoting that model does not explain any variation and 1 denoting that it perfectly explains the observed variation; It does not have any unit.

However, in the case of a logistic model, where L ( θ θ ^ ^ ) {\displaystyle {\mathcal {L}}({\widehat {\theta }})} cannot be greater than 1, R 2 is between 0 and R max 2 = 1 − − ( L ( 0 ) ) 2 / n {\displaystyle R_{\max }^{2}=1-({\mathcal {L}}(0))^{2/n}} : thus, Nagelkerke suggested the possibility to define a scaled R 2 as R 2 / R 2 max .

[ 22 ] Comparison with residual statistics [ edit ] Occasionally, residual statistics are used for indicating goodness of fit. The norm of residuals is calculated as the square-root of the sum of squares of residuals (SSR): norm of residuals = S S res = ‖ ‖ e ‖ ‖ .

{\displaystyle {\text{norm of residuals}}={\sqrt {SS_{\text{res}}}}=\|e\|.} Similarly, the reduced chi-square is calculated as the SSR divided by the degrees of freedom.

Both R 2 and the norm of residuals have their relative merits. For least squares analysis R 2 varies between 0 and 1, with larger numbers indicating better fits and 1 representing a perfect fit. The norm of residuals varies from 0 to infinity with smaller numbers indicating better fits and zero indicating a perfect fit. One advantage and disadvantage of R 2 is the S S tot {\displaystyle SS_{\text{tot}}} term acts to normalize the value. If the y i values are all multiplied by a constant, the norm of residuals will also change by that constant but R 2 will stay the same. As a basic example, for the linear least squares fit to the set of data: x 1 2 3 4 5 y 1.9 3.7 5.8 8.0 9.6 R 2 = 0.998, and norm of residuals = 0.302.
If all values of y are multiplied by 1000 (for example, in an SI prefix change), then R 2 remains the same, but norm of residuals = 302.

Another single-parameter indicator of fit is the RMSE of the residuals, or standard deviation of the residuals. This would have a value of 0.135 for the above example given that the fit was linear with an unforced intercept.

[ 28 ] History [ edit ] The creation of the coefficient of determination has been attributed to the geneticist Sewall Wright and was first published in 1921.

[ 29 ] See also [ edit ] Anscombe's quartet Fraction of variance unexplained Goodness of fit Nash–Sutcliffe model efficiency coefficient ( hydrological applications ) Pearson product-moment correlation coefficient Proportional reduction in loss Regression model validation Root mean square deviation Stepwise regression Notes [ edit ] ^ Steel, R. G. D.; Torrie, J. H. (1960).

Principles and Procedures of Statistics with Special Reference to the Biological Sciences .

McGraw Hill .

^ Glantz, Stanton A.; Slinker, B. K. (1990).

Primer of Applied Regression and Analysis of Variance . McGraw-Hill.

ISBN 978-0-07-023407-9 .

^ Draper, N. R.; Smith, H. (1998).

Applied Regression Analysis . Wiley-Interscience.

ISBN 978-0-471-17082-2 .

^ a b Devore, Jay L. (2011).

Probability and Statistics for Engineering and the Sciences (8th ed.). Boston, MA: Cengage Learning. pp.

508– 510.

ISBN 978-0-538-73352-6 .

^ Barten, Anton P.

(1987). "The Coeffecient of Determination for Regression without a Constant Term". In Heijmans, Risto; Neudecker, Heinz (eds.).

The Practice of Econometrics . Dordrecht: Kluwer. pp.

181– 189.

ISBN 90-247-3502-5 .

^ Colin Cameron, A.; Windmeijer, Frank A.G. (1997). "An R-squared measure of goodness of fit for some common nonlinear regression models".

Journal of Econometrics .

77 (2): 1790– 2.

doi : 10.1016/S0304-4076(96)01818-0 .

^ Chicco, Davide; Warrens, Matthijs J.; Jurman, Giuseppe (2021).

"The coefficient of determination R-squared is more informative than SMAPE, MAE, MAPE, MSE and RMSE in regression analysis evaluation" .

PeerJ Computer Science .

7 (e623): e623.

doi : 10.7717/peerj-cs.623 .

PMC 8279135 .

PMID 34307865 .

^ Legates, D.R.; McCabe, G.J. (1999). "Evaluating the use of "goodness-of-fit" measures in hydrologic and hydroclimatic model validation".

Water Resour. Res .

35 (1): 233– 241.

Bibcode : 1999WRR....35..233L .

doi : 10.1029/1998WR900018 .

S2CID 128417849 .

^ Ritter, A.; Muñoz-Carpena, R. (2013). "Performance evaluation of hydrological models: statistical significance for reducing subjectivity in goodness-of-fit assessments".

Journal of Hydrology .

480 (1): 33– 45.

Bibcode : 2013JHyd..480...33R .

doi : 10.1016/j.jhydrol.2012.12.004 .

^ Everitt, B. S. (2002).

Cambridge Dictionary of Statistics (2nd ed.). CUP. p. 78.

ISBN 978-0-521-81099-9 .

^ Casella, Georges (2002).

Statistical inference (Second ed.). Pacific Grove, Calif.: Duxbury/Thomson Learning. p. 556.

ISBN 9788131503942 .

^ Kvalseth, Tarald O. (1985). "Cautionary Note about R2".

The American Statistician .

39 (4): 279– 285.

doi : 10.2307/2683704 .

JSTOR 2683704 .

^ "Linear Regression – MATLAB & Simulink" .

www.mathworks.com .

^ Faraway, Julian James (2005).

Linear models with R (PDF) . Chapman & Hall/CRC.

ISBN 9781584884255 .

^ a b Raju, Nambury S.; Bilgic, Reyhan; Edwards, Jack E.; Fleer, Paul F. (1997).

"Methodology review: Estimation of population validity and cross-validity, and the use of equal weights in prediction" .

Applied Psychological Measurement .

21 (4): 291– 305.

doi : 10.1177/01466216970214001 .

ISSN 0146-6216 .

S2CID 122308344 .

^ Mordecai Ezekiel (1930), Methods Of Correlation Analysis , Wiley , Wikidata Q120123877 , pp. 208–211.

^ Yin, Ping; Fan, Xitao (January 2001).

"Estimating R 2 Shrinkage in Multiple Regression: A Comparison of Different Analytical Methods" (PDF) .

The Journal of Experimental Education .

69 (2): 203– 224.

doi : 10.1080/00220970109600656 .

ISSN 0022-0973 .

S2CID 121614674 .

^ a b c d Shieh, Gwowen (2008-04-01). "Improved shrinkage estimation of squared multiple correlation coefficient and squared cross-validity coefficient".

Organizational Research Methods .

11 (2): 387– 407.

doi : 10.1177/1094428106292901 .

ISSN 1094-4281 .

S2CID 55098407 .

^ Olkin, Ingram; Pratt, John W. (March 1958).

"Unbiased estimation of certain correlation coefficients" .

The Annals of Mathematical Statistics .

29 (1): 201– 211.

doi : 10.1214/aoms/1177706717 .

ISSN 0003-4851 .

^ Karch, Julian (2020-09-29).

"Improving on Adjusted R-Squared" .

Collabra: Psychology .

6 (45).

doi : 10.1525/collabra.343 .

hdl : 1887/3161248 .

ISSN 2474-7394 .

^ Richard Anderson-Sprecher, " Model Comparisons and R 2 ", The American Statistician , Volume 48, Issue 2, 1994, pp. 113–117.

^ a b c Nagelkerke, N. J. D. (September 1991).

"A Note on a General Definition of the Coefficient of Determination" (PDF) .

Biometrika .

78 (3): 691– 692.

doi : 10.1093/biomet/78.3.691 .

JSTOR 2337038 .

^ "regression – R implementation of coefficient of partial determination" .

Cross Validated .

^ a b c Hoornweg, Victor (2018).

"Part II: On Keeping Parameters Fixed" .

Science: Under Submission . Hoornweg Press.

ISBN 978-90-829188-0-9 .

^ Cox, D. D.; Snell, E. J.

(1989).

The Analysis of Binary Data (2nd ed.). Chapman and Hall.

^ Magee, L. (1990). " R 2 measures based on Wald and likelihood ratio joint significance tests".

The American Statistician .

44 (3): 250– 3.

doi : 10.1080/00031305.1990.10475731 .

^ Nagelkerke, Nico J. D. (1992).

Maximum Likelihood Estimation of Functional Relationships, Pays-Bas . Lecture Notes in Statistics. Vol. 69.

ISBN 978-0-387-97721-8 .

^ OriginLab webpage, http://www.originlab.com/doc/Origin-Help/LR-Algorithm . Retrieved February 9, 2016.

^ Wright, Sewall (January 1921). "Correlation and causation".

Journal of Agricultural Research .

20 : 557– 585.

Further reading [ edit ] Gujarati, Damodar N.

; Porter, Dawn C.

(2009).

Basic Econometrics (Fifth ed.). New York: McGraw-Hill/Irwin. pp.

73– 78.

ISBN 978-0-07-337577-9 .

Hughes, Ann; Grawoig, Dennis (1971).

Statistics: A Foundation for Analysis . Reading: Addison-Wesley. pp.

344–348 .

ISBN 0-201-03021-7 .

Kmenta, Jan (1986).

Elements of Econometrics (Second ed.). New York: Macmillan. pp.

240–243 .

ISBN 978-0-02-365070-3 .

Lewis-Beck, Michael S.

; Skalaban, Andrew (1990). "The R -Squared: Some Straight Talk".

Political Analysis .

2 : 153– 171.

doi : 10.1093/pan/2.1.153 .

JSTOR 23317769 .

Chicco, Davide; Warrens, Matthijs J.; Jurman, Giuseppe (2021).

"The coefficient of determination R-squared is more informative than SMAPE, MAE, MAPE, MSE and RMSE in regression analysis evaluation" .

PeerJ Computer Science .

7 (e623): e623.

doi : 10.7717/peerj-cs.623 .

PMC 8279135 .

PMID 34307865 .

v t e Machine learning evaluation metrics Regression MSE MAE sMAPE MAPE MASE MSPE RMS RMSE/RMSD R 2 MDA MAD Classification F-score P4 Accuracy Precision Recall Kappa MCC AUC ROC Sensitivity and specificity Logarithmic loss Clustering Silhouette Calinski–Harabasz index Davies–Bouldin index Dunn index Hopkins statistic Jaccard index Rand index Similarity measure SMC DBCV index Ranking MRR NDCG AP Computer vision PSNR SSIM IoU NLP Perplexity BLEU Deep learning Inception score FID Recommender system Coverage Intra-list similarity Similarity Cosine similarity Euclidean distance Pearson correlation coefficient Confusion matrix Authority control databases : National Germany NewPP limit report
Parsed by mw‐web.codfw.main‐7c956d68b4‐g72cw
Cached time: 20250817152929
Cache expiry: 2592000
Reduced expiry: false
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.780 seconds
Real time usage: 1.113 seconds
Preprocessor visited node count: 4243/1000000
Revision size: 46576/2097152 bytes
Post‐expand include size: 113676/2097152 bytes
Template argument size: 6357/2097152 bytes
Highest expansion depth: 20/100
Expensive parser function count: 12/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 131040/5000000 bytes
Lua time usage: 0.465/10.000 seconds
Lua memory usage: 8866435/52428800 bytes
Number of Wikibase entities loaded: 3/500 Transclusion expansion time report (%,ms,calls,template)
100.00%  745.408      1 -total
 45.87%  341.934      1 Template:Reflist
 22.17%  165.279     14 Template:Cite_book
 13.75%  102.513     15 Template:Cite_journal
  9.75%   72.689      1 Template:Machine_learning_evaluation_metrics
  9.48%   70.693      1 Template:Navbox
  9.45%   70.466      1 Template:Short_description
  9.05%   67.448      1 Template:Expand_German
  9.04%   67.366      1 Template:Cite_Q
  8.52%   63.538      1 Template:Expand_language Saved in parser cache with key enwiki:pcache:1500869:|#|:idhash:canonical and timestamp 20250817152929 and revision id 1302911335. Rendering was triggered because: page-view Retrieved from " https://en.wikipedia.org/w/index.php?title=Coefficient_of_determination&oldid=1302911335 " Categories : Regression diagnostics Statistical ratios Least squares Hidden categories: Articles with short description Short description matches Wikidata Articles needing translation from German Wikipedia All articles with unsourced statements Articles with unsourced statements from August 2021 Articles with unsourced statements from March 2017 Articles with unsourced statements from October 2021 Wikipedia articles needing clarification from October 2021 This page was last edited on 28 July 2025, at 02:50 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Coefficient of determination 19 languages Add topic

