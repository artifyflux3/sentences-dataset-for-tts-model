Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 History 2 Example 3 Proofs Toggle Proofs subsection 3.1 Composite modulus 3.2 Prime modulus 3.2.1 Elementary proof 3.2.2 Proof using Fermat's little theorem 3.2.3 Proof using the Sylow theorems 4 Applications Toggle Applications subsection 4.1 Primality tests 4.2 Quadratic residues 4.3 Formulas for primes 4.4 p-adic gamma function 5 Gauss's generalization 6 See also 7 Notes 8 References 9 External links Toggle the table of contents Wilson's theorem 38 languages العربية বাংলা Български Català Čeština Dansk Deutsch Ελληνικά Español Euskara فارسی Français 한국어 Hrvatski Bahasa Indonesia Italiano עברית Қазақша Kreyòl ayisyen Latviešu Lietuvių Magyar Nederlands 日本語 Polski Português Română Русский Simple English Slovenčina Slovenščina کوردی Suomi Svenska ไทย Українська Tiếng Việt 中文 Edit links Article Talk English Read View source View history Tools Tools move to sidebar hide Actions Read View source View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Theorem on prime numbers In algebra and number theory , Wilson's theorem states that a natural number n > 1 is a prime number if and only if the product of all the positive integers less than n is one less than a multiple of n .  That is (using the notations of modular arithmetic ), the factorial ( n − − 1 ) !

= 1 × × 2 × × 3 × × ⋯ ⋯ × × ( n − − 1 ) {\displaystyle (n-1)!=1\times 2\times 3\times \cdots \times (n-1)} satisfies ( n − − 1 ) !

≡ ≡ − − 1 ( mod n ) {\displaystyle (n-1)!\ \equiv \;-1{\pmod {n}}} exactly when n is a prime number. In other words, any integer n > 1 is a prime number if, and only if, ( n − 1)! + 1 is divisible by n .

[ 1 ] History The theorem was first stated by Ibn al-Haytham c.

1000 AD .

[ 2 ] Edward Waring announced the theorem in 1770 without proving it, crediting his student John Wilson for the discovery.

[ 3 ] Lagrange gave the first proof in 1771.

[ 4 ] There is evidence that Leibniz was also aware of the result a century earlier, but never published it.

[ 5 ] Example For each of the values of n from 2 to 30, the following table shows the number ( n − 1)! and the remainder when ( n − 1)! is divided by n .  (In the notation of modular arithmetic , the remainder when m is divided by n is written m mod n .)
The background color is blue for prime values of n , gold for composite values.

Table of factorial and its remainder modulo n n {\displaystyle n} ( n − − 1 ) !

{\displaystyle (n-1)!} (sequence A000142 in the OEIS ) ( n − − 1 ) !

mod n {\displaystyle (n-1)!\ {\bmod {\ }}n} (sequence A061006 in the OEIS ) 2 1 1 3 2 2 4 6 2 5 24 4 6 120 0 7 720 6 8 5040 0 9 40320 0 10 362880 0 11 3628800 10 12 39916800 0 13 479001600 12 14 6227020800 0 15 87178291200 0 16 1307674368000 0 17 20922789888000 16 18 355687428096000 0 19 6402373705728000 18 20 121645100408832000 0 21 2432902008176640000 0 22 51090942171709440000 0 23 1124000727777607680000 22 24 25852016738884976640000 0 25 620448401733239439360000 0 26 15511210043330985984000000 0 27 403291461126605635584000000 0 28 10888869450418352160768000000 0 29 304888344611713860501504000000 28 30 8841761993739701954543616000000 0 Proofs As a biconditional (if and only if) statement, the proof has two halves: to show that equality does not hold when n {\displaystyle n} is composite, and to show that it does hold when n {\displaystyle n} is prime.

Composite modulus Suppose that n {\displaystyle n} is composite.  Therefore, it is divisible by some prime number q {\displaystyle q} where 2 ≤ ≤ q < n {\displaystyle 2\leq q<n} . Because q {\displaystyle q} divides n {\displaystyle n} , there is an integer k {\displaystyle k} such that n = q k {\displaystyle n=qk} . Suppose for the sake of contradiction that ( n − − 1 ) !

{\displaystyle (n-1)!} were congruent to − − 1 {\displaystyle -1} modulo n {\displaystyle {n}} . Then ( n − − 1 ) !

{\displaystyle (n-1)!} would also be congruent to − − 1 {\displaystyle -1} modulo q {\displaystyle {q}} : indeed, if ( n − − 1 ) !

≡ ≡ − − 1 ( mod n ) {\displaystyle (n-1)!\equiv -1{\pmod {n}}} then ( n − − 1 ) !

= n m − − 1 = ( q k ) m − − 1 = q ( k m ) − − 1 {\displaystyle (n-1)!=nm-1=(qk)m-1=q(km)-1} for some integer m {\displaystyle m} , and consequently ( n − − 1 ) !

{\displaystyle (n-1)!} is one less than a multiple of q {\displaystyle q} .  On the other hand, since 2 ≤ ≤ q ≤ ≤ n − − 1 {\displaystyle 2\leq q\leq n-1} , one of the factors in the expanded product ( n − − 1 ) !

= ( n − − 1 ) × × ( n − − 2 ) × × ⋯ ⋯ × × 2 × × 1 {\displaystyle (n-1)!=(n-1)\times (n-2)\times \cdots \times 2\times 1} is q {\displaystyle q} .  Therefore ( n − − 1 ) !

≡ ≡ 0 ( mod q ) {\displaystyle (n-1)!\equiv 0{\pmod {q}}} .  This is a contradiction; therefore it is not possible that ( n − − 1 ) !

≡ ≡ − − 1 ( mod n ) {\displaystyle (n-1)!\equiv -1{\pmod {n}}} when n {\displaystyle n} is composite.

In fact, more is true. With the sole exception of the case n = 4 {\displaystyle n=4} , where 3 !

= 6 ≡ ≡ 2 ( mod 4 ) {\displaystyle 3!=6\equiv 2{\pmod {4}}} , if n {\displaystyle n} is composite then ( n − − 1 ) !

{\displaystyle (n-1)!} is congruent to 0 modulo n {\displaystyle n} . The proof can be divided into two cases: First, if n {\displaystyle n} can be factored as the product of two unequal numbers, n = a b {\displaystyle n=ab} , where 2 ≤ ≤ a < b < n {\displaystyle 2\leq a<b<n} , then both a {\displaystyle a} and b {\displaystyle b} will appear as factors in the product ( n − − 1 ) !

= ( n − − 1 ) × × ( n − − 2 ) × × ⋯ ⋯ × × 2 × × 1 {\displaystyle (n-1)!=(n-1)\times (n-2)\times \cdots \times 2\times 1} and so ( n − − 1 ) !

{\displaystyle (n-1)!} is divisible by a b = n {\displaystyle ab=n} .  If n {\displaystyle n} has no such factorization, then it must be the square of some prime q {\displaystyle q} larger than 2. But then 2 q < q 2 = n {\displaystyle 2q<q^{2}=n} , so both q {\displaystyle q} and 2 q {\displaystyle 2q} will be factors of ( n − − 1 ) !

{\displaystyle (n-1)!} , and so n {\displaystyle n} divides ( n − − 1 ) !

{\displaystyle (n-1)!} in this case, as well.

Prime modulus The first two proofs below use the fact that the residue classes modulo a prime number form a finite field (specifically, a prime field ).

[ 6 ] Elementary proof The result is trivial when p = 2 {\displaystyle p=2} , so assume p {\displaystyle p} is an odd prime, p ≥ ≥ 3 {\displaystyle p\geq 3} . Since the residue classes modulo p {\displaystyle p} form a field, every non-zero residue a {\displaystyle a} has a unique multiplicative inverse a − − 1 {\displaystyle a^{-1}} .

Euclid's lemma implies [ a ] that the only values of a {\displaystyle a} for which a ≡ ≡ a − − 1 ( mod p ) {\displaystyle a\equiv a^{-1}{\pmod {p}}} are a ≡ ≡ ± ± 1 ( mod p ) {\displaystyle a\equiv \pm 1{\pmod {p}}} .  Therefore, with the exception of ± ± 1 {\displaystyle \pm 1} , the factors in the expanded form of ( p − − 1 ) !

{\displaystyle (p-1)!} can be arranged in disjoint pairs such that product of each pair is congruent to 1 modulo p {\displaystyle p} . This proves Wilson's theorem.

For example, for p = 11 {\displaystyle p=11} , one has 10 !

= [ ( 1 ⋅ ⋅ 10 ) ] ⋅ ⋅ [ ( 2 ⋅ ⋅ 6 ) ( 3 ⋅ ⋅ 4 ) ( 5 ⋅ ⋅ 9 ) ( 7 ⋅ ⋅ 8 ) ] ≡ ≡ [ − − 1 ] ⋅ ⋅ [ 1 ⋅ ⋅ 1 ⋅ ⋅ 1 ⋅ ⋅ 1 ] ≡ ≡ − − 1 ( mod 11 ) .

{\displaystyle 10!=[(1\cdot 10)]\cdot [(2\cdot 6)(3\cdot 4)(5\cdot 9)(7\cdot 8)]\equiv [-1]\cdot [1\cdot 1\cdot 1\cdot 1]\equiv -1{\pmod {11}}.} Proof using Fermat's little theorem Again, the result is trivial for p = 2, so suppose p is an odd prime, p ≥  3 . Consider the polynomial g ( x ) = ( x − − 1 ) ( x − − 2 ) ⋯ ⋯ ( x − − ( p − − 1 ) ) .

{\displaystyle g(x)=(x-1)(x-2)\cdots (x-(p-1)).} g has degree p − 1 , leading term x p − 1 , and constant term ( p − 1)!

. Its p − 1 roots are 1, 2, ..., p − 1 .

Now consider h ( x ) = x p − − 1 − − 1.

{\displaystyle h(x)=x^{p-1}-1.} h also has degree p − 1 and leading term x p − 1 . Modulo p , Fermat's little theorem says it also has the same p − 1 roots, 1, 2, ..., p − 1 .

Finally, consider f ( x ) = g ( x ) − − h ( x ) .

{\displaystyle f(x)=g(x)-h(x).} f has degree at most p − 2 (since the leading terms cancel), and modulo p also has the p − 1 roots 1, 2, ..., p − 1 . But Lagrange's theorem says it cannot have more than p − 2 roots. Therefore, f must be identically zero (mod p ), so its constant term is ( p − 1)! + 1 ≡ 0 (mod p ) . This is Wilson's theorem.

Proof using the Sylow theorems It is possible to deduce Wilson's theorem from a particular application of the Sylow theorems . Let p be a prime. It is immediate to deduce that the symmetric group S p {\displaystyle S_{p}} has exactly ( p − − 1 ) !

{\displaystyle (p-1)!} elements of order p , namely the p -cycles C p {\displaystyle C_{p}} . On the other hand, each Sylow p -subgroup in S p {\displaystyle S_{p}} is a copy of C p {\displaystyle C_{p}} . Hence it follows that the number of Sylow p -subgroups is n p = ( p − − 2 ) !

{\displaystyle n_{p}=(p-2)!} . The third Sylow theorem implies ( p − − 2 ) !

≡ ≡ 1 ( mod p ) .

{\displaystyle (p-2)!\equiv 1{\pmod {p}}.} Multiplying both sides by ( p − 1) gives ( p − − 1 ) !

≡ ≡ p − − 1 ≡ ≡ − − 1 ( mod p ) , {\displaystyle (p-1)!\equiv p-1\equiv -1{\pmod {p}},} that is, the result.

Applications Primality tests In practice, Wilson's theorem is useless as a primality test because computing ( n − 1)! modulo n for large n is computationally complex .

[ 7 ] Quadratic residues Using Wilson's Theorem, for any odd prime p = 2 m + 1 , we can rearrange the left hand side of 1 ⋅ ⋅ 2 ⋯ ⋯ ( p − − 1 ) ≡ ≡ − − 1 ( mod p ) {\displaystyle 1\cdot 2\cdots (p-1)\ \equiv \ -1\ {\pmod {p}}} to obtain the equality 1 ⋅ ⋅ ( p − − 1 ) ⋅ ⋅ 2 ⋅ ⋅ ( p − − 2 ) ⋯ ⋯ m ⋅ ⋅ ( p − − m ) ≡ ≡ 1 ⋅ ⋅ ( − − 1 ) ⋅ ⋅ 2 ⋅ ⋅ ( − − 2 ) ⋯ ⋯ m ⋅ ⋅ ( − − m ) ≡ ≡ − − 1 ( mod p ) .

{\displaystyle 1\cdot (p-1)\cdot 2\cdot (p-2)\cdots m\cdot (p-m)\ \equiv \ 1\cdot (-1)\cdot 2\cdot (-2)\cdots m\cdot (-m)\ \equiv \ -1{\pmod {p}}.} This becomes ∏ ∏ j = 1 m j 2 ≡ ≡ ( − − 1 ) m + 1 ( mod p ) {\displaystyle \prod _{j=1}^{m}\ j^{2}\ \equiv (-1)^{m+1}{\pmod {p}}} or ( m !

) 2 ≡ ≡ ( − − 1 ) m + 1 ( mod p ) .

{\displaystyle (m!)^{2}\equiv (-1)^{m+1}{\pmod {p}}.} We can use this fact to prove part of a famous result: for any prime p such that p ≡ 1 (mod 4) , the number (−1) is a square ( quadratic residue ) mod p .  For this, suppose p = 4 k + 1 for some integer k .  Then we can take m = 2 k above, and we conclude that ( m !) 2 is congruent to (−1) (mod p ).

Formulas for primes Wilson's theorem has been used to construct formulas for primes , but they are too slow to have practical value.

p-adic gamma function Wilson's theorem allows one to define the p-adic gamma function .

Gauss's generalization Gauss proved [ 8 ] [ 9 ] that ∏ ∏ k = 1 gcd ( k , m ) = 1 m − − 1 k ≡ ≡ { − − 1 ( mod m ) if m = 4 , p α α , 2 p α α 1 ( mod m ) otherwise {\displaystyle \prod _{k=1 \atop \gcd(k,m)=1}^{m-1}\!\!k\ \equiv {\begin{cases}-1{\pmod {m}}&{\text{if }}m=4,\;p^{\alpha },\;2p^{\alpha }\\\;\;\,1{\pmod {m}}&{\text{otherwise}}\end{cases}}} where p represents an odd prime and α α {\displaystyle \alpha } a positive integer. That is, the product of the positive integers less than m and relatively prime to m is one less than a multiple of m when m is equal to 4, or a power of an odd prime, or twice a power of an odd prime; otherwise, the product is one more than a multiple of m .  The values of m for which the product is −1 are precisely the ones where there is a primitive root modulo m .

See also Wilson prime Table of congruences Agoh–Giuga conjecture Notes ^ Because if a ≡ ≡ a − − 1 ( mod p ) {\displaystyle a\equiv a^{-1}{\pmod {p}}} then a 2 − − 1 ≡ ≡ 0 ( mod p ) {\displaystyle a^{2}-1\equiv 0{\pmod {p}}} , and if the prime p {\displaystyle p} divides a 2 − − 1 = ( a − − 1 ) ( a + 1 ) {\displaystyle a^{2}-1=(a-1)(a+1)} , then by Euclid's lemma it divides either a − − 1 {\displaystyle a-1} or a + 1 {\displaystyle a+1} .

^ The Universal Book of Mathematics.

David Darling, p. 350.

^ O'Connor, John J.; Robertson, Edmund F.

"Abu Ali al-Hasan ibn al-Haytham" .

MacTutor History of Mathematics Archive .

University of St Andrews .

^ Edward Waring, Meditationes Algebraicae (Cambridge, England:  1770), page 218 (in Latin).  In the third (1782) edition of Waring's Meditationes Algebraicae , Wilson's theorem appears as problem 5 on page 380 .  On that page, Waring states:  "Hanc maxime elegantem primorum numerorum proprietatem invenit vir clarissimus, rerumque mathematicarum peritissimus Joannes Wilson Armiger."  (A man most illustrious and most skilled in mathematics, Squire John Wilson, found this most elegant property of prime numbers.) ^ Joseph Louis Lagrange, "Demonstration d'un théorème nouveau concernant les nombres premiers" (Proof of a new theorem concerning prime numbers), Nouveaux Mémoires de l'Académie Royale des Sciences et Belles-Lettres (Berlin), vol. 2, pages 125–137 (1771).

^ Giovanni Vacca (1899) "Sui manoscritti inediti di Leibniz" (On unpublished manuscripts of Leibniz), Bollettino di bibliografia e storia delle scienze matematiche ... (Bulletin of the bibliography and history of mathematics), vol. 2, pages 113–116; see page 114 (in Italian).  Vacca quotes from Leibniz's mathematical manuscripts kept at the Royal Public Library in Hanover (Germany), vol. 3 B, bundle 11, page 10: Original :  Inoltre egli intravide anche il teorema di Wilson, come risulta dall'enunciato seguente: "Productus continuorum usque ad numerum qui antepraecedit datum divisus per datum relinquit 1 (vel complementum ad unum?) si datus sit primitivus.  Si datus sit derivativus relinquet numerum qui cum dato habeat communem mensuram unitate majorem." Egli non giunse pero a dimostrarlo.

Translation :  In addition, he [Leibniz] also glimpsed Wilson's theorem, as shown in the following statement: "The product of all integers preceding the given integer, when divided by the given integer, leaves 1 (or the complement of 1?) if the given integer be prime.  If the given integer be composite, it leaves a number which has a common factor with the given integer [which is] greater than one." However, he didn't succeed in proving it.

See also:  Giuseppe Peano, ed., Formulaire de mathématiques , vol. 2, no. 3, page 85 (1897).

^ Landau, Edmund (1966) [1927]. "Part One, Chapter V: Congruences, Theorem 77".

Elementary Number Theory (2nd ed.). New York: Chelsea Publishing Company. pp.

51– 52.

LCCN 66002147 .

OCLC 1420155 .

OL 5976039M . Retrieved 2025-02-06 .

^ Lagrange, p. 132: "cette méthode devient extrémement laborieuse, & presque impracticable" ^ Gauss, DA, art. 78 ^ Cosgrave, John B.; Dilcher, Karl (2008).

"Extensions of the Gauss–Wilson theorem" .

Integers .

8 A39.

MR 2472057 .

References The Disquisitiones Arithmeticae has been translated from Gauss's Ciceronian Latin into English and German. The German edition includes all of his papers on number theory: all the proofs of quadratic reciprocity, the determination of the sign of the Gauss sum, the investigations into biquadratic reciprocity, and unpublished notes.

English translation: Gauss, Carl Friedrich; Clarke, Arthur A. (1986).

Disquisitiones Arithemeticae (2nd corrected ed.). New York: Springer .

ISBN 0-387-96254-9 .

German translation: Gauss, Carl Friedrich; Maser, H. (1965).

Untersuchungen über hohere Arithmetik (Disquisitiones Arithemeticae & other papers on number theory) (2nd ed.). New York: Chelsea.

ISBN 0-8284-0191-8 .

Landau, Edmund (1966).

Elementary Number Theory . New York: Chelsea.

.

Ore, Øystein (1988).

Number Theory and its History . Dover. pp.

259–271 .

ISBN 0-486-65620-9 .

External links "Wilson theorem" .

Encyclopedia of Mathematics .

EMS Press . 2001 [1994].

Weisstein, Eric W.

"Wilson's Theorem" .

MathWorld .

Mizar system proof: http://mizar.org/version/current/html/nat_5.html#T22 Ohana, Andrew.

"A Generalization of Wilson's Theorem" (PDF) .

NewPP limit report
Parsed by mw‐web.codfw.main‐6cc77c66b8‐5z9s6
Cached time: 20250812001111
Cache expiry: 2592000
Reduced expiry: false
Complications: [vary‐revision‐sha1, show‐toc]
CPU time usage: 0.300 seconds
Real time usage: 0.547 seconds
Preprocessor visited node count: 1760/1000000
Revision size: 17297/2097152 bytes
Post‐expand include size: 22767/2097152 bytes
Template argument size: 1420/2097152 bytes
Highest expansion depth: 9/100
Expensive parser function count: 3/500
Unstrip recursion depth: 1/20
Unstrip post‐expand size: 37586/5000000 bytes
Lua time usage: 0.142/10.000 seconds
Lua memory usage: 5302621/52428800 bytes
Number of Wikibase entities loaded: 0/500 Transclusion expansion time report (%,ms,calls,template)
100.00%  265.102      1 -total
 38.22%  101.319      2 Template:Reflist
 27.24%   72.209      1 Template:MacTutor_Biography
 19.95%   52.893      1 Template:Short_description
 13.98%   37.059      1 Template:Pp
 10.94%   28.995      5 Template:Cite_book
  9.30%   24.644      2 Template:Pagetype
  7.47%   19.814      7 Template:Main_other
  6.60%   17.495      1 Template:SDcat
  4.74%   12.579      1 Template:Noteslist Saved in parser cache with key enwiki:pcache:227323:|#|:idhash:canonical and timestamp 20250812001111 and revision id 1296341458. Rendering was triggered because: page-view Retrieved from " https://en.wikipedia.org/w/index.php?title=Wilson%27s_theorem&oldid=1296341458 " Categories : Modular arithmetic Factorial and binomial topics Theorems about prime numbers Primality tests Hidden categories: Wikipedia semi-protected pages Articles with short description Short description is different from Wikidata Articles containing proofs This page was last edited on 19 June 2025, at 11:31 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Wilson's theorem 38 languages Add topic

