Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Examples Toggle Examples subsection 1.1 Example 1 1.2 Example 2 2 Formulations 3 Complex representation 4 See also 5 References 6 Further reading Toggle the table of contents Instantaneous phase and frequency 2 languages فارسی 中文 Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia (Redirected from Unwrapped phase ) Electrical engineering concept This article may be too technical for most readers to understand .

Please help improve it to make it understandable to non-experts , without removing the technical details.

( July 2022 ) ( Learn how and when to remove this message ) Instantaneous phase and frequency are important concepts in signal processing that occur in the context of the representation and analysis of time-varying functions.

[ 1 ] The instantaneous phase (also known as local phase or simply phase ) of a complex-valued function s ( t ), is the real-valued function: φ φ ( t ) = arg ⁡ ⁡ { s ( t ) } , {\displaystyle \varphi (t)=\arg\{s(t)\},} where arg is the complex argument function .
The instantaneous frequency is the temporal rate of change of the instantaneous phase.

And for a real-valued function s ( t ), it is determined from the function's analytic representation , s a ( t ): [ 2 ] φ φ ( t ) = arg ⁡ ⁡ { s a ( t ) } = arg ⁡ ⁡ { s ( t ) + j s ^ ^ ( t ) } , {\displaystyle {\begin{aligned}\varphi (t)&=\arg\{s_{\mathrm {a} }(t)\}\\[4pt]&=\arg\{s(t)+j{\hat {s}}(t)\},\end{aligned}}} where s ^ ^ ( t ) {\displaystyle {\hat {s}}(t)} represents the Hilbert transform of s ( t ).

When φ ( t ) is constrained to its principal value , either the interval (− π , π ] or [0, 2 π ) , it is called wrapped phase . Otherwise it is called unwrapped phase , which is a continuous function of argument t , assuming s a ( t ) is a continuous function of t . Unless otherwise indicated, the continuous form should be inferred.

Instantaneous phase vs time. The function has two true discontinuities of 180° at times 21 and 59, indicative of amplitude zero-crossings. The 360° "discontinuities" at times 19, 37, and 91 are artifacts of phase wrapping.

Instantaneous phase of a frequency-modulated waveform: MSK (minimum shift keying). A 360° "wrapped" plot is simply replicated vertically two more times, creating the illusion of an unwrapped plot, but using only 3x360° of the vertical axis.

Examples [ edit ] Example 1 [ edit ] s ( t ) = A cos ⁡ ⁡ ( ω ω t + θ θ ) , {\displaystyle s(t)=A\cos(\omega t+\theta ),} where ω > 0.

s a ( t ) = A e j ( ω ω t + θ θ ) , φ φ ( t ) = ω ω t + θ θ .

{\displaystyle {\begin{aligned}s_{\mathrm {a} }(t)&=Ae^{j(\omega t+\theta )},\\\varphi (t)&=\omega t+\theta .\end{aligned}}} In this simple sinusoidal example, the constant θ is also commonly referred to as phase or phase offset .

φ ( t ) is a function of time; θ is not. In the next example, we also see that the phase offset of a real-valued sinusoid is ambiguous unless a reference (sin or cos) is specified.

φ ( t ) is unambiguously defined.

Example 2 [ edit ] s ( t ) = A sin ⁡ ⁡ ( ω ω t ) = A cos ⁡ ⁡ ( ω ω t − − π π 2 ) , {\displaystyle s(t)=A\sin(\omega t)=A\cos \left(\omega t-{\frac {\pi }{2}}\right),} where ω > 0.

s a ( t ) = A e j ( ω ω t − − π π 2 ) , φ φ ( t ) = ω ω t − − π π 2 .

{\displaystyle {\begin{aligned}s_{\mathrm {a} }(t)&=Ae^{j\left(\omega t-{\frac {\pi }{2}}\right)},\\\varphi (t)&=\omega t-{\frac {\pi }{2}}.\end{aligned}}} In both examples the local maxima of s ( t ) correspond to φ ( t ) = 2 π N for integer values of N . This has applications in the field of computer vision.

Formulations [ edit ] Instantaneous angular frequency is defined as: ω ω ( t ) = d φ φ ( t ) d t , {\displaystyle \omega (t)={\frac {d\varphi (t)}{dt}},} and instantaneous (ordinary) frequency is defined as: f ( t ) = 1 2 π π ω ω ( t ) = 1 2 π π d φ φ ( t ) d t {\displaystyle f(t)={\frac {1}{2\pi }}\omega (t)={\frac {1}{2\pi }}{\frac {d\varphi (t)}{dt}}} where φ ( t ) must be the unwrapped phase ; otherwise, if φ ( t ) is wrapped, discontinuities in φ ( t ) will result in Dirac delta impulses in f ( t ).

The inverse operation, which always unwraps phase, is: φ φ ( t ) = ∫ ∫ − − ∞ ∞ t ω ω ( τ τ ) d τ τ = 2 π π ∫ ∫ − − ∞ ∞ t f ( τ τ ) d τ τ = ∫ ∫ − − ∞ ∞ 0 ω ω ( τ τ ) d τ τ + ∫ ∫ 0 t ω ω ( τ τ ) d τ τ = φ φ ( 0 ) + ∫ ∫ 0 t ω ω ( τ τ ) d τ τ .

{\displaystyle {\begin{aligned}\varphi (t)&=\int _{-\infty }^{t}\omega (\tau )\,d\tau =2\pi \int _{-\infty }^{t}f(\tau )\,d\tau \\[5pt]&=\int _{-\infty }^{0}\omega (\tau )\,d\tau +\int _{0}^{t}\omega (\tau )\,d\tau \\[5pt]&=\varphi (0)+\int _{0}^{t}\omega (\tau )\,d\tau .\end{aligned}}} This instantaneous frequency, ω ( t ), can be derived directly from the real and imaginary parts of s a ( t ), instead of the complex arg without concern of phase unwrapping.

φ φ ( t ) = arg ⁡ ⁡ { s a ( t ) } = atan2 ⁡ ⁡ ( I m [ s a ( t ) ] , R e [ s a ( t ) ] ) + 2 m 1 π π = arctan ⁡ ⁡ ( I m [ s a ( t ) ] R e [ s a ( t ) ] ) + m 2 π π {\displaystyle {\begin{aligned}\varphi (t)&=\arg\{s_{\mathrm {a} }(t)\}\\[4pt]&=\operatorname {atan2} ({\mathcal {Im}}[s_{\mathrm {a} }(t)],{\mathcal {Re}}[s_{\mathrm {a} }(t)])+2m_{1}\pi \\[4pt]&=\arctan \left({\frac {{\mathcal {Im}}[s_{\mathrm {a} }(t)]}{{\mathcal {Re}}[s_{\mathrm {a} }(t)]}}\right)+m_{2}\pi \end{aligned}}} 2 m 1 π and m 2 π are the integer multiples of π necessary to add to unwrap the phase. At values of time, t , where there is no change to integer m 2 , the derivative of φ ( t ) is ω ω ( t ) = d φ φ ( t ) d t = d d t arctan ⁡ ⁡ ( I m [ s a ( t ) ] R e [ s a ( t ) ] ) = 1 1 + ( I m [ s a ( t ) ] R e [ s a ( t ) ] ) 2 d d t ( I m [ s a ( t ) ] R e [ s a ( t ) ] ) = R e [ s a ( t ) ] d I m [ s a ( t ) ] d t − − I m [ s a ( t ) ] d R e [ s a ( t ) ] d t ( R e [ s a ( t ) ] ) 2 + ( I m [ s a ( t ) ] ) 2 = 1 | s a ( t ) | 2 ( R e [ s a ( t ) ] d I m [ s a ( t ) ] d t − − I m [ s a ( t ) ] d R e [ s a ( t ) ] d t ) = 1 ( s ( t ) ) 2 + ( s ^ ^ ( t ) ) 2 ( s ( t ) d s ^ ^ ( t ) d t − − s ^ ^ ( t ) d s ( t ) d t ) {\displaystyle {\begin{aligned}\omega (t)={\frac {d\varphi (t)}{dt}}&={\frac {d}{dt}}\arctan \left({\frac {{\mathcal {Im}}[s_{\mathrm {a} }(t)]}{{\mathcal {Re}}[s_{\mathrm {a} }(t)]}}\right)\\[3pt]&={\frac {1}{1+\left({\frac {{\mathcal {Im}}[s_{\mathrm {a} }(t)]}{{\mathcal {Re}}[s_{\mathrm {a} }(t)]}}\right)^{2}}}{\frac {d}{dt}}\left({\frac {{\mathcal {Im}}[s_{\mathrm {a} }(t)]}{{\mathcal {Re}}[s_{\mathrm {a} }(t)]}}\right)\\[3pt]&={\frac {{\mathcal {Re}}[s_{\mathrm {a} }(t)]{\frac {d{\mathcal {Im}}[s_{\mathrm {a} }(t)]}{dt}}-{\mathcal {Im}}[s_{\mathrm {a} }(t)]{\frac {d{\mathcal {Re}}[s_{\mathrm {a} }(t)]}{dt}}}{({\mathcal {Re}}[s_{\mathrm {a} }(t)])^{2}+({\mathcal {Im}}[s_{\mathrm {a} }(t)])^{2}}}\\[3pt]&={\frac {1}{|s_{\mathrm {a} }(t)|^{2}}}\left({\mathcal {Re}}[s_{\mathrm {a} }(t)]{\frac {d{\mathcal {Im}}[s_{\mathrm {a} }(t)]}{dt}}-{\mathcal {Im}}[s_{\mathrm {a} }(t)]{\frac {d{\mathcal {Re}}[s_{\mathrm {a} }(t)]}{dt}}\right)\\[3pt]&={\frac {1}{(s(t))^{2}+\left({\hat {s}}(t)\right)^{2}}}\left(s(t){\frac {d{\hat {s}}(t)}{dt}}-{\hat {s}}(t){\frac {ds(t)}{dt}}\right)\end{aligned}}} For discrete-time functions, this can be written as a recursion: φ φ [ n ] = φ φ [ n − − 1 ] + ω ω [ n ] = φ φ [ n − − 1 ] + arg ⁡ ⁡ { s a [ n ] } − − arg ⁡ ⁡ { s a [ n − − 1 ] } ⏟ ⏟ Δ Δ φ φ [ n ] = φ φ [ n − − 1 ] + arg ⁡ ⁡ { s a [ n ] s a [ n − − 1 ] } {\displaystyle {\begin{aligned}\varphi [n]&=\varphi [n-1]+\omega [n]\\&=\varphi [n-1]+\underbrace {\arg\{s_{\mathrm {a} }[n]\}-\arg\{s_{\mathrm {a} }[n-1]\}} _{\Delta \varphi [n]}\\&=\varphi [n-1]+\arg \left\{{\frac {s_{\mathrm {a} }[n]}{s_{\mathrm {a} }[n-1]}}\right\}\\\end{aligned}}} Discontinuities can then be removed by adding 2 π whenever Δ φ [ n ] ≤ − π , and subtracting 2 π whenever Δ φ [ n ] > π . That allows φ [ n ] to accumulate without limit and produces an unwrapped instantaneous phase. An equivalent formulation that replaces the modulo 2 π operation with a complex multiplication is: φ φ [ n ] = φ φ [ n − − 1 ] + arg ⁡ ⁡ { s a [ n ] s a ∗ ∗ [ n − − 1 ] } , {\displaystyle \varphi [n]=\varphi [n-1]+\arg\{s_{\mathrm {a} }[n]\,s_{\mathrm {a} }^{*}[n-1]\},} where the asterisk denotes complex conjugate. The discrete-time instantaneous frequency (in units of radians per sample) is simply the advancement of phase for that sample ω ω [ n ] = arg ⁡ ⁡ { s a [ n ] s a ∗ ∗ [ n − − 1 ] } .

{\displaystyle \omega [n]=\arg\{s_{\mathrm {a} }[n]\,s_{\mathrm {a} }^{*}[n-1]\}.} Complex representation [ edit ] In some applications, such as averaging the values of phase at several moments of time, it may be useful to convert each value to a complex number, or vector representation: [ 3 ] e i φ φ ( t ) = s a ( t ) | s a ( t ) | = cos ⁡ ⁡ ( φ φ ( t ) ) + i sin ⁡ ⁡ ( φ φ ( t ) ) .

{\displaystyle e^{i\varphi (t)}={\frac {s_{\mathrm {a} }(t)}{|s_{\mathrm {a} }(t)|}}=\cos(\varphi (t))+i\sin(\varphi (t)).} This representation is similar to the wrapped phase representation in that it does not distinguish between multiples of 2 π in the phase, but similar to the unwrapped phase representation since it is continuous. A vector-average phase can be obtained as the arg of the sum of the complex numbers without concern about wrap-around.

See also [ edit ] Angular displacement Analytic signal Frequency modulation Group delay Instantaneous amplitude Negative frequency References [ edit ] ^ Sejdic, E.; Djurovic, I.; Stankovic, L. (August 2008). "Quantitative Performance Analysis of Scalogram as Instantaneous Frequency Estimator".

IEEE Transactions on Signal Processing .

56 (8): 3837– 3845.

Bibcode : 2008ITSP...56.3837S .

doi : 10.1109/TSP.2008.924856 .

ISSN 1053-587X .

S2CID 16396084 .

^ Blackledge, Jonathan M. (2006).

Digital Signal Processing: Mathematical and Computational Methods, Software Development and Applications (2 ed.). Woodhead Publishing. p. 134.

ISBN 1904275265 .

^ Wang, S. (2014).

"An Improved Quality Guided Phase Unwrapping Method and Its Applications to MRI" .

Progress in Electromagnetics Research .

145 : 273– 286.

doi : 10.2528/PIER14021005 .

Further reading [ edit ] Cohen, Leon (1995).

Time-Frequency Analysis . Prentice Hall.

Granlund; Knutsson (1995).

Signal Processing for Computer Vision . Kluwer Academic Publishers.

Retrieved from " https://en.wikipedia.org/w/index.php?title=Instantaneous_phase_and_frequency&oldid=1287500120 " Categories : Signal processing Digital signal processing Time–frequency analysis Fourier analysis Electrical engineering Audio engineering Hidden categories: Articles with short description Short description is different from Wikidata Wikipedia articles that are too technical from July 2022 All articles that are too technical This page was last edited on 26 April 2025, at 17:25 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Instantaneous phase and frequency 2 languages Add topic

