Jump to content Main menu Main menu move to sidebar hide Navigation Main page Contents Current events Random article About Wikipedia Contact us Contribute Help Learn to edit Community portal Recent changes Upload file Special pages Search Search Appearance Donate Create account Log in Personal tools Donate Create account Log in Pages for logged out editors learn more Contributions Talk CentralNotice Contents move to sidebar hide (Top) 1 Definition 2 Expectation 3 Variance 4 Related distributions 5 References Toggle the table of contents Negative hypergeometric distribution 4 languages Català Deutsch עברית Shqip Edit links Article Talk English Read Edit View history Tools Tools move to sidebar hide Actions Read Edit View history General What links here Related changes Upload file Permanent link Page information Cite this page Get shortened URL Download QR code Print/export Download as PDF Printable version In other projects Wikidata item Appearance move to sidebar hide From Wikipedia, the free encyclopedia Discrete probability distribution Negative hypergeometric Probability mass function Cumulative distribution function Parameters N ∈ ∈ { 0 , 1 , 2 , … … } {\displaystyle N\in \left\{0,1,2,\dots \right\}} - total number of elements K ∈ ∈ { 0 , 1 , 2 , … … , N } {\displaystyle K\in \left\{0,1,2,\dots ,N\right\}} - total number of 'success' elements r ∈ ∈ { 0 , 1 , 2 , … … , N − − K } {\displaystyle r\in \left\{0,1,2,\dots ,N-K\right\}} - number of failures when experiment is stopped Support k ∈ ∈ { 0 , … … , K } {\displaystyle k\in \left\{0,\,\dots ,\,K\right\}} - number of successes when experiment is stopped.

PMF ( k + r − − 1 k ) ( N − − r − − k K − − k ) ( N K ) {\displaystyle {\frac {{{k+r-1} \choose {k}}{{N-r-k} \choose {K-k}}}{N \choose K}}} Mean r K N − − K + 1 {\displaystyle r{\frac {K}{N-K+1}}} Variance r ( N + 1 ) K ( N − − K + 1 ) ( N − − K + 2 ) [ 1 − − r N − − K + 1 ] {\displaystyle r{\frac {(N+1)K}{(N-K+1)(N-K+2)}}[1-{\frac {r}{N-K+1}}]} In probability theory and statistics , the negative hypergeometric distribution describes probabilities for when sampling from a finite population without replacement in which each sample can be classified into two mutually exclusive categories like Pass/Fail or Employed/Unemployed. As random selections are made from the population, each subsequent draw decreases the population causing the probability of success to change with each draw. Unlike the standard hypergeometric distribution , which describes the number of successes in a fixed sample size, in the negative hypergeometric distribution, samples are drawn until r {\displaystyle r} failures have been found, and the distribution describes the probability of finding k {\displaystyle k} successes in such a sample.  In other words, the negative hypergeometric distribution describes the likelihood of k {\displaystyle k} successes in a sample with exactly r {\displaystyle r} failures.

Definition [ edit ] There are N {\displaystyle N} elements, of which K {\displaystyle K} are defined as "successes" and the rest are "failures".

Elements are drawn one after the other, without replacements, until r {\displaystyle r} failures are encountered. Then, the drawing stops and the number k {\displaystyle k} of successes is counted. The negative hypergeometric distribution, N H G N , K , r ( k ) {\displaystyle NHG_{N,K,r}(k)} is the discrete distribution of this k {\displaystyle k} .

[ 1 ] The negative hypergeometric distribution is a special case of the beta-binomial distribution [ 2 ] with parameters α α = r {\displaystyle \alpha =r} and β β = N − − K − − r + 1 {\displaystyle \beta =N-K-r+1} both being integers (and n = K {\displaystyle n=K} ).

The outcome requires that we observe k {\displaystyle k} successes in ( k + r − − 1 ) {\displaystyle (k+r-1)} draws and the ( k + r ) -th {\displaystyle (k+r){\text{-th}}} bit must be a failure. The probability of the former can be found by the direct application of the hypergeometric distribution ( H G N , K , k + r − − 1 ( k ) ) {\displaystyle (HG_{N,K,k+r-1}(k))} and the probability of the latter is simply the number of failures remaining ( = N − − K − − ( r − − 1 ) ) {\displaystyle (=N-K-(r-1))} divided by the size of the remaining population ( = N − − ( k + r − − 1 ) {\displaystyle (=N-(k+r-1)} . The probability of having exactly k {\displaystyle k} successes up to the r -th {\displaystyle r{\text{-th}}} failure (i.e. the drawing stops as soon as the sample includes the predefined number of r {\displaystyle r} failures) is then the product of these two probabilities: ( K k ) ( N − − K k + r − − 1 − − k ) ( N k + r − − 1 ) ⋅ ⋅ N − − K − − ( r − − 1 ) N − − ( k + r − − 1 ) = ( k + r − − 1 k ) ( N − − r − − k K − − k ) ( N K ) .

{\displaystyle {\frac {{\binom {K}{k}}{\binom {N-K}{k+r-1-k}}}{\binom {N}{k+r-1}}}\cdot {\frac {N-K-(r-1)}{N-(k+r-1)}}={\frac {{{k+r-1} \choose {k}}{{N-r-k} \choose {K-k}}}{N \choose K}}.} Therefore, a random variable X {\displaystyle X} follows the negative hypergeometric distribution if its probability mass function (pmf) is given by f ( k ; N , K , r ) ≡ ≡ Pr ( X = k ) = ( k + r − − 1 k ) ( N − − r − − k K − − k ) ( N K ) for k = 0 , 1 , 2 , … … , K {\displaystyle f(k;N,K,r)\equiv \Pr(X=k)={\frac {{{k+r-1} \choose {k}}{{N-r-k} \choose {K-k}}}{N \choose K}}\quad {\text{for }}k=0,1,2,\dotsc ,K} where N {\displaystyle N} is the population size, K {\displaystyle K} is the number of success states in the population, r {\displaystyle r} is the number of failures, k {\displaystyle k} is the number of observed successes, ( a b ) {\displaystyle a \choose b} is a binomial coefficient By design the probabilities sum up to 1. However, in case we want show it explicitly we have: ∑ ∑ k = 0 K Pr ( X = k ) = ∑ ∑ k = 0 K ( k + r − − 1 k ) ( N − − r − − k K − − k ) ( N K ) = 1 ( N K ) ∑ ∑ k = 0 K ( k + r − − 1 k ) ( N − − r − − k K − − k ) = 1 ( N K ) ( N K ) = 1 , {\displaystyle \sum _{k=0}^{K}\Pr(X=k)=\sum _{k=0}^{K}{\frac {{{k+r-1} \choose {k}}{{N-r-k} \choose {K-k}}}{N \choose K}}={\frac {1}{N \choose K}}\sum _{k=0}^{K}{{k+r-1} \choose {k}}{{N-r-k} \choose {K-k}}={\frac {1}{N \choose K}}{N \choose K}=1,} where we have used that, ∑ ∑ j = 0 k ( j + m j ) ( n − − m − − j k − − j ) = ∑ ∑ j = 0 k ( − − 1 ) j ( − − m − − 1 j ) ( − − 1 ) k − − j ( m + 1 + k − − n − − 2 k − − j ) = ( − − 1 ) k ∑ ∑ j = 0 k ( − − m − − 1 j ) ( k − − n − − 2 − − ( − − m − − 1 ) k − − j ) = ( − − 1 ) k ( k − − n − − 2 k ) = ( − − 1 ) k ( k − − ( n + 1 ) − − 1 k ) = ( n + 1 k ) , {\displaystyle {\begin{aligned}\sum _{j=0}^{k}{\binom {j+m}{j}}{\binom {n-m-j}{k-j}}&=\sum _{j=0}^{k}(-1)^{j}{\binom {-m-1}{j}}(-1)^{k-j}{\binom {m+1+k-n-2}{k-j}}\\&=(-1)^{k}\sum _{j=0}^{k}{\binom {-m-1}{j}}{\binom {k-n-2-(-m-1)}{k-j}}\\&=(-1)^{k}{\binom {k-n-2}{k}}\\&=(-1)^{k}{\binom {k-(n+1)-1}{k}}\\&={\binom {n+1}{k}},\end{aligned}}} which can be derived using the binomial identity , ( n k ) = ( − − 1 ) k ( k − − n − − 1 k ) , {\displaystyle {{n \choose k}=(-1)^{k}{k-n-1 \choose k}},} and the Chu–Vandermonde identity , ∑ ∑ j = 0 k ( m j ) ( n − − m k − − j ) = ( n k ) , {\displaystyle \sum _{j=0}^{k}{\binom {m}{j}}{\binom {n-m}{k-j}}={\binom {n}{k}},} which holds for any complex-values m {\displaystyle m} and n {\displaystyle n} and any non-negative integer k {\displaystyle k} .

Expectation [ edit ] When counting the number k {\displaystyle k} of successes before r {\displaystyle r} failures, the expected number of successes is r K N − − K + 1 {\displaystyle {\frac {rK}{N-K+1}}} and can be derived as follows.

E [ X ] = ∑ ∑ k = 0 K k Pr ( X = k ) = ∑ ∑ k = 0 K k ( k + r − − 1 k ) ( N − − r − − k K − − k ) ( N K ) = r ( N K ) [ ∑ ∑ k = 0 K ( k + r ) r ( k + r − − 1 r − − 1 ) ( N − − r − − k K − − k ) ] − − r = r ( N K ) [ ∑ ∑ k = 0 K ( k + r r ) ( N − − r − − k K − − k ) ] − − r = r ( N K ) [ ∑ ∑ k = 0 K ( k + r k ) ( N − − r − − k K − − k ) ] − − r = r ( N K ) [ ( N + 1 K ) ] − − r = r K N − − K + 1 , {\displaystyle {\begin{aligned}E[X]&=\sum _{k=0}^{K}k\Pr(X=k)=\sum _{k=0}^{K}k{\frac {{{k+r-1} \choose {k}}{{N-r-k} \choose {K-k}}}{N \choose K}}={\frac {r}{N \choose K}}\left[\sum _{k=0}^{K}{\frac {(k+r)}{r}}{{k+r-1} \choose {r-1}}{{N-r-k} \choose {K-k}}\right]-r\\&={\frac {r}{N \choose K}}\left[\sum _{k=0}^{K}{{k+r} \choose {r}}{{N-r-k} \choose {K-k}}\right]-r={\frac {r}{N \choose K}}\left[\sum _{k=0}^{K}{{k+r} \choose {k}}{{N-r-k} \choose {K-k}}\right]-r\\&={\frac {r}{N \choose K}}\left[{{N+1} \choose K}\right]-r={\frac {rK}{N-K+1}},\end{aligned}}} where we have used the relationship ∑ ∑ j = 0 k ( j + m j ) ( n − − m − − j k − − j ) = ( n + 1 k ) {\displaystyle \sum _{j=0}^{k}{\binom {j+m}{j}}{\binom {n-m-j}{k-j}}={\binom {n+1}{k}}} , that we derived above to show that the negative hypergeometric distribution was properly normalized.

Variance [ edit ] The variance can be derived by the following calculation.

E [ X 2 ] = ∑ ∑ k = 0 K k 2 Pr ( X = k ) = [ ∑ ∑ k = 0 K ( k + r ) ( k + r + 1 ) Pr ( X = k ) ] − − ( 2 r + 1 ) E [ X ] − − r 2 − − r = r ( r + 1 ) ( N K ) [ ∑ ∑ k = 0 K ( k + r + 1 r + 1 ) ( N + 1 − − ( r + 1 ) − − k K − − k ) ] − − ( 2 r + 1 ) E [ X ] − − r 2 − − r = r ( r + 1 ) ( N K ) [ ( N + 2 K ) ] − − ( 2 r + 1 ) E [ X ] − − r 2 − − r = r K ( N − − r + K r + 1 ) ( N − − K + 1 ) ( N − − K + 2 ) {\displaystyle {\begin{aligned}E[X^{2}]&=\sum _{k=0}^{K}k^{2}\Pr(X=k)=\left[\sum _{k=0}^{K}(k+r)(k+r+1)\Pr(X=k)\right]-(2r+1)E[X]-r^{2}-r\\&={\frac {r(r+1)}{N \choose K}}\left[\sum _{k=0}^{K}{{k+r+1} \choose {r+1}}{{N+1-(r+1)-k} \choose {K-k}}\right]-(2r+1)E[X]-r^{2}-r\\&={\frac {r(r+1)}{N \choose K}}\left[{{N+2} \choose K}\right]-(2r+1)E[X]-r^{2}-r={\frac {rK(N-r+Kr+1)}{(N-K+1)(N-K+2)}}\end{aligned}}} Then the variance is Var [ X ] = E [ X 2 ] − − ( E [ X ] ) 2 = r K ( N + 1 ) ( N − − K − − r + 1 ) ( N − − K + 1 ) 2 ( N − − K + 2 ) {\displaystyle {\textrm {Var}}[X]=E[X^{2}]-\left(E[X]\right)^{2}={\frac {rK(N+1)(N-K-r+1)}{(N-K+1)^{2}(N-K+2)}}} Related distributions [ edit ] If the drawing stops after a constant number n {\displaystyle n} of draws (regardless of the number of failures), then the number of successes has the hypergeometric distribution , H G N , K , n ( k ) {\displaystyle HG_{N,K,n}(k)} .  The two functions are related in the following way: [ 1 ] N H G N , K , r ( k ) = 1 − − H G N , N − − K , k + r ( r − − 1 ) {\displaystyle NHG_{N,K,r}(k)=1-HG_{N,N-K,k+r}(r-1)} Negative-hypergeometric distribution (like the hypergeometric distribution) deals with draws without replacement , so that the probability of success is different in each draw. In contrast, negative-binomial distribution (like the binomial distribution) deals with draws with replacement , so that the probability of success is the same and the trials are independent. The following table summarizes the four distributions related to drawing items: With replacements No replacements # of successes in constant # of draws binomial distribution hypergeometric distribution # of successes in constant # of failures negative binomial distribution negative hypergeometric distribution Some authors [ 3 ] [ 4 ] define the negative hypergeometric distribution to be the number of draws required to get the r {\displaystyle r} th failure. If we let Y {\displaystyle Y} denote this number then it is clear that Y = X + r {\displaystyle Y=X+r} where X {\displaystyle X} is as defined above. Hence the PMF Pr ( Y = y ) = ( y − − 1 r − − 1 ) ( N − − y N − − K − − r ) ( N N − − K ) .

{\displaystyle \Pr(Y=y)={\binom {y-1}{r-1}}{\frac {\binom {N-y}{N-K-r}}{\binom {N}{N-K}}}.} If we let the number of failures N − − K {\displaystyle N-K} be denoted by M {\displaystyle M} means that we have Pr ( Y = y ) = ( y − − 1 r − − 1 ) ( N − − y M − − r ) ( N M ) .

{\displaystyle \Pr(Y=y)={\binom {y-1}{r-1}}{\frac {\binom {N-y}{M-r}}{\binom {N}{M}}}.} The support of Y {\displaystyle Y} is the set { r , r + 1 , … … , N − − M + r } {\displaystyle \{r,r+1,\dots ,N-M+r\}} . It is clear that: E [ Y ] = E [ X ] + r = r ( N + 1 ) M + 1 {\displaystyle E[Y]=E[X]+r={\frac {r(N+1)}{M+1}}} and Var [ X ] = Var [ Y ] {\displaystyle {\textrm {Var}}[X]={\textrm {Var}}[Y]} .

References [ edit ] ^ a b Negative hypergeometric distribution in Encyclopedia of Math.

^ Johnson, Norman L.; Kemp, Adrienne W.

; Kotz, Samuel (2005).

Univariate Discrete Distributions . Wiley.

ISBN 0-471-27246-9 .

§6.2.2 (p.253–254) ^ Rohatgi, Vijay K., and AK Md Ehsanes Saleh. An introduction to probability and statistics. John Wiley & Sons, 2015.

^ Khan, RA (1994). A note on the generating function of a negative hypergeometric distribution. Sankhya: The Indian Journal of Statistics B, 56(3), 309-313.

v t e Probability distributions ( list ) Discrete univariate with finite support Benford Bernoulli Beta-binomial Binomial Categorical Hypergeometric Negative Poisson binomial Rademacher Soliton Discrete uniform Zipf Zipf–Mandelbrot with infinite support Beta negative binomial Borel Conway–Maxwell–Poisson Discrete phase-type Delaporte Extended negative binomial Flory–Schulz Gauss–Kuzmin Geometric Logarithmic Mixed Poisson Negative binomial Panjer Parabolic fractal Poisson Skellam Yule–Simon Zeta Continuous univariate supported on a bounded interval Arcsine ARGUS Balding–Nichols Bates Beta Generalized Beta rectangular Continuous Bernoulli Irwin–Hall Kumaraswamy Logit-normal Noncentral beta PERT Raised cosine Reciprocal Triangular U-quadratic Uniform Wigner semicircle supported on a semi-infinite interval Benini Benktander 1st kind Benktander 2nd kind Beta prime Burr Chi Chi-squared Noncentral Inverse Scaled Dagum Davis Erlang Hyper Exponential Hyperexponential Hypoexponential Logarithmic F Noncentral Folded normal Fréchet Gamma Generalized Inverse gamma/Gompertz Gompertz Shifted Half-logistic Half-normal Hotelling's T -squared Hartman–Watson Inverse Gaussian Generalized Kolmogorov Lévy Log-Cauchy Log-Laplace Log-logistic Log-normal Log-t Lomax Matrix-exponential Maxwell–Boltzmann Maxwell–Jüttner Mittag-Leffler Nakagami Pareto Phase-type Poly-Weibull Rayleigh Relativistic Breit–Wigner Rice Truncated normal type-2 Gumbel Weibull Discrete Wilks's lambda supported on the whole real line Cauchy Exponential power Fisher's z Kaniadakis κ-Gaussian Gaussian q Generalized hyperbolic Generalized logistic (logistic-beta) Generalized normal Geometric stable Gumbel Holtsmark Hyperbolic secant Johnson's S U Landau Laplace Asymmetric Logistic Noncentral t Normal (Gaussian) Normal-inverse Gaussian Skew normal Slash Stable Student's t Tracy–Widom Variance-gamma Voigt with support whose type varies Generalized chi-squared Generalized extreme value Generalized Pareto Marchenko–Pastur Kaniadakis κ -exponential Kaniadakis κ -Gamma Kaniadakis κ -Weibull Kaniadakis κ -Logistic Kaniadakis κ -Erlang q -exponential q -Gaussian q -Weibull Shifted log-logistic Tukey lambda Mixed univariate continuous- discrete Rectified Gaussian Multivariate (joint) Discrete: Ewens Multinomial Dirichlet Negative Continuous: Dirichlet Generalized Multivariate Laplace Multivariate normal Multivariate stable Multivariate t Normal-gamma Inverse Matrix-valued: LKJ Matrix beta Matrix normal Matrix t Matrix gamma Inverse Wishart Normal Inverse Normal-inverse Complex Uniform distribution on a Stiefel manifold Directional Univariate (circular) directional Circular uniform Univariate von Mises Wrapped normal Wrapped Cauchy Wrapped exponential Wrapped asymmetric Laplace Wrapped Lévy Bivariate (spherical) Kent Bivariate (toroidal) Bivariate von Mises Multivariate von Mises–Fisher Bingham Degenerate and singular Degenerate Dirac delta function Singular Cantor Families Circular Compound Poisson Elliptical Exponential Natural exponential Location–scale Maximum entropy Mixture Pearson Tweedie Wrapped Category Commons Retrieved from " https://en.wikipedia.org/w/index.php?title=Negative_hypergeometric_distribution&oldid=1291634405 " Categories : Discrete distributions Factorial and binomial topics Hidden categories: Articles with short description Short description is different from Wikidata This page was last edited on 22 May 2025, at 13:35 (UTC) .

Text is available under the Creative Commons Attribution-ShareAlike 4.0 License ;
additional terms may apply. By using this site, you agree to the Terms of Use and Privacy Policy . Wikipedia® is a registered trademark of the Wikimedia Foundation, Inc.

, a non-profit organization.

Privacy policy About Wikipedia Disclaimers Contact Wikipedia Code of Conduct Developers Statistics Cookie statement Mobile view Search Search Toggle the table of contents Negative hypergeometric distribution 4 languages Add topic

